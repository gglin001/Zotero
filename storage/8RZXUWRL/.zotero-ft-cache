Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3007

Optical blood pressure estimation with photoplethysmography and FFT-based neural networks
XIAOMAN XING* AND MINGSHAN SUN
Medical Imaging Department, Suzhou Institute of Biomedical Engineering and Technology, Chinese Academy of Sciences, 88 Keling Road, SND, Suzhou, Jiangsu, 215163, China *xingxm@sibet.ac.cn
Abstract: We introduce and validate a beat-to-beat optical blood pressure (BP) estimation paradigm using only photoplethysmogram (PPG) signal from finger tips. The scheme determines subject-specific contribution to PPG signal and removes most of its influence by proper normalization. Key features such as amplitudes and phases of cardiac components were extracted by a fast Fourier transform and were used to train an artificial neural network, which was then used to estimate BP from PPG. Validation was done on 69 patients from the MIMIC II database plus 23 volunteers. All estimations showed a good correlation with the reference values. This method is fast and robust, and can potentially be used to perform pulse wave analysis in addition to BP estimation.
©2016 Optical Society of America
OCIS codes: (170.1610) Clinical applications; (170.3890) Medical optics instrumentation; (280.1415) Biological sensing and sensors.
References and links
1. A. V. Chobanian, G. L. Bakris, H. R. Black, W. C. Cushman, L. A. Green, J. L. Izzo, Jr., D. W. Jones, B. J. Materson, S. Oparil, J. T. Wright, Jr., and E. J. Roccella; Joint National Committee on Prevention, Detection, Evaluation, and Treatment of High Blood Pressure. National Heart, Lung, and Blood Institute; National High Blood Pressure Education Program Coordinating Committee, “Seventh report of the Joint National Committee on Prevention, Detection, Evaluation, and Treatment of High Blood Pressure,” Hypertension 42(6), 1206–1252 (2003).
2. S. Lewington, R. Clarke, N. Qizilbash, R. Peto, and R. Collins; Prospective Studies Collaboration, “Age-specific relevance of usual blood pressure to vascular mortality: a meta-analysis of individual data for one million adults in 61 prospective studies,” Lancet 360(9349), 1903–1913 (2002).
3. R. Agarwal, J. E. Bills, T. J. Hecht, and R. P. Light, “Role of home blood pressure monitoring in overcoming therapeutic inertia and improving hypertension control: a systematic review and meta-analysis,” Hypertension 57(1), 29–38 (2011).
4. E. O’Brien, R. Asmar, L. Beilin, Y. Imai, J. M. Mallion, G. Mancia, T. Mengden, M. Myers, P. Padfield, P. Palatini, G. Parati, T. Pickering, J. Redon, J. Staessen, G. Stergiou, and P. Verdecchia; European Society of Hypertension Working Group on Blood Pressure Monitoring, “European Society of Hypertension recommendations for conventional, ambulatory and home blood pressure measurement,” J. Hypertens. 21(5), 821–848 (2003).
5. D. Chemla, J. L. Teboul, and C. Richard, “Noninvasive assessment of arterial pressure,” Curr. Opin. Crit. Care 14(3), 317–321 (2008).
6. B. P. Imholz, W. Wieling, G. A. van Montfrans, and K. H. Wesseling, “Fifteen years experience with finger arterial pressure monitoring: assessment of the technology,” Cardiovasc. Res. 38(3), 605–616 (1998).
7. B. Williams, P. S. Lacy, F. Baschiera, P. Brunel, and R. Düsing, “Novel description of the 24-hour circadian rhythms of brachial versus central aortic blood pressure and the impact of blood pressure treatment in a randomized controlled clinical trial: The Ambulatory Central Aortic Pressure (AmCAP) Study,” Hypertension 61(6), 1168–1176 (2013).
8. B. Williams, P. S. Lacy, P. Yan, C.-N. Hwee, C. Liang, and C.-M. Ting, “Development and validation of a novel method to derive central aortic systolic pressure from the radial pressure waveform using an n-point moving average method,” J. Am. Coll. Cardiol. 57(8), 951–961 (2011).
9. C. H. Chen, E. Nevo, B. Fetics, P. H. Pak, F. C. Yin, W. L. Maughan, and D. A. Kass, “Estimation of central aortic pressure waveform by mathematical transformation of radial tonometry pressure. Validation of generalized transfer function,” Circulation 95(7), 1827–1836 (1997).
10. Jeon Lee and Ki Chang Nam, “Tonometric Vascular Function Assessment,” in Biomedical Engineering, Carlos Alexandre Barros de Mello, ed. (InTech, 2009).
11. L. A. Geddes, M. H. Voelz, C. F. Babbs, J. D. Bourland, and W. A. Tacker, “Pulse Transit Time as an Indicator of Arterial Blood Pressure,” Psychophysiology 18(1), 71–74 (1981).

#261929 Journal © 2016

http://dx.doi.org/10.1364/BOE.7.003007 Received 1 Apr 2016; revised 30 Jun 2016; accepted 7 Jul 2016; published 12 Jul 2016

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3008
12. Y. Choi, Q. Zhang, and S. Ko, “Noninvasive cuffless blood pressure estimation using pulse transit time and Hilbert–Huang transform,” Comput. Electr. Eng. 39(1), 103–111 (2013).
13. R. A. Payne, C. N. Symeonides, D. J. Webb, and S. R. J. Maxwell, “Pulse transit time measured from the ECG: an unreliable marker of beat-to-beat blood pressure,” J. Appl. Physiol. 100(1), 136–141 (2006).
14. R. Mukkamala, J.-O. Hahn, O. T. Inan, L. K. Mestha, C.-S. Kim, H. Töreyin, and S. Kyal, “Toward Ubiquitous Blood Pressure Monitoring via Pulse Transit Time: Theory and Practice,” IEEE Trans. Biomed. Eng. 62(8), 1879–1901 (2015).
15. S. C. Millasseau, F. G. Guigui, R. P. Kelly, K. Prasad, J. R. Cockcroft, J. M. Ritter, and P. J. Chowienczyk, “Noninvasive assessment of the digital volume pulse. Comparison with the peripheral pressure pulse,” Hypertension 36(6), 952–956 (2000).
16. Y. Kurylyak, F. Lamonaca, and D. Grimaldi, “A Neural Network-based method for continuous blood pressure estimation from a PPG signal,” in Proceedings of IEEE conference on Instrumentation and Measurement Technology (IEEE, 2013), pp. 280–283.
17. J. Allen and A. Murray, “Modelling the relationship between peripheral blood pressure and blood volume pulses using linear and neural network system identification techniques,” Physiol. Meas. 20(3), 287–301 (1999).
18. X. R. Ding, Y. T. Zhang, J. Liu, W. X. Dai, and H. K. Tsang, “Continuous Cuffless Blood Pressure Estimation Using Pulse Transit Time and Photoplethysmogram Intensity Ratio,” IEEE Trans. Biomed. Eng. 63(5), 964–972 (2016).
19. T. Aoyagi, “Pulse oximetry: its invention, theory, and future,” J. Anesth. 17(4), 259–266 (2003). 20. I. Yoshiya, Y. Shimada, and K. Tanaka, “Spectrophotometric monitoring of arterial oxygen saturation in the
fingertip,” Med. Biol. Eng. Comput. 18(1), 27–32 (1980). 21. T. W. Secomb, “Hemodynamics,” Compr. Physiol. 6(2), 975–1003 (2016). 22. A. Langewouters, G. J. F. Zwart, R. Zwart, A. F. Busse, K. H. Busse, R. F. Wesseling, and K. H. Wesseling,
“Pressure-diameter relationships of segments of human finger arteries,” Clin. Phys. Physiol. Meas. 7(1), 41–56 (1986). 23. G. Venmathi, “Continuous Non-Invasive Arterial Blood Pressure Measurement Using Photoplethysmography,” (UC San Diego: Thesis in Bioengineering), http://escholarship.org/uc/item/8fq5k1hp 24. D. J. Hughes, C. F. Babbs, L. A. Geddes, and J. D. Bourland, “Measurements of Young’s modulus of elasticity of the canine aorta with ultrasound,” Ultrason. Imaging 1(4), 356–367 (1979). 25. D. H. Bergel, “The static elastic properties of the arterial wall,” J. Physiol. 156(3), 445–457 (1961). 26. L. H. Peterson, R. E. Jensen, and J. Parnell, “Mechanical Properties of Arteries in Vivo,” Circ. Res. 8(3), 622– 639 (1960). 27. A. L. Goldberger, L. A. N. Amaral, L. Glass, J. M. Hausdorff, P. C. Ivanov, R. G. Mark, J. E. Mietus, G. B. Moody, C.-K. Peng, and H. E. Stanley, “PhysioBank, PhysioToolkit, and PhysioNet: components of a new research resource for complex physiologic signals,” Circulation 101(23), E215–E220 (2000). 28. G. B. Moody and R. G. Mark, “A database to support development and evaluation of intelligent intensive care monitoring,” in Proceedings of IEEE Conference on Computers in Cardiology (IEEE, 1996), pp. 657–660. 29. J. X. Sun, A. T. Reisner, and R. G. Mark, “A signal abnormality index for arterial blood pressure waveforms,” in Proceedings of IEEE Conference on Computers in Cardiology (IEEE, 2006), pp. 13–16. 30. I. Silva, J. Lee, and R. Mark, “Photoplethysmograph quality estimation through multichannel filtering,” in Proceedings of IEEE Conference on Engineering in Medicine and Biology Society (IEEE, 2011), pp. 4361–4364. 31. Q. Li and G. D. Clifford, “Dynamic time warping and machine learning for signal quality assessment of pulsatile signals,” Physiol. Meas. 33(9), 1491–1501 (2012). 32. P. R. Fleming, “The mechanism of the pulsus bisferiens,” Br. Heart J. 19(4), 519–524 (1957). 33. D. Hayoz, B. Rutschmann, F. Perret, M. Niederberger, Y. Tardy, V. Mooser, J. Nussberger, B. Waeber, and H. R. Brunner, “Conduit artery compliance and distensibility are not necessarily reduced in hypertension,” Hypertension 20(1), 1–6 (1992). 34. E. C. Chua, S. J. Redmond, G. McDarby, and C. Heneghan, “Towards using photo-plethysmogram amplitude to measure blood pressure during sleep,” Ann. Biomed. Eng. 38(3), 945–954 (2010). 35. E. O’Brien, B. Waeber, G. Parati, J. Staessen, and M. G. Myers, “Blood pressure measuring devices: recommendations of the European Society of Hypertension,” BMJ 322(7285), 531–536 (2001). 36. M. Elgendi, “On the analysis of fingertip photoplethysmogram signals,” Curr. Cardiol. Rev. 8(1), 14–25 (2012). 37. P. E. Marik, R. Cavallazzi, T. Vasu, and A. Hirani, “Dynamic changes in arterial waveform derived variables and fluid responsiveness in mechanically ventilated patients: a systematic review of the literature,” Crit. Care Med. 37(9), 2642–2647 (2009). 38. A. A. Alian and K. H. Shelley, “Photoplethysmography,” Best Pract. Res. Clin. Anaesthesiol. 28(4), 395–406 (2014). 39. K. H. Shelley, “Photoplethysmography: beyond the calculation of arterial oxygen saturation and heart rate,” Anesth. Analg. 105(6 Suppl), S31–S36 (2007).
1. Introduction
Suboptimal blood pressure (BP) is the number one risk factor for death throughout the world, but currently only one third of the hypertensive population has their BP under control [1]. One major reason is the lack of proper monitoring and feedback on the treatment. In patients with hypertension, rapid BP change can occur with physical activity, emotion and stress, it is thus crucial for hypertensive people to monitor their BP continuously and get timely medical

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3009
intervention, so that serious cardiovascular complications may be avoided [2,3]. Compared to conventional BP measured by auscultation, continuous BP is also considered a better preditor for cardiovascular events [4]. Unfortunately, to this day, the most widely used non-invasive sphygmomanometers, especially for home use, are still cuff-based, which interrupt regular blood flow, and are too cumbersome to wear for an extended period of time. Besides, this method only measures the systolic blood pressure (SBP) and diastolic blood pressure (DBP), with limited additional information [5].
Volume clamping is a new technology that measures BP noninvasively and continuously [6]. The idea is to keep the blood volume throughout the cardiac cycle constant, by rapidly inflating and deflating a tiny cuff around the finger. The applied cuff pressure is then used to estimate BP. This method is accurate and measures pressure waveforms, but the instrument is very expensive and difficult to wear. The finger cuff also limits the blood flow, and causes a sense of numbness if worn for a long time.
Applanation tonometry can measure entire peripheral BP waveforms continuously and cufflessly [7]. With proper transfer functions, central blood pressures can be derived and more diagnostic information can be extracted [8,9]. However, this method still need to compress the radial artery and the devices are uncomfortable to wear. Besides, the artery must be flattened in a carefully controlled manner, to keep a perpendicular wall tension and constant deflection in the perpendicular direction [10], which is very difficult in practice and needs constant calibration. This method also has a potential bias related to the use of a generalized transfer function (GTF).
In recent years, BP measurement with photoplethysmogram (PPG) has shown a lot of promise. Previous studies have reported an inverse correlation between BP and the pulse transit time (PTT) [11,12]. However, this method requires additional measurements of Electrocardiogram (ECG) or Ballistocardiography (BCG), and relies on very complicated arterial wave propagation models. Even with calibration, due to different physiological parameters, the dynamic nature of human muscle and hydrostatic change, PTT is not always a reliable marker of beat-to-beat blood pressure [13,14]. Thus, its usage is limited to track BP changes and for qualitative analysis, such as to tell whether the BP is at a level of concern.
Optical BP estimation with only PPG signal, on the other hand, has a couple of practical advantages. First, PPG was shown to resemble the waveform of carotid pressure [15]. Secondly, a PPG device is inexpensive and the measurement is operator independent. This method was investigated in previous work [15–17]. For example, Kurylyak et al used 21 freatures extracted from timing information of PPG waveforms to calculate SBP and DBP [16]. However, their work didn’t keep the fine details of PPG waveforms and the selection of parameters was mainly empirical. S. C. Millasseau et al reported a method to calculate normalized BP waveform from PPG, which was based on fast Fourier transforms (FFT) and generalized transfer function (GTF) [15]. They found that GTF could be applied to almost all subjects, even after nitroglycerin administration. However, it bore the same disadvantage of using GTF, and their main purpose was only to compare the shape of the waveform instead of fitting BP amplitude. John Allen et al used linear and neural network system identification techniques to correlate the BP and PPG waveforms [17]. They used a linear auto-regressive with exogenous variable (ARX) model to extract waveform features, and confirmed a strong tie between PPG and BP waveforms. However, this method requires a long initial calibration, and is prone to influences by age etc. Xiaorong Ding et al has proposed a hybrid method, that used both PPG intensity information and PTT to derive BP, showing improvement upon using PTT only [18]. However, they only incorporated the peak to peak amplitude information of the PPG waveforms and the measurement still required the use of ECG.
Our aim is to provide a theoretical explanation of PPG waveforms, and design an algorithm to estimate BP accurately from PPG signal, so that a wearable, continuous, and cuffless device can be developed and hypertensive population can use this device to better manage their BP in all conditions. This paper is organized as follows: in Section 2, theoretical relation between PPG and BP is derived, in Section 3, data preprocessing steps and ANN

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3010
structures are described, Section 4 shows the experimental results and discusses future research directions, Section 5 gives a conclusion to this study. 2. Theoretical background 2.1 Theory of photoplethysmograph A photoplethysmogram measures blood volume change by illuminating the skin and calculating light absorption changes. Except for critically ill patients, the measurement site is typically on the fingers. The concept of modern PPG measurement originated from Aoyagi [19] and Yoshiya [20], who associated the time variant PPG signal with arterial blood volume change, and assumed that venous blood didn’t pulsate.
The pulsating part of blood volume (commonly referred to as the AC part) is mainly caused by the pulsation of blood pressure over the cardiac cycle. It’s usually very small, and is superimposed onto a large non pulsating part (the DC part). Normalization is usually performed by dividing the AC part by the DC part, and the signal is linearly scaled to yield PPG waveforms within a certain amplitude range.

Fig. 1. Schematic for instrument design, PPG signal decomposition and normalization.

2.2 Arterial wall mechanics
To derive a relation between PPG and BP signals, it’s crucial to understand the elastic property of blood vessels and how blood volume changes with blood pressure. Blood vessel wall is anisotropic in structure that has highly nonlinear elastic properties, thus a simple Hookean model doesn’t apply here [21]. Langewouters et al derived a relationship between BP in the human finger and the change in the arterial radius [22]. However, the expression was complicated, and has limited success in BP estimation applications [23]. In this paper, we will adopt a simpler formula to establish the relation between the two.
The arterial wall stress is generally born by collagen, elastin and smooth muscle [21]. Their combined dynamic Young's modulus of elasticity (E) determines the stiffness of blood vessels. A number of in vitro studies have been carried out to estimate the relationship between E and the transmural pressure (P). One widely used empirical formula was given by Hughes et al [24]

E = E0eγ P

(1)

In Eq. (1), E0 and γ depend on the site of measurement and upon the particular animal. For example, γ measured in canine aorta is 0.017 ± 0.004 mm Hg−1 [24]. Bergel et al and Peterson et al [25,26] used different approaches to calculate E, which can be simplified approximately to

E

=

(1 − σ

2)×

r2 h

×

dP dr

(2)

Here, σ is Poisson’s ratio and is typically treated as a constant. In some previous studies [25], σ was assumed to be 0.5, which treated E as incremental modulus. Since we only care about

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3011

the circumferential stress, E was chosen to represent the “tension-strain modulus” and σ was set to 0. Note that the choice of σ doesn’t affect the general conclusion drawn in the next section. h represents the thickness of the blood vessel wall, and r represents the mean radius of the blood vessel.

2.3 Interpretation of PPG signal

To simplify our model, we assume PPG signal correlates linearly with the blood volume (V) in the fingertip, and arterial blood vessels in the finger vascular bed have a uniform radius r, so that V in the measured area can be written as

V = Cπ r2 + V0

(3)

Here C is a constant related to arterial blood vessel density, and V0 is related to microvascular and venous blood volume. Suppose V0 doesn’t pulsate, and combine Eq. (1)-(3), we can derive the following relation (see Appendix)

V

=

C(E0γ h)2π (b + e−γ P )2

(4)

Here b is a large constant introduced by integration, and is assumed to be independent of E0, γ and h. V can be roughly approximated to the first order as

V

≈

C(E0γ h)2π b2

(1 −

2 e−γ P ) b

(5)

The normalized PPG signal is then formulated as

PPGnorm

=

V

− Vmin Vmin

=

2(e−γ Pmin − e−γ P ) b − 2e−γ Pmin

(6)

The time variant component of V is typically only a few percentage of the stationary

component, which means PPGnorm is very small. To help visualize the pulse waveforms, a linear scaling function is typically used to amplify and shift the normalized PPG signal. This

scaling function varies from manufacturer to manufacturer. In this study, we used ks as the scaling factor and Voff as the offset factor. Since b is very large, a modified scaling factor k is used to simplify the calculation. k is very important to proper normalization of PPG signal

across patients, which will be described in section 3.

PPGscaled = ks × PPGnorm + Voff ≈ k (e−γ Pmin − e−γ P ) + Voff

(7)

2.4 Advantages and limitations Before normalization, PPG signal is heavily influenced by blood vessel elastic properties E and blood volume V etc, which have large person to person variation. It’s difficult to derive a general rule that applies to all people. After normalization, PPG signals taken from different subjects become comparable, assuming similar vascular composition. Normalization also ameliorated the effect of non-ideal contact between sensors and the finger, such as off-center placement, since DC component and AC component change almost proportionally. γ may still have a small variation among different population, but the influence is comparatively small.
However, because of the assumptions used in our derivation, there are limitations to this method. One important assumption is that the blood constituent ratio will remain constant during the entire course of meansurement, especially those having high absorption abilities at NIR wavelength such as hemoglobin, which is true for most people including hypertensive patients. But in certain cases where a patient undergoes hemodynamic fluctuation, such as serious edema or blood clot, this method could fail and needs to be used with discretion. Secondly, arterial vascular structure in the finger is far from uniform, which gives a

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3012

distribution of vessel diameters. We only did approximation to the second order, which may introduce considerable error when more accurate results are desired. Also, different vascular composition causes different background absorption ratio, which leads to a variation of b. Thus the BP fitting error will be relatively large if only amplitude information is used. That’s why we also have to combine with shape information of the waveforms, which is indirectly influenced by the BP level [14,21], to improve BP fitting accuracy. Thirdly, we haven’t considered the light absorption from nonvascular soft tissue, pulsation from venous and the mild pressure exerted by the PPG sensor. Last but not the least, our theory is based on Eqs. (1)-(2), which describe the property of arota and its major branches fairly well, but may lose its accuracy when applied to blood vessels in finger tips. But fortunately, thanks to the use of neural network as opposed to straight forward regression, some of these adverse effects can be overcome quite effectively in practice with the extensive training of the network.

3. Materials and method

3.1 Data source

In this study, data from freely distributed MIMIC II (Multiparameter Intelligent Monitoring in Intensive Care) database was used. MIMIC II is a collection of multi-parameter recordings of more than 15000 ICU patients, and includes both physiologic signals and vital signs [27,28]. We examined 85 patients with complete ECG, BP and PPG readings, simultaneously taken with a sampling rate of 125Hz. For those patients, BP was continuously taken by an invasive method at the wrist, and PPG was taken at the finger with a pulse oximeter. Data length varies from patient to patient, depending on their ICU stay time. For our analysis, 16 patients were excluded for poor data quality (N = 7), pulsus bisferiens (N = 7) or unstable BP-PPG correlation (N = 2). In the end, more than 170,000 heartbeats from 69 patients were used to capture the relationship between PPG and BP.
Data processing steps are as follows:

1. PPG and BP data were aligned to compensate for their phase lag.

2. Quality data were selected based on established criteria.

3. Proper normalization was performed to get rid of the variance in k factor

4. Waveform data were examined in frequency domain, and key features were extracted Note that PPG recordings in MIMIC II came from commercial pulse oximeters, which had been amplified and highly filtered. Data from other resources should be adjusted accordingly to match the results from this paper.

3.2 Data alignment

BP and PPG data from MIMIC II are not perfectly aligned. To account for phase lag between BP signal and PPG signal, a cross correlation function g(Δt) was calculated to precisely align those two waveforms.

g (Δt )

=

<

BP(t)PPG(t + Δt) < BP(t)PPG(t) >

>

(8)

Here g(Δt) represents a time averaged value of the cross correlation function, and Δt is the

phase lag between BP and PPG. The most accurate Δt corresponds to the biggest g(Δt). Δt is

generally bigger than 0 and smaller than the duration of a single pulse, as shown in Fig. 2.

Our analysis shows a mean Δt of 0.28s and a standard deviation of 0.04s. Δt may be

influenced by drug use, body temperature change and position change etc, so it should be

recalibrated regularly.

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3013

Fig. 2. g(Δt) v.s. time for two patients. Phase lag varies from person to person.

3.3 Initial data selection criteria

Fidelity of BP and PPG data is critical to finding the right model. Abnormal or corrupted data may cause undesirable results for future analysis. Since data from MIMIC II database is from real patients in critical condition, sensors may fall off, and good contacts may be lost occasionally. We need to find a way to filter the raw data, and use the data with less artifact and good internal connection.
Various methods have been proposed to evaluate the quality of BP data. For example, Sun et al [29] used a signal abnormality index (SAI) to assess BP quality. We modified their method for the purpose of deriving a correct model between BP and PPG. A linear Savitzky—Golay smoothing filter was firstly applied to SBP and DBP signal, and any data two standard deviation away from smoothed value were considered too noisy and discarded. In this preliminary study, data with SBP higher than 180mmHg were too few to generate a correct fitting. So they were not used either. The initial selection rules are as follows (Table 1).

Table 1. BP data exclusion criteria

Feature

SBP

DBP

ΔSBP

ΔDBP

SBP-DBP T

Abnormality >180mmHg <20mmHg > 2*std_sbp >2*std_dbp <20mmHg <0.3s

criteria

or

or >3s

<80mmHg

*SBP: Systolic Blood Pressure; DBP: Diastolic Blood Pressure; ΔSBP = |SBP -SBP(smoothed)|;

ΔDBP = |DBP -DBP(smoothed)|; T: Pulse duration time; std_sbp = standard deviation of ΔSBP; std_dbp =

standard deviation of ΔDBP

PPG signals tend to be much noisier. To evaluate their quality, Silva et al [30] used a multichannel adaptive filter (MCAF) method to give a Signal Quality Index (SQI) for PPG signal. The algorithm was originally designed to predict missing data and relied on measurement history. Li and Clifford [31] compared PPG pulses with known good ones with dynamic time warping technique, and derived their own quality index. This study focused on PPG signals only and worked without other inputs. Since we have simultaneous BP data, which are generally very clean, we used a simple yet effective method similar to Chen et al [9]. They reported a correlation coefficient of 0.9 between tonometric radial and central aortic pressures. Sudden loss of correlation indicated error in tonometric measurement. Similarly, in our situation, the hypothesis is that good PPG signal should highly correlate with BP. A linear regression was performed between each corresponding PPG and BP pulses. The threshold value of coefficient of determination (R2) was empirically chosen to be 0.8.

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3014
Fig. 3. Example of measured radial pressure wave versus simultaneously recorded PPG wave (a) A clinical abnormal PPG waveform (b) Correlation between BP and abnormal PPG waveform (c) A clinical good PPG waveform (d) Correlation between BP and good PPG waveform.
We also screened the data for pulsus bisferiens, which means a double peak per cardiac cycle. This may indicates aortic insufficiency in association with diseases like aortic stenosis [32]. This type of data was excluded to keep our model simple, but will be implemented in the future work. 3.4 Normalization Previous research found that the diameter-pressure curve was not significantly different between hypertensive patients and their respective controls [33], which implies that in Eq. (7), γ stays relatively constant. However, the scaling factor k varies from patient to patient, which makes it very difficult to derive a general correlation between PPG and BP, as shown in Fig. 4.
Fig. 4. Relation between PPG and radial BP.

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3015
It’s found that BP measured at the wrist was closely related to digital BP measured at the finger tip [6]. In this study, we assumed γ to be 0.017, and normalized k across all patients using the relationship between PPGscaled and radial BP. With a least square error method, we found that k varied from 0.50 to 3.26, with a mean value of 1.86 and a standard deviation of 0.5 (Npatient = 71). The relationship between PPGscaled and e−γ Pmin − e−γ P deviates from linearity when P becomes very high or closer to Pmin, which may have been caused by the loss of accuracy of Eqs. (1)-(2), or the inherent difference between radial BP and digital BP.
Note that we are using PPG data from commercial pulse oximeters, and estimating BP is considered “off-label” use. For future studies, auto-scaling function should be disabled to avoid errors introduced by k calibration. In our study, evaluation without auto-scaling was also carried out and the results were presented in section 4. 3.5 Feature extraction from PPG Systolic amplitude of PPG signal has been found to have a good correlation with local vascular distensibility over a wide range [34]. In our study, a fast fourier transform was used to extract both amplitude and phase features from the waveforms. This method is more stable than time domain feature extraction because it does not require identification of the exact location of certain characteristic points on the waveform, and can analyze more than one cardiac cycle at a time. For a beat to beat BP estimation, one frame was defined to contain a complete cardiac cycle with 10% of the previous cycle and 5% of the following cycle, which was then padded with zero to a length of 150 data points per frame.
This feature extraction method has certain limitations. When BP changes very rapidly, features will be influenced by adjacent beats, which will introduce considerable errors for a beat-to-beat estimation. 3.6 Architecture of the ANN Artificial neural networks are a family of models inspired by biological neural networks and can be used to estimate complex functions that are highly nonlinear. In practice, a multilayer feed-forward back propagation ANN with one hidden layer is enough to fit a continuous function. The inputs for our ANN are amplitudes and phases of the fourier components, as shown in Fig. 5. A Levenberg-Marquardt algorithm was used to train the ANN. 70% of data were used for training, 15% for validation and 15% for test. The structure of ANN is as follows:
Fig. 5. ANN architecture for SBP and DBP estimation.
To check the validity of our method, we firstly compared the outputs from ANN with invasively measured BP, which was considered the gold standard. We also implemented this algorithm to a high resolution pulse oximeter and compared the outputs with a commercial cuff sphygmomanometer, to see if those two methods are interchangeable.

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3016
4. Experiment results 4.1 BP fitting (MIMIC II) To validate the proposed method, we firstly investigated how correlated the spectral components of PPG and BP are. As shown in Fig. 6(a)-6(b), amplitude components of PPG and BP are highly correlated for all frequencies. The correlation of their phases is good at low frequencies, but becomes worse at higher frequencies, as shown in Fig. 6(c)-6(d).
Fig. 6. Correlation between spectral components of BP and PPG (a)-(b) amplitude correlation (c)-(d) phase correlation.
From the above analysis, it’s plausible to derive SBP and DBP from PPG signal only. However, with so much variation, it’s difficult to reconstruct BP waveform precisely with only a linear regression method.
ANN is often used to estimate complex nonlinear functions. Previous study found a cutoff frequency of 8-11Hz was ideal for BP waveform reconstruction [9,15]. In our case, a fitting net with a hidden layer of 35 neurons and cut off frequency of 10.8Hz gives a stable and accurate fitting of SBP and DBP simultaneously, as shown in Fig. 7. More neurons in the hidden layer provide slight improvement (~0.2mmHg), but they also tend to over-fit the data, and introduce instability.

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3017

Fig. 7. Performance of the ANN (root-mean-square error) vs. number of hidden neurons and cutoff frequency.
Accuracy of BP estimation requires a steady correlation of BP and PPG. If cardiac loading or medical intervention changes the correlation drastically during the measurement, fitting accuracy will be lowered. In our study, patients with huge fluctuation of the correlation function were not used to train the general ANN.
To identify those outliers, we firstly trained individual ANN for each patient separately (Npatient = 71). Most of the fitting errors were within the American National Standards of the Association for the Advancement of Medical Instrumentation (AAMI), where the maximal accepted error is 5 ± 8 mmHg, as shown in Fig. 8. 2 out of 71 patients were excluded from general ANN training due to lack of steady BP and PPG correlation.

Fig. 8. Individual fitting error distribution.

In the end, we trained the general ANN with 69 patient data, which includes 175,477 waveforms. The beat to beat fitting error was 0.06 ± 7.08mmHg for SBP, and 0.01 ± 4.66mmHg for DBP, which also fulfills the British Hypertension Society (BHS) protocol and ranks grade A/A [35], as shown in Table 2. The fitting results are illustrated in Fig. 9.

Table 2. BP estimation accuracy. Grades represent the cumulative percentage of readings falling within 5 mm Hg, 10 mm Hg, and 15 mm Hg of the standard.

Absolute difference between standard and our method(%)

≤5

SBP

61

DBP

77

≤10

≤15

86

95

95

99

Grade A

60

85

95

Grade B

50

75

90

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3018
Fig. 9. General ANN fitting for all data points and BP data distribution.
If we don’t care about the beat to beat BP value, and instead we average BP for several seconds, fitting error can be further reduced. For example, if five adjacent waveforms are averaged, the fitting error can be reduced to 0.06 ± 5.57mmHg for SBP, and 0.01 ± 3.69mmHg for DBP, as shown in Fig. 10.
Fig. 10. Error reduction with averaging.
Considering that those patients were under intensive care, and medical intervention might be administered, this result is very promising.
However, this method still has limitations and needs to be improved. For example, A model more accurate than FFT is desirable to capture the essential waveform of PPG. Data sampling and preprocessing method can be further optimized. ANN structure should be fine tuned to firstly classify patients and reduce the number of outliers. Those work will be implemented in future studies. 4.2 Test on volunteers To see if our scheme is robust, we did additional testing on healthy volunteers. In this study 23 subjects were recuited, with age ranging from 26 to 34. Among them, 18 were male and 5 were female. A PPG evaluation module (AFE4490, Texas Instruments) with high resolution pulse waveform output was firstly used to obtain PPG signals, with the detector centered on the palmar side of the index finger. The sampling frequency was 500Hz. The unscaled and unfiltered outputs were used to keep k constant, as shown in Eq. (7). Subjects were allowed to rest for at least 5 minutes before BP measurement by an Omron HEM-7051 digital automatic upper-arm blood pressure monitor. All the measurements were done under resting conditions. The quality of PPG waveforms was visually inspected, and the BP measurement was later verified by another upper arm automatic sphygmomanometer (Microlife BP3GX1-5X). For each subject, PPG pulses in 8 seconds were averaged to estimate SBP and DBP. Note that this comparison is meant to prove the equivalency of the two methods, thus cannot result in an indication of the accuracy of either device. Our result showed a difference of −1.67 ± 2.46mmHg for SBP and −1.29 ± 1.71mmHg for DBP. T-test of the two measurements showed no significant difference (p<0.01), indicating a high correlation. We also did Bland–

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3019
Altman analysis to see if these two methods are interchangeable. The limit of agreement was shown to be 4.1mmHg, as in Fig. 11, which is acceptable in clinical settings.
Fig. 11. Bland–Altman analysis between PPG-based BP estimation and the cuff sphygmomanometer.
5. Discussion and conclusion PPG is a very promising technology due to its wearablity, non-invasiveness and versatility, which not only provides information about tissue oxygenation and heart rate, but also offers blood pressure information and has potential for early screening of vascular diseases [36–39]. However, PPG signal analysis is also complicated due to the influences from the cardiovascular, respiratory, and autonomic systems. A full understanding of its morphology and underlying physiology is still lacking.
We have investigated the intrinsic connection between BP and PPG, and derived a simple mathematical formula to describe their relationship, which is straight forward and based on fewer assumptions than methods using PTT. FFT based feature extraction uses a few key parameters to preserve the entire amplitude and shape information of the waveform and makes the analysis much easier. We have also utilized the power of ANN to improve the fitting accuracy of BP. With proper data processing, normalization and training, this method performs well, without the need of complicated and repeated calibration for each individual. It also provides much richer information about the patients’ cardiovascular health by looking into the spectral components of BP and PPG.
In this work, we have used more than 170,000 waveforms from 69 patients to train the general ANN, which is a much bigger population than those used in previous studies [15–18]. We have shown our method is robust and accurate over a fairly large number of subjects tested. But this is by no means a thorough training and test. Distribution of BP in real world may be different from the training samples we used. For example, there are more than 15,000 patients available in the MIMIC II database and we only randomly selected a few dozens. Ideally we should include data from both healthy and unhealthy subjects with a wider range of BP readings, but analyzing all of them will need more sophisticated computational tool.
Data quality is important to the initial training and the later usage of the artificial neural network in this method. For the MIMIC II data sets, we selected the good PPG waveform sections based on the BP information we had from the same database, which enabled we to easily and reliably obtain clean BP and PPG signals for ANN training and validation. For the volunteer experiment, we however had to rely on the PPG signal itself to determine and discard any PPG segments that were deemed bad or unusable. There, a rudimental method of comparing the signal to the mean signal plus and minus two standard deviations was used.

Vol. 7, No. 8 | 1 Aug 2016 | BIOMEDICAL OPTICS EXPRESS 3020

For future work, we will focus on developing a more robust and universal data selection scheme to assess the quality of PPG signal and to filter out the bad waveforms from the good ones in realtime. Also, both digital BP and radial BP should be measured to establish a more accurate relationship between BP and PPG. We should also try to classify patients with different medical conditions before doing BP estimation. Raw PPG data will be used instead of heavily processed data from commercial pulse oximeters, to identify patients with different PPG-BP responses. For example, morphological characters and low frequency drifting of PPG waveforms may be used to label certain diseases such as atrial fibrillation, stiff arteries, and hypovolemia. To do this, new technologies such as pattern recognition and recurrent ANN may help.

Appendix

Here, we derive the expressions for blood volume (V) as a function of blood pressure (P). Derivation is firstly done on both sides of Eq. (3).

dV = 2Cπ rdr

(A1)

Combine Eqs. (1)-(3), we can derive the following relation

dV

=

2Cπ r3 E0heγ P

dP

=

2V 3/2 E0h Cπ eγ P

dP

Move V3/2 to the left side of Eq. (10), we have a relation between V and P.

dV −1/2 =

1

de−γ P

E0γ h Cπ

Constant b is introduced in the expression as a result of the integration.

(A2) (A3)

V

=

E0γ h Cπ b + e−γ P

(A4)

Finally, we acquired (4), as shown in section 2.3

V

=

C(E0γ h)2π (b + e−γ P )2

(A5)

Acknowledgements This study is supported by Hundred-Talent Program of Chinese Academy of Sciences. The authors would also like to thank the Laboratory for Computational Physiology at MIT for maintaining the MIMIC II database and make it available to all researchers.

