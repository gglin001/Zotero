On the monitoring of blood pressure and pulse pressure variations in peri-operative care
Citation for published version (APA): Sun, S. (2018). On the monitoring of blood pressure and pulse pressure variations in peri-operative care Eindhoven: Technische Universiteit Eindhoven
Document status and date: Published: 30/05/2018
Document Version: Publisher‚Äôs PDF, also known as Version of Record (includes final page, issue and volume numbers)
Please check the document version of this publication: ‚Ä¢ A submitted manuscript is the version of the article upon submission and before peer-review. There can be important differences between the submitted version and the official published version of record. People interested in the research are advised to contact the author for the final version of the publication, or visit the DOI to the publisher's website. ‚Ä¢ The final author version and the galley proof are versions of the publication after peer review. ‚Ä¢ The final published version features the final layout of the paper including the volume, issue and page numbers. Link to publication
General rights Copyright and moral rights for the publications made accessible in the public portal are retained by the authors and/or other copyright owners and it is a condition of accessing publications that users recognise and abide by the legal requirements associated with these rights.
‚Ä¢ Users may download and print one copy of any publication from the public portal for the purpose of private study or research. ‚Ä¢ You may not further distribute the material or use it for any profit-making activity or commercial gain ‚Ä¢ You may freely distribute the URL identifying the publication in the public portal. If the publication is distributed under the terms of Article 25fa of the Dutch Copyright Act, indicated by the ‚ÄúTaverne‚Äù license above, please follow below link for the End User Agreement: www.tue.nl/taverne Take down policy If you believe that this document breaches copyright please contact us at: openaccess@tue.nl providing details and we will investigate your claim.
Download date: 22. . 2019

On the monitoring of blood pressure and pulse pressure variations in peri-
operative care
PROEFSCHRIFT
ter verkrijging van de graad van doctor aan de Technische Universiteit Eindhoven, op gezag van de rector magnificus prof.dr.ir. F.P.T. Baaijens, voor een commissie aangewezen door het College voor Promoties, in het openbaar te verdedigen op woensdag 30 mei 2018 om 11:00 uur
door
Shaoxiong Sun
geboren te Heilongjiang, China

Dit proefschrift is goedgekeurd door de promotoren en de samenstelling van de promotiecommissie is als volgt:

voorzitter: 1e promotor: copromotor(en):
leden:
adviseur(s):

prof.dr.ir. J.H. Blom prof.dr. R.M. Aarts dr. R. Bezemer (Philips Research) prof.dr. M. Mischi dr. J. Allen (Newcastle University) Prof.dr. H.E. Korsten dr. G.J. Noordergraaf (Elisabeth-Tweesteden Ziekenhuis Tilburg & Radboud UMC Nijmegen)

Het onderzoek of ontwerp dat in dit proefschrift wordt beschreven is uitgevoerd in overeenstemming met de TU/e Gedragscode Wetenschapsbeoefening.

On the monitoring of blood pressure and pulse pressure variations in peri-operative care
Shaoxiong Sun

On the monitoring of blood pressure and pulse pressure variations in perioperative care/ by Shaoxiong Sun ‚Äì Eindhoven : Eindhoven University of Technology, 2018. A catalogue record is available from the Eindhoven University of Technology Library. ISBN : 978-90-386-4506-3
The research presented in this thesis was financially supported by China Scholarship Council
Cover Design : Shaoxiong Sun, Eindhoven, The Netherlands. Reproduction : Eindhoven University of Technology.
Copyright ¬© 2018, Shaoxiong Sun All rights reserved. Copyright of the individual chapters belongs to the publisher of the journal listed at the beginning of each respective chapter. No part of this publication may be reproduced, stored in a retrieval system, or transmitted, in any form or by any means, electronic, mechanical, photocopying, recording or otherwise, without the prior written permission from the copyright owner.

To myself who never surrenders To my beloved parents To my motherland

Summary
Blood pressure (BP) is one of the vital signs among respiratory rate, heart rate, oxygen saturation, and body temperature, which reflect the cardiovascular status of the human body. Blood pressure can be seen as the most important regulatory measure of the subtle balance in the homeostasis in the internal environment of the body, which reflects changes in needs for nutrients and changing requirements for waste product disposal. Monitoring BP is of critical importance in both people‚Äôs daily life and in the clinical environment. High BP, which an estimated 40% of the worldwide population suffers from, is closely related to increased cardiovascular morbidity and mortality. In the clinical context, BP is essential for assessing the hemodynamic status of patients undergoing surgery in the operating room (OR) and staying in the intensive care unit (ICU).
BP monitoring is routinely implemented by either cuff-based intermittent measurements or catheter-based continuous measurements. Despite the advantage of the cuff-based method in terms of convenience and noninvasiveness, it provides only intermittent measurements and therefore has the risk of missing clinically-relevant BP changes. In addition, cuff-based measurements are also uncomfortable, as patients can be waken up when the cuff is inflated. In the catheter-based method, cannulation of an artery has been associated with adverse effects including distal ischemia, bleeding, thrombosis, pain, and infection, which may result in increased morbidity and costs.
Due to the drawbacks of these BP monitoring methods, it is desirable to investigate a non-invasive and continuous surrogate of BP. A widely-studied surrogate is the one based on the pulse arrival time (PAT), which is defined as the delay between an R peak in the electrocardiography (ECG) signal and a subsequent fiducial point in the photoplethysmography (PPG) signal. PAT is
i

an indicator inversely related to the pulse wave velocity with which the pulse wave propagates along the vessel. Increased BP stiffens arteries and therefore increases pulse wave velocity, which results in a decreased PAT. However, this close relationship only holds for elastic arteries, and is not readily applicable to all arterial paths where PPG is measured. As a result, frequent recalibration is needed to accommodate the varying compliance of arteries. Other parameters extracted from PPG waveforms have also been studied to infer BP. However, only limited success has been obtained when using these parameters in the BP estimation, which may be in part due to their unknown coupling with BP.
This thesis deals with non-invasive continuous BP estimation. We propose a model to estimate systolic blood pressure (SBP) using PPG and ECG for subjects doing physical exercise (Chapter 2). We made use of a finger-based, continuous non-invasive method for reference BP measurement. This model includes an initialization process for each subject at rest in which SBP and ECG- and PPG-derived features were derived. After this initialization process, the model estimated SBP every 30 seconds for the whole period of exercise. In order to build this model, in addition to PAT, we extracted 18 features from the PPG signal by means of its waveform, first derivative, second derivative, and frequency content. After evaluating four different regression models, we chose multiple linear regression (MLR) to combine all derived features to estimate SBP. The contribution of each feature was quantified using its normalized weight in the MLR model. The results show that the inclusion of PAT reduced the standard deviation (SD) of the difference between the measured and estimated SBP. There was no significant difference in the estimation performance between the model using finger- and forehead-derived PPG signals. It is shown that the model should be adapted for different postures. The optimized model using finger-derived PPG signals during physical exercise had a plausible performance. Furthermore, we identified two groups of features that contributed more to SBP estimation compared to other features: the features depicting beat morphology and the features depicting the dicrotic notch.
We also studied SBP monitoring for patients undergoing major surgery in the OR (Chapter 3). Using data from these patients, we propose a novel model to estimate SBP every 30 seconds based on previous intermittent SBP
ii

measurements and ECG- and PPG-derived features. Specifically, upon each SBP measurement, we dynamically selected features from the feature pool based on feature robustness and the principle of correlation feature selection (CFS). The creation of the feature pool was inspired by the study described in Chapter 2. Here, the feature robustness refers to the robustness when extracting the feature, i.e. the higher the order of the signal derivative involved in the feature extraction, the less robust the extracted feature would be. As a result, we categorized the features into four groups. CFS dictates that a feature would be selected if it can provide complementary information to the features that are already selected. In this chapter, we selected the first feature based on feature robustness, and the following features based on the CFS principle. After selecting the features, we built an MLR model to combine these features. The results show that compared to the reference SBP, our proposed model achieved a clinically-acceptable performance. The results also demonstrated that PAT is the feature that was selected most frequently and that PPG-derived features can provide additional information to PAT, thereby reinforcing the PAT-based SBP estimation model.
In addition to BP monitoring, we investigated the monitoring of volume status, particularly fluid responsiveness. Hemodynamic optimization, with the goal of maintaining optimal circulatory conditions, has been shown to improve postoperative outcome and reduce the cost of surgery. Before subjecting a patient to fluid therapy, one should assess whether the heart would actually increase its output upon volume loading. This is called fluid responsiveness. During mechanical ventilation, the cyclic changes in the intrathoracic pressure induce cyclic changes in the venous return and therefore the preload (enddiastolic blood volume) of the heart. These cyclic changes in the preload induce cyclic changes in the stroke volume, which will appear as cyclic changes in pulse pressure. A parameter called pulse pressure variation (PPV) has been designed to quantify such cardiopulmonary interactions. PPV is widely used for predicting fluid responsiveness and supporting fluid management in the operating room and intensive care unit. Available PPV algorithms have been validated for fluid responsiveness, but typically only during episodes of hemodynamic stability. To date, little is known about the performance of PPV algorithms during surgery, where fast changes of the blood pressure may affect the robustness of the presented PPV value.
iii

We provide a comprehensive analysis of how various existing algorithmic designs affect the robustness of the presented PPV value derived from invasively-measured ABP during surgery, and proposed additional processing in order to provide more robust PPV values (Chapter 4). Based on our observations on the clinical data, we propose three clinically-relevant metrics for assessing the performance of PPV calculation algorithms. These metrics are the difference from the original specification, the hourly occurrence of unstable PPV calculation episodes, and the hourly occurrence of short-term elevations. With these metrics in place, we studied and compared five existing algorithms in the literature. Inspired by the design and corresponding performance of these algorithms, we proposed additional processing, which included baseline extraction and adaptive peak filtering processing for the pulse pressure signal before calculating PPV. The results show that all algorithms performed well during episodes of hemodynamic stability. Moreover, it is demonstrated that the proposed processing can help improve the robustness of PPV values during the entire course of surgery.
Finally, we studied the potential of PPV monitoring in a non-invasive manner using PPG signals (Chapter 5). We compared finger- and foreheadPPG derived pulse amplitude variation (PAV) in their ability to approach the value and trend of ABP-derived PPV. Furthermore, we investigated several potential confounding factors that might affect the agreement between PPV and PAV. These factors include baseline variations, PPV values, heart rate to respiration rate ratio, and perfusion index. We analyzed the impact of these factors using an MLR analysis. The results show that, compared with the ABPderived PPV, finger-derived PAV had a significantly better agreement than forehead-derived PAV. From the MLR analysis, we found that the PPG signal baseline variation was an important factor significantly affecting the agreement between PPV and PAV. After correcting for the respirationinduced baseline variation in the PPG signals, the agreements between PPV and finger-derived PAV, and between PPV and forehead-derived PAV were both improved, and the difference between these two agreements was diminished. Yet, the tracking abilities for both finger- and forehead-derived PAV still warrant improvement for wide use in clinical practice.
iv

Contents
1. Introduction........................................................................................ 1 1.1. Conventional blood pressure measurement .................................. 2 1.2. Photoplethysmography and its current applications ..................... 6 1.3. PPG-based blood pressure estimation........................................... 7 1.4. Fluid responsiveness ................................................................... 10 1.5. Pulse pressure variations ............................................................. 12 1.6. Pulse amplitude variations derived from PPG ............................ 14 1.7. Objectives of the thesis ............................................................... 14 1.7.1. Objectives of Part I............................................................... 15 1.7.2. Objectives of Part II ............................................................. 15 1.8. Outlines of the thesis................................................................... 16
Part I The monitoring of blood pressure ........................................... 19 2. Blood pressure estimation using ECG and PPG during physical exercise.................................................................................................. 21
2.1. Introduction ................................................................................. 23 2.2. Materials and methods ................................................................ 24
2.2.1. Data ...................................................................................... 24 2.2.2. Experiments.......................................................................... 25 2.2.3. Signal preprocessing............................................................. 26
v

2.2.4. Feature extraction ................................................................. 27 2.2.5. Regression model ................................................................. 32 2.2.6. Model validation................................................................... 33 2.2.7. Model comparison ................................................................ 34 2.3. Results and Discussion................................................................ 35 2.3.1. Physical exercise experiment ............................................... 35 2.3.2. Posture change experiment................................................... 38 2.3.3. Feature contributions ............................................................ 39 2.3.4. Study limitations................................................................... 41 2.4. Conclusions ................................................................................. 42 3. Continuous blood pressure estimation using ECG and PPG with intermittent recalibrations in the operating theatre......................... 45 3.1. Introduction ................................................................................. 47 3.2. Materials and methods ................................................................ 48 3.2.1. Patients ................................................................................. 48 3.2.2. Protocol ................................................................................ 48 3.2.3. Feature extraction ................................................................. 49 3.2.4. Data Analysis ....................................................................... 51 3.2.5. Feature selection and regression model................................ 52 3.2.6. Comparison with two methods............................................. 53 3.2.7. Statistical Analysis ............................................................... 54 3.3. Results ......................................................................................... 54 3.4. Discussion ................................................................................... 56 Part II The monitoring of pulse pressure variations ........................ 61 4. On algorithms for calculating arterial pulse pressure variation during major surgery .......................................................................... 63 4.1. Introduction ................................................................................. 65
vi

4.2. Materials & Methods .................................................................. 67 4.2.1. Protocol and data acquisition ............................................... 67 4.2.2. General framework for the analysis of existing and proposed algorithms ....................................................................................... 68 4.2.3. Performance indicators of PPV algorithms during surgery.. 69 4.2.4. Statistical analysis ................................................................ 70
4.3. Description of existing algorithms .............................................. 72 4.4. Description of our algorithm ....................................................... 73
4.4.1. Step 1: IPP derivation........................................................... 73 4.4.2. Step 2: IPP post-processing .................................................. 74 4.4.3. Step 3: Calculation of raw PPV............................................ 75 4.4.4. Step 4: Calculation of presented PPV .................................. 75 4.5. Results ......................................................................................... 76 4.5.1. Step 1: the influence of methods for IPP derivation ............ 76 4.5.2. Step 2: effect of our IPP post-processing ............................. 76 4.5.3. Step 3: the influence of the sample duration ........................ 80 4.5.4. Overall comparisons ............................................................. 80 4.6. Discussion ................................................................................... 82 4.7. Conclusion .................................................................................. 84 Appendix A ........................................................................................ 85 Appendix B ........................................................................................ 88 5. Finger and forehead PPG-derived pulse-pressure variation and the benefits of baseline correction ............................................................ 93 5.1. Introduction ................................................................................. 95 5.2. Materials and methods ................................................................ 96 5.2.1. Patients ................................................................................. 96 5.2.2. Protocol ................................................................................ 96
vii

5.2.3. Data Analysis ....................................................................... 97 5.2.4. Statistics.............................................................................. 101 5.3. Results ....................................................................................... 102 5.4. Discussion ................................................................................. 109 6. General discussions and future directions for research ............. 113 6.1. The monitoring of blood pressure ............................................. 114 6.2. The monitoring of pulse pressure variation .............................. 116 References........................................................................................... 121 List of publications ............................................................................ 139 Acknowledgements ............................................................................ 143 About the author................................................................................ 147
viii

CHAPTER 1 Introduction
This chapter provides a general background on the monitoring of blood pressure and pulse pressure variations. In addition, the scope and outline of the thesis are presented.
1

Chapter 1. Introduction
1.1. Conventional blood pressure measurement
Patient monitoring is a cornerstone of patient care and clinical decision making. Blood pressure (BP) is one of the vital signs among respiratory rate, heart rate, oxygen saturation, and body temperature, which reflect the cardiovascular status of the human body. BP refers to the pressure exerted on the vessel wall by the circulating blood. BP is mainly expressed by systolic blood pressure (SBP), which is maximum pressure during one heartbeat, and diastolic blood pressure (DBP), which is minimum pressure during one heartbeat.
Monitoring BP is of critical importance in people‚Äôs daily life. This is because high blood pressure (hypertension), higher than 140/90 mmHg, is closely related to increased cardiovascular morbidity and mortality [1]‚Äì[7]. Yet, those with hypertension often show no symptoms in early stages, rendering hypertension a ‚Äòsilent killer‚Äô [8]‚Äì[12]. It has been reported that over 1.5 billion people, 40% of the worldwide population, suffer from hypertension, but only 46% of these are treated [13]. Furthermore, less than 33% of those under treatment manage to reach well controlled blood pressures [14]. In the clinical context, blood pressure monitoring is also essential for assessing hemodynamics of patients undergoing surgery in the operating room (OR) or staying in the intensive care unit (ICU), as a measure of organ perfusion [15]‚Äì [18].
BP can be measured in both non-invasively and invasively. When measured non-invasively, two cuff-based approaches are often employed: the Korotkoff method (aka auscultatory method) and the oscillometric method, which are shown in figure 1.1.
In the Korotkoff method, a stethoscope is placed over the brachial artery inside or below the cuff of a sphygmomanometer, which warps over the biand triceps of the upper arm. The caregiver listens for Korotkoff sounds (i.e., sounds heard when blood moves through the partially occluded artery [19], [20]). The cuff is inflated to be well above the expected SBP and the air is gradually let out, allowing pressure in the cuff to decrease and blood flow to restart. When the pressure inside the cuff is above the level of the subject‚Äôs SBP, no sound is audible as a result of completely occluding the blood flow. When the pressure falls to a level equal to that of a subject‚Äôs SBP, the first Korotkoff sound can be heard from the stethoscope. The rationale is as follows. 2

1.1. Conventional blood pressure measurement

(a)

(b)

Figure 1.1: Two predominant cuff-based blood pressure measurements. (a) Korotkoff sound. (b) Oscillometric method. Adapted from source: http://www.canadianpharmacymeds.com and https://www.nhlbi.nih.gov
When the pressure in the cuff is equal to the peak BP produced by the heart, some blood can pass through the cuffed region. This blood flows in spurts as the pressure in the artery exceeds and then falls below the cuff pressure, inducing turbulence that produces an audible sound. As the pressure in the cuff is allowed to decrease further, the sound becomes intensified and then muted. As the occlusion in the vessel is gradually removed, the sound finally disappears. This process has led to the definition of some five Korotkoff sounds (table 1.1). The last Korotkoff sound will be detected when the cuff pressure is the same as DBP. Figure 1.2 illustrates the process of the emergence of Korotkoff sounds.
While the Korotkoff method is regarded as gold standard and usually applied in healthcare environments, the oscillometric method is commonly found in home settings. In contrast to dependence on sound detection by caregivers in the Korotkoff method, the oscillometric method operates automatically and electronically to detect pulsatile blood flow [21], [22]. In the oscillometric method, cuff pressure oscillations are recorded using an electronic pressure sensor. The oscillations at the cardiac frequency, derived by high-pass filtering the recorded oscillations, are in essence caused by the cyclic expansion and contraction of the brachial artery. The envelope of this oscillation is computed, from which SBP and DBP are further calculated using specialized algorithms. Figure 1.3 illustrates the mechanism of the oscillometric method in relation to the Korotkoff technique for reference.
3

Chapter 1. Introduction

Phase Phase I
Phase II Phase III Phase IV Phase IV

Table 1.1: Illustrations of Korotkoff sounds. Korotkoff sounds
The first appearance of faint, repetitive, clear tapping sounds which gradually increase in intensity for at least two consecutive beats is the systolic blood pressure.
A brief period may follow during which the sounds soften and acquire a swishing quality.
The return of sharper sounds, which become crisper to regain, or even exceed, the intensity of the Phase I.
The distinct abrupt muffling of sounds, which become soft and blowing in quality.
The point at which all sounds finally disappear completely is the diastolic pressure.

Figure 1.2: The process of the production of Korotkoff sounds. Adapted from https://nl.wikipedia.org/wiki/Korotkoff-toon.
4

1.1. Conventional blood pressure measurement
Figure 1.3: The mechanism of oscillometric method. Adapted from https://aneskey.com/patient-monitoring/.
In spite of the popularity of these two methods, they have certain shortcomings. First, they can only provide intermittent readings (e.g. every five or ten minutes, to low frequency of once in hours‚Äô time), which has a risk of missing clinically-relevant blood pressure changes [23]. Second, they both include the inflation of cuffs, which may cause discomfort and disturbance for patients, especially when monitoring during sleep.
BP can also be invasively measured with increased continuity and accuracy. In the invasive method, an arterial catheter or cannula is inserted into a peripheral artery (e.g. the radial, tibial, brachial or femoral artery). This catheter is attached to a fluid-filled and stiff line, which transfers the arterial pressure wave to the pressure transducer where the signal becomes digital. This technique is essential for in the ICU and OR, where patients have potentially rapid-changing hemodynamics [13], [24], [25]. In addition, the arterial pressure waveform can be instrumental when calculating circulatory parameters, e.g. pulse pressure variation (PPV), and estimated cardiac output [26]‚Äì[29]. Despite these advantages, the invasive method has been associated with the risk of adverse effects including patient immobility, distal ischemia, bleeding, thrombosis, and infection, which may result in increased morbidity and costs [30]‚Äì[32].
These drawbacks prompt researchers to explore alternatives. Recently, photoplethysmography-derived approaches have gained interests.
5

Chapter 1. Introduction
1.2. Photoplethysmography and its current applications
Photoplethysmography (PPG) is a technique in which the intravascular blood volume changes caused by arterial pulsations in the tissue are optically measured. A PPG sensor, often placed at a distal site such as fingertip or earlobe, comprises a light emitter and a light receiver (see figure 1.4). The emitter shines light onto the skin and the receiver detects the light transmitted or reflected, depending on sensor design. The light returning to the detector is attenuated by a mixture of absorbers including pigment, skin, bone, venous, and arterial blood. All absorbers, except for arterial blood, are assumed to be constant at the site of measurement. Thus, the variations in the detected light are primarily induced by the pulsation of arterial blood.
Pulse oximetry, for a long time the primary application of PPG, was invented in the mid-1980s and is now a standard of care for anesthesiology and critical care [33]‚Äì[40]. The working principle of pulse oximetry, using PPG signals obtained at a red and a near-infrared wavelength, is as follows. The oxyhemoglobin molecules in the red blood cells absorb red and infrared light in a different spectrum when compared to deoxyhemoglobin molecules. Specifically, oxyhemoglobin molecules absorb more infrared light and allow more red light to pass through, while deoxyhemoglobin allows more infrared light to pass through and absorbs more red light. Based on this observation, a ratio is calculated between the normalized signals of two wavelengths (red and near infrared). The normalization is done by dividing the pulsatile (AC)
Figure 1.4: Schematic representation of a transmissive finger pulse oximetry clip (drawing by H. Herps). LED: light emitting diode.
6

1.3. PPG-based blood pressure estimation

components over the slowly-varying (DC) components in one heartbeat. The calculated ratio by the processor is then mapped to oxygen saturation via a lookup table [41], [42]. This principle has gave rise to many proprietary algorithms used by manufacturers for calculating oxygen saturation [41].
In addition to estimating oxygen saturation, PPG can be used in monitoring heart or pulse rate, respiration rate, cardiac output, fluid responsiveness, and vascular disease [35], [43], [52]‚Äì[54], [44]‚Äì[51]. PPG has been suggested for use to detect a spontaneous pulse and therefore provide decision support in cardiopulmonary resuscitation [55], [56]. Detection in the changes in the heart rate can warn the caregivers of potential dangers for people with epilepsy [57]. PPG can be also helpful in detecting and screening atrial fibrillation [58]‚Äì[60]. PPG also finds its application in commercial health watches such as MIO Alpha, which is used to keep track of the exercise intensity [61], [62]. Recently, contactless camera PPG has been proposed to remotely acquire cardiovascular information with enhanced comfort and unobtrusiveness [63]‚Äì[65].

1.3. PPG-based blood pressure estimation

To understand PPG as an instrument in BP estimation, it is important to understand initial research involving the use of pulse wave velocity (PWV) for this purpose [66]‚Äì[72]. According to the Moens-Korteweg equation, PWV can be expressed by

Ì†µÌ∞∏‚Ñé

Ì†µÌ±ÉÌ†µÌ±äÌ†µÌ±â = ‚àöÌ†µÌºåÌ†µÌ±ë

(1.1)

where Ì†µÌ∞∏ [Pa] is the elastic modulus of vessel wall, ‚Ñé [m] is the wall thickness,

Ì†µÌ±ë [m] is the arterial diameter, Ì†µÌºå is blood density [kg/m3]. The elastic modulus

can be further expressed by

Ì†µÌ∞∏ = Ì†µÌ∞∏0Ì†µÌ±íÌ†µÌªæÌ†µÌ±É

(1.2)

where Ì†µÌ∞∏0 [Pa] is the elastic modulus at zero pressure, Ì†µÌªæ is a coefficient specific to the particular vessel, and P [mmHg] is blood pressure. The equations make it clear that BP is correlated with PWV.

7

Chapter 1. Introduction

To measure PWV, researchers often adopt a method involving the

combination of electrocardiography (ECG) and PPG. The delay between the

R peak in the ECG signal and a fiducial point, such as foot or steepest slope,

in the PPG signal in the same heartbeat is derived (see figure 1.5). This delay,

termed pulse arrival time (PAT), is an estimation of the pulse transit time

(PTT), which is the time it takes for a pulse to travel from the heart to the

peripheral artery. For a given arterial path, PTT is inversely proportional to

PWV. Studies have shown significant correlations between PAT and BP [67],

[68], [73], [74]. Nevertheless, this relationship does not always hold due to the

variance in the heart‚Äôs pre-ejection period (PEP) [75]‚Äì[77]. In fact, PAT

consists of two components:

PAT = PTT + PEP

(1.3)

where PEP [s] refers to the delay between the cardiac electrical activity and the actual mechanical ejection of blood through the aortic valves, and PTT [s] refers to the delay from the actual mechanical ejection to the arrival of the pulse at the peripheral arteries. In other words, the changes in PAT not only depend on PTT, but also on PEP. When PEP changes as a result of varied heart contractility and afterload, the relationship between PAT and PWV is compromised [75], [76]. Furthermore, the application of Moens-Korteweg equation requires an elastic propagation route, which is different from the peripheral vasculature. This difference is also a factor that complicates the relationship between PAT and PWV. Finally, the Moens-Korteweg equation also demands that the arterial diameter is unchanged, which is not always true either due to active vasoregulation [78]. These reasons may account for the discrepancy in the performance of PAT-derived blood pressure estimation reported by different groups [74], [75], [85], [76], [78]‚Äì[84].
Aside from the discussions on PWV and PAT, PPG has been related to potential usefulness for BP estimation via PPG-derived features [78], [86]‚Äì [88]. The PPG waveform is similar to the BP waveform. This results from the fact that they reflect cardiac-induced variations in arterial volume and pressure, respectively. A number of features of the PPG waveform have been designed to capture BP information hidden in the PPG waveform. The systolic time, diastolic time, and pulse width were initially proposed as features to derive BP [88]. Later, features from the dicrotic peak in the PPG waveform have been
8

1.3. PPG-based blood pressure estimation
found to be informative in inferring BP [74], [89]. The dicrotic peak refers to the second peak found in one PPG heartbeat. It is produced by the reflections

Figure 1.5: Illustration of PPG-derived features. The first panel (from top to bottom): ECG signal. The second panel: PPG signal. The third panel: the first derivative of the PPG signal. The fourth panel: the second derivative of the PPG signal. PAT: pulse arrival time. PD: pulse delay. AMP: PPG amplitude. SP: systolic phase. DP: diastolic phase. P1: The local maximum in the first derivative. P2: the local minimum in the first derivative.

of the arterial pressure pulse at bifurcations in the arterial system. The delay

between the first and second peak was found to be related to BP. Elevated BP

leads to increased pulse wave velocity, resulting in a shorter delay. The ratio

between the amplitudes of the first and second peak was also investigated, as

it quantifies the degree of reflection, which can be associated with the

systematic vascular resistance (SVR). The area ratio segmented by the dicrotic

notch has also been used to derive a SVR indicator. BP can be represented by

Ì†µÌ∞µÌ†µÌ±É = Ì†µÌ∞ªÌ†µÌ±Ö √ó Ì†µÌ±ÜÌ†µÌ±â √ó Ì†µÌ±ÜÌ†µÌ±âÌ†µÌ±Ö

(1.4)

where HR [bpm] and SV [L] means heart rate and stroke volume, respectively. As a result, SVR is potentially useful in estimating BP. Although these parameters can be effective, the dicrotic notch and peak are often missing,

9

Chapter 1. Introduction
particularly in the case of high BP or elderly subjects. In those cases, a surrogate fiducial point, such as the maximum first derivative in the diastolic phase, is often selected at the cost of degrading performance. Other features exist in the second derivative of the PPG waveform. Features such as b/a, c/a, d/a, and e/a have been studied to assess arterial stiffness (figure 1.5). As elevated BP is often accompanied by less distensible arteries, these parameters are also likely to be useful for the estimation of BP. Other more sophisticated algorithms have also been advocated to derive BP by extracting alternative features from the PPG waveform. Wavelet transformation was used in several studies [90], [91]. However, due to by nature the varied morphology of PPG waveforms, it is difficult to find a widely-applicable wavelet basis function, limiting the use of this approach [92], [93].
1.4. Fluid responsiveness
Optimal circulatory volume status of patients in the OR and ICU is of crucial importance, as the circulatory volume is an important determinant in the oxygen supply to the tissues. On one hand, insufficient circulatory volume, hypovolemia, potentially leads to increased postoperative morbidity or even mortality [94]‚Äì[99]. On the other hand, excessive circulatory volume, hypervolemia, can result in increased cardiac, renal, and pulmonary injury [94], [100]‚Äì[104]. Hemodynamic optimization, with the goal of maintaining optimal circulatory conditions, has been shown to improve postoperative outcome and reduce the cost of surgery [105]‚Äì[108].
To evaluate volume status, several approaches have been proposed. One option is to use clinical signs [96], [109], [110]. In the case of hypovolemia, clinical signs are considered such as reduced skin turgor, oliguria, tachycardia, hypotension, and other end organ signs. However, the emergence of these signs is often late, which then requires urgent intervention. In other words, the absence of these signs does not exclude the presence of hypovolemia and they are not sufficiently robust to help in the early detection of hypovolemia [111], [112]. In fact, several studies have shown that clinicians are able to accurately predict volume status in less than 50% of cases [112], [113].
Another option, intuitively, would be to directly measure circulating blood volume. However, most techniques aiming for this do not lend themselves to rapid determination of blood volume and are not clinically
10

1.4. Fluid responsiveness
useful. Furthermore, even if a reliable volume measurement technique is found, ‚Äúnormal‚Äù blood volume has been shown to be a poor indicator of physiological requirements and is also affected by body composition [114]. Another option a single measurement of central venous pressure (CVP) has gained popularity based on its ease of measurement [115]. CVP is the pressure recorded at the right atrium or super vena cava. CVP depends on many factors such as venous return to the heart, right ventricular compliance, peripheral venous tone, intrathoracic pressure, and posture. This strongly suggests that the absolute value of (one) measurement of CVP does not confirm volume status [115]. A similar pitfall applies to the option using pulmonary artery wedge pressure (PAWP), the level of which can be influenced by, for example, positioning, pulmonary disease or left ventricular disease [115]. In addition, pulmonary artery catheterization, required to measure the wedge pressure, is known to be related to complications which are suspected to be a cause of increased mortality [116].
All the different drawbacks in these approaches weaken the potential concept of using one measurement to assess circulatory volume status.
To test the patient‚Äôs need for fluid therapy, clinicians can use a fluid challenge, in which a patient is given a relatively small amount of fluid (i.e. 250ml) to see whether this increases the cardiac output. If a patient‚Äôs cardiac output is actually increased, then the patient is considered fluid responsive, or otherwise fluid unresponsive. When the patient is fluid unresponsive, the clinician should not administer more fluid in order to avoid overloading the patient. To assess fluid responsiveness, static and dynamic parameters have been investigated. Static parameters include CVP, PAWP, left ventricular enddiastolic area, and changes in CVP [117], [118]. These static parameters have been found to be poor predictors for fluid responsiveness [117], [118]. The other category of the parameters reflecting hemodynamic changes and therefore cardiopulmonary interactions are called dynamic parameters such as systolic pressure variations (SPV) and pulse pressure variations (PPV) [119], [120]. These parameters have been shown to be superior to the static ones for patients undergoing mechanical ventilation [108], [118], [121]. The dynamic parameters rely on the pressure-volume relation explained by the FrankStarling curve (figure 1.6), which describes the relationship between intrathoracic pressure (as a surrogate for preload) and left ventricular stroke
11

Chapter 1. Introduction
Figure 1.6: Illustration of a Frank-Starling Curve.
volume. The Frank-Starling curve indicates that when preload is low and the heart is operating in the steep region of the curve, the ejected volume will increase significantly when preload is increased. When preload is high and the heart is operating in the plateau part of the curve, the ejected volume will change only marginally even in the face of large increases in preload. Among the dynamic parameters, PPV is one of the most popular [26], [108], [122].
1.5. Pulse pressure variations
Variations in pulse pressure are generated in the following way. During the inspiratory and plateau phase in positive pressure mechanical ventilation, the positive intrathoracic pressure compresses the highly compliant vena cava, increasing the resistance to venous flow, resulting in decreased venous return to the right atrium [123]. During expiratory phase of mechanical ventilation, the vena cava is released, decreasing the resistance to venous flow, and leading to increased venous return. In this way, the ventilation-induced cyclic changes in the intrathoracic pressure induce cyclic changes in the venous return and therefore the preload (end-diastolic blood volume) of the heart. These cyclic changes in the preload induce cyclic changes in the stroke volume, which will appear as cyclic changes in pulse pressure (PP) [122]. The parameter PPV is designed to quantify such cardiopulmonary interactions [26]. It is defined as 12

1.5. Pulse pressure variations

the ventilation-induced variation in pulse pressure normalized by the mean

pulse pressure [26]. Precisely, the formula for calculating PPV is given by

Ì†µÌ±ÉÌ†µÌ±ÉÌ†µÌ±â (%) = 100

√ó

Ì†µÌ±ÉÌ†µÌ±ÉÌ†µÌ±öÌ†µÌ±éÌ†µÌ±• ‚àí Ì†µÌ±ÉÌ†µÌ±ÉÌ†µÌ±öÌ†µÌ±ñÌ†µÌ±õ (Ì†µÌ±ÉÌ†µÌ±ÉÌ†µÌ±öÌ†µÌ±éÌ†µÌ±• + Ì†µÌ±ÉÌ†µÌ±ÉÌ†µÌ±öÌ†µÌ±ñÌ†µÌ±õ)/2

(1.5)

where PPmax and PPmin are, respectively, the maximum and minimum pulse pressures sampled from a sample window with a duration of a single respiratory cycle. PPV has been shown to be useful for making therapeutic choices in mechanically ventilated patients with acute circulatory failure related to sepsis [26] as well as in patients who have undergone coronary artery bypass grafting [124]. In general, the use of PPV in clinical decision making has been proven to decrease the length of hospitalization [108], [120], [125].
In the original specification by Michard et al. [26], PPV was calculated in the sample duration of a single respiratory cycle and then averaged over three sample durations. Since the original specification for PPV, multiple implementations and adaptations have been used in the commercial and scientific community. Before calculating PPV, the interpolated pulse pressure (IPP) signal can be obtained by using different methods. The original specification is equivalent to linear interpolation of the pulse pressure, whereas Aboy et al. [126], [127] applied kernel smoothing to derive the IPP.
When calculating PPV, various sample durations have been adopted: one ventilation cycle [26], three or five ventilation cycles [128], two ventilation cycles [127], 8s [129], 10s [130]. Extended sample durations has been put forward to reduce detrimental effects originating from the asynchrony between the cardiac and respiratory cycles [128], and to eliminate the need for accurate estimation of the ventilation frequency. Methods to smooth raw PPV values, in order to filter out fast PPV fluctuations, were also investigated: a three-point mean filter [26], a three-point median filter [126], and the Kalman filter [127] have all been advocated. Although not clearly published, commercial patient monitors seem to employ 8‚Äì12s sample durations and to subsequently use a three- or four-point mean filter, thereby evaluating in total about 30s of the ABP waveform for each presented PPV value [128], [129].

13

Chapter 1. Introduction

1.6. Pulse amplitude variations derived from PPG

Although PPV has been shown to be effective, the measurement of PPV

requires arterial catheterization, which has a risk of causing medical

complications. This concern has driven the emergence of a non-invasive

alternative, derived from the PPG waveform. In fact, the first study suggesting

the relation between respiration-induced PPG-derived variations and volume

status was published as early as in 1987 [131]. More recently, extensive

research has been done to dive into the usefulness of PPG-derived variations

for determining fluid responsiveness [132]‚Äì[136]. In line with PPV, the pulse

amplitude variation (PAV) of the PPG signal serves the same function. The

PAV is defined in an analogous fashion to PPV:

Ì†µÌ±ÉÌ†µÌ∞¥Ì†µÌ±â

(%)

=

100

√ó

Ì†µÌ±ÉÌ†µÌ∞¥Ì†µÌ±öÌ†µÌ±éÌ†µÌ±• ‚àí Ì†µÌ±ÉÌ†µÌ∞¥Ì†µÌ±öÌ†µÌ±ñÌ†µÌ±õ (Ì†µÌ±ÉÌ†µÌ∞¥Ì†µÌ±öÌ†µÌ±éÌ†µÌ±• + Ì†µÌ±ÉÌ†µÌ∞¥Ì†µÌ±öÌ†µÌ±ñÌ†µÌ±õ)/2

(1.6)

where PAmax and PAmin are the maximum and minimum PPG pulse amplitudes

sampled from a sample window with a duration of a single respiratory cycle.

Another implementation, pleth variability index (PVI), was devised by the

Masimo Corp. Though few details can be found for its proprietary algorithm,

the core formula is:

Ì†µÌ±ÉÌ†µÌ±âÌ†µÌ∞º

(%)

=

100

√ó

Ì†µÌ±ÉÌ†µÌ∞ºÌ†µÌ±öÌ†µÌ±éÌ†µÌ±• ‚àí Ì†µÌ±ÉÌ†µÌ∞ºÌ†µÌ±öÌ†µÌ±ñÌ†µÌ±õ Ì†µÌ±ÉÌ†µÌ∞ºÌ†µÌ±öÌ†µÌ±éÌ†µÌ±•

(1.7)

where PImax and PImin are the the maximum and minimum perfusion indexes sampled from a sample window with a duration of a single respiratory cycle. Although some studies show good correlations between PPV and PAV [132]‚Äì [134], others report poor results especially those investigating their relationship over a long period of time [135]‚Äì[137].

1.7. Objectives of the thesis
This thesis consists of two parts. Part I deals with the estimation of SBP from ECG- and PPG-derived features. This part describes studies in unobtrusive and continuous monitoring for SBP in both daily life and clinical settings. Part II addresses the calculation of pulse pressure variations from
14

1.7. Objectives of the thesis
ABP and PPG waveforms. This part focuses on improving the robustness of existing PPV algorithms and investigating its non-invasive surrogates.
1.7.1. Objectives of Part I
Existing research focused on using PAT or a single PPG-derived feature to estimate SBP, with the requirement of frequent calibrations. Thus, the goal in the study described in Chapter 2 was to design an SBP estimation model combining multiple ECG and PPG-derived features with a minimal need of calibration for subjects doing physical exercise. We also propose four novel morphological features to strengthen the model. In addition, we explored the dependence of the model‚Äôs performance on several varying factors.
Existing works on non-invasive continuous estimation of SBP has been described to fail to meet clinical standards [83], [138]. In Chapter 3, we describe our investigation into how to utilize prior intermittent measurements to strengthen the estimation model, as models inferring blood pressure often show improved performance in the presence of calibration and recalibration [67], [73], [139]. We propose an SBP estimation model using ECG- and PPGderived features and previous intermittent measurements, which meets the clinical requirement.
1.7.2. Objectives of Part II
Available PPV algorithms have been typically validated for fluid responsiveness during episodes of hemodynamic stability. Yet, little is known about the performance of PPV algorithms during surgery, where rapid changes of blood pressure may affect the robustness of the presented PPV value. In Chapter 4, we provided a comprehensive understanding of how various existing algorithmic designs affect the robustness of the presented PPV value during surgery and propose additional processing for the pulse pressure signal before calculating PPV. In order to evaluate the performance of these algorithms, we designed three clinically-relevant metrics which are presented in Chapter 4.
A number of studies have researched on the potential of the use of PAV as a replacement for PPV. However, it is still unclear how the performance of the PPG-derived PAV is site-dependent during surgery.
15

Chapter 1. Introduction
In our work described in Chapter 5, we compared finger- and foreheadPPG derived PAV in their ability to approach the value and trend of ABPderived PPV. Furthermore, we investigated four potential confounding factors that may affect the agreement between PPV and PAV.
1.8. Outlines of the thesis
In Part I, Chapter 2 describes a model for the estimation of SBP for subjects doing physical exercise. This model has an initialization process for each subject at rest. After this initialization process, the model estimated SBP every 30 seconds during the entire course of exercise. In order to build this model, 18 features, in addition to PAT, were extracted from the PPG signals using its waveform, first derivative, second derivative, and frequency content. Among these features, four features derived from the first derivative are proposed for use. To combine all derived features, we evaluated four different regression models including multiple linear regression (MLR), linear ridge, support vector regression, and random forest, from which we later selected MLR due to its performance and simplicity. The contribution of each feature was quantified using its normalized weight in the MLR model. We also studied the influence of factors such as the inclusion of PAT, initialization process, measurement sites, and different postures. The results show that the inclusion of PAT reduced the standard deviation (SD) of the difference. There was no significant difference in the estimation performance between the model using finger- and forehead-derived PPG signals. It is shown that the model should be adapted for different postures. The optimized model using fingerderived PPG signals achieved high correlation correlations and promisingly low absolute errors.
In Chapter 3, we studied SBP monitoring for patients undergoing major surgery in the OR. For these patients, we propose a novel model to estimate SBP every 30 seconds based on previous intermittent SBP measurements and ECG- and PPG-derived features. Specifically, upon each SBP measurement, we dynamically selected features based on feature robustness and the principle of correlation feature selection (CFS) from the feature pool. The creation of feature pool was inspired by the study we present in Chapter 2. As a result, we categorized the features into four groups. CFS dictates that a feature would be selected if it can provide complementary information to the features that are
16

1.8. Outlines of the thesis
already selected. After selecting the features, we built an MLR model to combine these features. The results show that the proposed model achieved a clinically-acceptable performance. The results also demonstrated that PAT is the feature that was selected most frequently and PPG-derived features can provide additional information to PAT, thereby reinforcing the PAT-based SBP estimation model.
In Part II, Chapter 4 provides a comprehensive understanding of how various existing algorithmic designs affect the robustness of the presented PPV value derived from ABP during surgery, and proposed additional processing in order to provide more robust PPV. Based on our observations on the clinical data, we propose three clinically-relevant metrics for assessing the performance of PPV calculation algorithms. These metrics are the difference from the original specification, the hourly occurrence of unstable PPV calculation episodes, and the hourly occurrence of short-term elevations. With these metrics in place, we studied and compared five existing algorithms in the literature. Inspired by the design and corresponding performance of these algorithms, we proposed additional processing, which included baseline extraction and adaptive peak filtering processing for the pulse pressure signal before calculating PPV. The results show that all algorithms performed well during episodes of hemodynamic stability. Moreover, it is demonstrated that the proposed processing can help improve the robustness of PPV during the entire course of surgery.
Chapter 5 studies the potential of PPV monitoring in a non-invasive manner using PPG signals. We compared finger- and forehead-PPG derived PAV in their ability to approach the value and trend of ABP-derived PPV. Furthermore, we investigated several potential confounding factors that might affect the agreement between PPV and PAV. These factors include baseline variations, PPV values, heart rate to respiration rate ratio, and perfusion index. We analyzed the impact of these factors using an MLR analysis. The results show that, compared with the ABP-derived PPV, finger-derived PAV had a significantly better agreement than forehead-derived PAV. From the MLR analysis, we found that the PPG signal baseline variation was an important factor significantly affecting the agreement between PPV and PAV. After correcting for the respiration-induced baseline variation in the PPG signals, the agreements between PPV and finger-derived PAV, and between PPV and
17

Chapter 1. Introduction forehead-derived PAV were both improved, and the difference between these two agreements was diminished. Yet, the tracking abilities for both finger- and forehead-derived PAV still warrant improvement for wide use in clinical practice.
Chapter 6 provides a general discussion on the implications of this work on the monitoring of BP and PPV and suggests research directions for future work.
18

Part I The monitoring of blood pressure
19

20

CHAPTER 2
Blood pressure estimation using ECG and PPG during physical exercise
This chapter is based on: Sun, S, Bezemer, R, Long, X., Muehlsteff, J., and Aarts, R.M. ‚ÄúSystolic blood pressure estimation using PPG and ECG during physical exercise,‚Äù Physiological Measurement, vol. 37, no. 12, pp. 2154‚Äì2169, 2016. Sun, S., Bezemer, R., Long, X., Muehlsteff, J., Aarts, R.M. ‚ÄúSystolic blood pressure estimation using PPG during physical exercise,‚Äù 38th Annual International Conference of IEEE Engineering in Medicine and Biology Society (EMBC), Orlando, FL, US, Aug 16-20, 2016. Sun, S., Bezemer, R., Muehlsteff, J., Aarts, R.M. ‚ÄúA novel continuous noninvasive estimation of systolic blood pressure,‚Äù 5th Dutch Bio-Medical Engineering Conference (BME), Egmond aan Zee, the Netherlands, Jan. 2223, 2015.
21

Chapter 2. Blood pressure estimation using ECG and PPG during physical exercise
Abstract In this work, a model to estimate systolic blood pressure (SBP) using
photoplethysmography (PPG) and electrocardiography (ECG) is proposed. Data from 19 subjects doing 40-minute of exercise was analyzed. Reference SBP was measured at the finger, based on the volume-clamp principle. PPG signals were measured at the finger and forehead. After an initialization process for each subject at rest, the model estimated SBP every 30 second for the whole period of exercise. In order to build this model, eighteen features were extracted from PPG signals by means of its waveform, first derivative, second derivative, and frequency spectrum. In addition, pulse arrival time (PAT) was derived as a feature from the combination of PPG and ECG. After evaluating four regression models, we chose multiple linear regression (MLR) to combine all derived features to estimate SBP. The contribution of each feature was quantified using its normalized weight in the MLR. To evaluate the performance of the model, we used a leave-one-subject-out cross validation. In the aim of exploring the potential of the model, we investigated the influences of the inclusion of PAT, regression models, measurement sites (finger and forehead), and posture change (supine, sitting, and standing).
The results show that the inclusion of PAT reduced the standard deviation (SD) of the difference from 14.07 to 13.52 mmHg. There was no significant difference in the estimation performance between the model using finger- and forehead-derived PPG signals. Separate models are necessary for different postures. The optimized model using finger-derived PPG signals during physical exercise had a performance with a mean difference of 0.43 mmHg, an SD of difference of 13.52 mmHg, and a median correlation coefficients of 0.86. Furthermore, we identified two groups of features that contributed more to SBP estimation compared to other features. One group consists of our proposed features depicting beat morphology. The other comprises existing features depicting the dicrotic notch. The present work demonstrates promising results of the SBP estimation model during physical exercise.
22

2.1. Introduction
2.1. Introduction
Blood pressure is one of the vital signs that reflect the cardiovascular status of the human body. Continuous monitoring of blood pressure not only provides immediate physiological parameters for patient care and monitoring, but also reveals health risks that might eventually lead to hypertension or arteriosclerosis [140]. Conventional blood pressure measurements have certain limitations and risks. Measurements using a brachial cuff can be only obtained intermittently. Measurements using a finger cuff are not suitable for long-term use, while use of an invasive arterial catheter expose patients to infection risks [31], [32]. To avoid these drawbacks and develop alternatives, researchers have been looking for non-invasive continuous blood pressure monitoring methods [74], [86], [138].
Photoplethysmography (PPG) has been considered as a method to estimate blood pressure [74], [86], [138]. It includes an optical sensor that emits light onto the skin and receives the transmitted or reflected light. PPG measures local blood volume changes in tissues at distal sites, such as the finger, forehead, and toe. The relationship between volume and pressure in vessels leads to similar morphology between PPG signals and arterial blood pressure signals. Researchers have therefore proposed a number of features (representing certain physiological properties) to derive blood pressure from PPG signals [88], [141]‚Äì[143]. In addition, other studies have focused on pulse arrival time (PAT) to estimate blood pressure, where PAT is defined as the time delay from the R peak in the electrocardiography (ECG) signal to the foot in the PPG signal that follows immediately the R peak [67], [85]. The underlying mechanism is that, as blood pressure increases, the pulse travels faster in the arteries, leading to a shorter PAT.
In recent years, some researchers have built novel models or improved existing models for estimating blood pressure from PPG. For example, Baek et al. [74] investigated a linear model using three features, but that model included a calibration process which required introducing changes in the blood pressure and measuring at least three different blood pressure values. In addition, the PPG waveform was not fully explored in that work. MonteMoreno [86] proposed and combined a wide range of features from PPG waveforms in order to estimate blood pressure, but that model was only validated in a scenario at rest and the proposed features were not explicitly
23

Chapter 2. Blood pressure estimation using ECG and PPG during physical exercise
explained. Rodriguez et al. [138] designed a model that took raw PPG signal as features and employed a deep learning technique to estimate blood pressure. However, the model was computationally intensive and it was difficult to interpret useful physiological information from PPG waveforms.
In addition to estimation models, different experimental settings were studied. In the work of Baek et al. [74], they recorded data during dental anesthesia and during the Valsalva maneuver, where blood pressure was measured either by a catheter or a finger cuff, and PPG was measured on the leg, palm, or finger. In the work of Monte-Moreno [86], he measured blood pressure at rest for each subject by sphygmomanometer and measured PPG at the finger. In the work of Rodriguez et al. [138], they recorded data in the intensive care unit, where blood pressure was measured invasively and PPG was measured at the patient‚Äôs finger.
This study aims to design a model using multiple PPG- and ECG-derived features to estimate SBP for healthy people during physical exercise. In addition, this study explores the dependency of model performance on varying factors. These factors include the use of ECG signals, measurement sites (finger and forehead), and different postures (supine, sitting, and standing). We addressed only systolic blood pressure (SBP) because diastolic blood pressure (DBP) changes only marginally during exercise for healthy people [144].
2.2. Materials and methods
2.2.1. Data
In this study, 20 subjects were included, where the data from one subject was excluded due to low signal quality. Continuous blood pressure, PPG, and ECG signals were acquired from the 19 subjects (14 males and 5 females) with an average age of 28.9 ¬± 8.6 years (ranging from 22 to 53), an average height of 175.6 ¬± 10.0 cm, and an average weight of 70.6 ¬± 14.2 kg. For each subject, one ECG and two PPG signals (placed at the fingertip and forehead) were recorded with a sampling frequency of 200 Hz and subsequently synchronized. The blood pressure signal was continuously measured at the finger by a commercial Portapres device (Finapres Medical Systems, Amsterdam, The Netherlands). This device is based on a volume-clamp method where the cuff
24

2.2. Materials and methods
pressure is changed rapidly to maintain constant arterial volume below the cuff. The oscillation of pressure have been found to resemble the intra-arterial pressure wave. This type of device has been well validated and achieved an accuracy of 6.5¬±2.6 mmHg compared to intra-arterial blood pressure [145]. Signal processing and statistical analysis were carried out using Matlab (Mathwork, Natick, USA).
2.2.2. Experiments
In this work, we analyzed two datasets collected from 19 subjects participating in two experiments previously described by Proenca et al. [76] and Muehlsteff et al. [146], respectively.
The first experiment was done when subjects were doing physical exercises. The experiment started with a five-minute baseline phase at rest. After that, subjects were asked to do three sequential cycling exercises. There was a five-minute recovery period between each of these exercises. Three levels of activity were investigated: low intensity of about 25 Watt, medium intensity of about 45 Watt, and high intensity of about 65 Watt. Figure 2.1 (a) illustrates the experimental protocol and shows an example of SBP changes during physical exercises with the three levels of activity. It can be seen that SBP increased during the exercise periods and decreased during the recovery periods. In addition to this general trend, other variations in the SBP can also be seen. These may be caused by respiration or measurement noise. Although subjects were asked to comply with the protocol as much as possible, the actual exercise periods, therefore the changes in SBP, may still precede or succeed the planned exercise periods. Furthermore, it is possible that subjects cycled too fast and reached highest SBP early and SBP started to decrease before the exercise stopped or that subjects became excited and had high SBP before the exercise started.
The second experiment was done when subjects changed their postures. During this experiment, all subjects were asked to maintain and change their postures as follows: five-minute supine, five-minute sitting, five-minute supine, five-minute standing, and five-minute supine. The analysis of this dataset aimed to investigate the effects of different postures on PPG waveform features and their relation to SBP. Figure 2.1 (b) illustrates the experiment protocol and how SBP responded to different postures.
25

Chapter 2. Blood pressure estimation using ECG and PPG during physical exercise
Figure 2.1: Illustration of study protocols and corresponding systolic blood pressure (SBP) changes. (a): The subjects performed three rounds of cycling activity of different intensities. SBP increased during exercise and decreased during rest. (b): The subjects maintained and changed postures between supine, sitting, and standing.
To mitigate the measurement noise in the first experiment, we instructed the subjects to hold their hands onto a handle bar at a constant height level in respect to the heart level. In the second experiment, we removed the posture transition phases.
2.2.3. Signal preprocessing
The continuous blood pressure signal was first processed with a six-order Butterworth low-pass filter with a cutoff frequency at 10 Hz. Beat-by-beat SBP values were determined at the detected peaks in the blood pressure signal. 26

2.2. Materials and methods
For the ECG signal, baseline drift and high frequency noise were removed using a six‚Äìorder Butterworth band-pass filter with cutoff frequencies at 0.6 Hz and 10 Hz. This was also done on the PPG signal for the same purposes. All filtering processes were implemented in forward and backward directions to eliminate phase distortion. Segments of low quality in the ECG and PPG signals were removed by a combination of visual inspection and a dedicated software. This software calculated distances between neighboring detected peaks, distances between neighboring detected valleys, and the amplitude of each detected pulse. By comparing such values with the historic values, the program determined the quality of each pulse. The first and second derivatives of the PPG signal were acquired using smooth noise-robust differentiator [147]. This method designs a differentiation filter in the frequency domain for the sake of noise robustness. This filter allows for precise frequency response at low frequencies, and improved suppression of noise at high frequencies. The order of the filter determines suppression effects at high frequency. In this work, we chose the order to be five. Peaks and valleys in the ECG and PPG signals were detected using the first and second derivative [74], [130]. All were visually verified.
2.2.4. Feature extraction
From a physiological point of view, blood pressure is determined by cardiac output and systematic vascular resistance, and is regulated by the autonomic nervous system (ANS). Arterial stiffness also plays a role in increasing systematic vascular resistance. Features reflecting the function of ANS are therefore potentially helpful in estimating blood pressure from PPG signals. Similarity between PPG signals and blood pressure signals in their waveform morphologies is often observed. To utilize this similarity, features describing PPG waveform morphology were also included in the model. We extracted 18 features from the waveform of the PPG signal, the first and second derivatives, and frequency spectrum. In addition, we derived another feature from the arrival time that is related to the time delay from the R peak in the ECG signal to the maximum first derivative during upstroke of the pulse in the PPG signal. A summary of all features is given in table 2.1.
27

Chapter 2. Blood pressure estimation using ECG and PPG during physical exercise

Table 2.1: Features extracted from the PPG waveform, the first and second

derivatives, the frequency spectrum, and the arrival time.

Extraction aspects

Features

Description

Number

notation

[unit]

Waveform

PW [s]

Pulse width between half

1

See figure 2.2

amplitude

SI [-]

Stiffness index: PD divided

2

by subject height

RI [-]

Reflection index: second

3

peak amplitude over first

peak amplitude

PAR [-]

Pulse area ratio separated

4

by notch

First derivative See figure 2.2

LVET [s] Left ventricle ejection time

5

estimated from PPG

waveform

dpmean [-]

Mean of normalized first

6

derivative in diastolic phase

dpvar [-]

variance of normalized first

7

derivative in diastolic phase

spmean [-]

Mean of normalized first

8

derivative in systolic phase

spvar [-]

variance of normalized first

9

derivative in systolic phase

Second derivative See figure 2.2

b/a [-]

Height of b over height of a

10

c/a [-]

Height of c over height of a

11

d/a [-]

Height of d over height of a

12

e/a [-]

Height of e over height of a

13

28

2.2. Materials and methods

Frequency Spectrum

NHA [-]

Normalized harmonic area

14

SEmean [-]

Mean of spectral entropy

15

SEvar [-]

Variance of spectral

16

entropy

PPGV [-]

PPG pulse amplitude

17

variability

HRV [-]

Heart rate variability

18

Arrival time

NPAT [s/m]

Pulse arrival time

19

See figure 2.2

normalized by subject

height

2.2.4.1. Waveform.
Five existing waveform-derived features were computed in this work (see figure 2.2). Left ventricle ejection time (LVET), the time interval from opening of the aortic valve to its subsequent closure, has been shown to be associated with cardiac output [148]. We estimated LVET, as a feature, from the PPG signal waveform using a multi-Gaussian fitting method, as described by Couceiro et al. [149]. SVR has been represented as the half amplitude pulse width (PW) [141], the pulse area ratio (PAR) [150], and the reflection index (RI) [89] of each pulse in the PPG signal. PW was defined as the width from the half of the amplitude location in the systolic phase to the half of the amplitude location in the diastolic phase. PAR was defined as the ratio between the areas separated by the dicrotic notch, i.e., Area2 divided by Area1. RI was defined as the ratio between the amplitude of the dicrotic peak (AMP2) and that of the first peak (AMP1).
When systematic vascular resistance increases, blood flow decreases. In the meantime, the degree of impedance mismatch at reflection sites between large and small arteries is elevated. The decrease in blood flow leads to a larger PW and the increased mismatch leads to a stronger reflection effect, which increases RI and PAR. Arterial stiffness also affects blood pressure by altering systematic vascular resistance. As vessels become stiffer, blood pressure
29

Chapter 2. Blood pressure estimation using ECG and PPG during physical exercise
increases, the pulse wave travels faster and the delay between the forward wave and reflected wave drops. Stiffness index (SI) was extracted as the pulse delay (PD) from the first peak to the second peak, normalized by the subject height, as described by Millasseau et al. [142].
2.2.4.2. First derivative.
We propose four features from the first derivative of the PPG signal (see figure 2.2). We derived the first derivative of the PPG signal for each pulse and then a min-max normalization was applied for scaling each pulse waveform to its first peak-to-preceding valley amplitude. This normalization aimed to suppress the impact of local perfusion and to focus only on the rising and falling characteristics of each pulse. Next, we calculated the mean and variance of the first derivative in the systolic and diastolic phase of the pulse, respectively.
2.2.4.3. Second derivative.
In previous studies [151]‚Äì[153], five waves were observed in the second derivative and were defined as a, b, c, d, and e waves (see figure 2.2). In these work, features were extracted from the second derivative of the PPG signal such as b/a, c/a, d/a, e/a, and (e-d-c-b)/a that were related to arterial stiffness, or mean blood pressure (MBP). We omitted (e-d-c-b)/a, given that it can be linearly represented by b/a, c/a, d/a, and e/a.
2.2.4.4. Frequency spectrum.
Heart rate variability (HRV) has been proven to reflect ANS. PPG variability (PPGV) has also been shown to be associated with sympathetic vasomotor activities [154]‚Äì[156]. Thus, HRV and PPGV were included as features in the model where PPGV was derived by calculating PPG amplitude variability. Both features were computed using Welch‚Äôs technique. The normalized harmonic area (NHA), ratios of the amplitudes at harmonics frequency to the amplitude at the fundamental frequency, was proposed by Wang et al. [143] and by Yan and Zhang [157]. These authors found this feature to be related to pulse wave reflection and SBP. Thus, we included this feature in the model. In addition, we also included the mean and variance of the spectral entropy in the PPG signal, as proposed by Monte-Moreno [86]. These features indicate the richness of spectral components and therefore also
30

2.2. Materials and methods
Figure 2.2: Illustration of the derived features. (a) Features derived from the PPG waveform. P1 and P2 were determined by the method by Couceiro et al. [149]. (b) The upper panel: features derived from combination of ECG and PPG signals. P3 was the maximum first derivative. The middle panel: features derived from the first derivative of PPG signals. SP stands for systolic phase and DP stands for diastolic phase. The bottom panel: features derived from the second derivative of PPG signals. Wave a and b are the first local maximum and minimum within one pulse, respectively. Wave c and e is the second and third local maximum and d is the local minimum between them. These waves were defined mathematically by Takazawa et al. [153].
31

Chapter 2. Blood pressure estimation using ECG and PPG during physical exercise
reflect the damping effects of the pulse during the transmission from the heart to the periphery. When blood pressure increases, the vessels become stiffer, leading to less damping of the pulse.
2.2.4.5. Arrival time PAT consists of a pre-ejection period and a pulse transit time. The pulse transit time from the aorta to the periphery is associated with MBP as shown by Geddes et al. [66]. As MBP increases, pulse transit time decreases. This relationship is treated as linear for a short period of time when vascular properties are assumed to be stable, making it necessary to adjust the model frequently in order to accommodate changes in vascular properties [67]. Changes in vascular properties regulated by sympathetic activity, for example vessel radius and vasomotor tone, can be pronounced [158]. To take these effects into account and free our model from frequent calibration, we included above features to reflect the changes in systematic vascular resistance and in sympathetic activity. In this chapter, we defined PAT as the delay from the R peak in the ECG signal to the maximum in the first derivative of the PPG signal (see figure 2.2), as a surrogate for the pulse transit time. To mitigate subject-specific pulse travelling distance and make PAT solely dependent on blood pressure, the PAT was normalized by subject height and denoted by NPAT.
2.2.5. Regression model
In this study, the estimation period was 30 seconds and all features extracted on a beat-by-beat basis were averaged over that duration. A normalization of all features was done by computing a z-score (standard score). To explore the relationship between the features and the SBP, four regression models were considered, namely multiple linear regression (MLR), linear ridge (LR), random forest (RF), and support vector regression (SVR). MLR has the advantage of displaying a weight for each feature showing its contribution. To quantify and normalize the contribution of each feature, normalized feature weights were calculated by dividing the absolute weight of each features by the sum of the absolute weights of all involved features. LR
32

2.2. Materials and methods
penalizes regression coefficients due to highly correlated variables where the penalty parameter was determined using an automatic method proposed in [159]. RF utilizes abundant decision trees to reduce variance (the capability of the model when generalized on unseen data) while maintaining low bias (the capability of the model when fitting on the existing data). In this work, we set the total number of trees to be 500 and number of considered features for each node to be seven. SVR maps the feature space to a high-dimensional space, builds linear model on that space, and ignores estimation errors situated within user-specified distance from the reference values. For SVR, we chose a Gaussian kernel. The results obtained using these four regression models were compared in this work.
2.2.6. Model validation
To assess the performance of the proposed model, leave-one-subject-out cross validation (LOSOCV) was used. The procedure of employing LOSOCV is shown in figure 2.3. In each iteration, the data of 18 subjects were used for training the model with the other set of subject data withheld for use as the test data. The derived model was then applied to the leave-out subject. Performance indicators such as median correlation coefficients, root mean square error (RMSE), and coefficient of determination (R2) were recorded. R2 is a statistical measure of how close the data are to the fitted regression model and it shows the percentage of the response variable variation that is explained by the model. When R2 equals one, this indicates that the model explains all the variability of the response data around its mean. When R2 equals zero, this indicates that the model explains none of the variability of the response data around its mean. When R2 is less than zero, it indicates the model is worse than a simple estimation using the mean value. After 19 iterations of these computations, the overall performance was reported by calculating bias (mean of the difference between the measured and estimated SBP), standard deviation (STD) of the difference, median correlation coefficients, R2, and RMSE. Wilcoxon signed-rank tests were done on median correlation coefficients and RMSE to detect significant difference.
33

Chapter 2. Blood pressure estimation using ECG and PPG during physical exercise

Figure 2.3: Block diagram of the LOSOCV procedure. In each iteration, one set of subject data was withheld to be used as the test data, and the data of the other 18 subjects were used for training the model. The derived model was then applied to the leave-out subject. Performance indicators were recorded. After all 19 iterations, the performance indicators were computed.

2.2.7. Model comparison

We started by considering a model where values of finger PPG-derived

features were directly used to estimate SBP, given by

Ì†µÌ±ÜÌ†µÌ∞µÌ†µÌ±ÉÌ†µÌ±ñ,Ì†µÌ±ó~{Ì†µÌ±ìÌ†µÌ±ñ1,Ì†µÌ±ó, Ì†µÌ±ìÌ†µÌ±ñ2,Ì†µÌ±ó, ‚Ä¶ , Ì†µÌ±ìÌ†µÌ±ñ1,Ì†µÌ±ó8 },

(2.1)

Ì†µÌ±ñ = 1,2, ‚Ä¶ , Ì†µÌ±ÅÌ†µÌ±ù, Ì†µÌ±ó = 1,2, ‚Ä¶ , Ì†µÌ±ÅÌ†µÌ±ö where Ì†µÌ±ÜÌ†µÌ∞µÌ†µÌ±ÉÌ†µÌ±ñ,Ì†µÌ±ó, Ì†µÌ±ìÌ†µÌ±ñ1,Ì†µÌ±ó are the values of SBP and the feature for the i-th subject at the j-th measurement, respectively. Ì†µÌ±ÜÌ†µÌ∞µÌ†µÌ±ÉÌ†µÌ±ñ,Ì†µÌ±ó is a function of all features {Ì†µÌ±ìÌ†µÌ±ñ1,Ì†µÌ±ó, Ì†µÌ±ìÌ†µÌ±ñ2,Ì†µÌ±ó, ‚Ä¶ , Ì†µÌ±ìÌ†µÌ±ñ1,Ì†µÌ±ó8 }.

Then another model applying an initialization at rest was built on the

same data, given by ‚àÜÌ†µÌ±ÜÌ†µÌ∞µÌ†µÌ±ÉÌ†µÌ±ñ,Ì†µÌ±ó~{‚àÜÌ†µÌ±ìÌ†µÌ±ñ1,Ì†µÌ±ó, ‚àÜÌ†µÌ±ìÌ†µÌ±ñ2,Ì†µÌ±ó, ‚Ä¶ , ‚àÜÌ†µÌ±ìÌ†µÌ±ñ1,Ì†µÌ±ó8 }

(2.2)

‚àÜÌ†µÌ±ÜÌ†µÌ∞µÌ†µÌ±ÉÌ†µÌ±ñ,Ì†µÌ±ó = Ì†µÌ±ÜÌ†µÌ∞µÌ†µÌ±ÉÌ†µÌ±ñ,Ì†µÌ±ó ‚àí Ì†µÌ±ÜÌ†µÌ∞µÌ†µÌ±ÉÌ†µÌ±ñ,Ì†µÌ±èÌ†µÌ±éÌ†µÌ±†Ì†µÌ±íÌ†µÌ±ôÌ†µÌ±ñÌ†µÌ±õÌ†µÌ±í, Ì†µÌ±ñ = 1,2, ‚Ä¶ , Ì†µÌ±ÅÌ†µÌ±ù, Ì†µÌ±ó = 1,2, ‚Ä¶ , Ì†µÌ±ÅÌ†µÌ±ö

(2.3)

‚àÜÌ†µÌ±ìÌ†µÌ±ñÌ†µ,Ì†µÌ±òÌ±ó = Ì†µÌ±ìÌ†µÌ±ñÌ†µ,Ì†µÌ±òÌ±ó ‚àí Ì†µÌ±ìÌ†µÌ±ñÌ†µ,Ì†µÌ±òÌ±èÌ†µÌ±éÌ†µÌ±†Ì†µÌ±íÌ†µÌ±ôÌ†µÌ±ñÌ†µÌ±õÌ†µÌ±í, Ì†µÌ±ò = 1,2, ‚Ä¶ , Ì†µÌ±ÅÌ†µÌ±ì

(2.4)

34

2.3. Results and Discussion
where Ì†µÌ±ÜÌ†µÌ∞µÌ†µÌ±ÉÌ†µÌ±ñ,Ì†µÌ±èÌ†µÌ±éÌ†µÌ±†Ì†µÌ±íÌ†µÌ±ôÌ†µÌ±ñÌ†µÌ±õÌ†µÌ±í and Ì†µÌ±ìÌ†µÌ±ñÌ†µ,Ì†µÌ±òÌ±èÌ†µÌ±éÌ†µÌ±†Ì†µÌ±íÌ†µÌ±ôÌ†µÌ±ñÌ†µÌ±õÌ†µÌ±íare the SBP value and the k-th feature value for the i-th subject at the baseline (rest), ‚àÜÌ†µÌ±ÜÌ†µÌ∞µÌ†µÌ±ÉÌ†µÌ±ñ,Ì†µÌ±ó and ‚àÜÌ†µÌ±ìÌ†µÌ±ñÌ†µ,Ì†µÌ±òÌ±ó are the relative change compared to baseline for SBP and k-th feature, respectively.
The initialization was done by collecting SBP and PPG signals during rest periods and average them to obtain the baseline values, respectively. During exercise periods, the values of SBP and PPG features were subtracted by their baseline values to obtain relative changes. In other words, the model estimated the changes in SBP based on the changes in all features. These two models (with and without initialization) were compared on their estimation performance. Next, the winner of the two models, the initialized model (see results), was provided with an additional feature, NPAT. The model without NPAT and with NPAT were subsequently compared with their performance to decide whether to add NPAT in the feature pool. Subsequently, comparisons were made between models using different the regression methods: MLR, LR, RF, and SVR. Then, the optimal model based on these improvement steps, were employed on forehead PPG as well and compared with finger PPG based model. Finally, we investigated the effects of posture change when estimating SBP from PPG signals.
2.3. Results and Discussion
2.3.1. Physical exercise experiment
The results of estimating SBP using the data from finger PPG without initialization are presented first. All features extracted from finger-derived PPG signals (except for NPAT) were used in the regression model. The median correlation coefficient was 0.83 and the median RMSE was 15.27 mmHg (see table 2.2). The estimation performance was improved when initializing the model, leading to a median correlation coefficient of 0.85 and a median RMSE of 8.99 mmHg (see table 2.2). After performing the significance test, the p-values for the median correlation coefficients and RMSE between initialized and uninitialized method were 0.362 and 0.002, respectively (see figure 2.4). This indicated that better practice of predicting the changes in SBP is using changes in the PPG-derived features, rather than using their values directly. This may be caused by different peripheral
35

Chapter 2, Blood pressure estimation using ECG and PPG during physical exercise
conditions such as skin perfusion, and pigmentation that confound the absolute baseline values of PPG readings regardless of SBP [160].
By incorporating NPAT in the feature pool, the median correlation coefficient was improved to 0.86 (see table 2.2). The Bland-Altman plot and scatter plot can be found in figure 2.5 and the normalized weight of each feature can be found in figure 2.6. After performing the significance test, the p-values for the median correlation coefficients and RMSE between the models with and without NPAT were 0.067 and 0.778, respectively (see figure 2.4). It turned out that the presence of NPAT contributed to the improvement of median correlation coefficients, but it did not help to reduce the RMSE. Several reasons may account for this observation. One might be a lack of consistency of the inter-subject weights for NPAT, which indicates varying vascular properties amongst the subjects. This study intended to compensate this difference by adding features that indicate arterial stiffness such as b/a, and SI in the models, which seemed to be not sufficient. Future studies may consider normalizing the pulse arrival time by existing or novel arterial stiffness indexes. In addition, a pre-ejection period (PEP), which is included in the PAT, may confound the relationship between PAT and blood pressure [75]. However, one has to include an additional measurement, such as impedance cardiograph to measure PEP, which is beyond the focus of this study.
Figure 2.7 compares the estimation results using different regression models. No significant difference was found between MLR and the others in the median correlation coefficients and RMSE. It should be kept in mind that the dataset used in this study was relatively small, which made the models more vulnerable to overfitting. Thus, a larger data set with more subjects should be used in future work to validate these results.
To explore site-dependency of the method, we compared the performance of the model using finger- and forehead-derived PPG signals (see table 2.2). The results (a median correlation coefficient of 0.83 and a median RMSE of 12.30) were slightly poorer than that when using finger PPG data, although the differences were found not to be significant (p>0.05), as can be seen in figure 2.4. This means that the model performed similarly when using fingeror forehead-derived PPG signals. This is a counter-intuitive observation in that PPG signals from cephalic regions (e.g. forehead) are believed to respond
36

2.3. Results and Discussion

more closely to SBP than peripheral regions (e.g. finger), which are richly innervated by the sympathetic nervous system. Several factors may account for this observation. One could be that, the reflectance-mode forehead PPG may contain more venous oscillations compared to transmission-mode finger PPG, which confounds arterial blood pressure estimation [160]. Another could be that, during the physical exercise, limbs are better perfused, which makes them more responsive to blood pressure changes. In addition, blood pressure in this study was measured closer to finger, which might offer finger site a slight advantage. Finally, the reflected wave arrives earlier in forehead than in finger, which sometimes merges with systolic phase causing difficulty in extracting features.

Table 2.2: Model performance for finger-derived PPG signals during the physical

exercise.

Experi- Site Inita NPAT

Performance

ment

Bias STD Corr.b R2 RMSE

[mmHg] [mmHg]

[-]

[-] [mmHg]

Physical Finger N

N

0.84 18.61 0.83 0.14 15.27

exercise

Physical Finger Y

N

0.31 14.07 0.85 0.65 8.99

exercise

Physical Finger Y

Y

0.43 13.52 0.86 0.62 10.44

exercise

Physical Forehead Y

Y

0.44 14.00 0.83 0.46 12.30

exercise

Posture Finger Y

Y

0.01 7.36 0.47 -0.40 7.33

change

Posture Forehead Y change

Y

-0.89 8.30 0.09 -0.84 6.95

aInit. : the initialization process for the model bCorr.: median correlation coefficients

37

Chapter 2, Blood pressure estimation using ECG and PPG during physical exercise
Figure 2.4: Comparisions of model performance with different settings (a) Comparison of correlation coefficients (b) Comparsion of RMSE. The p-value from the signed-rank test is presented on the solid line. Finger ‚Äìinit ‚ÄìNPAT: without initialzation and without NPAT at finger. Finger +init ‚ÄìNPAT: with initialzation and without NPAT at finger. Finger +init +NPAT: with initialization and without NPAT at finger. Forehead ‚Äìinit ‚ÄìNPAT: without initialzation and with NPAT at foreheads. Horizontal lines: median values. Edges of boxes: the 25th and 75th percentiles. Whiskers: maxima or minima of values.
2.3.2. Posture change experiment
It can be seen in table 2.2 that the SBP estimation during posture changes was poor (a median correlation coefficient of 0.47 for finger PPG and 0.09 for forehead PPG). Surprisingly, the median RMSE, on the contrary, were better compared to those obtained during physical exercise. But the negative median R2 values, on the other hand, indicated that they were even worse than the estimation by mean SBP. In fact, the low median RMSE resulted from the much smaller SBP variations in each subject introduced by posture change. The NPAT played a less important role compared to in the exercise dataset, especially in forehead PPG. Interestingly, significantly higher correlation coefficients were found when using finger-derived PPG signals than when using forehead-derived PPG signals (p=0). In contrast, RMSE did not show much difference (p=0.171). The poor performance in posture change also reflects the different mechanism of blood pressure change compared to physical exercise. The different weights of features and the poor estimation 38

2.3. Results and Discussion
Figure 2.5: Performance of models built on PPG-derived features in combination with NPAT (a) Bland-Altman plot for estimated and measured SBP using the pooled data from all 19 subjects. The solid line corresponds to bias, and the dotted lines correpond to the limits of agreement (b) Scatter plot for estimated and measured SBP using the pooled data from all 19 subjects. The solid line correponds to the best linear fit, and the dotted line is the line of equality.
performance suggests that separate models are needed to account for different postures during physical exercise.
2.3.3. Feature contributions
The contributions of the features were evaluated by means of normalized weights for both the physical exercise and the posture change experiments. The normalized weights of five top-ranked features in different settings (i.e. different sites with and without posture changes) are shown in table 2.3. Despite the fact that the feature lists changed with different model settings, dpmean, spvar, RI, PAR, and NPAT seemed to outweigh the other features. The contributions of our proposed features (dpmean and spvar) indicated that these features contained rich information about blood pressure. It should be noted that our proposed features are related to existing features, systolic time and diastolic time, which were defined as the time span in the systolic and diastolic phase of each pulse [88], [161]. When the pulse amplitude is normalized, the mean slope of the upstroke (the reciprocal of the systolic time) can be obtained.
39

Chapter 2, Blood pressure estimation using ECG and PPG during physical exercise The same goes for the diastolic time. In contrast, our proposed features (dpmean, dpvar, spmean and spvar) allowed more descriptions of the morphology of the pulse. Furthermore, both spmean and dpmean had significantly better correlations with SBP than systolic time and diastolic time, respectively (p<0.01). It is noticeable that dpmean, extracted from diastolic phase, also contributed to SBP estimation. One reason could be that the features extracted from the diastolic phase describe how blood pressure falls, which gives information on the preload. The preload of the preceding pulse determines blood pressure in the next pulse. This finding is in accordance with the work by Teng [88], where diastolic time was found to outperform systolic time when estimating SBP. Interestingly, RI and PAR are related the dicrotic notch, which may indicate that the region close to the notch contains rich information related to SBP.
Figure 2.6: Box plots of the normalized weights for each feature from the trained models after all iterations. The model was built on PPG-derived features in combination with NPAT. Horizontal lines: median values. Edges of boxes: the 25th and 75th percentiles. Whiskers: maxima or minima of values.
40

2.3. Results and Discussion
Figure 2.7: Comparisions between model performance with different regression models (a) Comparison of correlation coefficients (b) Comparsion of RMSE. The p-value from signedrank test is presented on the solid line. Horizontal lines: median values. Edges of boxes: the 25th and 75th percentiles. Whiskers: maxia of minia of values.
2.3.4. Study limitations
There are some limitations in this study. To begin with, the reference measurement of SBP, by means of finger cuffs, may be less accurate than measurements by brachial cuffs and invasive arterial lines. However, measurement using brachial cuffs are not able to provide instant and continuous measurements and invasive arterial lines are ethically not acceptable for an experiment with healthy subjects. We therefore took the measurements from finger cuffs as the reference. Second, the signals in this study were acquired in well-controlled experiments: by instructing subjects to hold their hands on a handle bar and by removing posture transition phases. By doing so, motion artefacts were substantially suppressed. In reality, motion artefacts could be more disturbing and suppressing them is of importance. Thirdly, even with these controlled experiments, we are not able to control other factors such as contact pressure of the PPG sensor, which may confound PPG signals [160]. Fourthly, the sample size in this chapter is relatively small, making the model vulnerable to overfitting. This might explain the finding that
41

Chapter 2, Blood pressure estimation using ECG and PPG during physical exercise

Table 2.3: Feature normalized weights for the top five features in the SBP estimation

model

Experi- Site

Init.a NPAT

Features [dimensionless]

ment

1st 2nd 3rd 4th 5th

Physical Finger

N

exercise

N

spvar spmean

RI

dpmean

0.22 0.12 0.11 0.10

Physical Finger

Y

exercise

N

dpmean spvar

d/a PAR

0.21 0.20 0.10 0.08

Physical Finger

Y

exercise

Y

NPAT dpmean d/a

PAR

0.17 0.17 0.10 0.10

Physical Forehead Y exercise

Y

RI

PW NPAT SI

0.15 0.13 0.13 0.10

Posture Finger

Y

change

Y

NPAT RI

spvar spmean

0.19 0.15 0.14 0.11

Posture Forehead Y change

Y

NHA spvar

RI PAR

0.17 0.13 0.12 0.10

aInit. : the initialization process for the model

PAR 0.09
c/a 0.06
spvar 0.08
NHA 0.09
b/a 0.10
b/a 0.09

advanced regression models discussed in this work did not exhibit advantages over MLR. In addition, we did not select features in this work but we quantified their contributions by means of their normalized weights. Future work may investigate whether feature selection will improve mode performance. Lastly, the best standard deviation we obtained in the physical exercise is 13.52 mmHg, larger than the acceptable threshold of 8 mmHg according to Association for the Advancement of Medical Instrumentation (AAMI) [162]. However, one should note that the established protocol by AMMI is mostly applied for individual measurement at rest, rather than tracking blood pressure changes over time. In this small study, we were able to generate a model that only required an initialization at rest, highlighted the contributions of the features and gave promising results.
2.4. Conclusions
The present study provides an indication of the potential usefulness of an SBP estimation model using PPG and ECG signals for young healthy subjects with a sole requirement of initialization at rest. Particularly, it has been shown 42

2.4. Conclusions that the estimated SBP had high correlations with the measured SBP, while the RMSE still warrants further attention. The initialization reduces the RMSE. The use of PAT can further reduce the SD of difference at the cost of an additional ECG sensor. The model displayed slightly better tracking capability when using finger-derived PPG signals compared to when using foreheadderived PPG signals. Subjects should be instructed not to change their postures when applying models in physical exercises and separate models seem necessary for different postures in physical exercise.
Overall, the features we proposed such as dpmean and spvar played important roles as indicated by the larger normalized weights, and further work can be done on developing features from this normalized derivative domain and employing more advanced models in the context of larger population.
43

Chapter 2, Blood pressure estimation using ECG and PPG during physical exercise 44

CHAPTER 3 Continuous blood pressure estimation using ECG and PPG with intermittent recalibrations
in the operating theatre
This chapter is based on: Sun, S., Bresch, E., Muehlsteff, J., Schmitt, L., Long, X., Bezemer, R., Aarts, R.M. ‚ÄúContinuous ECG and PPG-derived estimation of systolic blood pressure with intermittent calibration,‚Äù Submitted to Physiological Measurement.
45

Chapter 3. Continuous blood pressure estimation using ECG and PPG with intermittent recalibrations in the operating theatre Abstract In a significant portion of surgeries, blood pressure (BP) is often measured non-invasively in an intermittent manner. This practice has a risk of missing clinically-relevant BP changes between two adjacent intermittent BP measurements. This study proposes a method to continuously estimate systolic blood pressure (SBP) based on previous intermittent SBP measurements and electrocardiography (ECG) - and photoplethysmography (PPG) - derived features. Continuous ABP, ECG, and PPG signals were acquired from 23 patients undergoing major surgery. After extracting nine features from PPG and ECG signals, we dynamically selected features upon each intermittent measurement (every 10 minutes) of SBP based on feature robustness and the principle of correlation feature selection. Finally, a multiple linear regression model was built to combine these features in order to estimate SBP every 30 seconds. Compared to reference SBP, the proposed method achieved a mean of difference at 0.07 mmHg, a standard deviation of difference at 7.92 mmHg, and a correlation coefficient at 0.89. This study presents the feasibility of continuously estimating SBP with clinically-acceptable accuracy during surgery with the aid of non-invasive intermittent BP measurements.
46

3.1. Introduction
3.1. Introduction
Hemodynamic monitoring is of great importance for patients in the operating theatre. The monitoring of blood pressure (BP) is routinely implemented by either cuff-based intermittent measurement or invasive continuous measurement with a catheter. In a significant portion of operations, BP is intermittently measured with a brachial cuff. Despite the advantage of convenience and non-invasiveness, these intermittent measurements have the risk of missing clinically-relevant BP changes [23]. Thus, this method is not preferred in major surgery with the risk of rapid changes in hemodynamics.
However, catheterization has been associated with the risk of adverse effects including distal ischemia, bleeding, thrombosis, and infection, which canresult in increased morbidity and costs [30]‚Äì[32]. These drawbacks of existing BP monitoring methods has prompted researchers to pursue noninvasive continuous solutions of ABP monitoring. Besides technologies such as the vascular unloading method or tonometry that both require specialized and additional equipment [13], [163], photoplethysmography (PPG) has emerged as a candidate technology for this pursuit as well. By using PPGderived features, systolic blood pressure (SBP) and/or diastolic blood pressure (DBP) can be estimated via regression models [73], [74], [85], [86], [164]‚Äì [166].
The most widely-studied feature for SBP estimation is pulse arrival time (PAT) [73], [74], [78], [167], [168]. It is defined as the time delay between an R peak in the electrocardiography (ECG) signal and a fiducial point in the PPG signal. PAT is often inversely related to the pulse wave velocity ‚Äì the velocity a pulse propagates along vessels. Increased BP induces decreased elasticity of arteries, leading to an increased pulse wave velocity and therefore decreased PAT. In addition to PAT, other PPG-derived features have also been investigated, including those extracted from morphology, the first derivative, second derivative, and spectrum [73], [86], [153]. Although the associated physiological basis is not fully understood, several features have shown significant correlations with blood pressure [73], [88], [142], [143].
Despite these extensive studies of PPG-derived methods, these methods still warrant improvements in the clinical context [83], [138]. It is therefore an interesting and relevant attempt to investigate how to utilize previous
47

Chapter 3. Continuous blood pressure estimation using ECG and PPG with intermittent recalibrations in the operating theatre
intermittent measurements to strengthen the estimation model, as models inferring blood pressure often show improved performance in the presence of calibration and recalibration [67], [73], [139]. In view of the clinical relevance of SBP, in this work, we propose an SBP estimation method using ECG- and PPG-derived features and the information from previous intermittent measurements. In this model, dynamic feature selection was employed based on feature robustness and the principle of correlation feature selection (CFS).

3.2. Materials and methods
3.2.1. Patients
The study was reviewed and approved by the regional medical ethics committee (METC Brabant, The Netherlands, NL48421.028.14-P1409). With written informed consent, a heterogeneous group of 29 patients scheduled for major surgery was enrolled. Characteristics of patients are shown in table 3.1.

3.2.2. Protocol
Anesthesia was induced by propofol (2mg/kg), sufentanil (0.5mcg/kg), and rocuronium (0.6mg/kg), and maintained by means of continuous infusion

Table 3.1: Patient characteristics (n=29).

Age [yr] Gender (male/female)
BMI [kg/m2] Height [cm] Length of operation [hours]
Surgical procedures Urology: Bricker deviation Radical prostatectomy Cystectomy Pyeloplasty Vascular surgery: FEM-Fem bypass or crossover EVAR removal and replacement PTA Femoral Artery Recanalization Iliac artery Carotid Endarterectomy

70.0 ¬± 8.9 23/6
27.8 ¬± 9.7 172.3 ¬± 13.7
4.4 ¬± 1.4
14 3 1 1
4 3 1 1 1

48

3.2. Materials and methods
of propofol and sufentanil. The depth of anesthesia was assessed using bispectral index (BSI) with a target range of 40-55. The patients were ventilated in a volume-controlled, pressure-limited mode with tidal volume of 6-10 ml/kg at a frequency of 10-14/minute, and adjusted to maintain normocapnea. The positive end-expiratory pressure was set at 6 cm H2O and adjusted as needed. Fluid management was at the discretion of the physician. During surgery, three signals were collected: invasive ABP signals (Philips Heartstart MRx monitor) by a radial arterial catheter, the finger PPG signal obtained at the right index finger (Philips M1191B), and the ECG signal (Philips Heartstart MRx monitor).
3.2.3. Feature extraction
We extracted nine features that have previously been proven to have significant relationship with BP [73], [142], [153], [165], [168]. These features include PAT, the mean and variance of the first derivative in the systolic phase, PPG amplitude, stiffness index, and several features defined in the second derivative. They were categorized into four groups for the purpose of feature selection, as can be seen in table 3.2 and shown in figure 3.1. The criteria was based on a combination of physiological interpretation of these features and the robustness when extracting them. The first group refers to the time delay from combinations of ECG- and PPG-derived features. Here it comprises only PAT, which has been extensively studied and of which its physiological association with SBP has been established [168]. It is, by far, one of the most relevant features for SBP estimation. The second group consists of features based on detected fiducial points in the first derivative and comprises PPG amplitude and the mean and variance of the first derivative in the systolic phase. The latter two features were determined after the pulse was normalized. They were found to contribute significantly to SBP estimation [73]. The third group includes the pulse delay (PD), which found to be related to arterial stiffness by Millasseau et al. [142]. PD was defined as the time delay between the first and second peak in a PPG pulse. In order to detect a second peak, it is necessary to detect the zero-crossing point in the first derivative. However, the patients in this study were elderly and the dicrotic notch, which results in the second peak, was often missing. In this case, a surrogate was often included from the zero-crossing point in the second derivative [74]. Thus, PD was in
49

Chapter 3. Continuous blood pressure estimation using ECG and PPG with intermittent recalibrations in the operating theatre

Table 3.2: Extracted feature and their affiliated group.

1st group

2nd group

3rd group

4th group

PAT

PPG amplitude

Pulse delay

c/a

e/a

spmean

norm a

spvar

norm b

Figure 3.1: Illustration of all features used in this study. The first panel (from top to bottom): ECG signal. The second panel: PPG signal. The third panel: the first derivative of the PPG signal. The fourth panel: the second derivative of the PPG signal. PAT: pulse arrival time. PD: pulse delay. AMP: PPG amplitude. SP: systolic phase. DP: diastolic phase. P1: The local maximum in the first derivative. P2: the local minimum in the first derivative.
this category. The fourth group was created to cluster features that are based on the detected fiducial points in the third derivative. These features include c/a, e/a, norm a, and norm b [153], [165]. The ratios c/a and e/a were defined as ratio between the amplitude of wave c and wave a, and the ratio between the amplitude of wave e and wave a, respectively. Norm a and norm b were defined as the amplitude of wave a and b after the pulse was normalized, respectively.
50

3.2. Materials and methods
3.2.4. Data Analysis
Signal analysis was confined to the period of mechanical ventilation. For ABP and PPG signals, signal segments with low signal quality or with severe cardiac arrhythmia were excluded by manual selection and a dedicated software program. This program, after identifying peaks and valleys for each pulse, computed three parameters. These were the distance between neighboring peaks, the distance between neighboring valleys and the amplitude of each pulse. For each parameter, if the difference between the present value and the extrema (maximum or minimum) in the past window of 30 seconds prior to that pulse was larger than the discrepancy between these maximum and minimum values, this pulse was excluded. For ECG signals, large signal segments with consistent invalid detected R peaks were removed manually. Note that an eligible segment requires three signals be of acceptable signal quality simultaneously. As a result, data from six patients were removed entirely. From the remaining 23 patients, 91.2 hours of data was found eligible for further analysis of PPV (9.8% data of the 23 patients was excluded due to poor signal quality or cardiac arrhythmia). Note that invalid pulses can also be excluded when deriving the feature values in the epoch of estimation, as explained in the next paragraph.
In this study, the epoch for SBP estimation was 30 seconds. All the extracted features and measured SBP were averaged using the values within the interquartile range (25% to 75%) in the epoch. The intermittent measurement of every 10 minute was simulated by the 30-second averaged SBP using this method at the time of the intermittent measurement. As our focus is to validate the algorithm and therefore we chose the stimulation of SBP in order not to induce additional errors when comparing cuff-based and catheter-based measurements. We chose the interval between intermittent measurements to be 10 minutes, as this is one option of the clinical practice.
The performance of the algorithm was evaluated by calculating agreement (Bland-Altman analysis), root mean square error (RMSE) and Pearson‚Äôs correlation coefficients in comparison with the reference SBP, derived from invasive ABP.
51

Chapter 3. Continuous blood pressure estimation using ECG and PPG with intermittent recalibrations in the operating theatre
3.2.5. Feature selection and regression model
In this work, we propose method that includes a dynamic feature selection and regression model. We selected features at the time of each intermittent measurement (in this case every 10 minutes). With the selected features, we applied a regression model to combine the information of these features. This model was used to predict the SBP before the next intermittent measurement (i.e. provide SBP estimation every 30 seconds for the next 10 minutes). Upon the next intermittent measurement, both the features and regression model were updated.
The feature selection method for the first feature is given in figure 3.2. The procedure was implemented as follows. The most recent nine intermittent measurements (around 1.5 hours) and corresponding feature values were stored. Firstly, the absolute value of correlation coefficient (ACC) between PAT and SBP was computed based on these nine pairs of data. If the ACC was higher than 0.7, then PAT was chosen as the first feature. Otherwise, the correlation between SBP and the second group (features involving the detection of the fiducial point in the first derivative) was assessed. If the maximum ACC between these features and SBP was higher than 0.7, we then performed a refined feature selection for the features with ACC higher than 0.7 (see figure 3.3). This refined feature selection was implemented by calculating the mean correlation coefficients after bootstrapping (1000 experiments with 10 samples per experiment) for each feature. The feature with highest mean ACC was selected. This was to prevent the spurious high correlation caused by several outliers, which did not indicate its predictive power for SBP estimation. In case that no features were found to have an ACC higher than 0.7 in the first and second group, the third and fourth groups were considered. The feature selection procedure for the third and fourth group was exactly the same as the second category. When no feature had an ACC higher than 0.7 in any of the category, we used the most recent SBP measurement as the estimation of SBP for the next 10 minutes. Note that we heuristically chose 0.7 because it is often associated with the boundary between strong and moderate correlation in practice.
After selecting the first feature, other features were included in the best feature subset (the features used to build the regression model) if they can provide complementary information to the first selected feature. This was
52

3.2. Materials and methods

realized by using correlation feature selection algorithm [169]. The procedure is illustrated in figure 3.4. The merit indicating the strength of predicative power for a certain feature subset is given by

Ì†µÌ±ÄÌ†µÌ±íÌ†µÌ±üÌ†µÌ±ñÌ†µÌ±° =

Ì†µÌ±üÌ†µÌ±†Ì†µÌ±ì1+ ‚ãØ + Ì†µÌ±üÌ†µÌ±†Ì†µÌ±ìÌ†µÌ±ò

‚àöÌ†µÌ±ò+2‚àó(Ì†µÌ±üÌ†µÌ±ì1Ì†µÌ±ì2+ ‚ãØ +Ì†µÌ±üÌ†µÌ±ìÌ†µÌ±ñÌ†µÌ±ìÌ†µÌ±ó+ ‚ãØ + Ì†µÌ±üÌ†µÌ±ìÌ†µÌ±òÌ†µÌ±ì1)

(3.1)

where Ì†µÌ±üÌ†µÌ±†Ì†µÌ±ìÌ†µÌ±ñdenotes ACC between i-th features and SBP, Ì†µÌ±üÌ†µÌ±ìÌ†µÌ±ñÌ†µÌ±ìÌ†µÌ±ódenotes ACC between i-th and j-th features, and k is the number of features.
The new merits were calculated for the features already in the best feature subset combined with each newly-added feature and the highest merit among all calculated merits was identified. This highest merit was then compared with the stored best merit (the merit for the current best subset). If the current merit was larger than the stored one, the current feature was added to the best feature subset and the stored merit was overwritten by the new highest merit. Because we only used nine points to build the regression model, in order to avoid overfitting, we heuristically set the maximum number of features to be three.
After determining the best subset, a linear regression model was built by using SBP and features from the most recent nine intermittent measurements. The regression coefficients for each feature was determined collectively in this linear fitting. After acquiring the coefficients for each feature, the offset was determined when fitting the most recent intermittent measurement. This aimed to ensure that the model fitted perfectly with the most recent measurement.

3.2.6. Comparison with two methods
To further evaluate the performance of the proposed method, we compared it with two methods. These two methods also provided SBP estimation every 30 seconds. In the first method, SBP was continuously estimated using the most recent intermittent SBP measurement until a new SBP intermittent measurement was acquired. This is essentially the zero-order hold of the most recent measurement, which is in line with what current clinical practice implies. Thus, the first method was termed zero-order hold. In the second method, the model was built using the most recent nine intermittent measurements. Particularly, the regression coefficient for PAT was estimated by these nine intermittent measurements, while the offset was determined using the most recent measurement. The second method was
53

Chapter 3. Continuous blood pressure estimation using ECG and PPG with intermittent recalibrations in the operating theatre
therefore termed PAT-only. This method was equivalent to the first step in the proposed method. This method was used to assess the effect of features derived exclusively from PPG.
3.2.7. Statistical Analysis
To statistically quantify the comparison between our proposed method and the two methods, we applied Friedman‚Äôs one-way test on the RMSE and correlation coefficients. The Friedman‚Äôs test was followed by pairwise comparisons, which were implemented using the sign test. The p values were corrected according to the Bonferroni method using the number of comparisons (in this case 3). A p < 0.05 was regarded statistically significant.
3.3. Results
The SBP estimation performance for all the considered methods (zeroorder hold, PAT-only, and the proposed method) can be found in table 3.3. All the results in table 3.3 are based on pooled data from all patients. It can be seen that the proposed method outperformed zero-order hold and PAT-only methods in the SD of the difference in the Bland-Altman analysis. The proposed method also showed higher correlation coefficients with reference SBP when compared to other two methods. Figure 3.5 shows an example on the performance comparison of the considered methods. It is shown that the proposed method approached better the value and trend of measured SBP compared to the other two methods. Figure 3.6 gives the boxplot of the estimation performance of these three methods for each patient. It is demonstrated that the proposed method performed significantly better compared to these two methods in both RMSE and correlation coefficients. After the correction by Bonferroni method in which the p values were increased by 3 times, all the p values were still smaller than 0.05, indicating that the statistically significant differences still held. Particularly, the median difference in the RMSE was 1.11 mmHg between the PAT-only and the proposed method and 4.32 mmHg between the zero-order hold and the proposed method. The median difference was 0.05 in the correlation coefficients between the proposed method and PAT-only method and 0.21 between the proposed method and the zero-order hold.
54

3.3. Results

All the features values and SBP for the previous 9 intermittent measurements

Calculate the correlation coefficient r between PAT and SBP
abs(r) > 0.7
N
Calculate the correlation coefficient r for features in the 2nd group (see table 3.2)

Max abs(r) > 0.7

N

N

Calculate the correlation coefficient r for features in the 3rd group (see table 3.2)

Max abs(r) > 0.7
N
Calculate the correlation coefficient r for features in the 4th group (see table 3.2)

Y

Put PAT in the best

subset

Put features with

Y abs(r) > 0.7 in the

refined

feature

selection (see figure

3.3)

Put features with abs(r)
Y > 0.7 in the refined
feature selection (see figure 3.3)

Max abs(r) > 0.7
N
Take the most recent measurement as the estimation

Put features with

Y abs(r) > 0.7 in the

refined

feature

selection (see figure

3.3)

Figure 3.2: The flowchart for selecting the first feature.

55

Chapter 3. Continuous blood pressure estimation using ECG and PPG with intermittent recalibrations in the operating theatre
Features with abs (r) > 0.7

The number of feature > 1

N

Put the feature

in the best

subset

Y
Bootstrap and calculate the mean correlation coefficients for the considered features and put the feature with highest mean ACC in the best subset

Figure 3.3: The refined feature selection in figure 3.2.

The statistics of selected features for the proposed method is presented in table 3.4. It is shown that three features were selected in a majority of cases and PAT was often chosen as one of these three features. Next to best feature subsets comprising three features, best feature subset comprising one feature was chosen to build the regression model, where PAT was the most selected feature. In very few cases, two features were selected to build the regression model.
3.4. Discussion
In this study, we propose a novel method utilizing the previous intermittent SBP measurements and ECG- and PPG-derived features to build a regression model for continuous SBP estimation (every 30 seconds). Based on the physiological understanding of these features and robustness when extracting them, we selected the first feature (the most important feature). Next, we selected the features that provided complementary information based on correlation feature selection. The results show that the proposed method outperformed the existing zero-order hold method and PAT-only method.
56

3.4. Discussion

The selected first feature

Calculate and store the merit1

Add a second feature and determine the largest merit2

N
Merit2 > Merit 1
Y
Store merit2 and add a second feature and determine the largest merit3

Use the selected one feature to derive the model

Merit3 > Merit2

N

Use the selected two

features to derive the

model

Y
Use the selected 3 features to derive the model
Figure 3.4: The selection strategy for the second and third features.

57

Chapter 3. Continuous blood pressure estimation using ECG and PPG with intermittent recalibrations in the operating theatre

Table 3.3: The SBP estimation performance for zero-order hold, PAT-only, and the

proposed method.

Zero-order hold

PAT-only

Proposed

RMSE (mmHg)

12.97

10.06

7.92

Bland-Altman

0.07 ¬± 12.97

-0.27 ¬± 10.06

0.07 ¬± 7.92

analysis

(Bias ¬± SD) [mmHg]

Correlation

0.71

0.83

0.89

Coefficients

Figure 3.5 An example of SBP estimation for different methods in comparison to measured SBP.
In a significant portion of operations, invasive beat-to-beat blood pressure monitoring is not necessary and blood pressure is only intermittently measured using a brachial cuff. Although non-invasive and convenient, this may hinder clinicians from observing clinically-relevant changes in the blood pressure in the interval between intermittent blood pressure measurements. It is therefore important and valuable to also monitor the blood pressure between adjacent intermittent measurements. In this study, we achieved this goal by building an ECG- and PPG-based regression model that can provide SBP estimation every 30 seconds. Furthermore, we demonstrated that the proposed model yielded estimation that was in a good agreement and well correlated with the invasive reference SBP. The SD of difference was within the acceptable threshold of 8
58

3.4. Discussion
Figure 3.6 Boxplots of performance comparison between zero-order hold method, PAT-only method and, the proposed method. (a) Comparison on the RMSE. (b) Comparison on the correlation coefficients. The uncorrected p values from sign test are presented on the solid line.
mmHg according to the Association for the Advancement of Medical Instrumentation [162].
A few features have been applied to estimate SBP in the existing literature. The extraction of some of these features is more sensitive to noise when detecting fiducial points has to be done in higher derivatives. This is because the relevant signal is often attenuated in the higher derivative, while noise is often largely preserved. In this study, we designed a method where features
59

Chapter 3. Continuous blood pressure estimation using ECG and PPG with intermittent recalibrations in the operating theatre

Table 3.4: The statistics of selected features for the proposed method.

Occurrence frequency

Top 3 occurrence

One feature Two features Three features

19.1% 1.5% 79.3%

PAT PPG amplitude
spvar e/a, PAT spvar, PAT PPG amplitude, PAT spmean, norm b, PAT c/a, e/a, PAT spvar, c/a, PAT

were categorized based on the used derivatives when extracting these features. After selecting the best feature based on this consideration, additional features were chosen based on the idea that a relevant feature should correlate reasonably well with SBP while not inducing redundancy in the presence of existing features. The results show that PAT is most likely to be selected. This is in accordance with literature, as PAT is often shown to be correlated well with BP and has a physiological basis. In addition to PAT, other features such as spvar and e/a in the second derivative are often chosen, which is in line with the finding in our previous work [73].
Our study has several limitations. First, several parameters such as the number of measurements used to build the regression model were determined heuristically. With the acquisition of more data, these parameters can be further optimized and an improvement in the estimation performance can be expected. Second, in other clinical scenarios with non-sedated patients, a fixed measurement-interval of 10 minutes might be uncomfortable for some patients. In those scenarios, future research might be dedicated to devising smart triggering strategy where the BP measurement is only triggered when the estimation algorithm is likely to fail. By doing this, we can maximize the interval between each measurement.
In conclusion, this study presents a novel method that is capable of estimating SBP between the intermittent measurements of blood pressure. This method outperformed the zero-order hold and PAT-only methods.
60

Part II The monitoring of pulse pressure variations
61

62

CHAPTER 4
On algorithms for calculating arterial pulse pressure variation during major surgery
This chapter is based on: Sun, S., Peeters, W.H., Bezemer, R., Long X., Paulussen, I., Aarts, R.M., Noordergraaf, G.J. On algorithms for calculating arterial pulse pressure variation during major surgery. Physiological Measurement, vol. 38, pp. 2101‚Äì2121, 2017. Sun, S., Peeters, W.H., Bezemer, Long, X., R., Paulussen, I., Aarts, R.M., Noordergraaf, G.J. ‚ÄúThe effect of sample duration on the robustness of pulsepressure variation during ongoing surgery,‚Äù Joint conference of European Medical and Biological Engineering Conference (EMBEC) and the NordicBaltic Conference on Biomedical Engineering and Medical Physics (NBC), Tampere, Finland, June 11-15 2017. Sun, S., Peeters, W.H., Bezemer, R., Device, System and method for determining pulse pressure variation of a subject. Filed. PCT patent application. 2017.
63

Chapter 4. On algorithms for calculating arterial pulse pressure variation during major surgery Abstract Arterial pulse pressure variation (PPV) is widely used for predicting fluid responsiveness and supporting fluid management in the operating room and intensive care unit. Available PPV algorithms have been typically validated for fluid responsiveness during episodes of hemodynamic stability. Yet, little is known about the performance of PPV algorithms during surgery, where fast changes of the blood pressure may affect the robustness of the presented PPV value. This work provides a comprehensive understanding of how various existing algorithmic designs affect the robustness of the presented PPV value during surgery, and proposes additional processing for the pulse pressure signal before calculating PPV. We recorded arterial blood pressure waveforms from 23 patients undergoing major abdominal surgery. To evaluate the performance, we designed three clinically-relevant metrics. The results show that all algorithms performed well during episodes of hemodynamic stability. Moreover, it is demonstrated that the proposed processing helps improve the robustness of PPV during the entire course of surgery.
64

4.1. Introduction
4.1. Introduction
Optimal circulatory volume status of patients in the operating room (OR) and intensive care unit (ICU) is of key importance since hypovolemia can lead to inadequate organ perfusion, and hypervolemia can cause cardiac, renal, and pulmonary injury [94]. Hemodynamic optimization, with the goal of maintaining optimal circulatory conditions, has been shown to improve postoperative outcome and reduce the cost of surgery [105]‚Äì[107], [170].
Before subjecting a patient to fluid therapy, one should assess whether the heart would actually increase its output upon volume loading. This is called fluid responsiveness [122], [171], [172]. To assess fluid responsiveness, static and dynamic indicators have been proposed [26], [117], [173]‚Äì[176]. Static indicators, such as central venous pressure (CVP), pulmonary artery occlusion pressure, and left ventricular end-diastolic area, have been demonstrated to have poor performance [117], [122], [177], [178]. In contrast, dynamic indicators, relying on cardiopulmonary interactions, have been shown to be better predictors in patients undergoing mechanical ventilation [117], [122], [178], [179].
During mechanical ventilation, the cyclic changes in the intrathoracic pressure induce cyclic changes in the venous return and therefore the preload (end-diastolic blood volume) of the heart. These cyclic changes in the preload induce cyclic changes in the stroke volume, which will appear as cyclic changes in pulse pressure (PP) [122]. During positive pressure ventilation, pulse pressure increases during inspiration and decreases during expiration. The parameter pulse pressure variation (PPV) is designed to quantify such cardiopulmonary interactions [26]. It is defined as the ventilation-induced variation in pulse pressure normalized by the mean pulse pressure [26]. PPV has been shown to be useful for making therapeutic choices in mechanicallyventilated patients with acute circulatory failure related to sepsis [26] as well as in patients who have undergone coronary artery bypass grafting [124]. In general, the use of PPV in clinical decision making has been proven to decrease the length of hospitalization [125].
Originally, Michard et al. [26] specified the PPV as the mean of three consecutive raw PPV values, each of which is derived from a single breath. The formula is given by
65

Chapter 4. On algorithms for calculating arterial pulse pressure variation during major surgery

PPV (%)

=

100%

√ó

PPmax-PPmin (PPmax+PPmin)/2

(4.1)

where PPmax and PPmin are the maximum and minimum pulse pressures

sampled from a sample window with a duration of a single respiratory cycle.

Before calculating PPV, the interpolated pulse pressure (IPP) signal is

obtained by using different methods. The original specification is equivalent

to linear interpolation of the pulse pressure, whereas Aboy et al. [126], [127]

applied kernel smoothing to derive the IPP. When calculating PPV, various

sample durations were adopted: one ventilation cycle [26], three or five

ventilation cycles [180], two ventilation cycles [127], eight seconds [129], ten

seconds [130]. Extended sample durations reduce detrimental effects

originating from the asynchrony of the cardiac and respiratory cycle [180],

and eliminate the need for accurate estimation of the ventilation frequency.

Different ways to smooth raw PPV values in order to filter out fast PPV

fluctuations were also investigated: three-point mean filter [26], three-point

median filter [126], and Kalman filter [127]. Although not clearly published,

commercial patient monitors seem to employ 8-12-second sample durations

and to subsequently use a three- or four-point mean filter, thereby evaluating

in total about 30 seconds of the ABP waveform for each presented PPV value

[128], [129].

The validity of PPV is well established, although the reliability of PPV

has only been verified under relatively stable hemodynamic conditions [26],

[122], [132], [181]. Little is known about the difference in the performance of

algorithmic designs in the face of dynamically changing blood pressures,

which may occur during surgery.

In this work, we evaluated five key algorithms existing in literature, for

patients during ongoing surgery and present a comprehensive understanding

of how different algorithmic designs affect the performance robustness. We

designed three PPV performance metrics: the hourly occurrence of unstable

PPV calculation episodes, the hourly occurrence of short-term elevations, and

discrepancy compared to the original specification [26] during periods of

hemodynamic stability. Inspired by existing algorithms and our observations,

we propose additional IPP post-processing before computing PPV to improve

the robustness of PPV during surgery.

66

4.2. Materials & Methods
The chapter is organized as follows: Section 4.2 describes the acquired data, the general framework for the analysis of the algorithms, and comparison criteria for performance of algorithms during surgery; Section 4.3 describes five existing algorithms in the framework described in Section 4.2; Section 4.4 presents our algorithm in the same framework; Section 4.5 compares the performance of existing algorithms and our proposed algorithm; Section 4.6 discusses our findings; Section 4.7 concludes the chapter.
4.2. Materials & Methods
4.2.1. Protocol and data acquisition
The study protocol was reviewed and approved by the regional medical ethics committee (METC Brabant, The Netherlands, NL48421.028.14-P1409). Written informed consents were obtained from 29 patients scheduled for major abdominal surgery consisting mainly of open, radical, prostatectomy cases. Anesthesia was induced by propofol (2mg/kg), sufentanil (0.5mcg/kg), and rocuronium (0.6mg/kg), and later maintained by means of continuous infusion of sufentanil and propofol. The depth of anesthesia was assessed using bispectral index (BIS) with a target of 40-55. The patients were ventilated in a volume-controlled mode with tidal volume of 6-10 ml/kg at a frequency of 10-14 times/minute, and adjusted to maintain normocapnea. The positive endexpiratory pressure was set at 6 cm H2O and adjusted as needed. Fluid management was at the discretion of the physician. During surgery, continuous electrocardiogram (ECG) and invasive arterial blood pressure (ABP) signals (Philips Heartstart MRx monitor) were collected.
The analysis of ABP and PPV was confined to the period of mechanical ventilation. Signal segments with low signal quality or with severe cardiac arrhythmia were excluded by manual selection and a dedicated program. To determine the quality of each pulse, this program calculated distances between neighboring detected peaks, distances between neighboring detected valleys, and the amplitude of each detected pulse. For each of these parameter derived from every single pulse, if the difference between the present value and the extrema (maximum or minimum) in the 30-sec history window was larger than
67

Chapter 4. On algorithms for calculating arterial pulse pressure variation during major surgery
a threshold that was defined as the discrepancy between the maximum and minimum values, this pulse would be rejected. Data from 6 patients were removed entirely due to signal quality or continuous cardiac arrhythmia. In the rest 23 patients, 91.2-hour data were found eligible for the further analysis of PPV (9.8% data in these 23 patients were excluded).
4.2.2. General framework for the analysis of existing and proposed algorithms
In this chapter, we provide insights into how the algorithmic designs in the existing algorithms impacted the performance of a full algorithm during surgery. To this end, we analyzed five key algorithms existing in the literature and investigated the impact of the processing steps of those algorithms on their overall performance.
The algorithms selected for comparison are (see also table 4.2): (1) An algorithm applying the original specification of the PPV by Michard et al. [26], using linear interpolation of the pulse pressure to derive the IPP. It uses a sample duration of a single ventilation cycle and subsequently averages three subsequent raw PPV values. (2) An algorithm similar to (1) using a sample duration of three ventilation cycles, and no subsequent smoothing [128]. (3) An algorithm using kernel smoothing to derive the IPP, using a sample duration of a single ventilation cycle for the raw PPV values, and subsequently using a three-point median filter. The ventilation frequency is determined from the IPP [126]. (4) An algorithm that is adapted from (2), but using a longer sample duration for calculation of the raw PPV values, and using an advanced Kalman filter for PPV post-processing to deal with dynamic blood pressure changes [127]. (5) A fixed-time-window algorithm with kernel smoothing to derive the IPP. This fixed-time-window type of algorithm is relevant, because such algorithms omit the need of estimating the ventilation frequency [120], [129], [182]. We implemented such an algorithm, as mentioned by Derichard et al. [129]. The procedure of PPV calculation is described using a block diagram (see figure 4.1). Different options for each block can be found in Section 4.3 and
68

4.2. Materials & Methods
Figure 4.1: General framework for the analysis of PPV calculation algorithms.
4.4. IPP is first derived from the ABP signal. After post-processing the IPP, raw PPV is calculated. Finally, the PPV values are post-processed to generate the presented PPV.
4.2.3. Performance indicators of PPV algorithms during surgery
In this chapter, we employed three performance indicators to quantify the performance of the PPV algorithms. These performance indicators address both the performance during episodes of hemodynamic stability and the performance during the whole time span of surgery including more dynamic hemodynamic episodes. An elaborate discussion on the selection of these three indicators is given in Appendix A of this chapter, and this section provides a summary.
The first indicator is the closeness of the generated PPV values to those calculated using its original specification during periods of hemodynamic stability, as can be seen figure 4.2 (a). We manually selected a segment of 23 minutes without significant changes in the heart rate or ABP from each
69

Chapter 4. On algorithms for calculating arterial pulse pressure variation during major surgery
patient as stable hemodynamic episodes. In total, 64 minutes of recorded data were selected as stable periods with PPV values ranging from 0.4% to 13.3%.
The other two performance indicators were applied to the entire course of the surgery, and aimed to quantify the performance during more dynamic hemodynamic episodes. These performance indicators are the hourly occurrences of two false PPV patterns that are confusing and not representative of the underlying hemodynamic status. The lower the hourly occurrence of these patterns, the better the performance.
One false PPV pattern, which is the second performance indicator, is an episode of unstable PPV calculation as illustrated in figure 4.2 (b). Such an episode was defined as a time window of 40 seconds (i.e. approximately 10 ventilation cycles), in which the interquartile range of PPV values is larger than 2% (PPV values typically range in the order of 5-20% and change rather slowly). PPV algorithms are prone to producing this false pattern if the subsequent pulse pressure fluctuates due to motion artifacts, irregular beats, dyssynchrony of the heart rate to the ventilation rate.
The other false PPV pattern, which is the third performance indicator, is a short-term elevation, as illustrated in figure 4.2 (c). It was defined as a 1040 second increase in median values larger than 2% compared to the values in preceding 40 seconds and following 40 seconds. PPV algorithms are prone to producing this false pattern if the pulse pressure gradually changes over a time span of several ventilations.
A summary of all these parameters can be found in table 4.1.
4.2.4. Statistical analysis
To investigate our proposed IPP post-processing, we applied Wilcoxon signed-rank test on the hourly occurrence of unstable PPV calculation episodes and short-term elevations for each sample durations and each IPP derivation method after Kolmogorov-Smirnov test for distribution normality [183]. The p values were corrected according to the Bonferroni method using the number of comparisons (in this case 6). To investigate the impact of sample durations, we applied Friedman‚Äôs one-way test on the hourly occurrence of unstable PPV calculation episodes and short-term elevations after Kolmogorov-Smirnov test for distribution normality [183]. Following Friedman‚Äôs test, pairwise comparisons were carried out according to Tukey's honestly significant difference criterion. To study the influence of IPP derivation, we applied Wilcoxon signed-rank test on the hourly occurrence of
70

4.2. Materials & Methods
Figure 4.2: Illustration of the performance indicators. (a) Difference from the original PPV specification during episodes of hemodynamic stability. (b) An unstable PPV calculations episode. (c) A short-term elevation.
71

Chapter 4. On algorithms for calculating arterial pulse pressure variation during major surgery

Table 4.1: Three performance indicators and their relevance.

Performance indicatorsa

Valid periods

Clinical relevance

Difference from the Selected

Presented PPV values should be close to the

original specification periods of

original specification during periods of

(figure 4.2(a))

hemodynami

hemodynamic stability

c stability

Hourly occurrence of unstable PPV
calculation episodes (figure 4.2(b))

The entire course of surgery

Presented PPV values should not fluctuate rapidly in a short period of time

Hourly occurrence of The entire Gradual changes of the pulse pressure over a

short-term elevations course of time span of several ventilation cycles can cause

(figure 4.2(c))

surgery

false elevations in the presented PPV values.

a The lower the measure, the better the performance.

unstable PPV calculation episodes and short-term elevations for each sample durations after Kolmogorov-Smirnov test for distribution normality. The p values were corrected according to the Bonferroni method using the number of comparisons (in this case 6). For the final comparison between existing algorithms and our proposed algorithms, we applied Friedman‚Äôs one-way test after Kolmogorov-Smirnov test for distribution normality. Again, following Friedman‚Äôs test, pairwise comparisons were carried out according to Tukey's honestly significant difference criterion. A p<0.05 was regarded as statistically significant.

4.3. Description of existing algorithms
We analyzed and implemented five existing algorithms including Michard et al. [26] (the original specification of PPV), Kim and Pinsky [128], Aboy et al. [126], Aboy et al. [127], and Derichard et al. [129]. A summary of the processing steps of these existing algorithms and our proposed algorithm (further details in Section 4.4) can be found in table 4.2. A detailed elaboration of each step in each algorithm can be found in Appendix B.

72

4.4. Description of our algorithm

Table 4.2: Processing steps of existing algorithms and our proposed algorithm in the

defined framework.

Step 1: IPPa derivation

Michard et al. 2000 (original
specification of PPV) Linear
interpolation

Kim and Pinsky 2008
Linear interpolation

Step 2: IPP

___

___

post-

processing

Existing
Aboy et al. 2004
Kernel smoothing
+ LPFb
___

Aboy et al. Derichard 2009 et al. 2009

Kernel smoothing
+ LPF

Kernel smoothing
+ LPF

___

___

Our proposed algorithm
Linear interpolation
/ Kernel smoothing +
LPF Baseline extraction + Adaptive peak filter

Step 3:

One

Three

Calculation ventilation ventilation

of Raw

cycle

cycles

PPV

derived from derived from

(sample

the airway

the

duration)

pressure

ventilator

Step 4:

Mean of

___

Calculation

three

of

consecutive

presented

raw PPV

PPV

values

(smoothing

of raw

PPV)

aIPP: interpolated pulse pressure

bLPF: low-pass filter

One ventilation
cycle derived from the
IPP Median of
three consecutive
raw PPV values

Two ventilation
cycles derived from the
IPP Kalman
filter

Eightsecond window
Mean of four
consecutive raw PPV values.

One ventilation
cycle derived from
the ABP baseline Median of
three consecutive
raw PPV values

4.4. Description of our algorithm
4.4.1. Step 1: IPP derivation
For our new algorithm, we first obtained the baseline of the ABP signal by applying an LPF at a cutoff frequency of 0.4 Hz. The reason is that, in
73

Chapter 4. On algorithms for calculating arterial pulse pressure variation during major surgery
addition to the PP of the ABP signal, the baseline of the ABP signal is also modulated by ventilation and can be used for ventilation frequency estimation1.Thus, we stored this baseline at this step for estimating ventilation frequency, such that it can be used in step 2 (Section 4.4.2).
Next, we removed high-frequency components in the ABP signal by applying an LPF at a cutoff frequency of 15 Hz. To detect peaks and valleys in the signal, we used a dedicated method based on the first derivative of the ABP signal. Adaptive thresholds based on weighted averages of upper and lower envelope of the first derivative of the ABP signal were used to find the steepest slopes and thereby define the pressure pulse. The peaks and valleys were detected at the first zero-crossing in the first derivative after the steepest slope and the last zero-crossing before the steepest slope, respectively.
After deriving PP from the peaks and valleys, we separately used linear interpolation and kernel smoothing to derive IPP as comparison. For the kernel smoothing, as indicated by Aboy et al. [126], it was followed by low-pass filtering at a cutoff frequency of 0.45 Hz. This filtering achieved a comparable filtering effect as the method described in Section 4.3.1, while reducing computational complexity. Note that all the filtering was done bi-directionally to avoid phase delay.
4.4.2. Step 2: IPP post-processing
Unlike the other algorithms which incorporated post-processing of PPV values, we post-processed the intermediate IPP signal. This method dealt more effectively with noise and also avoided excessive delay in displaying PPV values. To post-process IPP, we began by extracting the baseline of the IPP. This was implemented by bi-directionally applying a six-order Butterworth LPF at a cutoff frequency of 0.1 Hz. The extracted baseline was then stored to allow, in the next step, the computation of the mean IPP during one ventilation cycle. The de-trended IPP, obtained by the subtraction of the baseline from the IPP, was used in the next step to determine the difference between the maximum and minimum IPP in a sample window. This method aimed to make the algorithm robust against the problem illustrated in figure 4.2 (c).
1Addison et al. [53] used the baseline of the PPG signal to estimate respiration frequency and we applied a similar approach to the ABP signal.
74

4.4. Description of our algorithm

In addition to extracting the baseline of the IPP, we applied an adaptive peak filter to the de-trended IPP, such that we focused on the variations in the IPP for calculating PPV that were in the narrow frequency band centered at the ventilation frequency. This was targeted at alleviating the problem illustrated in figure 4.2 (b). A classic second order adaptive peak filter [184] was used in this work. The transfer function of this filter in the z-domain is given by:

1 ‚àí Ì†µÌ±ß‚àí2

(4.1)

Ì†µÌ∞ª(Ì†µÌ±ß) = (1 ‚àí Ì†µÌ±è) 1 ‚àí 2Ì†µÌ±èÌ†µÌ±êÌ†µÌ±úÌ†µÌ±†Ì†µÌ±§0Ì†µÌ±ß‚àí1 + (2Ì†µÌ±è ‚àí 1)Ì†µÌ±ß‚àí2

1 Ì†µÌ±è = 1 + tan(‚àÜÌ†µÌ±§/2)

(4.2)

where Ì†µÌ±§0 is the center frequency and ‚àÜÌ†µÌ±§ is the bandwidth.

The center frequency of this filter (i.e., the ventilation frequency) was

estimated by applying a Fast Fourier Transform (FFT) on the baseline of the

ABP signal of the previous 60 seconds. The estimated ventilation frequency

was updated every 20 seconds. The bandwidth of the filter was set at 0.04 Hz,

which was empirically found to be an effective bandwidth as it stabilized the

de-trended IPP in a 30 second window.

4.4.3. Step 3: Calculation of raw PPV
For our new algorithm, we used the ventilation frequency determined from the ABP baseline modulation derived in step 2 (Section 4.4.2) to set our sample duration, and we used one ventilation cycle for calculating PPV. Furthermore, we used the extracted baseline of the IPP to compute the mean IPP. This approach was less dependent on sample durations compared to the methods of described by Aboy et al. [126], [127]. In these methods, if the length of ventilation cycle (the sample duration) was not determined correctly, the mean IPP would alter significantly because of the cyclic components in the IPP. In contrast, the mean IPP in our method, the extracted baseline of the IPP, was free of cyclic components.

4.4.4. Step 4: Calculation of presented PPV
To suppress the influence of irregular beats and noise, we adopted the same three-point median filter as Aboy et al. [126].

75

Chapter 4. On algorithms for calculating arterial pulse pressure variation during major surgery
4.5. Results
4.5.1. Step 1: the influence of methods for IPP derivation
An example of the results of various methods for deriving IPP can be found in figure 4.3. In figure 4.3 (a), it can be seen that there was no significant change in volume status. However, figure 4.3 (b) shows that linear interpolation generated different extrema values for neighboring ventilation cycles. In contrast, the methods based on kernel smoothing constructed extrema of more similar values. This similarity in extrema values offered promise of reconstructing the actual maximum and minimum of IPP. Nevertheless, figure 4.4 shows that the algorithms based on kernel smoothing produced more unstable PPV calculation episodes and short-term elevations than those based on linear interpolation. After IPP post-processing, the performance of the two algorithms were comparable.
Figure 4.3: Comparisons for different methods of deriving IPP. (a) A segment of the ABP signal. (b) The measured PP and derived IPP.
4.5.2. Step 2: effect of our IPP post-processing
In order to isolate the influence of IPP post-processing from other confounding factors, we did not post-process the raw PPV values for all the compared algorithms. Figure 4.4 (a) shows that the proposed IPP post76

4.5. Results
processing significantly reduced the hourly occurrence of unstable PPV calculation episodes independently of the method for IPP derivation and sample durations (p<0.001). Figure 4.4 (b) shows that the proposed IPP postprocessing significantly reduced the hourly occurrence of short-term elevations independently of the method for IPP derivation and sample durations (p<0.001).
By extracting the baseline in the IPP, we reduced the hourly occurrence of short-term elevations. Figure 4.5 shows the effect of extracting the baseline in the IPP. It can be seen that there was an increasing trend in the IPP. The method without baseline extraction suffered from a false temporary elevation in the PPV values. On the contrary, the method with baseline extraction showed no such short-term elevations in the PPV values and gave stable (physiologically-sensible) output.
By applying an adaptive peak filter, we achieved fewer unstable PPV calculation episodes. Figure 4.6 shows the effect of applying an adaptive peak filter to the de-trended IPP. It can be seen that the filtering led to more stable de-trended IPP. For example, the PPV values around 3860 s and 3920 s, which seemed to be outliers, were successfully suppressed using the adaptive filter.
The performance of the adaptive peak filtering depended on the accuracy with which the ventilation frequency was estimated. We compared our estimated frequency with the frequency provided by the ventilator. The mean difference was 0.003 Hz (i.e., 0.18 min-1) with a standard deviation (SD) of 0.01 Hz.
77

Chapter 4. On algorithms for calculating arterial pulse pressure variation during major surgery
Figure 4.4: Boxplots of two performance indicators for different configurations of the first 3 algorithmic steps of the PPV algorithm without PPV post-processing. (a) Hourly occurrence of unstable PPV calculation episodes. (b) Hourly occurrence of short term elevations. IPP post-processing refers to our proposed baseline extraction and adaptive peak filter. The sample durations in step 3 are given as the number of ventilation cycles. The lower the occurrence rates the better the performance of the algorithms. Significant comparisons are indicated by the horizontal lines where * means p<0.05, ** means p<0.01, and *** means p<0.001.
78

4.5. Results
Figure 4.5: The effect of extracting the IPP‚Äôs baseline from the IPP. (a) A segment of the ABP signal. (b) The IPP and its baseline. (c) The de-trended IPP. (d) PPV values. The two compared PPV algorithms in panel (d) both used kernel smoothing to derive IPP, applied sample durations of eight seconds, and did not post-process PPV: the only difference was the application of baseline extraction.
Figure 4.6: The effect of applying an adaptive peak filter to the de-trended IPP. (a) A segment of the ABP signal. (b) The IPP and its baseline. (c) The de-trended IPP and the de-trended IPP processed using an adaptive peak filter. (d) PPV values. The two compared PPV algorithms in the panel (d) both used kernel smoothing to derive IPP, post-processed IPP with baseline extraction, applied sample durations of eight seconds, and did not post-process PPV: the only difference was the application of an adaptive peak filter.
79

Chapter 4. On algorithms for calculating arterial pulse pressure variation during major surgery
4.5.3. Step 3: the influence of the sample duration
Figure 4.4 shows the influence of the sample duration for the different algorithms. We compared three sample durations: one ventilation cycle, two ventilation cycles (50% overlapping), three ventilation cycles. We did not include eight seconds for comparison, as this sample duration is often between two and three ventilation cycles, so the performance is accordingly between that of two ventilation cycles and that of three ventilation cycles. In order to isolate the influence of sample duration from other confounding factors, we did not post-process the PPV values for all the compared algorithms. Again, we compared the performance using the hourly occurrence of unstable PPV calculation episodes and short-term elevations. It can be seen that the hourly occurrence of short-term elevations increased with the sample duration. Algorithms using two ventilation cycles and three ventilation cycles generated significantly more short-term elevations than those using one ventilation cycles independently of IPP derivation (step 1) and IPP post-processing (step 2). When it comes to hourly occurrence of unstable PPV calculation episodes, the influence of sample duration was not very apparent. Note that our proposed IPP post-processing method helped reduce number of unstable PPV calculation episodes and short-term elevations regardless of the sample duration and that the sample duration had a stronger effect on the occurrence of short-term elevations than on the occurrence of unstable PPV calculation episodes.
4.5.4. Overall comparisons
The results of overall comparisons can be found in table 4.4 and figure 4.7. Table 4.4 shows that during selected episodes of hemodynamic stability, all existing and the proposed algorithm were in good agreement with the original specification by Michard et al. [26]. The mean of difference between the original specification and the other algorithms was between -0.64% and 1.15%, where the proposed algorithm based on kernel smoothing achieved 0.11%, followed by -0.19% from the work by Aboy et al. [126]. The SD of difference between the original specification and the other algorithms was between 0.49% and 0.93%, where the proposed algorithm based on linear
80

4.5. Results

interpolation achieved 0.49%, followed by 0.56% from the proposed algorithm based on kernel smoothing.
Figure 4.7 shows the performance of existing algorithms and the proposed algorithms during the entire course of the surgery. During the entire course of surgery, the proposed algorithms based on linear interpolation performed the best in avoiding unstable PPV calculation episodes, followed by the proposed algorithm based on kernel smoothing. The proposed algorithm based on linear interpolation showed significantly better performance compared to existing algorithms, except for the algorithm by Aboy et al. [126]. When it comes to the hourly occurrence of short-term elevations, the best performance was achieved by the proposed algorithm based on linear interpolation, followed by the proposed algorithm based on kernel smoothing. Both proposed algorithms performed significantly better than existing algorithms, except for the algorithm by Aboy et al. [126].

Table 4.4: Performance of existing and proposed algorithms during episodes of

hemodynamic stability.

Algorithms

Difference from the original PPV specificationa

Michard et al. 2000

--

Kim and Pinsky 2008

1.15% [0.93%]b

Aboy et al. 2004

0.19% [0.75%]

Aboy et al. 2009

0.42% [0.76%]

Derichard et al. 2009

0.47% [0.76%]

Proposed algorithm based on linear

-0.64% [0.49%]

interpolation

Proposed algorithm based on kernel smoothing

-0.11% [0.56%]

a applied to episodes of hemodynamic stability b mean [standard deviation]

81

Chapter 4. On algorithms for calculating arterial pulse pressure variation during major surgery
Figure 4.7: Boxplots of two performance indicators for comparisons between existing algorithms and the proposed algorithms during the entire course of the surgery. (a) Hourly occurrence of unstable PPV calculation episodes. (b) Hourly occurrence of short-term elevations. The compared algorithms were Michard et al. 2000 (M2000), Kim and Pinsky 2008 (K2008), Aboy et al. 2004 (A2004), Aboy et al. 2009 (A2009), Derichard et al. 2009 (D2009), proposed algorithm based on linear interpolation (Prop1), and proposed algorithm based on kernel smoothing (Prop2). Significant comparisons are indicated by the horizontal lines where * means p<0.05, ** means p<0.01, and *** means p<0.001.
4.6. Discussion
In this study, we evaluated five key PPV calculation algorithms existing in the literature on the data obtained in ventilated patients undergoing surgery. To understand the role of each processing step in the performance of the algorithms, we first decomposed the existing algorithms into four steps and analyzed different methods and effects for each of them. To enable this, we developed new clinically-relevant measures of PPV calculation performance. Insights into the behavior of each algorithm and the role of each algorithmic step has enabled us to propose an additional IPP post-processing approach, improving the robustness during surgery. The results show that all evaluated algorithms showed good agreement with the original PPV specification proposed by Michard et al. [26] during hemodynamically stable phases in surgery. In more dynamic phases, the proposed IPP post-processing algorithm helped improve the performance. 82

4.6. Discussion
In the past, little attention has been focused on post-processing IPP. However, various disturbances may exist in the IPP. These include the pulse pressure trend, dyssynchrony of the heart rate to the ventilation rate, and irregular beats. In this light, merely post-processing raw PPV values may perform inadequately, whereas post-processing IPP can help to improve the performance. The results show that our proposed baseline extraction and adaptive peak filtering significantly improved the robustness of the PPV algorithm during surgery.
We found it is preferred to use a sample duration of a single ventilation cycle instead of extended sample durations as using longer sample durations resulted in a larger hourly occurrence of short-term elevations. This is a consequence of the fact that the blood pressure baseline changes had a larger impact on the maximum and minimum of IPP when using longer sample durations. In addition, the PPV values computed using longer sample durations were consistently higher than those computed using shorter windows. This finding is also in line with the work by Kim and Pinsky [128], in which the authors suggested that separate validations are needed to be define the decision threshold. Interestingly, Cannesson et al. [185] also identified varied thresholds when calculating PPV using commercial patient monitors or when calculating PPV according to the original specification. They further defined a gray zone where PPV is inconclusive.
We also compared two different methods of deriving IPP: linear interpolation and kernel smoothing. As is shown, during period of hemodynamic stability, the kernel smoothing helped to reconstruct the actual extrema of IPP. However, the algorithm based on linear interpolation outperformed that based on kernel smoothing over the entire course of surgery. It could be that kernel smoothing was less stable in dynamic periods. Nevertheless, the algorithms based both methods achieved improved robustness when applying the proposed IPP post-processing and the performance differed marginally.
There are several limitations in this work. Firstly, here we could only investigate the role of blood pressure changes on PPV calculating performance during surgery. While it would have been useful to understand how cardiac output may affect the PPV calculation performances, cardiac output was however not monitored in these patients. The lack of measurement of cardiac
83

Chapter 4. On algorithms for calculating arterial pulse pressure variation during major surgery
output also hindered us from investigating the predictability of PPV for fluid responsiveness. Future study may include the measurement of cardiac output to test the predictability of all the PPV algorithms for fluid responsiveness during surgery. Secondly, our data size was limited. A sample size of this magnitude made it challenging to demonstrate a small significantly higher performance for a particular technique. Despite this, we still found some significant improvements in the performance indicators when using IPP postprocessing. We also found significant difference in generating short-term elevations when using different sample durations. Thirdly, when it comes to the sample window according to the original specification, we defined a sample window rather than using the precise ventilation timing derived from the airway pressure or capnography signals. We believe both methods of obtaining the sample window would not differ too much, as the signal in such short time scale is often assumed to be stable. Finally, when post-processing the IPP, we applied a classic filter in bi-directional manner to avoid phase delay and distortion; in practice this would require a latency of approximately four seconds.
4.7. Conclusion
All evaluated algorithms showed good agreement with the original PPV specification proposed by Michard et al. [26] during hemodynamically stable phases in surgery, but the overall performance during surgery depended on specific algorithmic choices. Appropriate interpolation for deriving IPP was helpful for reconstructing actual maximum and minimum of the PP within each ventilation cycle. Extracting the baseline in the IPP can greatly reduce the hourly occurrence of short-term elevations. Applying an adaptive peak filter to the de-trended IPP can reduce the hourly occurrence of unstable PPV calculation episodes. The sample duration should not be longer than one ventilation cycle as longer windows generate an increased hourly occurrence of short-term elevations as well as consistently higher PPV values. Finally, our proposed IPP post-processing improved the performance independent of the interpolation method and sample duration during surgery.
84

Appendix A
Appendix A
The validity of PPV, when calculated using its original specification, under relatively stable hemodynamic conditions is well-established [26], [122], [181], [186]. This means that a PPV calculation algorithm should generate values close to the original specification during relatively stable hemodynamic episodes. This comparative analysis, performed under stable hemodynamic episodes, is illustrated in figure 4.2 (a). We manually selected a segment of 23 minute without significant changes in the heart rate or ABP from each patient as stable hemodynamic episodes. In total, 64-minute data were included as stable periods with PPV values ranging from 0.4% to 13.3%.
The above performance indicator (i.e., the difference from the original specification, in episodes without sudden hemodynamic changes), is not supposed to be extended to the episodes in which acute blood pressure changes occur. To date, there are no existing PPV performance indicators addressing PPV performance under these conditions.
To address this issue, new PPV performance indicators need to be designed to assess the performance in more dynamic hemodynamic episodes. We identified two common patterns in the PPV time-trace that are, as we will argue, not representative of the true, underlying, hemodynamic status. The occurrence of each of these two false patterns were used as two additional PPV performance indicators during surgery.
The first false pattern is unstable PPV values over a short period of time. To quantify such fluctuations, we heuristically defined a time window of 40 seconds (i.e. approximately 10 ventilation cycles), in which the interquartile range of PPV values should be no larger than 2% (PPV values typically range in the order of 5-20% and change rather slowly). If the fluctuations exceeded this, the episode was labeled as ‚Äòunstable PPV calculation episode‚Äô. The time windows where PPV values consistently increased or decreased were excluded from this category. An illustration of a typical unstable PPV calculation episode can be found in figure 4.2 (b). We computed the hourly occurrence of these unstable PPV calculation episodes as an indicator inversely related to performance.
The second false pattern is short-term elevations of the PPV and a subsequent decrease (figure 4.2 (c)). To demonstrate that this artifact is
85

