基于光电容积脉搏波的抗运动心率及血氧提取算法研究
李敏
2016 年 1 月

中图分类号：R318 UDC 分类号：612
基于光电容积脉搏波的抗运动心率及血氧提取算法研究

作者姓名 学院名称 指导教师 答辩委员会主席 申请学位 学科专业 学位授予单位 论文答辩日期

李敏 信息与电子学院 王群 王卫东 教授 工学硕士 电子科学与技术 北京理工大学 2016 年 1 月

Research on Motion-resistant Heart Rate and Oxygen Saturation Extracting Algorithm Based on Photoplethysmography

Candidate Name：

Min Li

School or Department： Information and Electronics

Faculty Mentor：

Qun Wang

Chair, Thesis Committee： Prof. Weidong Wang

Degree Applied：

Master of Engineering

Major：

Electronic Science and Technology

Degree by：

Beijing Institute of Technology

The Date of Defence： January，2016

研究成果声明
本人郑重声明：所提交的学位论文是我本人在指导教师的指导下进行 的研究工作获得的研究成果。尽我所知，文中除特别标注和致谢的地方外， 学位论文中不包含其他人已经发表或撰写过的研究成果，也不包含为获得 北京理工大学或其它教育机构的学位或证书所使用过的材料。与我一同工 作的合作者对此研究工作所做的任何贡献均已在学位论文中作了明确的说 明并表示了谢意。
特此申明。

签 名：

日期：

摘要
心率(heart rate, HR)和血氧饱和度(oxygen saturation)是两个非常重要的人体参数。 心率的实时、无创检测可以帮助人们随时了解自己的身体状况，一定程度上能够避免 由于心血管疾病等因素引起的意外事件的发生。此外，心率监测还可以作为一种运动 监测手段，避免过高的运动强度给免疫系统带来较大的压力。因此，对心率的实时、 无创、准确检测受到越来越多的关注。氧气是所有生命活动的物质基础，是提供人体 新陈代谢的重要物质。血氧饱和度实时监测已成为判断人体供氧状况以及人体呼吸系 统和循环系统是否正常的一个重要指标。光电容积脉搏波（photoplethysmographic, PPG）信号中包含很多人体生理信息，例如心率和血氧，因此利用光电容积脉搏波信 号提取心率和血氧得到了广泛的应用。然而，光电容积脉搏波信号极易受到运动干扰 的影响，严重影响心率和血氧饱和度检测的准确性，尤其当光电容积脉搏波中包含突 变波形时，利用传统的算法得到的结果并不理想。
针对以上问题，本文提出一种基于时变自回归（time-varying autoregressive, TVAR) 模型的抗运动干扰的心率提取算法。本文首先利用加速度信号对 PPG 信号进行状态分 类，分为静止 PPG 和运动 PPG。对于静止 PPG 信号，本文提出一种均值交点法计算 心率，该方法在静止情况下准确度高、运算量小。对于运动 PPG 信号，本论文算法将 基于多小波基函数展开的时变自回归模型方法、快速傅里叶变换（fast Fourier transform, FFT）频谱分析法和加速度信号结合起来。该算法采用带通滤波器和滑动平均滤波器 对光电容积脉搏波信号作预处理。利用基于多小波基函数展开的时变自回归模型法对 受到干扰的 PPG 信号分段，对每段信号作快速傅里叶变换频谱分析，进行谱峰搜索， 确定所有可能的心率值，利用加速度信号从所有可能的心率值中作最优化选择，最终 确定心率。本论文针对 5 名健康人进行测试。测试状态分两种：静止和运动，运动状 态包括跳跃、挥臂、跑步三种情况。同传统快速傅里叶方法和基于最小均方误差自适 应（least mean square, LMS）算法的心率提取方法比较，本论文提出的算法具有准确 度高，抗干扰性强的特点。特别能有效应对运动干扰产生的 PPG 波形突变问题。在此 基础上，本文将新提出的抗干扰心率提取算法与血氧频域分析法结合，提出了抗运动 的血氧饱和度提取算法。实验结果表明此算法具有较好的准确性和稳定性。 关键词：心率；血氧饱和度；光电容积脉搏波；时变自回归模型；多小波；加速度信 号；快速傅里叶变换
I

Abstract
Heart rate and oxygen saturation are two very important physiological parameters of human body. Non-invasive and real-time detection of heart rate can not only help people keep their physical condition, but also avoid emergency caused by cardiovascular diseases. In addition, heart rate is one of the most direct indicators of exercise intensity. It can be used to control the amount of exercise to avoid too much pressure on the immune system caused by excessive exercise. Therefore, the real-time and noninvasive detection of heart rate has been paid more and more attention. Oxygen is the material basis of all life activities, and the important substance to for human metabolism. The detection of oxygen saturation in real-time is a key indicator to determine whether the Human respiratory system and circulatory system is normal. The photoplethysmographic (PPG) signal contains a lot of human physiological information, including heart rate and oxygen saturation, so it is widely used to extract the heart rate and oxygen from PPG signal. However, PPG signals are vulnerable to motion artifacts, which interfere strongly with heart rate and oxygen saturation monitoring. In particular, the performance of traditional heart rate and oxygen saturation extracting algorithms is not satisfactory when sudden changes are included in the waveform.
To solve the problem, a motion-resistant heart rate extracting algorithm was proposed based on time-varying autoregressive (TVAR) model. Acceleration signal was firstly used to classify PPG signal into two states: PPG in stillniss and PPG in motion. For PPG in stillness, a new method—Mean Intersection Method was proposed. The method has high accuracy and low computational complexity. For PPG in motion, this paper combined a time-varying autoregressive model algorithm, fast Fourier transform (FFT), and acceleration signal. A bandpass filter and an average moving filter were used for signal preprocessing of raw photoplethysmographic signal. Then, the proposed algorithm employed the TVAR modelling approach based on multi-wavelet basis functions to divide the corrupted PPG into different parts. In each part, FFT was applied for spectrum analysis and all the possible heart rates were determined by searching peaks among spectrum. Acceleration signals were used for heart rate optimum selection and heart rate was finally determined. Five healthy people were tested. There were two test modes: resting and motion. Three situations were included in motion modes, namely jumping，waving arm and
III

running. Compared with traditional fast Fourier transform (FFT) method and least mean square （LMS） based heart rate extracting method, the results shows that the proposed method has higher accuracy. In particular, the proposed method is effective for heart rate extracting when sudden changes caused by motion artifacts are included in PPG waveform. The new method has high accuracy and good motion-resistant ability. Combining the new motion-resistant heart rate extracting algorithm and frequency domain approach, we proposed the motion-resistant oxygen saturation extracting algorithm. The result shows that the method has good accuracy and stability. Key Words: heart rate; oxygen saturation; photoplethysmographic(PPG); time-varying autoregressive(TVAR) model; multi-wavelet; acceleration signal; fast Fourier transform(FFT)
IV

目录
第 1 章 绪论.................................................. 1
1.1 本论文研究的背景和意义 .......................................... 1 1.2 国内外研究历史及研究现状 ........................................ 2 1.3 论文的内容安排 .................................................. 5
第 2 章 心率及血氧饱和度的检测方法研究 ........................ 7
2.1 脉搏波及光电容积脉搏波概述 ...................................... 7 2.2 心率检测原理及方法 .............................................. 9
2.2.1 心率检测原理 ............................................ 9 2.2.2 心率检测方法 ............................................ 9 2.3 血氧饱和度检测原理及方法 ....................................... 10 2.3.1 血氧饱和度的概念 ....................................... 10 2.3.2 朗伯-比尔定律 .......................................... 11 2.3.3 血氧饱和度检测原理 ..................................... 12 2.4 本章小结 ....................................................... 16
第 3 章 基于时变自回归模型的抗运动心率及血氧提取算法 ..........17
3.1 运动干扰的引入 ................................................. 17 3.2 多小波基函数展开的时变自回归模型 ............................... 21
3.2.1 时变自回归模型及系数展开 ............................... 21 3.2.2 多小波基函数展开 ....................................... 22 3.2.3 模型参数估计和谱估计 ................................... 23 3.3 基于时变自回归模型的抗运动心率提取算法 ......................... 24 3.3.1 信号状态分类 ........................................... 25 3.3.2 静止状态心率计算 ....................................... 27 3.3.3 信号预处理 ............................................. 28 3.3.4 信号分段 ............................................... 29
V

3.3.5 谱峰追踪 ............................................... 31 3.4 抗运动血氧饱和度提取算法 ....................................... 32 3.5 本章小结 ....................................................... 33
第 4 章 实验及结果分析........................................35
4.1 心率实验及结果分析 ............................................. 35 4.1.1 实验方法 ............................................... 35 4.1.2 参考心率提取 ........................................... 35 4.1.3 实验结果与分析 ......................................... 37 4.1.4 本文算法与传统算法比较 ................................. 40
4.2 血氧实验及结果分析 ............................................. 44 4.2.1 实验方法 ............................................... 44 4.2.2 实验结果与分析 ......................................... 44 4.2.3 本文算法与传统算法比较 ................................. 46
4.3 本章小结 ....................................................... 46
结论 ......................................................... 48 参考文献 ..................................................... 50 攻读学位期间发表论文与研究成果清单 ...........................53 致谢 ......................................................... 54
VI

第 1 章 绪论
1.1 本论文研究的背景和意义
随着社会的进步和人民生活水平的不断提高，人们对健康日益关注，越来越多的 人希望能够实时了解身体状况。因此，很多可穿戴生理参数监测设备应运而生。心率 和血氧饱和度是反映人体生理状态的两个重要参数，也成为很多可穿戴生理参数监测 设备希望反映的两个重要指标[1]。
心率不仅可以反映人体的健康状况，而且可以反映人体的运动情况。对心率的实 时检测可以帮助人们随时了解自己的身体状况。同时，也可以指导人们控制运动量。 随着人们对健康越来越关注，运动也受到当代人的重视。对心率的实时、无创监测一 定程度上能够避免由于心血管疾病等因素引起的意外事件的发生[2]。此外，心率监测 作为一种监督手段，还可以用于控制运动量，避免过高的运动强度给免疫系统带来较 大的压力[3]。中医通过切脉确定心率，操作时间长、不能动态监测心率是该方法最大 的限制[4]。动态心电信号可以实时检测心率，但是该方法操作复杂，给患者带来不适 感，不适用于日常的心率监测[1]。因此，对心率的实时、无创、准确检测受到越来越 多的关注。
氧气与人体新陈代谢密切相关。血氧饱和度是反映血液中氧气含量的重要指标。 血液中部分还原血红蛋白与氧气结合，形成氧合血红蛋白，到达毛细血管将氧气释放。 血氧饱和度是血液中氧合血红蛋白的容量占全部可结合的血红蛋白容量的百分比[5]。 血氧饱和度反映血液中氧气的浓度，成为判断人体供氧状况的一个重要指标。最初依 靠电化学分析的有创方式测量血氧饱和度[6]。有创测量方式虽然准确，但对人体易产 生伤害，且受限只能在医院中进行，操作复杂、费用较高，无法对病人实现连续的动 态监测。
综上所述，寻求无创方法实时监测心率和血氧饱和度具有非常重要的意义。 光电容积脉搏波(Photoplethysmography，PPG)信号是借助光电方法在组织中检测 血液容积变化而得到脉搏信号[7,8]。光强的变化与组织内血流灌注量变化有关系，PPG 信号包含了丰富的生理信息，因此能够提供心血管系统信息，最早于 1938 年由 Herizman 首次提出[9]。光照射到被测组织，经过组织吸收衰减作用后，从光源同侧或
1

异侧由光电接收器接收。被测组织中一些组织成分如肌肉、骨骼等对光的作用可看作 是不变的，而动脉血管内血液容积会随着心脏的收缩与舒张发生变化，导致血液对光 的吸收量发生变化，引起出射光强呈现周期性变化，最终光强的变化转换为电信号即 为 PPG 信号[7]。对获得的 PPG 信号处理运算，便可求得心率及血氧饱和度的值。由 于该方法不需要昂贵的仪器，且容易测量，因此受到国内外研究人员以及工程科技人 员的普遍重视。操作简单、成本低廉，以及其快速实时的特性，使其成为当今最广泛 使用的心率和血氧测量技术，广泛应用于临床监护领域以及日常监测领域。由于基于 该技术的穿戴式设备比较简单，且具有舒适、方便等优势，所以可穿戴心率和血氧监 测设备也得到了越来越多的关注。
然而，从光电容积脉搏波中提取心率和血氧时，最大的难点是检测到的光电容积 脉搏波很容易受到干扰的影响，特别是运动干扰的影响，使得测量结果出现偏差。且 这种噪声的频带范围常常和目标信号重叠，给心率的提取造成很大困难[11]。因此对 PPG 信号做深入研究、探索减小干扰影响的方法、研究在动态情况下从 PPG 信号中 准确提取心率和血氧具有重要的意义。
本课题针对所述问题展开，研究基于光电容积脉搏波的抗干扰心率及血氧提取算 法。
1.2 国内外研究历史及研究现状
脉搏中包含丰富的人体信息，中医便是依靠诊脉获取脉搏信息，虽然该方法简单 无创无痛，但是单纯凭借手指感觉辨别脉相特征，容易受到经验、感觉的限制，同时 也存在主观因素，这成为中医诊脉应用和发展的制约因素。医院的护士为住院病人把 脉记录每分钟脉搏数，这样做费时费力，精度也不高。传统的心率测量方法为心电测 量法[1]，该方法在身体上粘贴三个电极，通过测量人体的心电信号，从而提取人体心 率。但是该方法操作复杂，给患者带来不适感，因此不适用于日常的心率监测。刘宸 基于光电容积脉搏波原理，设计了一种便携式指端脉搏仪，该装置不仅能够实时地监 测人体的心率，同时，该装置还可以显示 PPG 波形，使被测者对自己的脉搏波形有一 个直观的了解。颜拥军引入匹配滤波处理技术，并和反射式 PPG 信号结合实现心率的 测量，这一技术也广泛应用于跑步机设备中[12]。2010 年 olga epikhina 设计出一套名为 healthpals 的可穿戴式的健康监测仪，这套设备可以检测人体的体温、心率等人体中重 要参数，该套设备配有手镯、戒指等。对无创血氧饱和度检测技术的探索可追溯到 20
2

世纪[11]。在这之前，Lambert-Beer 定律的提出为人体血氧饱和度的测量奠定了重要的 理论基础。另一个重要的理论为分光光度法，该方法主要利用氧合血红蛋白和还原血 红蛋白对光吸收特性的差异[5]。二十世纪末，由 Nellcor 等人利用发光二极管作为光源、 光敏三极管作为接收器研制得到的血氧仪拉开了现代血氧饱和度仪发展序幕[11]。无创 血氧监测分为透射式检测法和反射式监测法。由于透射式血氧仪只能用于手指、耳朵 等较薄的组织部位，测量位置受到局限性，而反射式测量仪能突破这样的局限性。二 十世纪中期，Polayi 等人提出一种反射式血氧监测模式，他们选择两种波长的光作为 入射光，结合反射光确定血氧饱和度计算公式，最终获取人体血氧饱和度值，这为现 代反射式血氧测量技术奠定了基础[11]。2010 年，Rammohan V. Maikala 研究了散射因 素对血氧测量的影响，对传统的朗伯-比尔定理进行了修正[12]。
PPG 信号极易受到运动干扰的影响，从而降低心率和血氧测量的准确性。有关消 除光电容积脉搏波中干扰的研究层出不穷。传统的频域分析法，如快速傅里叶变换法， 是一种常见的心率提取方法，该方法将时域信号转为频域曲线，通过分析频域中各频 率成分的分布来提取心率[13,14]。但是，当噪声较大，运动干扰强烈时，频谱中心率对 应频率点幅值较低，干扰频点较多，对于心率的提取非常困难。自适应去噪法，如最 小均方误差（least mean square, LMS）自适应算法，利用参考信号不断调整滤波器系 数从而去除干扰[15,16,17]。参考信号获得有两个途径：人工构造和外部设备提供（如加 速度计）。该方法非常依赖参考信号，参考信号的选择直接影响到去噪效果。滑动平 均滤波算法也常用来去除干扰，不足之处是该方法只对特定的干扰范围有噪声去除效 果，无法应对信号突变情况[16]。小波分析法也被用来去除干扰，但这种传统的数字信 号处理的方法对于运动干扰的去除无法达到很好的效果。Masimo 公司提出了一种离 散饱和度变换算法（DST），但这种方法会消耗大量的时间，因此，在 2008 年，Yan[18] 针对离散饱和度变换算法耗时较长的问题，提出最小相关离散饱和度变换算法，改进 了原来算法，缩短了计算时间。2013 年，Alzahrani A[19]等用三轴加速度计构建运动干 扰参考信号，三轴加速度信号一定程度可以反应运动干扰情况，因此利用三轴加速度 信号能降低运动干扰对 PPG 信号的影响。2015 年，Po-Hsiang Lai[20]利用 PPG 信号和 加速度信号的频谱中幅值大小、峰值个数、参考心率等之间的关系提出了一种抗运动 干扰心率提取算法。同年，Zhilin Zhang[21]提出了在运动情况下从手腕式光电容积脉 搏波中提取心率的算法框架，该算法框架包括信号分解、稀疏重构、谱峰追踪。其他 方法还有经验模态分解法[22]，独立成分分析法[23]等等。上述大部分方法在运动强度不
3

大时效果较好，然而，当运动干扰强烈，波形中出现突变的情况下，效果并不理想[21]。 可以看出，虽然针对 PPG 信号去除干扰的研究非常多，但是各个方法都各有优缺
点。 近年来，很多穿戴式设备都具有心率监测功能，包括三星 Gear Fit、Fitbit Surge、
Microsoft Band、Apple Watch 等，图 1.1 所示为具有心率监测功能的设备。其中心率 测量方法本质上没有太大差别，通常用的是光电容积脉搏波描记法。这些设备要求紧 贴手腕，并且不能在运动时测量。相比较医学上使用心电图机器来说，目前穿戴设备 上所配备的心率监测手段仍然不能达到绝对准确。为了极大促进穿戴设备测量的准确 性，算法是比较关键。在算法上，目前还不能满足各种运动和各类客户的需求，算法 上有很大改进空间。
图 1.1 具有心率监测功能的设备
目前，很多公司生产血氧计，例如 Nellcor、Masimo、SPO Medcial 和 philips 等。 图 1.2 是常见的血氧测量设备。SPO Medical 公司近几年已经成功生产出反射式血氧 测量产品，如 SPO Medical PulseOx 7500,可实现对人体血氧饱和度的监测以及心率的 测量。韩国的一家公司 APM Korea 近年来生产了一系列反射式血氧传感器，如 DCM01，DCM02，DCM03（2012 年推出），DCM05（2013 年推出）。国内的深圳迈 瑞生物医疗电子股份有限公司在血氧仪方面有很多探索。2012 年，苏州凯迪泰医学科 技有限公司申请了带血氧检测装置的额头垫及呼吸面罩的专利，核心技术是反射式血 氧测量技术。新日本无线开发的反射式血氧传感器 NJL5501R，有助于反射式脉搏血 氧仪的开发。
综上所述，从 PPG 信号中提取心率和血氧饱和度的方法具有无创测量、操作方便 的特点，其独特的优势必将在不久的将来广泛应用于临床监护以及家庭医疗体系中。 针对动态情况下，从受到干扰的 PPG 信号中提取心率和血氧必将为穿戴式监护设备的 推广奠定基础，在更多领域（如社区医疗、体育运动、军事等领域）发挥重要作用。
4

图 1.2 常见血氧饱和度测量设备
1.3 论文的内容安排
本论文主要研究从运动干扰的光电容积脉搏波信号中提取心率和血氧饱和度的 方法。本研究针对 PPG 信号运动干扰特点，引入基于多小波基函数展开的时变自回归 模型，同时结合快速傅里叶变换，并利用加速度信号，提出一种基于时变自回归模型 的抗运动干扰心率提取算法。本文算法由三部分构成：信号预处理，信号分段和谱峰 搜索。对于信号预处理部分，首先对信号带通滤波和滑动平均滤波，滤除包含正常心 率范围之外的噪声成分，同时使信号变得更平滑。对于信号分段部分，利用基于多小 波基函数展开的时变自回归模型方法对信号做时频分析，根据频率分布特性对信号分 段。在谱峰搜索阶段，对信号分段后的每一段信号作 FFT，在一定频谱范围内搜索所 有的谱峰，对应的频率作为可能的心率，在此基础上，结合三轴加速度信号，对心率 作最优选择。本文还将心率提取算法与频域分析法结合提出抗干扰血氧提取算法。本 文提出的方法具有较好的准确性和稳定性，尤其当 PPG 信号中包含突然强烈的运动干 扰时，表现出很强的抗干扰性。
本论文的结构如下： 第一章为绪论，对论文研究的背景和意义、国内外研究历史和研究现状做了介绍， 并说明了论文主要研究的内容和结构安排。 第二章对脉搏波以及光电容积脉搏波做了概述，并详细介绍了心率检测原理及方 法、血氧饱和度检测的原理及方法，为后面的章节奠定了基础。 第三章详细论述了本文提出的基于时变自回归模型的抗运动干扰心率及血氧提 取算法。本章首先对 PPG 运动干扰作了分析，然后根据干扰特点，引入多小波基函数 展开的时变自回归模型，接着对基于时变自回归模型的抗干扰心率提取算法作了详细 论述，并结合实测数据对各流程进行了分析。最后结合心率提取算法和血氧频域分析 法提出抗干扰血氧饱和度提取算法。
5

第四章为实验结果及分析，利用本文提出的算法对采集的信号处理得出结果，并 对结果进行分析，同时将结果与传统算法作比较，验证算法性能。
结论部分进行了总结与展望，总结了本课题研究存在的优势和不足，对全文进行 了概括，并探讨后续工作和未来研究方向。
6

第 2 章 心率及血氧饱和度的检测方法研究

2.1 脉搏波及光电容积脉搏波概述

脉搏一般情况下指的都是动脉脉搏。每分钟的脉搏次数称为脉率，正常情况下与 心率是一致的。心脏的一次收缩和舒张成为一个心动周期。在每个心动周期内，心室 的收缩和舒张会引起脉内压力的周期性波动，使动脉扩张和回缩，从而使得动脉血管 发生有规律的搏动，称为脉搏[24]。当脉搏在血管中向前传递的时候，是采用波浪式向 前，所以称为脉搏波。脉搏波是一种波的形式，当心脏规律性的进行收缩和舒张运动 的时候，血液注入到主动脉流经身体其他部位时产生的一种波[25]。心室进行收缩运动 的时候，主动脉瓣会呈现一种被张开的状态，血液在这种情况下会注入主动脉，但是 在血管中存在着阻挠血液流动的力，这样血液会有一部分不能够立即注入到静脉中， 造成血液会暂时存在主动脉的近端，扩张了主动脉，而导致主动脉血液容量变大，血 压升高等变化。而当心室舒张时，主动脉瓣会呈现关闭状态，停止向动脉注血，主动 脉在血管的弹性影响下而回到最初状态[26]。
脉搏波是心脏的收缩和舒张沿动脉向四周传递而形成的，其传播特点与心脏射血 能力、血管粗细、血管壁弹性、血液粘稠度等有关。因此，在脉搏波中包含着大量的 人体心脏和血管等人体系统的病理和生理信息。典型的脉搏波如图 2.1 所示。
a b

d c

1

2

图 2.1 典型的脉搏波波形
图 2.1 中的 1 表示脉搏波的上升支，代表心室的快速射血周期，表现为上升快速 且平滑，上升的速度与心室的射血能力以及动脉血管的阻力和血管壁的弹性有关，占 整个脉搏波波动周期的时间比较短，图 2.1 中 a 点所处的位置为心室射血结束，紧接 着主动脉关闭，进入下降支。2 表示脉搏波的下降支，是心室射血到下一次射血开始

7

前的一段时期，占整个脉搏波动周期的时间比较长，a 点之后，主动脉内血流向主动 脉瓣方向反向流冲击主动脉瓣，因瓣膜关闭不能进入心室，因而又退回到主动脉，过 程类似潮汐，因此称为潮波，又称为重波前波，如图 2.1 中 b 所示。c 点为重波波谷， 又被称之为降中峡，它的形成是因为心室收缩完毕、舒张开始，此时主动脉内血流趋 向回流，即血流向主动脉瓣方向反向流动，因此在急速降低的脉搏波的降支形成一个 切迹。d 点为重搏波峰。在心室射血期缓慢下来后，心室慢慢舒张，室内的压力很快 降低到明显低于主动脉的脉压，主动脉内的血流开始向心室方向反向流动，因主动脉 瓣关闭，血流逆流冲击主动脉瓣，但因瓣膜关闭血流不能流入心室，只能向主动脉退 去，因此造成动脉内的压强在突然降下后，很快的上升，动脉管壁亦随之稍有扩张， 因此，在下降支的终端形成一个小波[27]。
PPG 信号（PhotoPlethysmoGraphy）是通过光电容积脉搏波描记法得到的脉搏信 号，光电容积脉搏波描记法是一种通过光电方法在人体组织中观测血液的容积变化的 无创监护观测方法[7,28]。基本原理为：当光照射到人体组织的时候，肌肉、皮肤、骨 骼、脂肪、水、静脉血等对光的吸收度是一个固定的量，而由于心脏的舒张与收缩， 导致血管中血流量呈现搏动性变化，血流量的变化使得光在血液中的吸收量也呈现周 期性的变化，所以接收端光的强度大小能反映心脏的搏动情况。当心脏收缩时，人体 外周血容量变大，光吸收量也变大，检测到的光强也会变小，当心脏收缩时，血容量 变小，光吸收量也变小，检测到的光强变大。将检测到的光信号转化为电信号，便可 得 PPG 信号[29]。
根据获取光波的途径不同，PPG 信号的获取方式分为透射式和反射式两种。透射 式方法是将发光装置和接收装置置于待测组织的两端，在组织一侧光源发出特定波长 的光，在另一侧光电传感器检测透射出来的光，如图 2.2（a）所示。反射式方法是将 发光装置和接收装置于待测组织的同侧，在组织一侧光源发出特定波长的光，在同侧 的光电传感装置接收到经过血液吸收后的路径类似“香蕉型”的散射光，如图 2.2（b） 所示。常见的透射式传感装置为指夹式光电传感器探头。透射式的光电传感装置只能 放置于较薄的组织部位，测量部位受到局限，且用指夹式传感器对人体长期监测时， 会给人体带来不适感。反射式监测方法最大的优势在于不受测量位置的影响，可以安 置在手臂、额头、手腕、脚背等部位，而且相比透射式传感器而言，测量更加方便和 舒适。
8

发光

发光管

接收管

手指

体表

接收
（a）透射式检测法示意图（b）反射式检测法示意图 图 2.2 光电容积脉搏波的两种监测方式
2.2 心率检测原理及方法
2.2.1 心率检测原理
心率即心脏在每分钟搏动的次数，用来表示人的心脏搏动节奏的快与慢。安静非 运动状态下正常人的心跳速度通常为 60 次/分钟到 100 次/分钟，大多数人为 60 到 80 次/分。通常，女性个体的心率比男性个体的心率要稍微快一些，小孩的心率比大人的 要快，老人的心率一般偏慢[30]。心率与心脏功能息息相关，对心率的检测是判断心脏 病最有效的手段。此外，对心率的实时检测有助于控制运动量和运动强度。从光电容 积脉搏波中提取心率的原理为：当特定波长的光照射到活体组织，由于心脏的舒张与 收缩，导致血管中血流量呈现波动性变化，血流量的变化使得光在血液中的吸收量也 呈现周期性的变化，因此，接收端得到的 PPG 信号能够反应心脏的搏动情况，因而可 以从 PPG 信号中提取心率。单纯测脉率时，常使用绿色 LED 光作为入射光。当我们 提及脉搏波时，其通常都取自动脉。脉率可定义为每分钟脉所搏动的次数，通常情况 下其值等同于心率[30]。心动周期表示为心脏的单次活动所用时间，即一次收缩和舒张。 心动周期的存在产生脉搏，其机理表现为心室的变化会使动脉内的压力产生周期性改 变，从而导致动脉发生扩张和回缩这种规律性动作。 2.2.2 心率检测方法
从 PPG 信号中提取心率的常用的方法有： 1. 时域法：该方法通过分析光电容积脉搏波时域信号，根据信号特点，提取信 号中的特征点，进而求得信号周期，最终得到每分钟的心率值[31]。信号中特征点包括 波峰、波谷、最大值、最小值、主波、重搏波等。微分阈值法利用光电容积脉搏波的
9

形态特征，通过微分计算将陡立上升沿显现出来，得到信号周期，最终得到心率；过 零点法采用低通性质的平滑函数对 PPG 信号作不同频率带宽的滤波，再通过检测信号 的一阶导数模极大值与二阶导数过零点来得到边缘特征。其他数字处理方法例如：自 适应 AR 模型、相干平均法、模式识别等方法。时域法计算量小，实时性强，但是稳 定性以及抗干扰性很差，对于运动干扰几乎无能为力。
2. 频域法：该方法主要通过离散傅里叶变换，将时域信号转变到频域进行处理。 光电容积脉搏波信号中各频率成分及其能量分布是有差异的，因此可以从频谱中提取 与人体的心率对应的频率成分，最终得到心率[22]。因为是在频域中对信号各频率成分 进行分析，因此心率成分和运动成分等干扰成分很可能被分开，因此频域法较时域法 而言，具有更强的抗干扰性。

2.3 血氧饱和度检测原理及方法

2.3.1 血氧饱和度的概念

氧气是人体必需成分，新陈代谢离不开氧气。氧气通过肺部呼吸活动，与红细胞
中的血红蛋白相结合成为氧合血红蛋白（ HbO2 ），通过血液将氧气提供给身体各部位 器官和细胞，供人体新陈代谢。血氧饱和度( SpO2 )定义为血液中被氧结合的氧合血红 蛋白的容量占全部可结合的血红蛋白容量的百分比[32]。如公式（2.1）所示：

SpO2

=

CHbO2 CHbO2 + CHb

×100%

(2.1)

其中， CHbO2 和 CHb 分别为氧合血红蛋白浓度和还原血红蛋白浓度。 血氧饱和度用以评价血液中血红蛋白携带氧气的能力，一般来说，人体血液中氧

的成分愈多，人新陈代谢的能力会愈强，人体正常动脉血的血氧饱和度为 98%。除了

氧合血红蛋白和还原血红蛋白，人体中还含有少量特殊血红蛋白，包括碳氧血红蛋白 （ CoHb ）、高铁血红蛋白（ MetHb ）等。血氧饱和度还有另外一种定义方式，如公式

（2.2）所示，指氧合血红蛋白浓度与所有总血红蛋白浓度的百分比，又叫自然饱和度。

SpO2

=

C HbO2

C HbO2 + CHb + CCoHb

+ CMetHb

×100%

(2.2)

其中， CHbO2 、 CHb 、 CCoHb 和 CMetHb 分别为氧合血红蛋白浓度、还原血红蛋白浓度、碳 氧血红蛋白浓度和高铁血红蛋白浓度。

相比氧合血红蛋白浓度和还原血红蛋白浓度，碳氧血红蛋白和高铁血红蛋白浓度

10

很低，基于这一事实，临床上一般采用公式（2.1）确定血氧饱和度，评估人体血液中 氧气的含量百分比。 2.3.2 朗伯-比尔定律

血氧值的检测以朗伯比尔定律（Lambert-Beer）以及扩散传输理论为基础[33,34]。

从朗伯比尔定律可知对均匀介质，吸收光强度百分数与吸收物质、照射的光源波长和

介质纵截面的深度有关。当吸收介质的密度为常值时，那么接收到的光的强度与介质

纵截面的深度可表示为一种指数模式。

皮埃尔布格在 18 世纪对光子的吸收力度与介质纵截面的深度作了一定推断。1760

年，约翰海因里希朗伯对上述关系进行较为深入的阐述。1852 年，奥古斯特比尔对光

子的吸收能力和介质的密度之间的关系进行思考，并得到相近结论。将上述理论整理

便形成著名的布格-朗伯-比尔定律，简称朗伯-比尔定律[35]。

设入射到媒质中的入射光强 Iin ，检测到的出射光强为 Iout ， μa 为物质对光的吸收 系数， L 为光路长度。则入射光强、出射光强、吸收系数以及路径长度之间的关系如

下：

Iout = Iine−μaL

(2.3)

1852 年，比尔导出了一个描述吸收光强和吸收的物质分子数之间的关系公式，他

提出：

Iout = Iine− ECL

(2.4)

对上式进行变形，

l n(Iin / Iout ) = ECL

(2.5)

其中 E 为受试物体的消光系数， C 为介质内物体的浓度， L 光路径长。　 同理，当有光源照射到皮肤血液里血红蛋白会对光子产生吸收，其实质遵从朗伯

比尔定律，故能利用出射光的强度处理获取相关的血液参数。然而在人体的组织中，

血液在吸收光子之余，肌肉等成分也会贡献吸收的静态部分。在血液中，红细胞为对

光子产生吸收以及散射的决定性成分。除此之外，这些组织存在散射效应，导致光进

入组织之后，出现了散射现象，也就是说，接收端接收到的出射光并不是入射光沿着

理想中的路径被组织吸收部分光后剩下的光强，在这一过程中光路径得到了加长。基

于此，朗伯比尔定律可进一步修改为：

I out

=

I e− EBCL+G in

(2.6)

11

或

lg(Iin / Iout ) = EBCL + G

(2.7)

其中， B 称为路径因子，表示由于人体组织对入射光散射导致光路的增加，用于描述 散射引起的光学路径的增加，与特定波长的入射光的吸收系数和散射系数有关。G 为 背景光干扰因子，表示背景引起的损耗。
修正的朗伯比尔定律是通过对光的散射理论与朗伯比尔定律相融合。修正后的朗 伯比尔定律在对照射到组织上的入射光强和出射光强判定更为精准，在透射式的血氧 饱和度检测中已有很长的应用，同时在反射式也能够提出较为完善的测量方案。

2.3.3 血氧饱和度检测原理

首先介绍透射式血氧饱和度的检测原理。在对血氧进行透射式检测时，入射光和

出射光位于待测组织的两侧，利用检测透过人体组织的光强变化以实现血氧的估计。

如图 2.3 所示，入射光进入组织后，要经过骨骼、肌肉、静脉血、动脉血等组织成分。 从图 2.3 中我们可以观察到静脉血、非脉动动脉血成分及骨骼肌肉等其他组织对入射 光的衰减效应相对比较恒定，光经过这些组织成分后形成了出射光的平稳部分，成为

直流分量（DC）。脉动动脉血引起脉搏波变化，形成出射光的的脉动部分，成为交流
分量（AC）。光电容积脉搏波信号的波谷点光强记为 Imin ，该点处血管充盈程度最大， 脉动动脉血对光的吸收作用最明显，因此接收到的光强最弱；波峰处光强记为 Imax ，
入射光没有被脉动动脉血吸收，故此时接收到的光强最强。

入射光 Iin

其他组织

静脉血

非脉动动脉血

I max

出射光

I min

脉动动脉血 Io=Imax
脉动部分
平稳部分

图 2.3 透射式检测模型原理图
12

依据朗伯比尔定律，当光强为 Iin 的单色光照到人体组织，透射光光强可写为：

I = I e e e −ε0C0 L −ε HbO2 CHbO2 L −ε HbCHb L

DC

in

(2.8)

其中， ε0 、 C0 、 L 分别为静态组织成分的吸光系数、光吸收物质浓度以及光路径长 度，ε HbO2 、CHbO2 分别为动脉血液中氧合血红蛋白对光的吸收系数以及光吸收物质浓 度， ε Hb 、 CHb 为动脉血液中还原血红蛋白对光的吸收系数以及光吸收物质浓度。
因为心脏搏动引起血管产生相应的改变，此时光路径长度从原来 L 增多 ΔL ，光

强从 I DC 变为 I DC − I AC ，则有：

I − I = I e DC

AC

− (ε HbO2 CHbO2 +ε HbCHb ) ΔL DC

变形后可写为：

(2.9)

ln[1 +

−I AC I DC

]

=

ε −( C HbO2 HbO2

+ ε C Hb Hb )ΔL

(2.10)

由于在透射光中交流成分所占的比例很小，远远小于 1，因此，结合数学公式

（2.11），公式（2.10）可改为公式（2.12）。

lim ln(1 + x) = 1

x→0

x

(2.11)

ln[1+ −I AC ] = − I AC

I DC

I DC

(2.12)

最终得到透射式光电容积脉搏波吸光模型如下：

I AC I DC

ε = ( C HbO2 HbO2

+ ε HbCHb )ΔL

(2.13)

假设两束光的波长分别为 λ1 和 λ2 ，令

， Dλ1

=

I λ1 AC
I λ1 DC

Dλ2

=

I λ2 AC
I λ2 DC

(2.14)

则有：

λ1

λ1

λ1

λ1

λ1 λ1

D I / I ε C + ε C λ1

AC DC

HbO2 HbO2

Hb Hb

= = λ2

λ2

λ2

λ2

λ2 λ2

D I / I ε C + ε C λ2

AC DC

HbO2 HbO2

Hb Hb

(2.15)

代入血氧饱和度的计算公式，可得：

SpO2

=

(ε λ1 HbO2

ε λ2 Hb

( Dλ1

/

Dλ2

)

−

ε

λ1 Hb

−

ε

λ1 Hb

)

−

(ε

λ2 HbO2

−

ε

λ2 Hb

)

( Dλ1

/

Dλ2 )

(2.16)

13

选取

λ2

为等吸收点，则有

ε

λ2 HbO2

=

ε

λ2 Hb

，于是，上式可变为：

ε ε ε ε ε ε SpO2 =

λ1

Hb

− λ1

λ1

− Hb

HbO2

λ2

Hb

− λ1

λ1

Hb

HbO2

Dλ1 Dλ2

(2.17)

其中、，

ε

λ1 Hb

、ε

λ1 HbO2

、ε

λ2 Hb

可看作是常数，可以通过光谱分析法获得，考虑到不同的发

光二极管表现不尽相同，不同受试个体也存在区别，这些原因使得三个值无法准确确

定，故市面上的血氧饱和度检测仪器会利用经验公式，经验公式由能获取的实验数据

和理论数值，经过繁多的统计处理从而得出，我们令

ε ε ε ε ε ε A =

λ1

， Hb

− λ1

λ1

Hb

HbO2

B=−

λ1

Hb

− λ1

λ1

Hb

HbO2

(2.18)

则血氧饱和度的计算公式可写为：

SpO2

= A+B

I λ1 AC
I λ2 AC

/

I λ1 DC

/

I λ2 DC

(2.19)

将

I λ1 AC
I λ2 AC

/ /

I λ1 DC
I λ2 DC

记作

R，则血氧饱和度的计算公式可以写为：

SpO2 = A + B R

(2.20)

在实验测定中，不同人体间组织的性质不同，并且存在光反射，这种情况的引入

以及市面上现有的无创血氧仪测定所利用的计算模型，即对血氧值与两路光波接收强

度间数据的大量学习，研究其关系，推导出改进的血氧饱和度经验公式即为该生理参

数的计算表达式。

SpO2 = A + B R + C R2

(2.21)

其中 A、B、C 均为固定值，其可利用实验室相应血氧仪进行回归分析进行确定。 根据推导可知，血氧饱和度的测量需要两路不同波长的光作为入射光。氧合血红
蛋白与还原血红蛋白对不同波长入射光吸收程度并不相同，图 2.4 为氧合血红蛋白和 还原血红蛋白对不同波长光的吸光系数曲线。对吸光系数曲线进行分析，我们可以得 到以下结论：当入射波长在 600nm 到 700nm 时，两种血红蛋白吸光系数差距较大， 入射波长在 920nm 到 980nm 时，两种血红蛋白的吸光系数保持恒定，且差值比较稳 定。原理推导中要求一路入射光的波长对两种血红蛋白吸光系数相等，其中 805nm 处 为等吸收点，但是其左右区域两种血红蛋白吸光系数变化大，因此不适合选取等吸收 点为实验波长。在 940nm 附近，曲线的变化较小，且吸光系数也很接近，所以选用

14

940nm 更合适，另外一路光波选在 660nm 处，因为此时两种血红蛋白对光的吸收程度 区别较大[36]。

吸光系数

660nm

940nm

1.20

0.90

还原血红蛋

0.60

0.30

氧合血红蛋

0.00 600

700

800

900

波长（nm）

1000

2.4 氧合血红蛋白与还原血红蛋白对不同波长光的吸光系数曲线

以上介绍透射式的测定原理，下面介绍反射式的测定原理。根据光的散射理论，

光进入组织中，并不会完全别组织吸收，而且会出现散射现象，一部分光经过多次散

射后回到与发光管同侧的组织表面，通过检测接收到的反射光的强度变化进而求得血

氧值。

利用扩散传输理论，规定在组织 R 处，时刻 t 的光子散射方程表示如下：

1 c

∂ ∂t

Φ

(

r,

t

)

−

D∇

2Φ

(

r,

t

)

+

μα

Φ

(

r,

t

)

=

S

(

r,

t

)

(2.22)

其中，Φ (r, t ) 是 (r, t ) 处的光密度，μα 是吸收系数，S(r, t ) 是光源量，c 是光速，D 表
示扩散系数。根据公式（2.23）可推导得到反射式光强公式：

R(ρ,t)

=

( 4π

) Dc

−

3 2

z0t

−

5 2

exp

 



−

ρ 2 + z02 4Dct

  

(2.23)

ρ 等于光敏检测器与发光点的间距。对上式变形得：

∂ ∂t

lnR

(

ρ,

t

)

=

−

5 2t

( − μα

c)

+

−

ρ 2 + z02 4Dct

当时间足够长时，有：

lim
t→∞

∂ ∂t

lnT

(

ρ

,

d

,

t

)

=?−

μα

c

(2.24) (2.25)

15

通过上式我们可以看出，反射光强与吸收系数的关系可表示为一种正比形式，这

个关系可由公式表示，故从高层面分析，在讨论反射以及透射光强时，可认为在吸光

性表现上两者是等同的，从而在推导血氧饱和度结果时，反射式的计算公式可以由透

射式得来。

W = −μac

(2.26)

SpO2

= A+B

I λ1 AC
I λ2 AC

/

I λ1 DC

/

I λ2 DC

(2.27)

2.4 本章小结

本章主要了介绍了从光电容积脉搏波中提取心率和血氧饱和度的原理和方法。首 对脉搏波和光电容积脉搏波做了概述，然后介绍了心率检测原理和方法，接着，对血 氧饱和度检测原理和方法做了介绍。其中包括血氧饱和度的概念、朗伯比尔定律、透 射式血氧饱和度监测的基本原理和反射式血氧饱和度监测的基本原理，并给出了公式 的推导过程。

16

第 3 章 基于时变自回归模型的抗运动心率及血氧提取算法
3.1 运动干扰的引入
PPG 信号易受到干扰的影响，这些干扰大大降低心率检测和血氧饱和度检测的准 确性。如何获得高质量的 PPG 信号、减小干扰对检测结果的影响，成为重点解决的问 题之一。这些影响主要源自环境光和暗电流带来的干扰、工频干扰、基线漂移、电磁 干扰、运动干扰[26]。
由于 PPG 信号的检测是以光电检测为基础的，因此周围环境的杂散光、暗电流会 对检测系统产生影响，对于环境光和暗电流的影响，可以通过改进探头结构、制作工 艺、采用光调制技术改善。工频干扰是由 50Hz 及其谐波分量所组成的，幅度和频率 在一定环境下基本不变，对于工频干扰，通常采用低通滤波器或陷波器消除。基线漂 移往往由于人的呼吸和身体移位产生，频率为 0.15~0.3Hz，可以通过高通滤波器、小 波变换、三次样条差值等方法去除基线漂移。电磁干扰包括电子仪器本身的噪声和其 他设备的干扰，常常通过采用电磁屏蔽低噪声、高共模抑制比电路减小电磁干扰对 PPG 信号的影响。除了这些干扰外，运动干扰是影响测量准确性的非常重要的原因。 由于运动干扰非常复杂，且干扰的频率范围常常和正常心率范围相互重叠，不易消除， 这给心率和血氧的提取带来很大的困难。运动干扰的消除长期以来也是脉搏心率仪、 血氧仪设计中的重点和难点。
PPG 信号的心率提取中，用于减少运动干扰影响的技术很多，包括傅里叶分析法、 自适应去噪法、加速度信号消噪法、时频分析方法、小波变换、独立成分分析、经验 模态分解等。实际心率实时检测时，干扰情况复杂[37]。对于干扰强度小、变化缓慢的 信号，现有方法去噪效果较好，但是在强烈运动干扰存在时，PPG 信号中往往包含突 变波形，如图 3.1 所示，方框中的 PPG 信号存在明显的突变，在这种情况下，这些方 法去噪效果并不理想[21]。
为了更好地研究运动干扰对心率测量的影响，我们从频域的角度对 PPG 信号的心 率成分和运动成分作了分析。
静止状态下的 PPG 信号的频率成分主要有基波、二次谐波、三次谐波。如图 3.2 所示，峰值最高的为基波，对应心率值，除了最高峰之外，还有两个比较明显得峰值
17

为二次谐波和三次谐波。
图 3.1 运动情况下 PPG 信号
图 3.2 静止测得的 PPG 信号频谱
然而，在运动干扰情况下，PPG 信号的频谱中频率成分多变，本研究通过对大量 实测 PPG 数据的分析，给出了几种典型的运动干扰 PPG 信号的频谱，如图 3.3 所示。 图 3.3(a)图、(b)图中运动干扰强度较小，对应的频率成分幅值低于心率成分对应的幅 值，直接选择最大峰值对应的频率即可作为心率。(c)图、(d)图、(e)图中运动强度大，
18

对心率的提取产生较大的影响。(c)图、(d)图中心率峰附近干扰较多，干扰峰幅值大， 直接选取最大峰对应频率作为心率显然是不适用的。有些情况下，心率成分甚至会湮 没在运动干扰中，如图(e)所示，此时无法从频谱中直接提取心率。
综上所述，实际测量中运动干扰强度大、成分复杂，且在很多情况下，运动干扰 成分与正常心率频带会出现重叠，频谱中心率对应的频率成分有时会被噪声淹没，或 者与干扰成分接近，当 PPG 信号包含突变时，频谱中各成分显得更加复杂。此时，如 果对整段信号作整体的频谱分析来提取心率显得十分困难。通过大量数据分析，我们 发现，运动干扰下，时变分析法更适用于 PPG 信号的分析。

X: 80.57 Y: 1
1

心心运

归归归归归归

0.8 X: 62.26
Y: 0.8532
0.6

运运运

0.4

0.2

0 0 50 100 150 200 250 300 350 400 450 500
次/分
(a)

归归归归归归

1
X: 80.57 Y: 1
0.8
0.6

心心运

X: 285.6 Y: 0.6989

运运运

0.4

0.2

0 0 50 100 150 200 250 300 350 400 450 500
次/分
(b)

19

归归归归归归

1
运运运
0.8

X: 128.2 Y: 1

0.6
心心运
0.4

0.2

0

0

50 100 150 200 250 300 350 400 450 500

次/分

(c)

1

0.8

运运运运

0.6 0.4
运运运运 0.2

心心运

0

0

50 100 150 200 250 300 350 400 450 500

次/分

(d)

归归归归归归

归归归归归归

1
X: 135.5 Y: 1
0.8

运运运

0.6

0.4
X: 146.5 Y: 0.2272

0.2

真真心心真真真

0

0

50 100 150 200 250 300 350 400 450 500

次/分

(e)

图 3.3 典型的运动干扰 PGG 信号频谱

20

3.2 多小波基函数展开的时变自回归模型

PPG 信号特性往往随着时间改变，因此，可引入时变模型来处理。基于参数扩展 的时变自回归模型，被广泛用于解决工程中随时间变化的问题。Wei H L[38]等人提出 基于多小波基函数展开的时变自回归（time-varying autoregressive model, TVAR）模型 方法。该方法利用了小波函数多分辨率特性以及平滑小波基和非平滑小波基函数的优 良特性，因此，该方法在信号突然变化或分段变化时体现出明显的优势，同时适用于 缓慢变化和快速变化的信号。
本章详细介绍了本文要引入的基于多小波基函数展开的时变自回归模型，包括系 数的展开、多小波基函数的选择、模型参数估计和谱估计，并构建仿真信号，验证该 方法在处理时变信号方面的效果。
3.2.1 时变自回归模型及系数展开

时变系统的参数模型识别有很多应用，比如说，地震分析、语音处理和生物医学

系统。大多数系统识别方案是基于线性时不变或者平稳的，但现实中，存在着大量的

非平稳信号，因此针对非平稳信号的研究越来越多。

非平稳随机过程可由时变自回归（TVAR）模型描述。信号 y(t) 的 p 阶 TVAR 模型， TVAR(p)可由下式表示：

p

y(t) =  ai (t) y(t − i) + e(t)

(3.1)

i =1

其中， ai(t)是时变系数， e(t ) 代表模型的误差，可看作均值为

0，方差为

σ

2 e

的平

稳白噪声序列。

应对时变信号的追踪有很多方法，主要分两类：自适应递归的方法和基函数逼近

的方法。自适应递归算法包括最小均方误差算法、递归最小二乘法以及卡尔曼滤波器，

它可以跟踪时变信号但要求随机变量是缓变和平滑的。传统的自适应滤波器不能跟踪

跳变，每次跳变之后，都需要一定量的训练数据性能才能稳定。基函数逼近的方法是

将时变参数在预定义的有限基函数序列展开，然后时变参数估计问题就转化为时不变

参数的估计问题。如果基函数选择合适的话，这种方法可以有效地跟踪随机过程的参 数变化甚至是跳变的问题[38]。
将时变自回归模型中的时变系数 ai(t) 用一系列基函数{πm(t) : m =1,2,, L}进行展
开，展开如下：

21

L
 ai (t) = ci,mπm(t) m=1

其中，πm(t)为标量函数， ci,m为时间无关的常系数。
将上式带入时变自回归模型 TVAR(p)中，则 TVAR(p)可表示为：

pL

 y(t) =

ci,mπm(t)y(t −i) + e(t)

i=1 m=1

其中，

π (t) = [π1(t),π 2 (t),π L (t)], xi (t) = y(t − i)π (t), x (t) = [x1(t), x2 (t), x p (t)], ci = [ci,1, ci,2 ,ci,M ], c = [c1, c2 ,c p ]。

则等式（3.4）可以表示为：

y(t) = x(t)cT +e(t)

(3.2) (3.3) (3. 4)

其中，cT 表示矩阵 c的转置。此时，包含时变参数 ai(t)的时变自回归模型转化为系
数为常数 cT 的标准线性回归模型，可以被当作时不变模型求解。

3.2.2 多小波基函数展开

基函数展开的时变参数模型问题中，如何选择基函数以及如何从选定的基函数中

选择特定的函数是需要考虑的问题。

小波变换具有出众的多分辨特性和捕捉时变系统的全局和局部特征的优点，因而

被选为基函数[39]。然而，不同的小波函数也具有不同的特性。例如 B 样条小波[40]（如

图 3.4 所示）。一阶和二阶 B 样条小波函数是不平滑的分段函数，因此在系数发生瞬

变和突变时逼近性能较好。高阶的 B 样条函数适合应对平滑变化。因此，如果选取 B

样条小波集作为分解的函数基，该模型对于突变和缓变都有较好的拟合效果。

而事实上，B 样条多小波基除了阶数的选择还需要选择平移因子 k 和伸缩因子 l ，

多小波基可表示为如下：

π m (t ) = π m,l,k (t ) = 2l/2 Bm (2l ⋅ t − k )

(3. 5)

其中， m 为所选的 B 样条阶数，一般选择 1~4 阶即可同时应对瞬变和缓变。 l 为
伸缩因子，取值范围选 [l0 , lmax ] ，且 lmax = [log 2 (Mfmax )] ， fmax 为信号的最大频率，
{ } M = 10~ 20 。平移因子 k 的取值范围是 k : −m < k ≤ 2l 。
基于多小波基函数展开的时变自回归模型法就是将时变系数由一系列 B 样条小
波基函数多尺度展开。例如，采用 3 阶、4 阶、5 阶的 B 样条小波基函数对公式（3.1）

22

归 一 B样 样 样 样 样 1.5

二 一 B样 样 样 样 样 1.5

1

1

0.5

0.5

0

0

-0.5

-0.5

0

2

4

6

0

2

4

6

三 一 B样 样 样 样 样 1.5

四 一 B样 样 样 样 样 1.5

1

1

0.5

0.5

0

0

-0.5

-0.5

0

2

4

6

0

2

4

6

五 一 B样 样 样 样 样 1.5

六 一 B样 样 样 样 样 1.5

1

1

0.5

0.5

0

0

-0.5

-0.5

0

2

4

6

0

2

4

6

图 3.4 各阶 B 样条小波

中时变系数 ai (t) 多尺度展开为：

   ai

(t)

=

k∈Γη

α φ (η ) (η ) i,k k

(

t N

)

+

k∈Γr

α φ (r ) (r ) i,k k

(

t N

)

+

k∈Γs

α φ (s) (s) i,k k

(

t N

)

(3. 6)

其中，

φ

( k

m

)

(

x

)

=

2

j/2

Bm

(2

j

x

−

k)

是

B

样条多小波函数集，m

为所选定的

B

样条阶

数，这里取 m=3，4，5，则对应η = 3 ， r = 4 ， s = 5 ， Bm 是 m 阶 B 样条小波基函数，

{ } Γm = k :− m ≤ k ≤ 2 j −1 , j 和 k 分别为伸缩因子和平移因子。 t = 1, 2,, N , N 是观测信

号的总长度。αi,k 是扩展系数。将公式（4.6）代入到（4.1）中，则公式（4.1）可写为：

  y(t)

=

p i=1

  k∈Γm

α

(m i,k

)

(φk(

m)

(

t N

)

y

(t

− i)) + e(t) 

(3. 7)

从上式可以看出，时变自回归模型可由一系列与时间无关的系数 ai,k 和小波基函数 表示，常量系数代替了之前的时变系数，从而使信号有了时不变的特性。这样我们将 时变系数求解问题转化为与时间无关的参数估计问题。

3.2.3 模型参数估计和谱估计

公式（3.7）是标准线性自回归模型，可用正交最小二乘算法（orthogonal least

squares）求解[41]。该算法在解决多尺度动态回归问题中显示出优越性。我们令等式

（3.1）中的时变系数

ai

(t)

的估值为

aˆi

(t)

，

σ

2 e

的估值为

σˆ

2 e

。则对应时变自回归模型的

时间相关谱函数可由下式表示

23

 H（f , t）= 1−

σˆ

2 e

p i =1

aˆi

(t

)e−

j

2π

if

/

f

s

(3.8)

其中， fs 是采样频率， j = −1 。 这里，“多小波”有两层意思。其一，时变系数展开用了不同类型的小波基函数

（例如使用多阶 B 样条小波函数）。其二，时变系数的展开同时利用了小波多解析度

的特性，用不同尺度的小波进行展开。该方法对于平缓变化和突变的信号都可以实现

有效跟踪。

图 3.5 给出了仿真结果。图 3.5（a）所示为一段仿真信号，该信号由公式（3.9）

表示。该信号前半段和后半段信号频率分别为 1.5Hz 和 3Hz。第 4s 信号频率改变。

用基于多小波展开的时变自回归模型法对仿真信号作时频分析，图 3.5（b）给出了时

间相关谱的二维图。从图 3.5（b）中我们可以清晰地看到仿真信号的频率随时间的变

化，前 4s 信号频率在 1.5Hz，后 4s 信号频率在 3Hz 左右。仿真结果证明，基于多小

波基函数展开的时变自回归模型方法能够有效反映非平稳信号频率随时间的变化。

s(t)

=

5

 

t

sin(2π f1 t), sin(2π f2 t),

0≤ t < 4 4≤ t ≤ 8

(3.9)

归归 频心/Hz

仿真仿仿 10

5

0

-5

-100

2

4

6

8

时时/s

(a)

时时时时时

10

9

8

100

7

6

80

5

4

60

3

2

40

1 00 1 2 3 4 5 6 7 8

20

时时/s

(b)

图 3.5 仿真结果（a）仿真信号（b）时间相关谱的二维图

3.3 基于时变自回归模型的抗运动心率提取算法

本研究引入基于多小波基函数展开的时变自回归模型，同时结合快速傅里叶变 换，并利用加速度信号，提出一种基于时变模型的抗运动干扰心率提取算法。算法流 程图如图 3.6 所示。本文提出的心率提取算法首先利用加速度信号对 PPG 信号进行状

24

态分类，分为静止 PPG 和运动 PPG。对于静止 PPG 信号，本文提出均值交点法计算

心率，此算法计算量小，用于心率日常监测设备将大大减少功耗。对于运动 PPG 信号，

算法分成三部分：信号预处理、信号分段和谱峰搜索。首先对采集的 PPG 作预处理，

包括带通滤波和滑动平均率滤波。去除正常心率范围之外的噪声和部分高频噪声，同

时使信号更平滑。然后利用基于多小波基函数展开的时变自回归模型方法，对 PPG 信

号进行时频分析。然后，根据频率随时间的变化特征，将 PPG 信号分段，分成不同的

时间段。对于每段信号，各个时刻对应的信号频率变化不大，信号保持稳定。分段结

果能够将未受到运动干扰的 PPG 和受到运动干扰的 PPG 信号分开，将不同频率的信

号分开，将平稳变化的信号和突变的信号分开。最后，对每段信号作 FFT，通过频域

分析获得所有可能的心率值，并利用加速度信号对可能的值作最优选择，得到最终心

率估计值。

静止 带通滤波 PPG 平滑滤波

提取 PPG 均值线

提取均值线与 PPG 上升沿交点

确定 心率

PPG 信号 状态分类

加速度信号

运动 带通滤波 PPG 平滑滤波

TVAR 时 频分析

带通滤波 平滑滤波

一阶差分 分组标准差

加速度信 号去干扰
谱峰搜索

确定 心率

信号分段

快速傅里 叶变换

信号分段模块

谱峰追踪模块

3.3.1 信号状态分类

图 3.6 抗干扰心率提取算法流程图

为了减少运算量，在滤波之前，我们引入了加速度信号对信号进行状态分类。加 速度传感器内置于脉搏传感器旁边，可以反映人体运动情况。因此，利用加速度信号， 我们可以初步将信号分为两类：运动状态和非运动状态。PPG 信号用 yPPG (t) 表示，加
25

速度信号用 yACC (t) 表示。根据公式（3.11）和公式（3.12），我们将信号进行状态分类， 并用 Still _ Index 表示。当 Still _ Index 为 1 时，表明处于非运动状态，当 Still _ Index 为 0 时，表明处于运动状态。

N
（y(i) − y）2
S = i=1 N

(3.11)

Still

_

Index

=

1,  0,

S-3y ≤ 0 S-3y > 0

其中， y 为固定时间窗内 PPG 信号的均值。

(3.12)

图 3.7 信号状态分类结果图
如图 3.7 给出了信号状态分类结果图。其中包括原始 PPG 信号，某个轴的加速度 信号，以及 Still _ Index 的值。Still _ Index 为 1 时，被测者处于静止状态，当 Still _ Index 为 0 时，被测者处于运动状态。对应关系可从加速度信号中得到充分反映。通过加速 度信号，我们对被测者状态进行了初步地分类。这样做的目的有两个。一是降低运算 量。对信号状态进行分类后，我们对静止状态的信号就可以用较为简单的算法。因为 静止状态测得的 PPG 信号质量较好，无运动干扰，用较为简单的算法就能准确地求得
26

心率。如果对静止状态的 PPG 信号都应用抗干扰算法，会增加运算量，设备功耗也会 增加。通过状态分类，我们只需要对运动状态下测得的 PPG 信号应用抗干扰心率测量 算法即可。二是有利于心率测量结果重新置位。对状态分类后，我们可以清楚地识别 出静止状态的信号时段，在静止状态，心率测量结果有较高的可信度。即使前一时刻 计算结果有一定偏差，如果当前时刻我们认定为是静止的 PPG 信号，那么此时从 PPG 信号中提取的心率值即为当前时刻最终的心率，而无需进行可能性判断，直接对心率 测量结果置位即可。 3.3.2 静止状态心率计算
当为静止状态时，我们采用计算量较小的算法求心率。本文提出的均值交点法能 够以非常小的运算量在静止状态下的 PPG 信号中提取心率。算法流程图如图 3.8 所示。 静止状态检测到的 PPG 信号干扰较少，经过带通滤波和平滑滤波之后，信号比较平滑， 信号周期性非常明显，如图 3.9 所示。然后我们求 PPG 信号的均值，以均值作一条均 值线，求得 PPG 信号与均值线在上升沿的所有交点，如图 3.9 中圆圈标注的点即为均 值线与上升沿的交点。通过计算交点个数 k，我们可以求得心率周期，进而求得心率。

首点时刻 t1

带通滤波
平滑滤波
求 PPG 均值
PPG 与均值线在上 升沿交点个数 k

尾点时刻 t2

计算心率 HR=60 f = 60 (k −1)/(t2 -t1)
图 3.8 静止状态心率计算流程图

27

幅度

30

20

10

0

-10

-20

-30

-400

1

2

3

4

5

6

时间/s

3.3.3 信号预处理

图 3.9 静止状态下的 PPG 信号

无论是静止状态 PPG 信号还是运动状态 PPG 信号，原始 PPG 信号包含有明显基

线漂移、高频干扰、人体运动干扰等噪声。我们采用通带范围在 0.5Hz-5Hz（包含人

体心率正常范围 0.5Hz-4Hz[17]）的带通滤波器，将通带范围之外的噪声成分滤除。然

后用滑动平均滤波器对信号作平滑处理。

滑动平均滤波器是一种用来减少运动干扰简单又常用的方法，并且在一定的干扰

范围内效果是非常明显的。原理为对一组数据的每个点用周围几个数据的平均值代

替，具体方法是采用一个可以向前滑动的窗口，窗口内的第一个值用该窗口内所有数

据的平均值代替，将窗口依次向前滑动一位数，用同样的方法对下一个数据作滑动平

均，该过程可用用公式（3.10）描述。

 y[i] =

1

M −1
x[i +

j]

M j=0

(3.10)

其中，i 、 j 分为滑动窗口内信号的起点和终点的位置，M 滑动窗口内数据的总长度。

滑动平均滤波器能去除噪声中尖刺等突变干扰，使信号变得更平滑，提高信噪比。 与传统自适应滤波方法相比，滑动平均滤波器表现出更稳定的输出，然而，这种方法 不能解决突然的运动变化。
图 3.10（a）给出了一次固定时间窗内的原始 PPG 信号，经过预处理后的信号如

28

图 3.10（b）所示。预处理后，信号的高频噪声和低频噪声均被滤除，且信号变得平 滑。
本文采用滑动时间窗，通过对固定长度时间窗内的 PPG 信号处理得到一次心率结 果。将时间窗向前滑动一段时间，更新部分 PPG 数据，计算下一次心率。两次连续的 时间窗有一部分重叠时间域。
3.3.4 信号分段

对于运动干扰下的 PPG 信号，我们先对信号进行分段。信号分段的目的是将受到 运动干扰的 PPG 信号和无运动干扰的 PPG 信号分开，将处于不同频率段的信号分开， 将平稳变化的信号和突变信号分开。步骤如下：
（1）基于多小波基函数展开的时变自回归模型对信号中平稳变化的信号和迅速 变化的信号均能有效跟踪。我们用该方法对信号作时频分析，时频结果可用 F=[ f (1) ， f (2) ， ， f (N )] 表示（N 是时间窗内 PPG 信号的总长度），对图 3.10（b）中所示 信号作时频分析，时间相关谱的二维结果图如图 3.10（c）所示。从结果中可以看出 在第 4s 和 6s 处频率发生突变，在 0~4s/4~6s/6~8s 时间段内，频率变化平缓，对应波 形较平稳。
（2）对时间相关谱序列做一阶差分。差分用来突出序列中不连续或变化较快的 区域。差分结果记作 D=[ f (2) − f (1)，f (3) − f (2)，，f (N ) − f (N −1)] 。图 3.10（d） 给出了图 3.10（c）中时间相关谱序列的差分结果。
（3）根据公式（3.13）对差分结果分组作标准差,再利用阈值法对信号分段。将
差分结果序列平均分成 k 个组，求每组内序列的标准差，记作 Sdi ，i =1,2,k。再利
用阈值法，实现信号分段。本研究中取 k=50，分组标准差结果由图 3（e）所示。从 图中我们看到，第 25 组和第 38 组附近的标准差结果明显高于周围组的标准差结果， 通过对分组标准差结果设置合适的阈值，50 个组被分成三部分，分别对应 PPG 信号 0~4s, 4s~6s, 6s~8s 的数据。图 3.10（f）给出了第一段 t ∈ (0s, 4s) 的信号。

Sdi =

N
 y((m) − y)

m=1
N

, i = 1, 2,, k

(3.13)

其中， y 和 N 分别是对差分结果序列平均分组后，每组序列的均值和数据长度。 信号分段是本文算法的关键步骤。如果直接对时间窗内的 PPG 信号作整体频谱分
析，频谱中除了包含心率成分，还会有运动干扰等噪声成分。当运动干扰导致频谱中

29

幅度

200 100
0 -100 -200 -300
0
0.4 0.3 0.2 0.1
0 -0.10

500
采样真 (a)
500 采样真
(d)

幅度

40 20
0 -20 1000 -400
0.2

2

4

6

采样真

(b)

10

8

频率/Hz

6

4

2

8

00 1 2 3 4 5 6 7 8

时时/s

(c)

40

0.15

20

幅度

幅度

0.1

0

0.05

-20

1000

00 10 20 30 40 50 -400 100 200 300 400 500

组组仿

采样真

(e)

(f)

幅度

图 3.10 信号分段各步骤的示意图（a）一个时间窗内的原始 PPG 信号（b）预处理后的 PGG 信号 （c）时间相关谱的二维图（d）时间相关谱序列的一阶差分结果（e）分组标准差及信号分段结果
（f）分段后的第一部分信号

心率对应的谱峰低于运动干扰成分对应的谱峰，或者被运动干扰成分淹没时，在这种 情况下估计心率非常困难。本文方法中信号分段能够将包含运动干扰信号和未受到运 动干扰的信号分段，将处于不同频率段的信号分段，将平稳变化的信号和突变信号分 段。信号分段后，再分别对每段信号作频谱分析，原来频谱中频率成分较弱的心率对 应的谱峰会凸显，淹没在运动干扰成分中的频谱也会显现出来，从而降低运动干扰对 心率测量的影响，提高心率测量的准确性和抗干扰性。
以图 3.10（b）中的 PPG 信号为例，PPG 信号在开始阶段没有运动干扰，是较为 纯净的 PPG 信号，从大约第 4s 开始突然受到运动干扰的影响，导致 PPG 波形在 4s~6s 时间段内畸变。针对包含突变的一段 PPG 信号，如果直接对信号整体作 FFT，结果如 图 3.11（a）所示。图 3.11（a）中用圆圈标出了比较明显的谱峰，对应频率记作 f1 、 f2 、 f3 、 f4 、 f5 和 f6 。谱中最高峰对应频率为 f2 = 1.12 Hz ，而真实的心率为 f4 = 1.51Hz（真 实心率由同步采集的心电信号求得），最高峰对应的频率不是真实心率而是运动干扰 频率。事实上， f1, f2 , f3, f4 , f5 , f6 都可能作为心率值，在这种情况下，正确估计心率 并不容易。信号分段后，对第一部分信号作 FFT，结果如图 3.11（b）所示。此时，

30

正确心率对应峰值非常突出，且为最高峰。由此可见，信号分段非常重要，更有利于 心率的确定。

归归 归归

5000

4000

3000 f1 = 0.91 Hz
2000

1000

500

00

1

f2 = 1.12 Hz
f3 = 1.37 Hz f4 = 1.51 Hz (HR)
f5 = 1.71 Hz f6 = 1.90 Hz

2

3

4

5

6

频心 / Hz

(a)

1500

1000

500

00

1 1.51 2

3

4

5

6

频心 / Hz

(b)

图 3.11 FFT 频谱结果（a）整段 PPG 信号的频谱（b）信号分段后第一部分信号的频谱

3.3.5 谱峰追踪

对信号分段后的各段信号分别作 FFT 频谱分析，搜索所有的可能心率值，然后结 合加速度信号的频谱特征，从可能的心率值中估计正确心率。
加速度信号一定程度上能反映运动情况。其原理主要通过对加速度信号和受到运 动干扰的 PPG 信号之间的相关性进行分析，减小运动干扰对信号干扰的影响。本算法 谱峰追踪部分引入加速度信号，通过分析加速度信号的频谱，确定主要的峰值点对应 的频率及谐波频率作为运动干扰，然后在 PPG 信号频谱中取出运动干扰对应的频率， 从而去除干扰影响。图 3.12 给出了 PPG 信号和三路加速度信号的频谱图，从图中我 们可以看到 PPG 信号在 250 次/分附近有出现运动干扰峰，三路加速度信号的频谱在 该位置出现较大峰值，能够反映运动干扰的频率。
谱峰追踪基于一个事实，即如果两次时间窗口重叠部分很多，连续两次测得的心 率值变化不大。因此，上一次心率测量结果有助于对本次谱峰搜索和最终心率估计。 在谱峰搜索时，我们只选择上次测得的频率为中心的一段区域内搜索本次峰值。换句 话说，如果上次测得的心率值是 f ，本次谱峰搜索范围是[ f − Δ1，f − Δ2] 。在谱峰搜索 范围内，选择幅值超过频谱最高峰幅值 50%的谱峰作为可能的心率峰，相应频率记作
f = [ f1, f2 , , fn ] ， f 中的频率即为所有可能的心率值。
当可能的心率值不唯一时，我们利用加速度信号，选出最终的心率值。加速度信

31

号可由内置于手腕式心率测量设备中的三轴加速度计获得，能够反映手臂的运动情 况，有助于提高运动干扰下心率测量的准确性[42,43]。通过对大量实测 PPG 数据的研究 发现，运动干扰不仅会在运动所在频率对 PPG 信号造成干扰，运动频率的谐波处也有 可能对 PPG 造成干扰。因此，我们首先对同时采集的时间窗内三个轴的加速度信号分 别作 FFT 频谱分析，选取频谱中主要峰值点，将主要峰值点对应的频率及其谐波频
率成分记作 fMA = [ fMA1, fMA2 , , ] fMAn ，f M A 中的频率代表运动干扰频率及其谐波成分，
本文中选择幅值大于频谱最高峰幅值的 50%作为主要峰值点。然后，从可能的心率
f = [ f1, f2 , , fn ] 中去除与运动干扰频率 f M A 相同的频率。需要注意的是， f M A 中代表 的运动干扰频率及谐波频率有可能和心率接近，因此，保留 f = [ f1, f2 , , fn ] 中和上
次心率测量结果接近的频率。最后，从剩余的可能心率值中选择和上一次测量结果最
近的频率作为最终心率值。

1 心心运
0.8

PPG频时 加加归X轴仿仿频时 加加归Y轴仿仿频时 加加归Z轴仿仿频时

运运运

0.6

归归归归归归

0.4

0.2

0

0

50 100 150 200 250 300 350 400 450 500

次/分

图 3.12 PPG 信号和三路加速度信号的频谱

3.4 抗运动血氧饱和度提取算法

根据第二章推导的血氧计算公式，我们得知，血氧计算的关键是准确求出两路发 射光的交直流信号比的比值，在公式中用 R 表示。运动干扰情况下，光电容积脉搏波 信号通常会被干扰噪声淹没，从时域中很难准确求得 R。相比时域提取法，频域提取 方法有一定的抗干扰性。本研究将新提出的基于时变自回归模型的心率提取算法同频 域分析法结合来求得血氧饱和度的值。如图 3.13 所示为抗干扰血氧提取算法流程图。 血氧饱和度测量中有两路入射光，红光和红外光。首先选取红外光 PPG 信号进行处理，
32

利用抗干扰心率提取算法准确求出心率，然后对两路 PPG 信号（红光 PPG 信号和红 外 PPG 信号）频谱分析，根据频谱中心率所在频率位置提取红光 PPG 信号和红外 PPG 信号的幅值，进而求出 R 值，最后代入到血氧经验公式中，求得最终的血氧饱和度。
红外光 PPG

信号预处理

静止
采用均值交 点算法

状态分类 运动
信号分段
谱峰追踪

加速度信号 信号预处理 FFT 谱分析

红外光 PPG

信号预处理

FFT 谱分析

确定心率
提取心率峰 对应幅值

信号预处理

红光 PPG

FFT 谱分析

确定 R 值

3.5 本章小结

计算血氧饱 和度的值
图 3.13 抗干扰血氧提取算法流程图

本章详细介绍了基于时变自回归模型的抗干扰心率提取算算法。首先对 PPG 信号 的干扰进行了分析，并针对运动干扰情况作深入研究。然后详细介绍了本文要引入的

33

基于多小波基函数展开的时变自回归模型，包括系数的展开、多小波基函数的选择、 模型参数估计和谱估计，并构建仿真信号，验证该方法在处理时变信号方面的效果。 在此基础上，同时结合快速傅里叶变换，并利用加速度信号，提出一种基于时变模型 的抗运动干扰心率提取算法。该算法首先利用加速度信号对 PPG 信号进行状态分类， 分为静止 PPG 和运动 PPG。对于静止 PPG 信号，本文提出均值交点法计算心率。对 于运动 PPG，算法由三部分构成：信号预处理，信号分段和谱峰搜索。最后，结合本 文提出的心率提取算法和血氧频域分析法，提出抗干扰血氧饱和度提取方法。
34

第 4 章 实验及结果分析
4.1 心率实验及结果分析
4.1.1 实验方法
为了验证本文算法的有效性，选取 5 名年龄在 20~45 岁的健康人作为测试对象。 本实验同步采集 PPG 信号，心电（electrocardiogram，ECG）信号和三轴加速度信号。 本实验中采集的 PPG 信号是手腕式光电容积脉搏波信号，反射式检测方式获得的 PPG 信号质量没有透射式检测方式获得的 PPG 信号好，噪声大，有用的脉搏信息较弱，信 噪比低。但是，为了满足心率的日常监测以及运动时的心率监测，用反射式 PPG 信号 更方便舒适，被广泛用于心率监测设备中。因此本实验处理的信号为手腕式脉搏测量 装置获得的反射式 PPG 信号。加速度计内置于手腕式脉搏测量传感器旁边，用于测量 手腕加速度信号。PPG 信号、心电信号、加速度信号的采样频率均为 125Hz。为了实 现实时性，我们对这三种信号都用移动时间窗口处理。时间窗口长度是 8s，每次窗口 向前移动 1s 的长度，即本次信号和上次信号重叠时间为 7s。同步采集的心电信号可 提供心率值作标准心率参照。
实验前，所有受试者均保持安静状态 15 分钟以上，并被告知实验过程和实验规则 以及注意事项，待呼吸及脉搏相对平稳后开始记录所需的生理参数，包括 PPG 信号、 ECG 信号、三周加速度信号。试验中，测量状态分为两组：静止和运动。运动组中， 根据运动情况不同又分为跳跃、挥臂、跑步三种情况（这些运动状态属于影响心率测 量准确性的常见运动状态）。需要注意的是，为了对比运动干扰引起 PPG 波形突变时， 不同算法的效果，我们在运动组中采取“静止-运动-静止”的形式，根据运动情况的 不同，运动测试组分别为“静止-跳跃-静止”、“静止-挥臂-静止”、“静止-跑步-静止”。 4.1.2 参考心率提取
对于静止时刻测到的心电信号（如图 4.1 所示），信号质量较好，从信号中提取 R 波（用圆圈标记）比较容易且准确度高。然而，运动情况下，心电信号中也存在较大 干扰，图 4.2(a)给出了一段运动情况下的心电信号，从图中方框内的心电信号可以明 显看出运动情况下 R 波的检测也比较困难。为了准确提取 R 波，计算心率，首先，我 们对 ECG 信号做一阶差分差分结果如图 4.2(b)所示，然后利用矩形窗和差分信号进行
35

卷积，结果如图 4.2(c)所示，接着对卷积结果利用阈值法进行特定点检测，最后将检 测结果区域对应到心电时域信号区域，从各自区域寻找最大值即为 R 波所在位置。图 4.3 给出了运动情况下测得的心电信号以及利用本文处理方法得到的特征点（图中用 圆圈标出）。

幅度

心心仿仿 400

200

0

-200

0

1

2

3

4

5

6

7

8

时间/s

图 4.1 静止状态下的心电信号及特征点提取
1000 心心仿仿
500

幅度

0

幅度

-500 0
1000 500

200 400 600 800 1000 1200 1400 1600 1800 2000 采样点数 (a)
心心仿仿归次心分

0

-500

-1000 0

200 400 600 800 1000 1200 1400 1600 1800 2000

采样点数

5
x 10

(b)

15

移运移移移分

10

5

幅度

0

0

200 400 600 800 1000 1200 1400 1600 1800 2000

采样点数 (c)

图 4.2 心电信号提取算法

36

幅度

800
心心仿仿
600

400

200

0

-200

-400

-600

0

1

2

3

4

5

6

7

8

时间/s

图 4.3 运动状态下的心电信号及特征点提取
4.1.3 实验结果与分析

1）本实验的光电容积脉搏波为手腕式脉搏波信号。传感器选择的是反射式传感器。 实验记录的光电容积脉搏波信号如图 4.4 所示，（a）图是单次实验记录的全部测量时 间内的 PPG 信号，（b）图为一次时间窗内的原始 PPG 信号，对应于（a）中圆圈部分 的信号。

幅值

6000 5500

5000

4500

4000

放放

3500

0

20

40

60

80

100

120

时间/s

（a）原始PPG信号

4900

4800

4700

幅值

4600

4500

4400

0

1

2

3

4

5

6

7

8

时间/s

（b）单次处理的原始PPG信号

图 4.4 实验记录的光电容积脉搏波信号

2）本实验采用了三轴加速度计记录手腕处的加速度信号，图 4.5 给出了一个时间 窗内的三个轴（X 轴 Y 轴 Z 轴）的加速度信号。

37

幅度

12

10

8

0

1

2

3

4

5

6

7

8

X轴加速度信号

-30

幅度

幅度

-35

0

1

2

3

4

5

6

7

8

Y轴加速度信号

55

50

0

1

2

3

4

5

6

7

8

Z轴加速度信号

图 4.5 实验记录的光电容积脉搏波信号

3）本实验中，运动情况分为跳跃、挥臂、跑步三种情况，图 4.6、图 4.7 以及图

4.8 分别给出了对应的原始 PPG 信号和心率计算结果。

跳跃组中，原始 PPG 信号的基线漂移较大，45s 之前保持静止，46s~110s 运动，

110s 之后再次保持静止。从计算结果可以看出，本文算法提取的心率与参考心率非常

接近，特别是在静止到运动过渡阶段（大约在 46s 左右），该时刻的时间窗内 PPG 信

号包含突变的信号，我们发现真实心率在该时刻的波动较大，这种情况下，用传统方

法提取心率是非常苦难的，而本文的算法能应对这种突变，有效跟踪真实心率。

1.8 x 104

原始PPG信号

1.6

幅度

1.4

1.20 160

20

40

60

80

100 120 140 160

时间/s

心率计算结果

计算值/BPM

140

120 1000

HR-ECG HR-PPG

20

40

60

80

100 120 140 160

时间/s

图 4.6 跳跃组 PPG 信号及心率计算结果

38

挥臂组中，原始 PPG 信号基漂非常大，手臂的大幅度摆动对反射式 PPG 信号的

质量影响较大。单纯挥臂，运动量较小，心率在 80BPM（Beat Per Minite，BPM）到

110BPM 之间，从计算结果看出，本文算法提取的心率与参考心率基本一致。同时我

们也发现，在大约 20s 附近，本文算法提取的心率与与参考心率之间有一定能够偏差，

波动较大。通过该时间段内的结果详细分析，发现导致结果偏差的主要因为在 20s 附

近有一个 PPG 信号中出现一个非常大的干扰，形成很高的突起，干扰导致波形严重畸

变，干扰持续时间长达 4s 左右，如果从包含畸变的 8s 时间窗内的信号提取心率，传

统方法无法应对如此强度大的突变，本文的算法对 8s 数据分段后，能将干扰信号（持

续约 4s）和非干扰信号（持续约 4s）分成两部分，对这两部分信号分别作后续分析提

取心率，这样一来，本文算法求得的心率是 4s 内的心率结果，参考信号给出的是 8s

内的心率结果，所以结果出现一定偏差。同时，我们也发现，这种偏差在 7BPM 内，

这个偏差对于实际的心率检测是可以接收的。本文算法牺牲了部分时刻的精确度，提

高了整体范围内心率测量的正确性。

8000

原原PPG仿仿

7000

幅度

6000

5000

计算值/BPM

40000

20

40

60

80

100

120

时时/s

心心心心心心

120

HR-ECG

110

HR-PPG

100

90

80

70

0

20

40

60

80

100

120

时时/s

图 4.7 挥臂组 PPG 信号及心率计算结果

跑步组中，真实心率变化较快，心率从开始的 110BPM 最高增长到接近 180BPM， 从计算结果我们可以看出，本文算法在高强度跑时也能实现心率的有效跟踪。我们也 发现，在 50s 附近，本文算法的心率结果和参考心率存在 5BPM 内的偏差，该情况在 出现的原因和图 4.7 中偏差出现的原因一样，牺牲一定的精确度，换取心率的整体有

39

效跟踪，这也是本文算法巧妙的地方。

10000

原 原 PPG仿 仿

9000

幅度

8000

计算值/BPM

7000 0
180 160 140 120 100
0

50

100

150

200

250

时时/s

心心心心心心

HR-ECG HR-PPG

50

100

150

200

250

时时/s

图 4.8 跑步组 PPG 信号及心率计算结果
4.1.4 本文算法与传统算法比较

为了验证本文提出的心率提取算法的性能，本文对传统 FFT 心率提取算法、基于 LMS（least mean square, LMS）心率提取算法作比较。本文用平均绝对误差率和平均 绝对误差对三种算法的心率提取结果作评价。平均绝对误差率定义为

 Err1 = 1 M

M | HRPPG (i) − HRECG (i) |

i =1

HRECG (i)

(4.1)

平均绝对误差定义为

 Err2 = 1 M

M
| HRPPG (i) − HRECG (i) |
i =1

(4.2)

其中， M 是心率计算的总次数， HRPPG 、 HRECG 分别为利用 PPG 信号和心电信号求 得的心率，平均绝对误差单位为每分钟心跳次数（beat per minute, BPM）。
快速傅里叶变换（FFT）是信号处理中常用的方法。该方法将时域信号转换到频 域进行分析。正如第二章提到的 PPG 信号中各频率成分及其能量分布是有差异的，因 此可以从频谱中提取与人体的心率对应的频率成分，最终得到心率。传统基于 FFT 的 心率提取方法，首先对信号做快速傅里叶变换，然后在频谱范围内寻找最高峰对应的 频率点，将该点作为心率对应的频率点[13,14]。

40

最小均方（least mean square, LMS）自适应噪声抵消算法是自适应滤波算法中的 一类，计算量小且稳定性好。基于 LMS 的心率提取算法首先利用 LMS 自适应算法对 包含噪声的 PPG 信号自适应去噪，然后对去噪后的信号作时域分析或频域分析求得心 率，通常用频域分析法，求得频谱中峰值对应的频率即为心率值[15,16]。该方法计算量 小，实时性好，且有较好的稳定性。但是该方法收敛速度慢，不适合快速变化的信号。 参考信号由人工合成或利用额外设备提供，目前利用加速度计提供参考信号是很多穿 戴式心率监测设备常用的方法。该方法不需要提前估计信号和噪声就可以达到去噪的 效果。输入信号包括两路，一路信号为包含噪声的原始信号，另一路信号和噪声有很 大相关性。参考信号的获得通常有两种方法：一种是利用本身的信号重新构建一路参 考信号。另一种方法为利用其它外部设备，如加速度计提供包含噪声的参考信号。本 文用加速度信号作为噪声的参考信号。

幅度

200 100
0 -100 -2000
200 150

静静

运运

静静

10

20

30

40

50

60

70

时时/s

(a)

FFT

LMS

本本心本

HR( 从ECG仿仿信信)

心率/BPM

100

50

0

10

20

30

40

50

60

70

时时/s

(b)

图 4.9 （a）预处理后的 PPG 信号（b）用不同方法估计心率的结果

图 4.9 给出了运动组中运动情况为跑步时，其中一位受试者的测量结果。图 4.9（a） 是经过预处理后的 PPG 信号，图 4.9（b）是用不同方法测得的心率结果。其中利用心 电信号提取的心率可作为参考结果。利用传统 FFT 算法、基于 LMS 的心率提取算法 和本文算法得到的心率平均绝对误差分别为 8.76BPM、11.74BPM、3.29BPM。无论计 算结果还是从图中都不难发现，本文算法得到的心率结果比另外两种算法更接近参考 心率。当运动干扰引起波形突变时，另外两种方法误差很大，结果不可靠，本文方法
41

正确率高，抗噪效果突出。 图 4.10 所示为 5 名受试者在不同状态下心率的平均绝对误差率。对比传统 FFT 心
率提取算法、基于 LMS 的心率提取算法和本文算法，静止状态下三种算法误差都很 小，平均绝对误差均小于 1.10%。但是，在运动干扰情况下，三种算法效果差距较大。 传统 FFT 心率提取法和基于 LMS 的心率提取算法平均绝对误差率最高可分别达到 14.3%和 5.35%，本文提出的算法能将误差率控制在 2.6%以内，正确率有明显提高。

本本心本

15

LMS

FFT

10

14.30

10.06

平平平真平心心(% )

5
0.921.030.92 0 静静

3.58 2.11 1.55

4.50 1.94

跳跳

挥挥

运运运运

5.35 2.56
跑跑

图 4.10 在静止状态和运动状态下（跳跃、挥臂、跑步）的平均绝对误差率
本文仍有不足之处。从图 4.10（b）中我们可以看出，在 38s-40s 的时间段内，三 种算法误差都很大。这是因为该时间段内运动干扰对心率的影响较大，频谱中表现为 心率对应的峰被运动干扰对应的峰淹没。本文算法即使对信号分段后，心率对应的峰 值仍然没有凸显。这种情况下，三种方法都不能正确提取心率。所以，如何在心率峰 被噪声峰淹没的情况下正确提取心率是本文今后研究的重点方向。
为了进一步验证本文提出的算法在光电容积脉搏波信号包含突变时的算法性能， 我们在以上实验的基础上，作了两方面的修改。一方面，测量状态变为“静止-运动静止-运动”，使得测量过程包含较多突变的噪声，从而使测得的光电容积脉搏波信号 中尽可能多的包含突然的变化。另一方面，在算法对比上也作了调整。我们将本文提 出的算法和传统 FFT 心率提取算法作比较。本文提出的算法在谱峰搜索阶段，并不是 在整个频谱范围找可能的峰值，而是参考前一时刻心率的测量值确定一个搜索范围， 这样可以确保范围之外的错峰不被选中，增加算法的准确性和结果的平稳性。传统 FFT
42

心率提取算法是在整个频域内找最高峰对应的频率。本次对比实验对传统 FFT 心率提 取算法中作了调整，将每次搜索范围由根据前一时刻心率计算值确定。

50

0

归归

-50
静静

运运

静静

运运

-1000

10

20

30

40

50

60

70

80

90

时时/s

(a)

120

心心/BPM

100

80

本本本本

HR（从ECG仿仿信信）

FFT+参参参归时参心心

600

10

20

30

40

50

60

70

80

90

心心次计

(b)

图 4.11（a）预处理后的 PPG 信号（b）用不同方法估计心率的结果

图 4.11 所示为运动状态为快跑时用不同方法测量的心率结果。（a）图为预处理后 的 PPG 信号，（b）图给出了本文算法和调整后的传统 FFT 算法的心率计算结果，同 时给出了从心电信号提取的心率结果作为参考心率。其中，调整后的传统 FFT 算法计 算得到的心率与参考心率的皮尔逊相关系数为 0.438，本文算法计算得到的心率与参 考心率的皮尔逊相关系数为 0.973，显著性 P 值均小于 0.05。从实验结果我们可以看 出，使用本文提出的算法得到的心率更与参考心率具有非常高的相关性和准确度。特 别地，通过分析图 4.11 方框内的 PPG 信号和对应的心率值，我们发现，当 PPG 信号 中包含突变时，本文提出的算法准确度明显高于调整后的 FFT 心率提取算法。
从 PPG 信号中提取心率使得心率监测更加方便舒适。然而，PPG 信号很容易受到 运动干扰的影响。传统的 PPG 信号去噪方法在波形突变时去噪效果并不理想，心率测 量正确率低。本文提出了一种抗运动干扰的心率测量算法。该算能有效降低运动干扰 引起 PPG 信号波形突变对心率测量带来的影响，提高心率测量的准确性。本文算法主 要分为信号预处理、信号分段和谱峰搜索三部分。对 10 名测试者在不同状态进行测 试。对比传统 FFT 心率提取算法、LMS 心率提取算法和本文提出的算法。本文算法

43

有很高的准确率，相较于其他两种算法，准确率高，抗干扰强。
4.2 血氧实验及结果分析
4.2.1 实验方法
血氧实验方法同心率实验方法基本一致，区别主要体现在如下几个方面： （1） 实验选取两种运动状态作主要研究。 （2） 同时提取两路 PPG 信号：光源为红光和红外光。 （3） 本次实验采取指夹式血氧探头采集透射式的 PPG 信号。由于实验条件的限制，
缺少内置于探头中的加速度计，因此，本实验只能初步验证本文算法在无加速 度信号时的效果。 实验前，所有受试者均保持安静状态 15 分钟以上，并被告知实验过程和实验规则 以及注意事项，待呼吸及脉搏相对平稳后开始记录所需的生理参数。试验中，测量状 态分为两组：挥臂和跑步。日常运动中，随机的挥臂是常见的运动，日常走路的摆臂、 敲击物体、挥手等都包含挥臂动作，因此选取挥臂作为起一种重点研究运动。跑步运 动是常见运动，慢跑、快跑时人们对心率的变化希望得到实时了解，因此，我们选取 运动作为另一种研究情况。由于传统方法对小幅慢跑时去噪效果比较理想，而无法应 对高强度快跑运动组，所以本实验中跑步组主要研究高强度快跑时的情况。 4.2.2 实验结果与分析
第一种情况为挥臂运动，原始红光、红外 PPG 信号以及心率、血氧计算结果如图 4.12 所示。在 0~10s 起始阶段保持静止，10s~40s 运动，40s~60s 静止，60s~90s 再次 运动，90s~110s 保持静止，110s 之后再次运动。可见，原始 PPG 信号中多处出现波 形突变情况，在这种情况下对心率和血氧饱和度的测量提出较高要求。从图 5.18 血氧 的测量结果中，我们可以看出起始阶段血氧较平稳，25s 左右由于运动导致耗氧量增 加，血氧饱和度出现略微下降，随后血氧恢复，区域平稳，在 70s 和 90s 处，再次由 于耗氧量增加，血氧饱和度出现下降。
第二种情况为跑步运动，原始红光、红外 PPG 信号以及心率、血氧计算结果如图 4.13 所示。在 0~10s 起始阶段保持静止，10s~50s 运动，50s~60s 静止，60s~110s 再次 运动，11s~115s 保持静止，115s 之后再次运动。原始 PPG 信号中多出出现波形突变 情况，且在 65s 到 85s 时间内，运动强度非常大，波形突变严重，在这种情况下准确
44

测量血氧非常困难。从图 4.13 血氧的测量结果中，我们可以看出起始阶段血氧较 平稳，15s 左右由于运动导致耗氧量增加，血氧饱和度出现略微下降，随后血氧恢复， 区域平稳，在 60s 到 85s 之间由于剧烈运动，导致耗氧量增加，血氧饱和度下降幅度 较大，在这段时间区域内，血氧出现较大波动。

归归

0 -2000

红红红红红PPG原原仿仿

红红 红红

-4000

0

20

40

60 时时/s 80

100

120

140

心心计

100

心心计/BPM

80

心心计/%

60

0

20

40

60

80

100

120

140

心心次计

血血计
105

100

95

90

0

20

40

60

80

100

120

140

心心次计

图 4.12 挥臂组的原始 PPG 信号和心率及血氧测量结果

归计

心心计/BPM

0 -2000

红红

红红

红红红红红PPG原原仿仿

-4000

0

20

40

60 时时/秒 80

100

120

140

心心计
160

140

120

100

80

0

20

40

60 心心次计 80

100

120

140

血血计
105

100

95

90

0

20

40

60

80

100

120

140

心心次计

图 4.13 跑步组的原始 PPG 信号和心率及血氧测量结果

心心计/%

45

4.2.3 本文算法与传统算法比较

为了验证本文提出的心率提取算法的性能，实验对本文算法、传统基于 FFT 的算 法作比较。
图 4.14 给出了原始 PPG 信号和不同算法心率及血氧的结果。其中利用实验室已有 血氧检测设备可作提供血氧参考结果。从图 4.14 心率计算结果我们可以看到，运动情 况下，在 15s~21s、32s~37s、45s~48s 时间段内传统方法出现很大偏差，偏差范围超 过 30BPM，这样的误差在实际测量中是不被允许的。心率计算结果的偏差直接影响 血氧值的准确性。从血氧测量结果我们发现，血氧的变化并不大，即使在心率差距较 大的时间区域内，两种算法的计算结果差距也不是很大，但是从 17s~20s、35s~37s、 46s~48s 时间段内，不难看出两种算法，本文算法的血氧结果比传统算法得到的血氧 结果更接近参考心率。本文提出的算法能有效抑制干扰的影响，提高血氧测量的准确 度与可靠性。

归计

心心计/BPM

-1000 -2000 -3000

红 红 红 红 PPG原 原 仿 仿

红红 红红

-4000

0

10

20

30

40

50

60

70

时 时 /s

心心计 200

传传心本

150

本本心本

100

50

0

10

20

30

40

50

60

70

心心次计

血血计

100

98

参参参

传传心本

96

本本心本

0

10

20

30

40

50

60

70

心心次计

心心计/%

图 4.14 原始 PPG 信号和不同算法的处理结果

4.3 本章小结

本章针对心率提取算法和血氧提取算法分别设计了实验验证本文算法的性能。心

46

率实验采用反射式 PPG 信号，首先介绍了实验方法，接着对参考心率的提取方法做了 简单介绍，然后利用本文算法对实验数据作处理，对实验结果作了分析，并将本文算 法、传统 FFT 心率提取算法、基于 LMS 的心率提取算法进行比较，表现了本文算法 在运动情况下的抗干扰性，突出了本文算法能有效应对 PPG 信号中的突变问题这一优 势。血氧实验采用透射式 PPG 信号，对实验方法简单介绍之后给出了实验数据的血氧 提取结果，并将结果同传统血氧提取结果和参考血氧结果做对比，初步验证本文算法 在准确性和抗干扰上的优势。
47

结论
随着人们对健康日益关注，越来越多的人希望随时随地监测人体生理参数，各种 穿戴式设备应运而生，这些穿戴式设备能够以无创的方式测量人体生理参数。其中， 心率和血氧饱和度是两个非常重要的人体参数。对心率的实时、无创检测可以帮助人 们随时了解自己的身体状况，一定程度上能够避免由于心血管疾病等因素引起的意外 事件的发生。此外，心率监测作为一种监督手段，还可以用于控制运动量，避免过高 的运动强度向免疫系统施加较大的压力。因此，对心率的实时、无创、精确检测受到 越来越多的关注。氧气是所有生命活动的物质基础，是提供人体新陈代谢的重要物质。 实时检测血氧饱和度，成为判断人体供氧状况以及人体呼吸系统和循环系统是否正常 的一个重要指标。光电容积脉搏波信号中包含很多人体生理信息，包括心率和血氧， 因此得到了广泛的应用。然而，光电容积脉搏波信号极易受到干扰的影响，特别是在 运动干扰存在时，测量结果有往往有不可靠。目前缺少有效的抗运动干扰心率及血氧 提取算法。因此，从光电容积脉搏波信号中提取心率和血氧最大的难点在于运动干扰 的影响。研究如何消除干扰的影响，准确提取心率和血氧，提出一种抗运动干扰的脉 率及血氧饱和度提取算法是本研究课题的主要内容，也是难点与创新点。
本论文创新点主要包括以下几个方面： 1）本文通过分析大量实测数据，深入研究运动干扰下的 PPG 信号特点，针对干 扰 PPG 信号的特点引入多小波基函数展开的时变自回归模型，同时结合快速傅里叶变 换，并利用加速度信号，提出一种基于时变模型的抗运动干扰心率提取算法。此算法 准确率高、抗干扰效果好，特别地，当 PPG 信号中存在干扰产生的突变时，此算法效 果显著。 2）为了减少计算量，本文利用加速度信号对采集的 PPG 信号进行状态分类，分 为静止和运动两种状态。状态分类有利于我们在静止情况下运用计算量较小的算法。 对于静止状态，本文提出了均值交点法的心率提取方法，该方法在静止状态下心率计 算准确度高，运算量很小，满足工程中心率监测设备低功耗要求； 3）通过对大量运动干扰 PPG 信号及加速度信号的研究，发现运动干扰不仅会在 运动所在频率对 PPG 信号造成干扰，运动频率的谐波处也有可能对 PPG 造成干扰。 因此，本文在利用加速度信号确定运动频率时，同时将加速度信号频谱中的主要频率
48

及其谐波频率同时作为运动干扰频率。 4）结合本文心率提取法和血氧频域分析法提出抗干扰血氧饱和度提取算法。该
方法利用基于时变自回归模型的心率提取算法对一路光电容积脉搏波信号作处理，准 确提取心率，再结合两路光电容积脉搏波信号的频域中心率对应成分的幅值得到两路 光的交直流光强比，最后代入血氧定标公式中确定最终血氧值。
综上所述，本文重点研究运动干扰下从 PPG 信号中提取心率及血氧的方法，本文 提出的算法具有较强的抗干扰性，特别地，对于运动干扰引起的突变 PPG 信号，抗干 扰效果明显。然而，本研究仍然存在以下几个方面的不足之处，还需做进一步的研究 和改进：
1）本文心率提取算法在当前时刻的心率计算结果一定程度依赖前一时刻心率的 计算值，这将带来两方面的问题：一方面要求被测者在开始阶段保持一定时间的静止， 确定一个相对正确的心率初始值；另一方面，如果遇到干扰强度大时间较长的情况， 依靠前一时刻的心率值会造成误差的积累。
2）利用时变自回模型对信号进行分段是本文算法的关键部分，对分段后的信号 近一步频谱分析，估计心率。分段后的信号和原始信号长度有一定差距，导致利用分 段信号得到的心率值与整段信号反应的心率值之间有一定差距，但是该差距非常小， 远小于日常心率监测的误差范围，换句话说，本文算法牺牲一定的精确度，提高了算 法整体的准确度。
3）由于实验条件的限制，本研究没有进行反射式血氧饱和度的算法验证，而反 射式 PPG 信号一般情况信号质量没有透射式 PPG 信号好，需要进一步验证本文提出 的抗干扰算法在反射式血氧饱和度检测中的性能。
4）本课题研究的实验中，尽可能多的模拟常见的运动情景，但是真正实际应用 中还会有更多更复杂的运动情况，需要进一步完善实验，通过大量数据和更多运动场 景的模拟进一步验证算法性能。
49

参考文献
[1] 黄继萍. 基于脉搏信号的人体生理参数提取研究[D]. 哈尔滨: 哈尔滨工业大学, 2010. [2] 赵 志 勇 , 李 涵 , 陈 东 月 , 等 . 一 种 基 于 反 射 式 光 电 传 感 器 的 智 能 心 率 腕 表 [J]. 无 线 互 联 科 技,2014(05): 181-182. [3] 马新江. 运动员用多参数无线监护系统的开发与设计[D]. 青岛: 中国海洋大学, 2009. [4] 黄世林. 中医脉象研究[M]. 人民卫生出版社, 1986. [5] 徐伟. 反射式脉搏血氧饱和度信号检测与分析系统[D]. 兰州: 兰州理工大学, 2012. [6] 戴仲岩. 反射式脉搏血氧动态监测系统的设计及关键技术研究[D]. 长沙: 中南大学, 2012. [7] Allen J. Photoplethysmography and its application in clinical physiological measurement[J]. Physiological Measurement, 2007, 28(3):R1-39. [8] 陈廷鋆. 脉搏波自动检测及无线通讯技术的研究[D]. 北京: 北京工业大学, 2009. [9] Hertzman A B. The blood supply of various skin areas as estimated by the photoelectric plethysmograph[J]. American Journal of Physiology, 1938, 124(2):328-340. [10] 龚渝顺. 穿戴式抗运动干扰血氧饱和度监测技术研究[D]. 重庆: 第三军医大学, 2012. [11] 朱娟, 张列亮, 徐磊. 光电容积脉搏波的临床应用研究及进展[J]. 中华临床医师杂志: 电子版, 2013(22):176-178. [12] Maikala R V. Modified Beer's Law–historical perspectives and relevance in near-infrared monitoring of optical properties of human tissue[J]. International Journal of Industrial Ergonomics, 2010, 40(2): 125-134. [13] Scharf J E, Athan S, Cain D. Pulse oximetry through spectral analysis[C]. Biomedical Engineering Conference, 1993. Proceedings of the Twelfth Southern. IEEE, 1993: 227-229. [14] Yan Y S, Poon C C, Zhang Y T. Reduction of motion artifact in pulse oximetry by smoothed pseudo Wigner-Ville distribution[J]. Journal of Neuroengineering & Rehabilitation, 2005, 2(1):1-9. [15] Becerra-Luna B, Martínez-Memije R, Sánchez J C, et al. Miokinetic noise attenuation in photoplethysmographic pulse signals by LMS adaptive filtering with adequacy of the input signals[M] VI Latin American Congress on Biomedical Engineering CLAIB 2014, Paraná, Argentina 29, 30 & 31 October 2014. Springer International Publishing, 2014:128-131. [16] Tamura T, Maeda Y, Sekine M, et al. Wearable photoplethysmographic sensors–past and present[J].
50

Electronics, 2014, 3(2): 282-302. [17] Ram M R, Madhav K V, Krishna E H, et al. A novel approach for motion artifact reduction in PPG signals based on AS-LMS adaptive filter[J]. Instrumentation and Measurement, IEEE Transactions on, 2012, 61(5): 1445-1457. [18] Yan Y S, Zhang Y T. An efficient motion-resistant method for wearable pulse oximeter[J]. Information Technology in Biomedicine, IEEE Transactions on, 12(3): 399-405, 2008. [19] Alzahrani A, Hu S. An effective solution to reduce motion artefact in new generation reflectance pulse oximeter[C] Electronics, Communications and Photonics Conference (SIECPC), 2013 Saudi International. IEEE, 2013:1-5. [20] Lai PH, Kim I. Lightweight wrist photoplethysmography for heavy exercise: motion robust heart rate monitoring algorithm[J]. Healthcare Technology Letters, 2015, 2(1):6-11. [21] Zhang Z, Pi Z, Liu B. TROIKA: A general framework for heart rate monitoring using wrist-type photoplethysmographic signals during intensive physical exercise[J]. Biomedical Engineering, IEEE Transactions on, 2015, 62(2): 522-531. [22] Sun X, Yang P, Li Y, et al. Robust heart beat detection from photoplethysmography interlaced with motion artifacts based on empirical mode decomposition[C] Biomedical and Health Informatics (BHI), 2012 IEEE-EMBS International Conference on. IEEE, 2012: 775-778. [23] Peng F, Zhang Z, Gou X, et al. Motion artifact removal from photoplethysmographic signals by combining temporally constrained independent component analysis and adaptive filter[J]. Biomedical Engineering Online, 2014, 13(6):694-694. [24] 汤池. 利用脉搏波无创连续检测血压的实验研究[D]. 西安: 第四军医大学, 2005. [25] 米 洁 , 黄 桃 . 脉 搏 血 氧 饱 和 度 监 测 在 院 前 急 救 中 的 应 用 价 值 [J]. 医 疗 卫 生 装 备 , 2010, 31(9):109-110. [26] 王继寸. 基于脉搏波的无创连续血压测量方法研究[D]. 天津: 天津大学, 2009. [27] 张 列 亮 , 朱 娟 , 徐 磊 . 光 电 容 积 脉 搏 波 临 床 应 用 研 究 进 展 [J]. 临 床 麻 醉 学 杂 志 , 2013, 29(11):1132-1134. [28] 张彬. 基于脉搏波的血氧饱和度检测算法的研究[D]. 北京: 北京交通大学, 2009. [29] 沙娜. 人体脉搏信号的嵌入式实时监测技术及应用的研究[D]. 沈阳: 东北大学, 2007. [30] 姚丽峰. 基于 PPG 和彩色视频的非接触式心率测量[D]. 天津: 天津大学, 2012. [31] 李爱娟. 基于血管容积变化的血氧饱和度检测系统设计[D]. 呼和浩特: 内蒙古大学, 2012.
51

[32] 黄世祥. 反射式血氧饱和度测量仪的研究[D]. 贵阳: 贵州大学, 2009. [33] 王建军. 血氧饱和度测量信号的提取与处理研究[D]. 西安: 西安电子科技大学, 2005. [34] 张书颖. 基于扩散理论的脉搏血氧测量系统的研究[D]. 天津: 天津大学, 2012. [35] 张历. 基于 iOS 操作系统的无线脉搏血氧仪设计与实现[D]. 天津: 天津大学, 2014. [36] 张晓枫, 张香武, 赵春华,等. 基于脉搏光谱分形算法的血氧测量研究[J]. 长春理工大学学报: 自然科学版, 2014 (2): 94-97. [37] 李庆波, 聂鑫, 张广军,等. 分段滤波用于消除脉搏血氧检测中多种运动干扰的研究[J]. 光谱 学与光谱分析, 2009, 29(11):2994-2997. [38] Wei H L, Billings S A, Liu J J. Time-varying parametric modelling and time-dependent spectral characterisation with applications to EEG signals using multiwavelets[J]. International Journal of Modelling, Identification and Control, 2010, 9(3): 215-224. [39] Mallat S G. A theory for multiresolution signal decomposition: the wavelet representation[J]. Pattern Analysis and Machine Intelligence, IEEE Transactions on, 1989, 11(7): 674-693. [40] Wei H L, Billings S A. An efficient nonlinear cardinal B-spline model for high tide forecasts at the Venice Lagoon[J]. Nonlinear Processes in Geophysics, 2006, 13(5): 577-584. [41] Chen S, Billings S A, Luo W. Orthogonal least squares methods and their application to non-linear system identification[J]. International Journal of control, 1989, 50(5): 1873-1896. [42] Fukushima H, Kawanaka H, Bhuiyan M S, et al. Estimating heart rate using wrist-type photoplethysmography and acceleration sensor while running[C]//Engineering in Medicine and Biology Society (EMBC), 2012 Annual International Conference of the IEEE. IEEE, 2012: 2901-2904. [43] Asada H H, Jiang H H, Gibbs P. Active noise cancellation using MEMS accelerometers for motion-tolerant wearable bio-sensors[C] Engineering in Medicine and Biology Society, 2004. IEMBS'04. 26th Annual International Conference of the IEEE. IEEE, 2004, 1: 2157-2160.
52

攻读学位期间发表论文与研究成果清单
[1]王群,李敏,庞峰骞,刘志文.一种基于时变自回归模型的抗运动干扰心率提取算法[J].航天医学与 医学工程, 2016.（中文核心，已录用）
53

致谢
转眼间研究生生涯即将进入尾声。为期两年半的学习生活经历让我受益匪浅，也 成长很多。这段经历为我今后步入社会奠定了坚实的基础，也必将成为人生最宝贵的 一段记忆。在此，我要向所有给予过我关心和帮助的老师、同学、家人和朋友表示衷 心地感谢。
特别感谢我的导师王群老师，王群老师在学术上悉心指导，答疑解惑，逐步培养 我分析问题解决问题的能力。在生活中也给予我许多建议，在我面对困难、迷茫时给 予我关心和指导。王老师渊博的知识、求实创新的开拓精神让我终生受益。
衷心感谢课题组组长刘志文教授。刘志文教授学识渊博，治学严谨，不但让我 学会了如何做研究，更重要的是让我学会了如何做人，如何做事。他对学术的执着 追求精神对我的学习科研产生了深远的影响。
感谢林艳飞博士后对我课题的指导和帮助，她严谨勤奋、乐观开朗的态度深深影 响这我。感谢课题组的范哲意老师与何冰松老师，他们在日常行政管理中制定的各项 规章制度，使我能够更严格地要求自己，他们为课题组基础设施建设做出的贡献， 让我们可以顺利进行课题研究工作。感谢徐友根老师、时永刚老师和周治国老师， 各位老师向我们传授了信号与图像处理各方面的专业知识，让我获益良多。
特别感谢庞枫骞师兄对我的帮助，每次和师兄的学术讨论都能给我带来灵感， 产生新的想法，帮助我不断改进自己的研究工作，在程序编写方面庞枫骞师兄也给 予了大力帮助。感谢王阳、王跃俊师兄在我课题研究过程中给予我耐心的指导和解 答，让我能够在学习中快速成长。感谢张珣、李艳行等师弟师妹在平时学习生活上对 我的关怀和帮助，感谢李博文、董彬、彭岩岩、牛纯情等在科研项目中对我工作的大 力协作，感谢实验室全体陪我共同走过了美好的研究生时光。
感谢我的家人和朋友，感谢你们一直以来对我的鼓励和支持，让我在遇到苦难 时坚持下来，永不言弃，我的每一份进步都凝结着你们的心血和汗水。
最后，诚挚地感谢在百忙之中为论文评审付出辛勤劳动的各位专家学者。在今 后的科研、工作中，我会加倍努力，回报所有帮助过我的人！
54

word版下载：http://www.ixueshu.com
免费论文查重：http://www.paperyy.com 3亿免费文献下载：http://www.ixueshu.com 超值论文自动降重：http://www.paperyy.com/reduce_repetition PPT免费模版下载：http://ppt.ixueshu.com ------------------------------------------------------------------------------阅读此文的还阅读了：
1. 一种运动伪迹干扰下实时心率算法的研究与实现 2. 基于DEM的水系自动提取算法研究 3. 高斯模型下的视频运动目标提取算法研究 4. 基于AFE4400的动态心率和血氧监测仪 5. 基于视频的运动目标跟踪算法研究及改进 6. 基于DEM的水系自动提取算法研究 7. 基于TCP协议下的网络数据提取算法研究 8. 基于GC-ACM的红外前景目标提取算法研究 9. 基于角点特征的提取算法比较研究 10. 基于背景差法的运动车辆提取算法的研究 11. 基于运动检测的目标跟踪算法研究 12. 基于差分因子的血氧饱和度算法研究 13. 基于改进t-SNE算法的人体运动数据关键帧提取 14. 高原训练血氧饱和度及血压与心率的变化 15. 基于分块的网页内容提取算法的研究 16. 基于机器视觉检测的轮廓提取算法的研究 17. 基于超声的厚度提取算法 18. 基于Harris算法的直线提取方法 19. 基于HDD算法的头发区域提取算法研究与实现 20. 基于区域生长的肝区提取算法 21. 基于光电容积脉搏波的抗运动心率及血氧提取算法研究 22. 基于改进的帧间差分运动目标提取算法 23. 基于心冲击信号的心率提取算法 24. 基于肤色的人脸眼部特征提取算法研究 25. 基于容积数据的血管提取与重建算法研究

26. 基于4-邻域的运动目标提取改进算法 27. 基于分块的网页正文信息提取算法研究 28. 基于改进的TF-IGM热词提取算法研究 29. 基于Kinect的手势特征提取的改进算法研究 30. 基于SAD优化的运动估计搜索算法研究 31. 基于MeanShift算法的运动目标跟踪研究 32. 基于SAD优化的运动估计搜索算法研究 33. 基于压缩感知的监控视频运动对象提取算法 34. 基于CMSE的随钻脉冲信号提取算法研究 35. 基于车辆运动信息的感兴趣区域提取算法研究 36. 一种基于时变自回归模型的抗运动干扰心率提取算法 37. 基于STM32血氧心率检测仪的研制 38. 基于匹配滤波算法的异常信息提取研究 39. 基于AR模型的盲提取算法 40. 基于STC的纵波时差提取算法 41. 基于遥感影像水体提取算法的研究 42. 基于改进视觉背景提取的运动目标检测算法 43. 基于角点特征的提取算法比较研究 44. 基于运动的引力聚类算法(MGBCA)研究 45. 基于胎儿心电技术的胎心率参数提取及研究 46. 基于HDD算法的头发区域提取算法研究与实现 47. 一种基于稀疏贝叶斯分解的抗运动干扰心率提取算法 48. 基于Mean Shift算法的运动目标跟踪研究 49. 体育运动视频图像基于聚类提取算法的研究 50. 基于单元的孤立点提取算法研究

