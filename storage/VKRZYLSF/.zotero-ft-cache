参赛队员姓名： 李硕秋

中学： 中国人民大学附属中学

省份：

北京市

国家/地区：

中国

指导教师姓名： 李锂

论文题目： 指尖光电容积脉搏波初步研究

题目：指尖光电容积脉搏波初步研究

2 / 47

本参赛团队声明所提交的论文是在指导老师指导下进行的研究 工作和取得的研究成果。尽本团队所知，除了文中特别加以标注和致 谢中所罗列的内容以外，论文中不包含其他人已经发表或撰写过的研 究成果。若有不实之处，本人愿意承担一切相关责任。

参赛队员：

指导老师： 年月日

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

3 / 47

题目：指尖光电容积脉搏波初步研究
作者：李硕秋
摘要：
实时运动监测对于职业运动员的训练、心血管疾病患者的术后恢复有重要意 义。然而，目前尚没有既便携、又能无滞后实时监测运动状态的设备。本文基于 Arduino UNO 开发板和 Pulsesensor 传感器制作了便携且具有较高准确度的指尖 光电容积脉搏波采集仪器，通过原始波形和二阶微分波形的主要波峰波谷，依照 心动周期的 8 个典型时相，对指尖光电容积脉搏波划分出了 6 个重要时相，并 初步探究了几个时相内的变化趋势可能蕴含的生理意义。研究并分析了可能引起 波形趋势发生变化的影响因素。研究结果表明：指尖脉搏波与传统意义上测定的 腕部脉搏波之间存在较大差异；指尖脉搏波在五指间的差异不明显；食指和中指 最适宜采集较为稳定的指尖脉搏波；压力的变化会改变波形的振幅而不对时间参 数产生影响；一天内不同时间测得的波形间存在重搏点相对高度上的差异；心率 的上升会使得波形中重搏点逐渐消失。本文还通过离散地监测一天内不同时刻的 血压和容积脉搏波波形，研究了血压和波形中数个时相内时间参数之间的线性回 归关系。并以该关系式为基础，通过罗志昌教授 1996 年提出并在其后经过大量 文献论证的心输出量计算公式，进而从过负荷运动后恢复阶段的脉搏波形图中， 以两个时相的时长和心动周期总时长为自变量，尝试提取了心输出量、心搏出量 等重要生理参数，推导出了运动实时测算心输出量的可能算法。本文的研究成果 为更精准、便携的实时运动监测设备的开发提供了理论基础和初步实验验证，对 波形的分析利于其他研究者清晰地采集时间参数进行计算。为后续将波形和病理 学之间建立联系奠定了基础。
关键词： 运动实时监测，指尖脉搏波，光电容积描记法，
心动周期时相，临界心率阈值

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

4 / 47

Title: Preliminary Study on Pulse Wave of Fingertip
Photoelectric Plethysmographic
Abstract:
Real-time motion monitoring plays an important role in the training of professional athletes and the recovery of patients with cardiovascular diseases. However, at present, there is no portable and non-delay real-time motion monitoring device. This paper utilizes the Arduino UNO development board and Pulsesensor photoelectric sensor to make a portable and accurate fingertip Photoelectric Plethysmographic pulse wave acquisition instrument. Based on peaks and valleys of the original waveform and the second order differential waveform, according to the 8 typical phases of cardiac cycle, this paper recognizes 6 important phases and preliminarily discusses the physiological significance of these phases.Then I experiment and analysis influencing factors of the waveform. The wave of twist differentiates with that of finger. Wave difference between fingers is not obvious, while the index finger and middle finger is more suitable for the acquisition of waveform. The change of the pressure will change the amplitude of the wave, but not the time parameter. There is a difference in the relative height of the dicrotic point when measured at different times of the day. Heart rate rise will cause the dicrotic notch gradually disappear. Through the discrete monitoring of blood pressure and waveform at different time, this paper explores the linear regression relationship between blood pressure and several phases’ time parameters. Then this paper uses this relationship, based on the massively confirmed formula by Professor Luo Zhichang in 1996, to preliminarily extract the cardiac output, stroke volume and other important physiological parameters from the PPG waveform of the recovery after overload exercise. By using the length of two phases and the total cardiac cycle as independent variables, this paper deduces the algorithm of real-time monitoring of cardiac output. The results of this paper provide a theoretical basis and preliminary experimental verification for the development of more accurate and portable real-time motion monitoring equipment. The analysis of the waveform is helpful for other researchers to acquire the phase parameters, which laid the foundation for establishing the relationship between waveform and pathology.
Key Words: Real-time motion monitoring, fingertip pulse wave,
the photo plethysmography, cardiac cycle phase, the critical threshold heart rate

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

5 / 47

目录
1 引言 ....................................................................................................................................... 6 1.1 研究背景...............................................................................................................................6 1.2 研究目的...............................................................................................................................7 1.3 研究意义...............................................................................................................................7 1.4 研究技术路线.......................................................................................................................8
2 波形采集仪器开发.................................................................................................................9 2.1 采集技术现状.......................................................................................................................9 2.2 采集原理...............................................................................................................................9 2.3 硬件选择.............................................................................................................................10 2.3.1 光电模块 .................................................................................................................... 10 2.3.2 下位机开发板 ............................................................................................................ 11 2.4 采集仪器搭建.....................................................................................................................12 2.5 软件调试.............................................................................................................................13 2.5.1 数据采集程序 ............................................................................................................ 13 2.5.2 消噪程序 .................................................................................................................... 15 2.6 仪器测试.............................................................................................................................17
3 波形特征研究 ...................................................................................................................... 20 3.1 现有文献综述.....................................................................................................................20 3.2 PPG 波形特征探究 ..............................................................................................................21 3.3 PPG 波形变化探究 ..............................................................................................................23 3.3.1 测量位置对波形图的影响.........................................................................................23 3.3.2 测量点压力变化对波形图的影响.............................................................................24 3.3.3 测量时间对波形图的影响.........................................................................................26 3.3.4 心率变化对波形图的影响.........................................................................................28
4 PPG 波形中生理信息探究 .................................................................................................... 30 4.1 PPG 中提取生理信息的理论基础 ......................................................................................30 4.1.1 脉动信息提取 ............................................................................................................ 30 4.1.2 血压信息提取 ............................................................................................................ 30 4.1.3 血流信息提取 ............................................................................................................ 31 4.2 血压-时间参数回归方程建立............................................................................................32 4.3 心循环生理信息的提取.....................................................................................................35 4.4 数据分析及结论.................................................................................................................37
5 研究结论.............................................................................................................................. 41 6 研究展望.............................................................................................................................. 42
6.1 研究中存在的不足 .............................................................................................................42 6.2 研究展望 .............................................................................................................................42
6.2.1 优化实时运动监测仪器软硬件..................................................................................42 6.2.2 推进深度合作，扩大有效数据量..............................................................................42 6.2.3 设计智能化运动监测仪器并推广应用......................................................................42 7 参考文献.............................................................................................................................. 44 8 致谢 ..................................................................................................................................... 46 参赛团队简历 .......................................................................................................................... 47

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

6 / 47

1 引言
1.1 研究背景
日常生活中，运动有着维持或改善健康状态的作用：正常人通过运动强身健 体，运动员通过运动来增加或维持体能，有较轻心血管疾病的患者，在术后康复 期和姑息手术后观察期，也依靠适度的运动加速康复并调整身体状况。然而，过 负荷的运动可能会对身体机能造成不适或伤害，因此，一个准确、便携的运动监 测设备有十分重要的预警意义。
目前常用的运动监测仪器主要分为两种：
一种是医院使用的心电图采样机等专业监测设备，虽然可以准确地从多角度 监测人体的健康状态、对患者的心循环状况做出可靠评估，但需要专业医护人员 在静息状态下对患者进行监测，便携性较差从而无法用于运动实时监测。
另一类是如运动腕表一类的便携式运动监测设备，通过对心率(Heart Rate, HR)的测算实现实时监测；但其测量准确度往往有限，因使用心率作为判断指标， 导致评估滞后于症状，丧失了预警作用。同时心率运动阈值只能基于经验设定统 一值，不能体现个体差异及生理意义。
因此，人们需要一个能兼顾便携性、精准性，能无滞后且能体现个体差异的 运动实时监测设备。
分析上述两类监测仪器后得知，专业医疗设备的准确性是通过对心输出量 (Cardiac Output, CO)、心搏出量(Stroke Volume, SV)、脉压(Pulse Pressure)等精确生 理参数[1]进行监测而实现的。其中，心输出量作为心功能评判的最直接指标，对 运动监测也具很强的指导意义。而对于运动心率腕表，其便携性很大程度上缘于 光电容积描记法的使用。
光电容积描记法(Photoelectric Plethysmography, PPG)通过光波在皮下组织内 传播时的光衰减量来推导出微动脉中的容积变化，以此提取微动脉中血压和血流 信息。其原理为[2]：用一束已知波长的光照射皮肤，光线穿过人体后再通过透射 或反射的方式照射到光电接收器上，由于光线在穿过人体时会被各种组织和血液 吸收，接收器收到的光强度将减弱。而浅层微动脉的容积随心动周期发生周期波 动，会使得其中血液对光的吸收量也发生趋势相同的波动，于是，接收到的光电 信号就会呈现出相应的波形图，也就是光电容积脉搏波(简称 PPG 波)。(图 1-1)

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

7 / 47

图 1-1 光电容积描记法的原理[5] 因此，综上所述本研究目标便定义为：从便捷的 PPG 波形中提取 CO、SV 等 精准且无滞后的生理参数，试图找到能反映个体身体机能临界状态的关键参数点 作为阈值，来实现实时运动监测过程中的有效提醒或警示。
1.2 研究目的
自主设计、制作、测试，开发出可以简便且较为准确地采集 PPG 数据的仪 器；
用自主开发的仪器采集 PPG 波形，描述该波形；随后分析与已有文献中波 形的异同，研究其波形特征、影响因素和可以提取的生理信息；
基于已有文献的研究成果，尝试从采集到的 PPG 波形中提取 CO、SV 等生理 参数，提出波形用于运动监测的可能性。
1.3 研究意义
本研究的成果，初步完成了无滞后运动实时监测仪器系统的理论开发部分和 试验部分：
本研究制作的仪器可以简便、实时地采集 PPG 波形数据，有较好的准确性， 满足实验需求。后期，通过优化硬件设备和软件滤波算法可以更好地提高其准确 性，以及增加无线通讯方式也可以进一步提高其便携性，有较高的实用价值。
本研究首次将指尖反射型 PPG 波形从生理意义上划分为六个时相，可以较 好地对应心动周期，猜测了波形趋势的产生原因。随后在对波形影响因素的研究 中提出了数个重要假设，为从 PPG 波形中探寻病理信息提供了基础。若能成功 提取病理指导信息，可以比脉搏波波形参数[4]更为便捷地判定病患的心功能状况。
本研究基于使用脉搏波测定 CO 的算法[5]-[7]，实际操作了从运动后恢复阶段 指尖 PPG 波中提取 CO 的过程，提出了便捷 PPG 开发实时运动监测系统的算法，

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

8 / 47

为心血管病患和潜水员、航天员等特殊人群提供一种比心率监测更为准确、安全 的运动监测手段。
1.4 研究技术路线
本研究的技术路线如下（图 1-2）：

作者：李硕秋

图 1-2 研究技术路线
指导老师：李锂

题目：指尖光电容积脉搏波初步研究

9 / 47

2 波形采集仪器开发

2.1 采集技术现状
目前市场上对 PPG 波采集的方法主要分为两种：腕部 PPG 和指尖 PPG。
腕部 PPG 是将光电模块固定在手腕外侧，采用类似手表的佩戴方式，对反 射光进行采集并识别其中的生理信息。目前大量用于日常生活中的 PPG 监测设 备都是基于腕部 PPG。这一类设备大都设计为手表样式，方便人机交互界面的设 计，也方便使用者的佩戴，可以较为方便的提取简单运动信息，比如心率、步频 配速等，以初步满足运动监测的需求。
指尖 PPG 测量设备则常见于医疗辅助看护[3]，用于运动监测的设备非常少见。 其主要原因在于指尖 PPG 测量的不稳定性[8]。人的指尖往往呈嫩红色，这就表示 指尖的浅层微动脉数量较多，即微动脉总容积受心脏搏动的影响更大。对于采集 反射光的 PPG 测量设备，其波形的波动性会很强，使得经由放大器采集的脉搏 波形相比腕部波形更难处理，也就难以在实际监测中进行应用。
2.2 采集原理
PPG 的核心是将接收器收到的光电信号与微动脉内的血流容积变化建立联 系，其理论基础是朗伯-比尔定律(Lambert-Beer)和光散射理论[20]。
以对透射光的采集为例。当波长为 λ 的入射光以入射光强 I0 射入厚度为 D 的均匀组织时，透射光的强度 I 的计算方式为：
I =  
其中 E 为与 λ 特征相关的消光系数，C 为组织浓度。将等式两边取对数得：
ln  = ln  − 
然而实际上我们需要建立的是光强和微动脉截面积之间的关系，为：

ln  = ln  − 

将等式化为微分方程以获取光强变化量与截面积变化量之间的关系，为：

 1 

= − 



2 

考虑到实际上微动脉的截面积和光强的变化都非常小，因此可以大概认为光 强变化量与截面积变化量成负线性相关，即光电信号可以反向表示和容积脉搏波

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

10 / 47

相同的趋势。
而被照射的部位并不能等效为一个均匀组织，其包含皮肤、皮下组织、肌肉、 静脉和血流等许多部分，因此，可以将其等效为产生直流的皮肤等不随心动周期 改变的部分，和一个浓度会随心动周期发生搏动性变化的流体管部分（图 2-1）。

图 2-1PPG 波形搏动性变化示意图
从图 2-1 中可知，动脉中的血液会随心动周期产生搏动性变化，从而对吸收 光量产生影响，进而使光电容积脉搏波产生周期性变化。其中，光电信号中的波 动部分应与动脉容积的波动部分趋势正好相反，即心脏射血时动脉容积变大，光 电信号相应下降，心脏收缩时动脉容积减小，光电信号相应上升。
2.3 硬件选择

2.3.1 光电模块
基于硬件的基本功能考虑，光电模块应包含以下内容：一个发射光波长较为 集中且稳定、功耗相对较小的发光二极管；一个能够以较高精度将反射光信号转 化为电流信号的光电二极管；一个能以高分辨率将电流信号转化为电压信号的互 阻放大器；以及含有一个能对信号的高频噪音进行初步处理的检波滤波器。
基本原理为：输入的直流电压经过电阻降压之后加到发光二级管上，使二极 管放出最合适波长的光，经由皮肤和皮下组织吸收反射后，被光电二极管和互阻 放大器将光强信号记录为电压信号，随即被滤波器中的旁路电容滤去高频噪声， 输出的电压信号就可以很好的表示容积波的变化趋势。如此集成的光电模块，即 可以满足采集 PPG 波形的需求。
经过对比目前市场上常用的光电模块，最终选用 Pulsesensor 光电模块[9]。 该光电模块集成了一个发光峰值为 515nm 的绿光 LED、一个包含最简单放大器 的光电二极管和一个初步的滤波器；通过旁路电容消去采集到的高频信号，将信 号抖动滤去后放大输出（图 2-2）。此外，Pulsesensor 光电模块具有体积小、光 强高、能耗低等特点，便于使用和长时间监测续航。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

11 / 47

图 2-2 Pulsesensor 光电模块外形及原理
2.3.2 下位机开发板
鉴于 Pulsesensor 光电模块输出的是电压信号，任何开发板的模数转换 (analog-to-digital converter, ADC)端口都可以对该信号进行读取。
功能机理为：当输入一个模拟信号（电压值）时，依据积分器将该信号积分 完成的时间正比与信号幅值的原理，通过计数积分时间内的时钟脉冲数量来标定 该模拟信号的幅值，从而通过计数器的输出将数字信号输入开发板的核心以方便 各种算法对其的处理和提取；而输出的时候，藉由一个反向的数模转换 (digital-to-analog converter, DAC)器即可将电压值再次通过串口打印出来。
鉴于以上，在对开发板进行选择的时候，应在保证读取偏差不大的前提下尽 可能选用开发难度低的开发板以节省调试时间，为后期的数据采集和分析留出充 足的时间。另外，考虑到学校资源的便利性，最终决定选用学校通用技术课“电 子控制技术”上已经初步学习使用的 Arduino UNO 开发板[10]（图 2-3）。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

12 / 47

图 2-3 Arduino UNO 开发板外观和原理
Arduino 对需求没那么高的开发者提供了一种最简单易行的微控制平台，让 开发者可以节省出许多时间和精力用于对自己程序的设计和修改，这对于本课题 而言，也是最佳的开发方式。

2.4 采集仪器搭建

将光电模块的模拟电压输出接口接到 Arduino UNO 中上的 ADC 接口进行读 取，将光电模块的 5V 的电压供给线和 GND 零线与开发板上的对应电压接口连接 （图 2-4）。然后，再把 Pulsesensor 上 ADC 转换接口所读取的模拟信号，通过串 口通讯传输到电脑保存，再导入到 Microsoft EXCEL，用“插入-折线图”命令画 出 PPG 波形图。

另外，考虑到光电模块的线路都暴露在外，会加速 Pulsesensor 的失灵，导

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

13 / 47

致精度下降，甚至无法再测出数据。因此，在坏了两枚传感器之后，用热熔胶枪 在电路元件一侧贴一层保护层，同时在发光二极管的一侧贴上一个薄塑料膜，防 止手指上的油脂和汗液浸入传感器，破坏电路。经试验，这样会使接收到信号的 峰值略微下降，但对整体信号的采集无太大影响。

图 2-4 硬件搭接图
最后，用粘贴绑带把光电模块与指尖以合适压力固定，使用 AccessPort 串口 读取应用，就可以把指端脉搏波信息记录为 PPG 波形保存下来，结果证实此采 集仪器方便快捷，稳定可靠，能满足本研究的采集要求（图 2-5）。

2.5 软件调试

图 2-5 采集现场示例

2.5.1 数据采集程序

确定了硬件系统之后，由于 Pulsesensor 官方有配套的 Arduino 程序[9]，故二 次开发时提供了许多便利性。Pulsesensor 上已经集成了 LED、环境光感受器、滤

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

14 / 47

波电路和放大电路，故开发时只需使用 ADC 转换接口读取输入的模拟信号，将 其通过串口通讯传输到电脑即可。程序如下：
配置 interrupt 的各项参数：

此后每 2 毫秒会进行一次触发：
触发中只是读取 ADC 端口返回给 UNO 开发板的信号即可，随后在将 Signal 打印的时候将其反向为容积波信号即可：

其中，917 毫伏是 DAC 端口输出的电压上限，当 ADC 端口输入了高于 917 的电压信号则会被开发板“削颈”，只保留 0~917 之间的电压信号，故在反向光 电信号时为了方便，打印(917-Signal)的数值而得到容积波信号。至于为什么要在 loop 函数而非 setup 函数中制造打印开始点，则是因为当读取刚开始的一段时间 内，无论是手指和传感器的接触还是端口本身都有一定的不稳定性，如果等到上 位机（电脑）端给出信号才开始 interrupt 的配置和读取，输出的前面几百个数 值将完全不准，对后面数据的精确性造成不良影响。故而提前让信号从传感器中 输出，但不打印，能够保证打印出的数据都具有较高可靠性。
至此，得到的一系列电压数值可以画出初步的 PPG 波形图（图 2-6）。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

15 / 47

图 2-6 初步绘制的 PPG 波形图
容易发现此图中噪音依然很多，虽然整体趋势已经有正确的 PPG 波形的样 子，但是如果对该图做二阶微分就完全是一片混乱了（图 2-7）。

图 2-7 原始波形的二阶微分图样 因此，对输出的原始波形进行降噪是十分必要的。

2.5.2 消噪程序

由于 Arduino UNO 开发板和 Pulsesensor 本身的局限性，即使放大 330 倍的 环境噪音被内置的初级滤波电路消去，当输出频率高于 50HZ 时，板内振荡电路 和晶振的计时电流都会对信号的采集产生影响，同时由于输出的电压信号都是整 数且存在上下限，因此直接输出的数值会有很大的不稳定性。对此，需要一个程 序对直接输出的数据进行二次滤波降噪处理。

对波形进行降噪有三种思路：时域分析法、频域分析法和时频分析法。

时域分析法利用了脉搏波本身的周期性和其他一些波形特征，在原始图样基 础上通过拟合、微分等方法直接处理波形，计算量小且操作起来十分简单，但是 这种方法舍弃了信号的时序信息，无法获取脉搏波信号的全部信息内容；

频域分析法主要分为快速傅里叶变换法和最大熵值估计法，这两种方法在处 理平稳信号时十分有效，尤其是后者产生的 AR 谱可以将波形的时序特征充分地 表露出来，但是对于脉搏波而言并不十分适用，无法体现出频谱信息随时间变化 的特征；

时频分析法中主要被应用的是小波变化法[11]，能够在时频平面上拥有可变时 频分辨率的基函数，因此对脉搏波这类非平稳信号而言分析效果很好，也在各种 科研文献的数据处理中大量应用。但其缺点在于算法编写较为复杂，程序调试所 需的时间和精力都很多，对本研究而言，学习小波变换的使用得不偿失。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

16 / 47

综合考虑，本文中的信号分析并不需要包含充分的时序信息，信号采集的过 程中也没有过于明显的基线漂移这种必须使用小波变换才能处理的误差，使用小 波变换尽管会使得波形的信息全部表露出来，但是学习小波变换和 FFT 的基础知 识将耗去大量时间，对本研究而言意义不大。因此，最终决定采用时域分析法处 理文中所采集的波形噪声。
通过 Python 语言编写的时域分析法降噪算法如下。
首先，在所有的数据中以 100 个数据点为间距寻找“组中心”，并将组中心 的左右各 125 个数据加入该组中心的“组”。这样，每组共 250 个数据（时长 500ms， 可以覆盖绝大多数的完整心动周期，且不在一个组内覆盖两个以上的心动周期）， 将来进行拟合计算时去掉左右两端共 50 个数据，每个组内的有效数据为 200 个， 即每个数据被且仅被两个组覆盖：

然后使用 numpy 处理包中的高次拟合函数对单位内的数据进行 20 次函数的 拟合，随后对拟合之后的组内有效数据以 0.1 为单位进行重采样（即将数据量扩 大 10 倍）：
之前提到了每个点被两个组覆盖，这时就要根据这两个组的拟合数值对这一 点的最终数值进行加权平均，权重即为该点到相邻两个组的组中心之间的距离：
这样，就完成了对原始 PPG 波形的分段切片拟合工作，并同时将数据量扩 大了 10 倍，保证了对拟合曲线还原的精度，使得下一步的差分法求微分的计算 精度进一步上升。下一步将拟合后的 10 倍分辨率的数据存储，然后差分求一阶 微分和二阶微分：

至此，拟合消噪的过程就处理完成了，为了再对波形进行观察时更加方便， 原程序中有对一阶微分和二阶微分进行再次拟合的过程，但此数据仅用于显示波

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

17 / 47

形图的特征使用，不能使用拟合之后的二阶微分标定原始波形的特征点，故在此 不再赘述。
最后，将扩大了 10 倍的数据以 10 为间隔输出，保证拟合输出的数据没有时 序信息的巨大变动和分辨率的变化：

d0_、d1_、d2_就是返回的消噪后数值。此降噪方法可以很好的消去本仪器 测量过程中的噪音（图 2-8），可以很清晰地看出与原始波形的区别。

图 2-8 拟合后使用 matplotlib 包中的 plot 函数画出的图形 （从上至下依次为 d0_、d1_、d2_拟合后的图样）
2.6 仪器测试
随后，使用配置完成的波形采集仪器对指尖 PPG 波进行进一步的测试，验 证其波形的稳定性。
先用数据采集系统对 4 个样本的指尖 PPG 信号进行采集，每 20ms 输出一个 数据，观察相同个体或相近年龄间波形是否稳定以及不同年龄间的初步差异。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究
测试过程： 30s 静息 20s 内小臂小范围摆动，造成传感器与皮肤之间出现扭动 20s 静息 20s 内共起身+坐下 5 组 30s 静息，手背朝上将手置于平面上。 测试结果（详见附件数据）：

18 / 47

图 2-9 不同个体的 PPG 波形图

a：45 岁女性 b：18 岁男性 c：2 岁男性 d：50 岁女性

图 2-9 中，每两条横线之间的距离都为 100mV。初步得出结论：

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

19 / 47

本仪器在同一个个体上采集到的数据具有相对稳定性。如果小幅度的动作不 会引起传感器与手指接触面夹角之间的变化（起身+坐下），则对波形不会有太大 影响；反正则会对波形产生较大干扰。实验中应尽量避免手指与传感器之间的大 幅度相对滑动。
年龄较小的对象相对年龄较大的对象而言，波形的振幅较大，重搏点更加明 显，波动性较强。而与性别相关的波形变化在这里并不明显。在相近年龄段的个 体中波形也存在变化，因此 PPG 波形中可能蕴含能够指示被测对象病理信息的 数据。但对于 PPG 病理学价值的研究需要更精密的医疗设备和大量临床样本用 于对照实验，因此本文将在后续研究中开展这方面的探寻。
另外，测试过程中，发现本研究得出的 PPG 波形信号与文献中的波形信号 有较大差异。排除实验装置的不稳定性之后，确定本研究使用的采集仪器确实会 采集到一种独特的波形信号。于是，接下来对本文测得的波形进行描述和分析。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

20 / 47

3 波形特征研究
3.1 现有文献综述
对于腕部 PPG 采集技术和透射型指尖 PPG 采集技术，目前已有充分的文献 研究对其波形特征进行分析。然而，其中的波形与本研究进行仪器测量时获得的 PPG 波形不尽相同。文献中，波形之间的差异性主要体现为腕部 PPG 和指尖 PPG 波形之间的差异和五指指尖之间的 PPG 波形差异（图 3-1）。

图 3-1 文献中 PPG 波形
（a 为腕部脉搏波[6], b 为反射型指尖脉搏波[8], c 为透射型指尖脉搏波[11]）
本研究使用的 PPG 波采集方式为反射型指尖 PPG，但并不时时刻刻与 b 图 的波形相近。常常在早晚测量时重搏点相对高度较低，而中午、下午测量时的波 形则和 b 图相近。因此，推断测量 PPG 波的时间对产生的波形具有一定影响。
另外，Hiroshi Osanai 等人对五根手指之间的反射型 PPG 波形做了二阶微分 处理后分析其之间的差别[13]，得出了除拇指外其他波形趋势大致相同的结论（图 3-2）。

图 3-2 五指指尖反射 PPG 波形的二阶微分曲线
（I 至 V 分别为拇指、食指、中指、无名指和小指）
本研究在进行预测量时，也初步发现拇指的波形重搏点波动性较差，相较食 指和中指更难使用。因此，为了能进一步对本研究测得的波形进行探究，有必要 对测出的波形做详细的描述和分析。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

21 / 47

3.2 PPG 波形特征探究
在初步测量的 PPG 波形数据中，抽取一组典型波形进行描述。其余大多数 波形虽然在重搏点的幅度和波形的电压数值上存在差别，但总体趋势和各个区间 内的时长都相差不大，因此从一个典型波形图（图 3-3）中分析得出的波形特征 可以作为典型结论使用。

图 3-3 典型 PPG 波形
首先，可以识别出波形中几个较为明显的波峰和波谷，随后对每一个波峰波 谷之间的波形趋势进行分析（图 3-4）。

图 3-4 典型 PPG 波形趋势划分
以 a 至 g 标记一个波形周期，则在该波形的一个周期中，一共有 b、d、f 三 个较为明显的波峰和 a、c、e 三个较为明显的波谷。其中，a 称为主谷，b 称为 主峰，随后的波形一般在主峰值和主谷值的中位线略高处上下波动。理论上讲， 心脏在一次射血后渐渐舒张，波形应该只有一个波谷和波峰，而实际上却出现了 重搏点 d 和 e、f 两次小波动。对此，需要对心脏一次射血周期中的行为进行分 时相讨论，初步确定每一个时相[14]对应的微动脉容积变化。
但由于时相周期较短，一些时相无法在波形中实现很好的对应，而在查阅文 献时发现有对 PPG 波形图二阶微分提取生理学信息的前例[8][13]，故本研究决定通 过对波形求二阶微分来更加细致地区分各个时相的具体位置（图 3-5）。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

22 / 47

图 3-5 指尖 PPG 波形二阶微分
由于二阶微分所表示的几何意义即为原函数点的凹凸性，故二阶微分曲线的 极大值和极小值在原函数图像曲率最大处取到，即标志着这一点的趋势（斜率） 变化最为明显。
a 为微动脉容积最小值点，也表示容积增大的趋势最明显的地方，即快速射 血期的开始。b 为微动脉容积的极大值处，也表示容积增大的趋势停止得最明显 的地方，即快速射血期的结束。ab 持续约 0.09 秒（45 个数据），与快速射血期 时长相近。
b 之后微动脉容积因为射血速度下降而下降，到 c 表示容积下降停止的点， 即减慢射血期的结束。bc 持续约 0.13 秒（65 个数据），与减慢射血期时长相近。
c 后，房室瓣降低了静脉回心血充盈的速度，使得微动脉中容积出现一次反 升，即重搏。d 为容积出现反升趋势的标志点，即等容舒张期的开始；e 即为重 搏点，为等容舒张期的结束。cd 持续约 0.05 秒（25 个数据），与舒张前期时长 相近；de 持续约 0.09 秒（45 个数据），与等容舒张期时长相近。
e 之后进入充盈期，充盈的速度变化造成容积不断波动，总体呈下降趋势。 由于不同人群的心动周期时长差别主要体现于充盈期时长[21]，故精确定位充盈期 时长意义不大。f 点波形转入快速下降，即心房收缩期的开始。其后，g 点波形 的二阶微分为 0，即微动脉容积由加速下降转为减速下降的标志点，即等容收缩 期的开始。h 为下一个周期的开始。fg 持续时长约 0.04 秒（20 个数据），与心房 收缩期时长相近；gh 持续时长约 0.04 秒（20 个数据），与等容收缩期时长相近。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

23 / 47

至此，对 PPG 波形的特征描述和背后的生理学信息猜想解释就已经完成了。 另外，虽然大部分 PPG 波形都可以适配上述理论模型，得到合理的解释， 但有的波形中重搏点的高度甚至可以超过主波峰，这种情况在所有文献中都未被 提及过。
因此，为了探究引起这个异常重搏的具体生理原因，之后又进行了多次 PPG 静息情况采集，发现重搏点的高度并不是时刻都一样的，测量时传感器与指尖压 力的变化似乎对波形波动性有一定影响，而不同时间测量的 PPG 波形表现出的 波形特征至少在重搏点上出现了差异，心率比较快的时候得到的波形也与心率较 慢时的波形存在差异，因此有必要对 PPG 波形的影响因素做进一步的探究。
3.3 PPG 波形变化探究
3.3.1 测量位置对波形图的影响
首先使用本研究开发的仪器，对文献中表现出来的指尖波和腕部波之间的波 形差异性进行验证（图 3-6）。

图 3-6 指尖和腕部 PPG 波形对比
（a 为两组指尖 PPG 波形，b 为两组腕部 PPG 波形
a 中两横线间数值差为 100mV，b 中两横线数值差为 10mV）
发现，指尖波的波动性相较腕部更强：相对微动脉分布没有那么密集的腕部， 指尖可以让测得波形中的波动成分占比较大，从而获取更多的生理学信息。然而 指尖 PPG 波形的弊端也在实验中暴露无遗，“削颈”现象的出现确实表明从指尖 脉搏波中直接提取生理学参数乃至进行运动实时监测都有很大的困难，因此，通

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

24 / 47

过讨论一些外加因素的影响使指尖 PPG 波形尽可能利于信息提取是十分必要的。
另外，考虑到不同手指的指尖形状不一，无论是面积、厚度还是内部微动脉 粗细都有所不同，因此不同指尖采集到的 PPG 波形有所变化理论上属正常现象。 为了深究手指之间的波形存在什么样的差异，在此对每根手指的波形图进行比较 分析（图 3-7）。

图 3-7 五指间 PPG 波形图
（从上至下依次为拇指、食指、中指、无名指和小指
每两条横线之间的电压值差为 50mV）
发现，拇指的波形中主峰不明显，而无名指和小指波形的波动性较差，而食 指和中指大抵类似，具有较好的主峰，同时又具有良好的波动性用于波形信息提 取。这与已有的透射型指尖 PPG 分析得到的结果相似[13]。最终，采用波动性适 中的中指采集指尖 PPG 波形。
3.3.2 测量点压力变化对波形图的影响
从多次的测量数据发现，有时候指尖波的波动性也会发生很大的变化：有时 波形的极差可以达到 600mV 以上，而有时只有 200mV 左右。对此，猜测是测量 过程中手指捏着传感器不稳定，造成的压力变化影响了脉搏波的波动性，并对此 展开实验。
首先为了防止测量过程中手指与传感器之间压力的变化会对测量结果产生 影响，采购了一种粘贴带，在传感器背面粘上一个粘贴扣，粘贴扣和粘贴带之间 可多次反复粘贴，而粘贴带自身也可以环绕手指一圈之后粘贴固定，因此只要测 量之前将粘贴带固定好就可以避免测量过程中测量压力的变化（图 3-8）。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

25 / 47

图 3-8 压力测试示意图
随后进行测试，每组中先粘好粘贴带，将指尖和传感器之间的压力调整到合 适范围后，先进行一组不记录数据的预测量，确定当前的压力可以产生较为稳定 且波动性不至于太大的波形，然后开始正式测量：将手腕垫于桌面上，手指自然 下垂且不接触桌面，呼吸稳定后开始 10 秒的数据采集，然后不关闭采集系统， 立刻捏住传感器，用手指按压增强传感器与指尖的压力，随后维持压力或使压力 稍微下降，记录 10 秒的波形数据后结束。随后对波形进行简单对比（图 3-9）。

图 3-9 三次不同压力下测试 PPG 波形对比图
发现，压力的增加可以使波形的波动性减弱，且随压力增强的大小而变化， 即压力增大的越多，波形被“挤压”的越重，波动性也就越小。直观上讲挤压后 的波形和原来的波形没有时间参数上的差异，只体现在幅值上的差异，但实际上 时间参数尤其是 Td 是否会受压力影响还不能妄下定论。因此将这些数据进行拟 合处理后求二阶微分，探究其 Td 是否随压力的变化而变化（图 3-10）。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

26 / 47

图 3-10 压力测试 PPG 波形二阶微分
（c 中的中断区域缘于第三次测试的压力变化过大）
可以看出，Td 的变化和 T 的变化是完全同步的，并不因为压力的突然变化而 产生突然的上升或下降，因此可以认为 Td 的输出不受测量点外加压力的影响。 至于增加压力会使得 T 上升的原因，可能是测量过程中的完全静息状态造成了心 率缓缓下降，从而使 T 上升，与外加压力的突然变化无直接关系。
综上所述，测量点外加压力的增强可以使 PPG 波形的波动性下降，外加压 力越强波形的波动性越低，但对波形的改变仅限于波动性，对时间参数的测量没 有明显的影响。
3.3.3 测量时间对波形图的影响
在测量过程中，发现：早上饭后，中午饭前和深夜的时候重搏点会异常地高， 其他时间则呈现较为正常的脉搏波波形，即主波峰高于重搏点，重搏之后波形维 持在较高位置一段时间之后再在心房收缩期迅速下降。
为了探究 PPG 波形在一天内的具体变化趋势，本文在三天中记录了从早晨 到下午 9~10 个小时内，每个整点时刻的 PPG 波形图，纵向对比一天不同时段的 PPG 波形，以大致了解 PPG 波形在一天中的变化情况。其中，三天之间的 PPG 波形变化趋势大致相同，在此仅列出其中一天 10 个整点的 PPG 波形（图 3-11）。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

27 / 47

图 3-11 不同时间 PPG 波形图
图形对比可以得知，早上刚起床时主波峰高于重搏点，呈正常波形，到中午 时重搏点会不断升高，吃午饭后会立刻下降，然后在下午重复这个上升过程，到 晚饭后又立刻下降为正常波形的样子，并在睡觉前保持正常波形。
关于为什么重搏点会呈这样的变化趋势目前尚未有人提出确切的理论，本文 在此提出一种猜想：重搏点可以一定程度上指示血管顺应性 AC 或者脉搏波传导 速度 PWV[2]，即血流在血管内流动的速度越快，静脉回心血被阻塞后的反射波就 越强，也就对应着越高的重搏点。而人体处于空腹状态时的血糖含量比饭后较低， 且血糖浓度一定程度上会影响血流的粘滞系数，即影响 PWV。于是，睡觉时， 体液调节使肝糖元分解以维持睡眠过程中的较低水平代谢，而刚起床时这个过程 并没有马上停止，使得血糖浓度在刚起床的一段时间内依然较高，从而降低了 PWV，使重搏点较低；吃过早饭后的一段时间内维持较低值，但随着上午活动消 耗掉了早饭供给的能量，血糖浓度不断下降，没有大量肝糖元补足的血糖浓度迅

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

28 / 47

速下降，从而使 PWV 不断上升，重搏点也因此不断上升乃至超过主波峰；下午 和晚上也是类似的过程，但晚饭后生物钟调节使人体代谢水平下降，血糖浓度的 下降没有那么快，同时肝糖元的补足效果也逐渐达到最强，故而如果不熬夜太久， 重搏点不会再一次突破主波峰达到高值。
对此猜想的验证需要更高级的实验设备来连续监测血糖，同时需要更多的实 验样本以提供有力的证据支持，这都超过了本课题的研究范围。故在此仅提出猜 想而不再做进一步的论证。
3.3.4 心率变化对波形图的影响
在几次测量中，发现刚刚激烈活动过后的 PPG 波形会出现重搏点稍微上升 的现象。基于这些现象，本文做了一些高负荷运动后心率逐渐下降的恢复过程内 实验，探究心率变化对波形图的影响（图 3-12）。

图 3-12 不同心率(高、中、低)PPG 波形图
实验过程为：通过剧烈运动（高抬腿、快速爬楼梯）使得心率迅速上升到过 负荷水平，等到被测对象出现过负荷运动症状时停止，然后迅速戴上数据采集系 统对 PPG 波形进行采集，其后的一段时间内要求被测对象静止坐在椅子上，保 持平稳呼吸，使波形不至于有较大波动即可。等到被测对象表现平缓，心率下降 缓慢时即停止测量。
以上图中的三个波形分别为同一次测量之中的高、中、低心率段的 PPG 波 形。从中可以得知，在高心率段时振幅较小，重搏点完全不明显，随着心率的不 断降低，重搏点开始显现出来，并在之后的心率下降过程中不断升高。另外，从 图中也可以看到，在重搏点不断升高的过程中，重搏点在一段时间内基本保持水 平，之后再开始一点一点上升。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

29 / 47

本文在此识别“重搏点开始显现出来的心率界线值”为“重搏点出现的临界 心率”。对同一个对象三组波形的临界心率处 PPG 波形（图 3-13）进行如下分析：

图 3-13 3 组 PPG 波形对比图
计算后得知这三组波形中的临界心率值都在 146 左右，对同一个体相对稳定。 据此，推测临界心率值是一个确实具有一定生理意义的特征量。下面对高心率段 没有明显的重搏现象的原因提出猜想。
基于之前医学研究者们的实验结果，当外加负荷不断上升时，周身需要更快 的血流半更新率（ALK），即需求更高的心输出量，为此，心率出现代偿性增长来 增大 CO，但是心率的增加同时会压缩心动周期的时长，尤其是舒张期的时长， 这个时相的微调在动脉的表现特征即为随心率的增加，收缩压上升较缓慢而舒张 压上升较快，表明心动周期中舒张期的缩短大于收缩期的缩短。这在一方面会造 成单次射出血流量的下降即 SV 的下降，另一方面会造成每两次搏出之间的时间 间隔缩短。考虑到 PWV 主要受外周阻力和血管顺应性的影响而变动，心率上升 后 PWV 变化并不大，则脉搏波传播到心房的时间并没有太大的变化。也就是说， 虽然每两次射血期之间的间隔大幅度缩短了，静脉回心血产生的推进波的传播速 度却没有大的变化，那么依赖于反射波形成的重搏点也就会在心率过高时消失。
据此，重搏点出现的临界心率的生理学意义即在于“脉搏波不经阻塞地流通 心循环系统”的临界情况，此时所有的推进波都不会被房室瓣阻隔而产生反射波， 会刚好赶上下一组充盈期，把静脉回心血最大程度的利用起来。即，临界心率是 被测对象最适宜进行运动的心率，心率在此之下会使回心的血液无法被充分利用， 而心率在此之上则会使充盈期的血液供给不饱满，这两种情况一定程度上都会降 低心脏泵血的功效。
为了验证“临界心率”确实是一个具有上述生理意义的特征量，需要对几个 不同个体的“临界心率”进行采集，判断其临界心率值与运动符合之间是否存在 上述联系。为此，对能够直接指示心脏射血功能状态的心输出量进行提取是必要 的，接下来的工作即为从指尖 PPG 波形图从提取 CO、SV 等生理信息。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

30 / 47

4 PPG 波形中生理信息探究
4.1 PPG 中提取生理信息的理论基础
基于上一节的研究结论，PPG 波形与心动周期的时相信息之间存在直接对应 关系。因此，可以基于已有文献研究结果，通过 PPG 波形中的时间参数信息， 从 PPG 中对微动脉中的生理信息进行提取（图 4-1）。

图 4-1 指尖 PPG 波形二阶微分
4.1.1 脉动信息提取
脉动信息即心率，在 PPG 中体现为心动周期的时长，在图 4-1 中即为 a 与 h 之间的时间间隔。采集到波形之后，可以藉由识别 PPG 中最低的波谷点对 a 和 h 进行识别。
4.1.2 血压信息提取
因为 PPG 为容积波，无法直接体现血压信息，而在容积波与压力波之间构 造联系也受制于测量的外加条件，如测量压力、时间等。因此，医学上通过大量 离散测试点建立血压与 PPG 波形中时间信息的回归关系，通过对 PPG 中时间参 数的测量实现对血压的估计。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

31 / 47

已有文献中表明，脉搏波传导时间(pulse wave transit time, 简称 PWTT)与血 压之间存在良好的线性关系[15]，而在指端单点 PPG 波形中也存在一些时间参数 可以与血压建立较高相关性的回归方程[16]。基于之前论文的时相分析结果和文献
调研中的高相关性时间参数，对图 4-1 中 ab、ac、be、dh 之间的时间间隔（记 为 Tab、Tac、Tbe、Tdg，对于某些波形来说 c 点不明显，即 Tac 无法测量）和文献 中提到的 1/2 振幅处时间间隔（记为 Tw）进行采集，与血压之间建立线性回归 关系式，以从 PPG 中提取血压信息。

4.1.3 血流信息提取

血流信息的临床测量方法大多使用侵入式测量，基于 PPG 的血流信息估算 则需要依靠有成熟研究的心血管模型（Windkessel 模型等）得出。下面参考已经 成熟的两套心输出量(cardiac output, 简称 CO)和每搏出量(stroke volume, 简称 SV) 的计算公式，给出实时测量 CO 和 SV 的方法以及修正测量结果的方法。

在 Wessiling 弹性管模型基础上，罗志昌教授等完成的 SV 计算公式[4][17]可以 较好的适应临床情况，为：

0.283

SV =

( −  )



其中，K 为脉搏波波形特征量，为罗志昌教授提出的可以很好的反映受试者 生理特征的参数，为：

 −  K=
 − 

上述公式中，Ps 为压力脉搏波最高压，Pd 为压力脉搏波最低压，Pm 为平均 压，T 为心动周期。罗志昌教授随后做的对于不同人群的波形提取实验表明，对 于心循环系统健康的青少年来说，K 在很长一段时间内都将保持在 0.33 左右，其 生理耐受性可以耐受 18~24 岁的年龄变化。

假设得到的血压和某一个时间参数 Tx 的线性回归方程如下：  =  ×  +   =  ×  + 

则 SV 可以得到测算，由心输出量与 SV 之间存在着本征关系：

60 17 CO = SV × HR = SV × = ( −  )
 

此公式自罗志昌教授提出后不断被后续实验验证[18][19]，有大量期刊和硕士 毕业论文都基于其推导理论基础，因此可信度较高。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

32 / 47

4.2 血压-时间参数回归方程建立
基于 4.1.2，PPG 波形中的时间参数与血压之间应该存在一定的线性关系， 且该关系是在时间参数中提取 CO 等生理参数的必需关系式。生物医学上，利用 一天内人体的生理状态发生的变化，可以得到 24 小时血压变化图（图 4-2）。

图 4-2 24 小时血压变化图
因此，利用身体自身的血压波动，测量几天内几个离散特征时刻的血压值并 同步测量 PPG 波形即可构造血压和心动周期时间参数之间的线性回归关系。本 文测量了同一个样本三天（8 月 9、11、13 日）的共 29 组血压-PPG 数据，随后 人工采集 2.4.2 中提到的 5 个时间参数（表 4-1）。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

33 / 47

表 4-1 三天内血压-时间参数表
其中，最左边两列表示数据采集的时间。T 为心动周期，Tw 为为波形 1/2 振 幅处的宽度，Txy 为加速脉搏波中 x 点到 y 点的距离，依据本人另一篇论文中的 结论，Tab 为快速射血期，Tac 为收缩期（不是所有的波形都具有 c 特征点，故不 一定可以找到这个时间），Tbe 为主波峰到重搏波峰的时间，Tdg 为舒张期。k 值为 波形中采取的 T 值和血压计测量的 HR 的乘积除以 1000，单位为秒，理论上讲应 该等于 60，在这里，这个 k 值代表血压计测量的 HR 和使用其中一组比较好的心 动周期计算出来的与 HR 之间的差异，k 约接近 60 表示这次测量的数据的可靠性 越高。
根据上述实验数据，建立血压-时间参数的线性回归方程。（图 4-3）

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

34 / 47

图 4-3 血压-时间参数的线性回归图
（左侧的 5 张图纵轴为收缩压,右侧的五张图纵轴为舒张压。）
分析图样可知，虽然得到的最高相关系数在 Tw-Pd 图中出现，但其对于 Ps 的相关性较差；而对于论文中验证具有高线性关系的 Tbg（Td）在图中显现了很 好的均匀分布，对 Ps 和 Pd 的相关系数分别是 0.306 和 0.532，对于 22 个数据点 的回归分析来说已经算是较强的线性关系了，当数据量足够大时，我们有理由相 信 Td 可以与 Ps 和 Pd 建立很好的线性联系。因此，使用 Td 对 Ps 和 Pd 建立回归方 程以用于血压信息的提取是毫无问题的。
这样，我们就通过 24 小时离散血压-时间参数测量的实验获得了 Td 对 Ps 和 Pd 的回归方程：
 = −0.0196 + 110.07
 = −0.0245 + 68.531

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

35 / 47

由这两个回归方程，即可实现对血压信息的提取。接下来进一步提取 CO、 SV 等心循环生理参数。
4.3 心循环生理信息的提取
理论上讲，为了能开发实时运动监测系统，应该在运动中测量长时间的一段 PPG 波数据，对其进行分析、计算得到公式及其检验。实际上，本研究在采集了 跑步机上逐渐加速跑的四组数据之后，发现目前的仪器并不能承受运动时的大幅 度晃动，使得数据呈现完全混乱的态势。因此，采用测量过负荷运动后恢复阶段 的 PPG 波进行替代的方法，采集运动时的 PPG 波形数据。
为了有更加充分的恢复阶段数据，本研究又邀请了 6 名同级或低一年级的同 学参与实验数据采集。采集到了恢复过程中的 PPG 波形数据之后，编写了一个 python 的小程序对波形进行分析，利用理论基础对血压血流参数进行测算。
基础的拟合和求导的算法与之前论述的没有本质区别，为了方便使用，将拟 合并求导的算法整理为一个函数，命名为 deriving。该函数的功能为输入一个 rawdata 数组包含原始数据，输出两个数组分别是拟合后的原始 PPG 波形数据和 其二阶微分的加速波数据。

得到输出的 PPG 信号及加速波波形后，为了对其中的时间参数进行采集， 本文将 PPG 原始波形和加速波进行对比分析（图 4-4）。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

36 / 47

图 4-4 原始波形和加速波对比图 由前文知，一个完整的心动周期可以通过识别 a 和 h 来进行确定，在 PPG 原始波形图中表现为两个相邻最低点之间的距离，可以根据波谷点的基础判定很 容易地找到。
其中，400 为观察大量数据之后人工校对的一个可以满足 a 或 g 点数值的波 谷上限，可以很好的筛选掉绝大多数非 a 或 h 的波谷点。对于其他未能被 400 筛去的数据点，先将所有这些波谷记录到数组 ppg_bg 之后再进行筛选处理。

对 ppg_bg 里面的数据，如果相邻两个波谷点之间的间隔为 120 个数据点以 下，则认为这两个波谷中的较前一个为 d 点波谷，将其筛去。其中，120 同样是 人工校对结果，可以最大程度的适用六组波形数据。
确定出原始波形中的波谷之后，下一步就是找到对应心动周期的 Td，即 Tdg， 观察到是加速波形中两个较为明显的波峰，可以通过刚才找到的原始波形波谷和 加速波与原始波之间的数学联系来确定 d 和 h 的位置。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

37 / 47

先构造两个爬升函数，分别输出波谷点向左右两段的爬升顶点，即通过波谷 找两侧波峰的函数，其中<0 的限制是为了防止有些波形中的过高 c 点对其产生 干扰。然后，对于刚才算出的 PPG 原始波形的波谷，对应到加速波中也是 a 或 h 的位置，即波峰，将这个点向右平移一定长度（20 和 40 人工校对的经验值，两 个不一样是为了防止 b 点出现的反常波峰对数据采集造成的影响），移动到 b 的 位置，即可把每个原始波形中的波谷对应到加速波中的 a 和 d 点用爬升函数找到。 而前一个心动周期的 h 和后一个周期的 a 是同一个点，因此，只要输出 ppg_bg 中后一项对应的 a 减去前一项对应的 d，即可得到 Td。
上图中五个输出值分别是：心动周期波谷的位置、这个心动周期的长度、心 动周期内的 d、心动周期内的 h 和心动周期的 Td。完整输出如下：

图中的复杂计算和数字均为 4.1 中讨论过的计算公式，而血压的计算则基于 第 4.2 节中所构建的回归方程。

4.4 数据分析及结论

将产出的脉动、血压和血流信息制表，使用 excel 的制图工具绘制不同参数

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

38 / 47

随恢复过程时间推移的变化趋势后进行特征分析，同时将重搏点出现的临界心率 在图上做标记，得到一系列的心血管参数随时间的变化图样（图 4-5） 。

图 4-5 脉动、血压、血流信息变化趋势总图
图中，红点表示此次测量中的重搏点出现的临界心率位置。采集到六组数据 的 CO、HR 随时间变化曲线见下图 4-6 所示：

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

39 / 47

作者：李硕秋

图 4-6 六组数据的 CO 与 HR 的变化趋势图 指导老师：李锂

题目：指尖光电容积脉搏波初步研究

40 / 47

在实验中发现，对于每个个体而言，三组测得数据中的“临界心率”都是稳 定的：对于第 1~6 组分别为：147、162、131、141、157 和 159，偏差±1。故 而解决了 3.3.4 中提出的问题，证实了“临界心率”的生理意义。
由前文推导的结论，临界心率点表示“最适合对心功能进行锻炼的心率”， 具有一定的运动监控指导意义。在图 4-6 中，临界心率所在“红点”位置大多标 定了 CO 的一个突然断层，心率在此之上时 CO 较心率降到临界心率之后的 CO 有 一个明显的下降，称为“CO 的突然转折点”。该转折点普遍存在于测量得到的六 组数据中，因此有理由认为该转折点是 PPG 波形数据在运动后心率恢复过程中 存在的一个内在生理学规律。
而这个“突然转折点”的内在原因也和 CO 的本征意义相关。由于 CO 的生 理学意义是 SV 和 HR 的乘积，会受二者的共同影响。在运动过程中，心率会逐 渐上升，而搏出量会逐渐下降，而当心率过快时 SV 的下降趋势快于 HR 的上升 趋势，即运动负荷过大时，HR 对 CO 的代偿作用已经无法补足 SV 的快速下降。 在 CO 的变化趋势图中，即反映为波形的突然转折。因此，突然转折点的生理意 义标志了心脏供血无法满足运动负荷的特征点，这与“重搏点出现的临界心率” 在生理意义上是类似的，而对数据分析的结果正印证了这一点。
鉴于目前无法利用医院的数据资源对测得 CO 的准确性进行验证，上述实验 结论不能作为准确可靠的结论提出。不过，本研究通过实际操作了从 PPG 波形 中提取以 CO 为主的心循环生理信息的过程，证实了在实时运动监测设备中应用 PPG 波是可行的，建立回归方程、随后用时间参数推算心输出量的方法可以用于 实时运动监测的算法设计中。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

41 / 47

5 研究结论
本研究开发出了一套简易的 PPG 波采集仪器，具有较好的准确性，在实验 使用上可以方便快捷准确地采集到 PPG 波形，为研究提供了设备基础。后期， 仍可通过对该仪器硬件与软件的匹配优化，来提升精度和灵敏度、缩小模块空间 和仪器体积等，来进一步提高该仪器的准确度和便携性，以最终达到实时运动监 测的要求。
本研究对波形波动性最强、最难以实时提取生理信息的指尖 PPG 波形做了 初步分析，利用对原始波形求二阶微分获得的加速波波形，对心动周期中八个典 型时相中除快、慢充盈期外的具有较高生理价值的六个时相做了较精确定位，并 从生理意义上对该时相对应的可靠性做了论证。
另外，本研究对测量位置、测量点的压力变化、测量时间、心率变化四个因 素对波形图的影响做了详细探究：
指尖波相较腕部波有更强波动性，五指之间拇指的重搏现象不明显，小指和 无名指的波动性较差，故食指和中指较为适合对波形进行采集；
测量点外加压力的变化会改变波形的振幅，压力越大振幅的减少幅度越大， 而时间参数对压力的耐受能力较强，不阻断程序识别波形的前提下几乎不产生影 响；
往往在晨起、饭后等时段重搏点较低，随后重搏点呈现逐渐升高的趋势，并 在饭前空腹时达到最大，由此推测血糖可能是时间因素影响波形的原因所在；
心率的上升会使得波形中重搏点逐渐消失，其中重搏点刚刚消失的“临界心 率”具有一定的生理意义，可以通过理论提出一种解释，但仍需后续实验验证。
另外，本研究基于已有文献的研究成果，从采集到的 PPG 波形中初步提取 了 CO、SV 等生理参数，验证了通过指尖反射型 PPG 实时测量 CO 等心功能参数 的可能性，为便携、无滞后的实时运动监测系统的开发提供了指导意义。同时， 又通过对高负荷运动后恢复阶段内的 PPG 波形所提取的生理信息数据做了分析， 提出了“CO 突然转折点”的生理学意义即标志着心脏供血无法满足运动负荷的 特征点，这与“临界心率”在生理意义上是吻合的，从而也印证了“临界心率” 和测量数据结果中体现的“CO 突然转折点”之间存在着某种内在关联的可能性， 证实了在实时运动监测设备中应用 PPG 波和 CO 阈值的可行性。

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

42 / 47

6 研究展望

6.1 研究中存在的不足
研究过程中，由于硬件设备的精确度有限，对肢体摆动和气流变化的低适应 性，导致无法直接测量运动过程中的 PPG 波形图，无法对运动实时监测系统的 开发提供直接的算法支持；实验过程中，受到人力、物力的限制无法采集到大量 数据量，因此线性回归方程的建立与相应结论的产生都难以完全可靠，因此本课 题内的结论都只能作为初步结论待进一步的深入研究；最后，由于无法使用专业 医疗设备对 CO 进行准确测量，计算得到的 CO、SV 值只能从范围上判定是否可 靠，无法与真实值进行比对从而验证提取的生理参数的可靠性。
6.2 研究展望

6.2.1 优化实时运动监测仪器软硬件

接下来进一步的科研工作中，本研究将学习使用集成了更高精度的 SFH7050 光电模块的 Heart Rate 3 click 光电传感器和 Atmel SAM4L 开发板以及傅里叶变换、 小波变换等软硬件知识，通过不断更新硬件设备和使用更加成熟的滤波算法，成 熟地完成对指尖 PPG 波形的分析之后，应着眼于实际生产中便携无滞后的运动 监测系统制作。目前可行的一种思路是：将轻量化、低能耗化的传感器镶嵌于手 套内层，在指肚处加装一个很薄的硬质塑料板实现对 PPG 波形的采集；而数据 处理端将不再置于传感器同侧，最好可以使用无线数据传输模块将采集到的 PPG 波形数据直接发送到上位机进行处理，比如通过手机端 APP 开发接受信号，制 作可以实时监测并及时报警的运动监测“手套”，真正应用到有需要人士的日常 生活中。

6.2.2 推进深度合作，扩大有效数据量

虽然本研究目前已经与周口市中心医院心外科做了一定的基础合作，获得了 医院方提供的 24 小时动态心电图数据与心电图图像方面的咨询与帮助，可有助 于比对心电图与 PPG 波形图之间的联系并挖掘其中的病理学信息，但本研究用 的 PPG 波形图尚无法达到与心电图相当的精确性和对外界干扰的高耐受性，因 此，还暂时无法将这些现有的精确数据直接应用并推进课题的进展。接下来将推 进与多方医院和学校的深度合作，获得更多医院临床实验数据，来验证本研究中 所提出的初步理论结论，并为一些假设的下一步研究方向提供指导。

6.2.3 设计智能化运动监测仪器并推广应用

另外，本课题的结果可以在其他领域有充分的深入研究价值和实用价值。考 虑到临界心率的生理学意义标定了一个最适合对心功能进行锻炼的心率区间，可

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

43 / 47

以使类似潜水员、宇航员、心脏病患者这类需要控制运动量的特殊人群获得一种 判别运动状态的指标。基于临界心率的测量，这类特殊人群也可以从生理学角度 得到一个科学的最大心率限制阈值，而不是基于某些经验得到的初步结果。因此， 本课题提出的“临界心率”可以有很好的实际应用价值。
为了更准确地在实际运动监测中应用“临界心率”和“突然转折点”的生理 价值，可在本研究的基础上增设一套反馈机制，将不断测算的 CO 值存储后通过 深度学习不断完善 CO“突然转折点”的精准度，通过大量的数据推导出对单个 个体而言的最合适运动阈值。此设想可以搭建一个完整的运动实时监测系统或特 殊人群的活动警示系统，再将与之相应的专业指导结合进来，即可用于能实现个 性化需求的跨学科应用，具有较好的后期使用和推广前景（图 6-1）。

作者：李硕秋

图 6-1 设计算法图
指导老师：李锂

题目：指尖光电容积脉搏波初步研究

44 / 47

7 参考文献

[1] Hertzman A B. Blood supply at various skin areas as estimated by the photoelectron plethysmograph. Am. J. Physio, 1938.24(124)
[2]杨文武. 基于光电容积的脉搏波波形特征与速度测量研究. 西安电子科 技大学硕士学位论文, 2012-10.
[3] Cnoga Medical Ltd. VSM. http://cnogacare.co/portfolio-item/vsm/
[4]罗志昌, 张松等. 脉搏波波形特征信息的研究. 北京工业大学学报, 1996,22(1): 71-79
[5]丁有得. 基于容积脉搏波血流多参数测量的研究. 南方医科大学硕士学 位论文. 2010. 4. 10
[6]周娟, 于平, 张纯刚. 利用腕部脉搏波无创估测心脏每搏输出量的方法. 北京生物医学工程, 2015,34(6):589-594
[7]李景锡. 左心室每搏出量的估算. 第二军医大学学报, 1994, 15(2):141-144
[8] M. Maguire, et al. A comparative study in the use of brachial photoplethysmography and the QRS complex as timing references in determination of pulse transit time. 2001 Proceedings of the 23rd Annual EMBS International Conference, October 25-28, Istanbul, Turkey.
[9] Pulse Sensor. https://pulsesensor.com/
[10] Arduino. https://store.arduino.cc/usa/arduino-uno-rev3
[11]张彬. 基于脉搏波的血氧饱和度检测算法的研究. 北京交通大学硕士学 位论文, 2009-6
[12]何艺超. 脉搏波的传播与心输出量的研究分析. 北京工业大学硕士学位 论文. 2008
[13] Hiroshi Osanai. Plethysmographic acceleration pulse wave meter. United States Patent, 1984, Feb. 21, 4432374
[14] Wikipedia. https://en.wikipedia.org/wiki/Cardiac_cycle
[15] Zhang Q, Shi Y, Teng D, et al. Pulse transit time-based blood pressure estimation using hilbert-huang transform[C]// International Conference of the IEEE Engineering in Medicine & Biology Society. Conf Proc IEEE Eng Med Biol Soc, 2009:1785.
[16] 李章俊, 王成, 朱浩,等. 基于光电容积脉搏波描记法的无创连续血压 测量[J]. 中国生物医学工程学报, 2012, 31(4):607-614.

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

45 / 47

[17] 罗志昌, 程桂馨, 王丽娟,等. 由脉搏波计算人体心输出量的方法及在 临床中的应用[J]. 北京工业大学学报, 1988(2):16-24.
[18] 张松, 杨文鸣, 杨益民,等. 运动负荷下心血管血流参数无损伤动态检 测系统的研究[J]. 北京工业大学学报, 1996(1):103-110.
[19] 李志颖. 基于脉搏波的无创血压检测样机的研究与设计[D]. 吉林大学, 2009.
[20] 靳雪斌. 基于光电容积脉搏波描记法的智能婴儿脚环设计[D]. 河南大 学, 2016.
[21]. 赵泽, 王玲等. 心输出量监测技术的原理及发展. 中国生物医学工程 学报, 2010, 29(4):619-626

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

46 / 47

8 致谢
感谢人大附中李锂老师为此研究所给予技术上和学术上的支持与帮助； 感谢其他老师和教授给予我学术研究方向上的指引和帮助； 感谢阜外心血管病医院小儿外科副主任花中东教授提供的临床医学方面的 咨询与帮助； 感谢周口市中心医院提供的 24 小时动态心电图数据与心电图图像方面的咨 询与帮助； 感谢父母在我研究中所提供的帮助和作为首批用户对其提出的改进意见，也 感谢父母对我在研究中的奇思妙想和大胆假设的鼓励与支持； 感谢弟弟作为我所有一切思路的源泉和动力； 感谢人大附中的同学们为我采集数据所提供的配合与帮助； 感谢 PulseSensor 开源绿光心率传感器模块和 Arduino 开发板提供的硬件 支持； 感谢中国知网提供的大量优秀论文供我学习参考； 感谢百度提供的极强搜索引擎方便我广泛收集资料； 特此鸣谢以上为我的研学提供的支持！！！

作者：李硕秋

指导老师：李锂

题目：指尖光电容积脉搏波初步研究

47 / 47

参赛团队简历
李锂，中国人民大学附属中学生物学教师，北京师范大学生命科学学院生态 学博士（在读），承担高中生物学教学及生命科学创新人才早期培养相关研究工 作，博士期间主要研究方向为动物分子生态、生理生态与生态毒理学。
李硕秋，中国人民大学附属中学 高三（17）班学生，初高中就读于人大附 中“早陪班”，小学三年级开始参加 FLL，FTC 等机器人比赛，多次获得各类奖项； 初高中历次参加国内各级数学竞赛和美国 AMC、AIMO 数学竞赛，成绩优秀。人 大附中的“崇德”教育和“早陪”经历，让我奠定：“科学因爱而美丽”的信念， 特殊的经历，我开始关注生物医学，想通过对心血管循环系统的医学探究，再加 上整合数学、计算机科学等其它方面的知识，实现跨学科应用，为需要控制运动 量的特殊人群提供个性化医疗服务或警示服务。

作者：李硕秋

指导老师：李锂

