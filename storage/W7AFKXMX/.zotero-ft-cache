Tampere University of Technology
Is 50 Hz high enough ECG sampling frequency for accurate HRV analysis?
Citation Mahdiani, S., Jeyhani, V., Peltokangas, M., & Vehkaoja, A. (2015). Is 50 Hz high enough ECG sampling frequency for accurate HRV analysis? In 2015 37th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC) (pp. 5948-5951) https://doi.org/10.1109/EMBC.2015.7319746 Year 2015 Version Peer reviewed version (post-print) Link to publication TUTCRIS Portal (http://www.tut.fi/tutcris) Published in 2015 37th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC) DOI 10.1109/EMBC.2015.7319746 Copyright © 2015 IEEE. Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses, in any current or future media, including reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for resale or redistribution to servers or lists, or reuse of any copyrighted component of this work in other works. Take down policy If you believe that this document breaches copyright, please contact tutcris@tut.fi, and we will remove access to the work immediately and investigate your claim.
Download date:06.05.2019

Is 50 Hz High Enough ECG Sampling Frequency for Accurate HRV Analysis?*
Shadi Mahdiani1, Vala Jeyhani2, Mikko Peltokangas2 and Antti Vehkaoja2

Abstract— With the worldwide growth of mobile wireless technologies, healthcare services can be provided at anytime and anywhere. Usage of wearable wireless physiological monitoring system has been extensively increasing during the last decade. These mobile devices can continuously measure e.g. the heart activity and wirelessly transfer the data to the mobile phone of the patient. One of the signiﬁcant restrictions for these devices is usage of energy, which leads to requiring low sampling rate. This article is presented in order to investigate the lowest adequate sampling frequency of ECG signal, for achieving accurate enough time domain heart rate variability (HRV) parameters. For this purpose the ECG signals originally measured with high 5 kHz sampling rate were down-sampled to simulate the measurement with lower sampling rate. Downsampling loses information, decreases temporal accuracy, which was then restored by interpolating the signals to their original sampling rates. The HRV parameters obtained from the ECG signals with lower sampling rates were compared. The results represent that even when the sampling rate of ECG signal is equal to 50 Hz, the HRV parameters are almost accurate with a reasonable error.
I. INTRODUCTION
Heart rate variability (HRV) analysis has become a noninvasive tool for studying the operation of autonomic nervous system. The analysis of beat-to-beat heart rate can be approached in several ways such as time domain analysis, spectral analysis and non-linear analyses. The ﬁrst step in analyzing HRV, is measuring the time intervals between consecutive R-peaks of the electrocardiogram (ECG) signal. In order to reach reliable results, signal acquisition and processing methods, such as sampling rate of the ECG signal must be properly chosen.
A low sampling rate may decline the accuracy in detection of R-wave ﬁducial points, which causes changes in the heart rate variability parameters. According to a previous research, the optimal range of sampling rate for spectral analysis of HRV parameters is between 250 and 500 Hz or even higher [1]. However, due to deterministic nature of the ECG signal, interpolation techniques can be used until some extent to restore its original waveform and improve the temporal as well as amplitude accuracy of searched ﬁducial points. In the study of Merri et al. was shown that lower sampling rate may behave satisfactorily only if an appropriate algorithm of
*The work was partially funded by the Finnish Funding Agency for Technology and Innovation (TEKES) as a part of project VitalSens (decision ID 40103/14).
Shadi Mahdiani, Vala Jeyhani, Mikko Peltokangas and Antti Vehkaoja are with the Department of Automation Science and Engineering, Tampere University of Technology, Tampere, FI33720, Finland 1firstname.lastname@student.tut.fi 2firstname.lastname@tut.fi

interpolation is used to estimate the original R-wave ﬁducial points [2].
Garcia-Gonzalez et al. showed in [3], by using relatively low ECG sampling rate of 125 Hz, that a bias error as well as uncertainty in frequency domain HRV parameters HF and HF/LF are highly dependent on the accuracy of the R-peak detection, especially when the HRV is very small.
The effect of different ECG sampling frequencies on the spectral parameters of HRV were also evaluated by Ziemssen et al. in [4]. In their study the original ECG sampling frequency was 500 Hz and the simulated sampling frequencies were 200 and 100 Hz.
In contrast to the result of Garcia-Gonzalez et al., Ziemssen et al. concluded that there is not any signiﬁcant impact on spectral parameters for ECG with lower sampling frequencies. However, they showed that if there is a pathologically decreased variability in RR intervals (RRIs) in patients, spectral parameters could be signiﬁcantly inﬂuenced when lower ECG sampling frequencies.
In [5], Hejjel and Roth have studied the consequences of digitization errors on the time domain HRV parameters. They resampled model tachograms with different ratios and compared the obtained HRV parameters. They have argued that the optimum sampling rate for ECG signal to get accurate time domain HRV parameter without interpolation is 1 kHz. They noticed that beyond time domain HRV parameter, pNN50 presents the poorest accuracy and precision by decreasing ECG sampling interval.
In this article, the inﬂuence of different sampling rates of the ECG signal on certain time domain heart rate variability parameters is studied. Especially, it is tried to conclude what would be the lowest reasonable sampling rate that still produces adequate HRV accuracy. It is shown that even as low as 50 Hz sampling rate may be adequate for obtaining time domain HRV parameters with reasonable accuracy.
Motivation for trying to ﬁnd the lowest possible ECG sampling rate that still enables accurate HRV analysis is the increased interest towards small, wearable and networked physiological monitoring devices, which commonly are strongly energy limited. In general, these devices beneﬁt from low sampling rate, especially if the application requires transmitting the whole ECG signal to a receiver where a cardiologist usually needs to make a visual inspection in addition to HRV parameters.

II. MATERIALS AND METHODS
A. Signal Database
• Combined measurement of ECG, breathing and seismocardiogram (CEBS) Database consisting 60 records from 20 healthy volunteers was used in the evaluation. The records have been acquired in supine position using a Biopac MP36 data acquisition system (Santa Barbara, CA, USA). Channels 1 and 2 of the system were devoted to measure conventional ECG (leads I and II, respectively) with a bandwidth between 0.05 Hz and 150 Hz. Each channel has been sampled at 5 kHz. In this work, lead II ECG signals with 5-minute length were used. The main reason for choosing this database was the high sampling rate and resolution of the ECG signals, which enables comparison between the HRV parameter calculated from high quality signal and signals resampled to lower sampling rates. The CEBS database is publicly available at Physionet database archive [6].
• A high-noise ECG signal was recorded at Department of Automation Science and Engineering of Tampere University of Technology, to demonstrate the effect of using the same sampling rate as the dominating frequency of external interference. The sampling rate of the signal was 250 Hz and the pass-band of the analog ﬁlters of the ECG ampliﬁer was 0.5 - 40 Hz. This recording contains signiﬁcant amounts of 50 Hz powerline interference. The purpose of this measurement was studying the effect of down-sampling the ECG signal with power-line interference on its HRV parameters.
From CEBS Database, for every subject, ﬁrstly the ECG signal was down-sampled by different ratios to create signals that demonstrate ECG recorded with different sampling rates. The further procedures are described in the following:
B. Signal Down-sampling
To evaluate the impact of low sampling rate on heart rate variability components, the CEBS signals were downsampled by factor 10, 20, 25, 32, 40, 50, 80, 100 and 125. Since the CEBS signals were originally sampled at 5 kHz, then the down-sampled ECG signals were sampled at 500, 250, 200, 156.5, 125, 100, 62.5, 50 and 40 Hz, respectively.
It should be noted that decimation requires an anti-aliasing ﬁlter before it to avoid overlapping of replicated signals in frequency domain. Therefore, an 8-order Butterworth lowpass ﬁlter with cut-off fs/(2 ∗ f actor) (fs is sampling frequency and factor is ratio of down-sampling for each down-sampled signal) was applied on the original ECG signal before down-sampling to prevent aliasing.
C. Interpolation
A common way for improving the QRS detection accuracy is using R-wave interpolation. Cristov and Daskalov showed in [7] by using the cubic interpolation a resolution of 1 ms and deviation of ±1 ms was achieved in more than 99% of

the RR intervals for the sampling rate of 250 Hz compared to the original 1 kHz sampling rate. For the worst cases with 100 Hz sampling rate, the same resolution was preserved in 90.5% of the RR intervals. In this work a cubic interpolation method was used to produce sampling rate equal to 5 kHz.
It is worth mentioning that for a healthy person the shape of the R-wave is close to symmetric in which case cubic spline method can estimate R-peak location with sufﬁcient accuracy from down-sampled ECG signals. But generally the shape of the R-wave can be altered as a result of certain cardiovascular diseases. Thus, the shape of the Rwave may be clearly non-symmetric which causes cubic spline interpolation to be less accurate.
D. QRS Detection
A well-known QRS detection algorithm proposed by Pan and Tompkins in 1985 was applied on the original and downsampled ECG signals to detect the R-wave ﬁducial points [8]. The Pan-Tompkins method recognizes QRS complexes based on analyses of the slope, amplitude, and width. The algorithm includes ﬁltering, derivative, squaring and integration steps.
First of all, a band-pass ﬁlter reduces T wave interference, baseline drift and power-line interference, if present. Then, derivative procedure suppresses the low frequency components of P and T waves, and provides a large gain to the high-frequency components arising from high slopes of QRS complex. The squaring operation emphasizes on high-frequency components in the signal that related to QRS complex. At the end, the squared waveform passes through a moving window integrator. Since rising edge of the integration waveform corresponds to QRS complex then the ﬁducial point can be determind as the peak of the R-wave [8] and [9].
Eventually, by obtaining the R-wave ﬁducial points, the RR intervals for each signal were calculated as the time intervals between successive R peaks of the ECG signal.
E. Time Domain HRV Parameters
To compare the heart rate variability indices between original ECG signal and down-sampled versions of it, some widely used linear and non-linear time domain parameters were calculated. The parameters were implemented based on their standard deﬁnitions in [10] as following:
• SDNN: Standard deviation of all RR intervals • RMSSD: Root mean-square of successive differences of
adjacent RR intervals • pNN50: Percentage of pairs of adjacent RR intervals
differing by more than 50 ms from all RRIs • SD1: Standard deviation of data against the axis x = y
in Poincare´ plot • SD2: Standard deviation of data against the axis, which
is orthogonal to the axis x = y in Poincare´ plot (crosses this axis at the mean value of the data)
Poincare´ plot is constructed by plotting the RRI as a function of itself with a delay of 1 sample.
Signal processing was done with MATLAB software (R2014b) from MathWorks Inc., Natick, MA, USA. The

TABLE I HRV PARAMETERS FOR SUBJECT B002 OBTAINED FROM THE ORIGINAL ECG AND AFTER DOWNSAMPLING WITH DIFFERENT RATIOS

ECG Signal
Sampled at 5 kHz (Original) Sampled at 500 Hz Sampled at 250 Hz Sampled at 200 Hz Sampled at 156.5 Hz Sampled at 125 Hz Sampled at 100 Hz Sampled at 62.5 Hz Sampled at 50 Hz Sampled at 40 Hz

SDNN (ms)
53.6499 53.6499 53.6502 53.6506 53.6515 53.6512 53.6526 53.6522 53.6495 53.6481

RMSSD (ms)
50.5568 50.5568 50.5593 50.5605 50.5624 50.5603 50.5632 50.5659 50.5802 50.5172

pNN50 (%)
36.2745 36.2745 36.2745 36.2745 36.2745 36.2745 36.2745 36.2745 36.6013 35.9477

SD1 (ms)
35.8061 35.8061 35.8078 35.8087 35.8100 35.8085 35.8106 35.8125 35.8226 35.7780

SD2 (ms)
66.7802 66.7802 66.7798 66.7800 66.7807 66.7810 66.7821 66.7813 66.7707 66.7916

Fig. 1. RR Intervals for subject b002, top: obtained from original ECG (sampled at 5 kHz), middle: obtained from down-sampled ECG (sampled at 50 Hz), bottom: difference of above RRIs
accuracy and precision of heart rate variability parameters that were computed by our method were validated with Kubios software, which is an open license HRV analysis software developed in Univerty of Kuopio, Finland. [11].
III. RESULT AND DISCUSSION
Certain time domain HRV parameters were separately analyzed for every subject of CEBS database. Fig. 1 from top to bottom, shows the RRIs obtained from the original, the resampled ECG signal of subject b002, and the difference between these two RRIs, respectively. It is seen that even when the time resolution of the signal sampled with 50 Hz is 20 ms, the R-peak locations can be approximated by interpolating with such accuracy that the maximum absolute error of RR-interval is less than 1 ms. Furthermore, the mean absolute error (MAE) and root mean squared error (RMSE) are computed for RRIs which for this subject are equal to 2.6906 × 10−4 ms and 3.2945 × 10−4 ms, respectively.
In Table I, the HRV parameters introduced in previous

section are presented for subject b002, which were computed from the original and the down-sampled ECG signals by different rates. The results of Table I conﬁrm that HRV parameters of the down-sampled ECG signals with much lower sampling rate than their original (5 kHz) and then interpolated, can still be retained accurate with a reasonable error. For this subject, even with 40 Hz sampling rate, the error of the HRV parameters is very small.
For the measured noisy ECG signal, which was only down-sampled by factor 5, all the procedure mentioned in the method section was performed except applying the antialiasing ﬁlter. Because when the sampling rate is exactly the same as the frequency of the interference, the interference is aliased to 0 Hz frequency, causing only a DC offset to the signal. Also, a little mismatch in these frequencies is tolerable because a small difference introduces a slowly varying component, which is similar to baseline wandering, to the observed signal. This component can be removed by high-pass ﬁltering in normal ECG processing.
In Fig. 2, on the left-top panel, short piece of the measured ECG signal recorded at 250 Hz including power-line interference and left-bottom panel the resampled ECG signal are shown. On the right side, their power spectra are illustrated. Furthermore, HRV parameters were computed for this signal as well, that resulted in less than 1% relative error for all the HRV indices except pNN50. pNN50 represents the poorest accuracy with the relative error 30%. Eventually, it can be seen that how well the 50 Hz peak is removed by down-sampling the noisy ECG signal (sampled at 250) with factor 5, while due to interpolation, the HRV parameters except pNN50 are assessed with acceptable error. It should be mentioned that due to the interpolation, there is some power also above 25 Hz in the bottom-right power spectrum.
Results displayed in Table II indicate HRV parameters for 5 different subjects from CEBS database. HRV indices were computed from their original ECG signals (sampled at 5 kHz) and the down-sampled signals (sampled at 50 Hz). In addition, the relative error of each parameter was calculated for every subject. By studying the average of relative errors for HRV parameters beyond all the 5 subjects, it can be concluded that SDNN, RMSSD, SD1 and SD2 are accurate with less than 1% error and pNN50 with 1.21% error for the interpolated ECG signal that was down-sampled to 50 Hz.

TABLE II HRV PARAMETERS CALCULATED FROM THE ORIGINAL 5 KHZ ECG SIGNAL, FROM THE SAME SIGNAL DOWNSAMPLED TO 50 HZ AND THEIR
RELATIVE ERROR, FOR 5 SUBJECTS

Data
Subject b002
Subject b003
Subject b005
Subject b006
Subject b008

Actual Measured Relative Error (%)
Actual Measured Relative Error (%)
Actual Measured Relative Error (%)
Actual Measured Relative Error (%)
Actual Measured Relative Error (%)
Mean Relative Error (%)

SDNN (ms)
53.6499 53.6495
0.00
47.3965 47.3992
0.01
39.0200 38.0200
2.58
83.0377 83.0524
0.02
43.2183 43.2017
0.04
0.53

RMSSD (ms)
50.5568 50.5802
0.05
48.1750 48.1640
0.02
38.2400 38.2300
0.02
59.0071 59.0492
0.07
28.3448 28.3118
0.12
0.06

pNN50 (%)
36.2745 36.6013
0.90
34.6821 34.9711
0.83
19.9400 20.4986
2.78
42.8571 43.5065
1.52
7.1130 7.1130 0.00
1.21

SD1 (ms)
35.8061 35.8226
0.05
34.1142 34.1064
0.02
27.0800 27.0716
0.02
41.7920 41.8219
0.07
20.0632 20.0398
0.12
0.06

SD2 (ms)
66.7802 66.7707
0.01
57.6912 57.6997
0.01
48.1400 48.1352
0.01
109.7308 109.7415
0.01
57.6890 57.6714
0.03
0.02

Fig. 2. ECG with power line interference, top-left: short piece of noisy ECG, top-right: power spectrum of the noisy ECG, bottom-left: short piece of down-sampled noisy ECG by factor 5 that was interpolated back to 250 Hz, bottom-right: power spectrum of the down-sampled noisy ECG by factor 5 that was interpolated back to 250 Hz
IV. CONCLUSIONS
It was shown that as low as 50 Hz sampling rate could be used for measuring the ECG signal without compromising the accuracy of the calculated time domain HRV parameters. However, the ECG and especially R-peak waveform is slightly distorted and it should be investigated in the future how much this affects to other ECG parameters than HRV and what would be the minimum sampling rate that produces adequate signal quality for the visual inspection.
The study was performed with database consisting ECG signals recorded from healthy subjects. An important part

of the future work is to evaluate the adequacy of 50 Hz
sampling rate for patients suffering from cardiac problems
and people having decresed heart rate variability.
REFERENCES
[1] G. D. Pinna, R Maestri, A. Di Cesare, R. Colombo and G. Minuco, ”The accuracy of power spectrum analysis of heart rate variability from annotated RR lists generated by Holter systems,” Physiological Measurement, vol. 15, no. 2, pp. 163-179, May 1994.
[2] M. Merri, D. C. Farden, J. G. Mottley, E. L. Titlebaum, ”Sampling frequency of the electrocardiogram for spectral analysis of the heart rate variability,” IEEE Trans. Biomedical Engineering, vol. 37, no. 1, pp. 99-106, Jan. 1990.
[3] M. A. Garcia-Gonzalez, M. Fernandez-Chimeno, J. Ramos-Castro, ”Bias and uncertanity in heart rate variability spectral indices due to the ﬁnit ECG sampling frequency,” Physiological Measurement, vol. 25, no. 2, pp. 489-504, Apr. 2004.
[4] T. Ziemssen, J. Gasch and H. Ruediger, ”Inﬂuence of ECG sampling frequency on spectral analysis of RR intervals and baroreﬂex sensitivity using the EUROBAVAR data set,” Journal of Clinical Monitoring and Computing, vol. 22, no. 2, pp. 159-168, Mar. 2008.
[5] L. Hejjel and E. Roth, ”What is the adequate sampling interval of the ECG signal for heart rate variability analysis in the time domain?,” Physiological Measurement, vol. 25, no. 6, pp. 1405-1411, Dec. 2004.
[6] M. A. Garcia-Gonzalez, A. Argelagos-Palau, M. Fernandez-Chimeno and J. Ramos-Castro, ”Differences in QRS Locations due to ECG Lead: Relationship with Breathing,” in XIII Mediterranean Conf. Medical and Biological Engineering and Computing 2013, IFMBE Proceedings, Vol. 41, pp. 962-964.
[7] I. Daskalov and I. Christov, ”Improvement of resolution in measurement of electrocardiogram RR intervals by interpolation,” Medical Engineering & Physics, vol. 19, no. 4, pp. 375-379, June 1997.
[8] J. Pan and W. J. Tompkins, ”A real-time QRS detection algorithm,” IEEE Trans. Biomed. Eng., vol. BME-32, no. 3, pp. 230-236, Mar. 1985.
[9] R. M. Rangayyan, Biomedical Signal Analysis: A Case-Study Approach, 2nd ed. New York: Wiley-Interscience, 2002.
[10] T. F. of the European Society of Cardiology the North American Society of Pacing Electrophysiology, ”Heart Rate Variability: Standards of Measurement, Physiological Interpretation, and Clinical Use,” Circulation, Vol. 93, No. 5, pp. 1043-1065, Mar. 1996.
[11] M. P. Tarvainen, J.-P. Niskanen, J. A. Lipponen, P. O. Ranta-aho, P. A. Karjalainen, ”Kubios HRV - A Software for Advanced Heart Rate Variability Analysis,” in 4th European Conf. Int. Federation for Medical and Biological Engineering, vol. 22, pp. 1022-1025, 2009.

