"use strict";function FormField(e,i,a){var o=function(e){if(null!=n.error){n.error.html(""),n.error.removeClass("dn");var i=$("<div>").html(e).text();n.error.append(i)}},n=this;this.container=e,this.control=i,this.error=a,this.validators=[],this.isValid=!1,this.validate=function(e,i){i=i||!1;var a=!0,s="";for(var t in n.validators){var r=n.validators[t].validate();if(r&&r.asyncValidationInProgress)return;r&&!r.isValid&&(a=r.isValid,s=r.errorMessage)}if(!a)return n.isValid=!1,void(e||(n.container.removeClass("valid"),n.container.addClass("notValid"),o(s)));n.isValid=!0,i||(n.container.removeClass("notValid"),n.container.addClass("valid")),null!=n.error&&(n.error.html(""),n.error.addClass("dn"))},this.showValidationStatus=function(e){n.isValid?(n.container.removeClass("notValid"),n.container.addClass("valid")):(n.container.removeClass("valid"),n.container.addClass("notValid")),o(e)},this.applyValidationResult=function(e){n.isValid&&e.isValid?o(""):(n.isValid=e.isValid,n.showValidationStatus(e.errorMessage))},this.showInfoMessage=function(e){n.container.removeClass("notValid").removeClass("valid"),o(e)}}function UserRegistrationFormBase(s){this.userRegistrationValidation=new UserRegistrationValidation(s.validationServiceEndpoint);var t=function(){var e=!0;for(var i in s.formFields)if(!IsFieldSelectedOrCheckedOrNotEmpty(s.formFields[i])){e=!1;break}return e},r=this;r.messages={professtionRequired:"&lt;span class=&#39; red i b db mb3 &#39;&gt;You need to select a profession.&lt;/span&gt;",specialityRequired:"&lt;span class=&#39; red i b db mb3 &#39;&gt;You need to select a speciality.&lt;/span&gt;",workSettingRequired:"&lt;span class=&#39; red i b db mb3 &#39;&gt;You need to select a work setting.&lt;/span&gt;",firstNameReqired:"&lt;span class=&#39; red i b db mb3 &#39;&gt;You need to enter a first name.&lt;/span&gt;",lastNameReqired:"&lt;span class=&#39; red i b db mb3 &#39;&gt;You need to enter a last name.&lt;/span&gt;",zipCodeReqired:"&lt;span class=&#39; red i b db mb3 &#39;&gt;You need to enter a zip code.&lt;/span&gt;",emailEqualsPassword:"&lt;span class=&#39; red i b db mb3 &#39;&gt;Password must be different than your email.&lt;/span&gt;",regexpZipCode:"&lt;span class=&#39; red i b db mb3 &#39;&gt;Enter a valid zip code.&lt;/span&gt;",emailAddressReqired:"&lt;span class=&#39; red i b db mb3 &#39;&gt;You need to enter an email address.&lt;/span&gt;",regexpEmailAddress:"&lt;span class=&#39; red i b db mb3 &#39;&gt;This is not a valid email address, please try again.&lt;/span&gt;",passwordRequired:"&lt;span class=&#39; red i b db mb3&#39;&gt;You need to enter a password.&lt;/span&gt;"},r.updateSubmitButtonAvailability=function(){if(!t())return s.submitButton.hasClass("disabled")||s.submitButton.addClass("disabled"),void s.submitButton.removeClass("active");var e=!0;for(var i in s.formFields)s.formFields[i].isValid||(e=!1);e?(s.submitButton.hasClass("active")||s.submitButton.addClass("active"),s.submitButton.removeClass("disabled")):(s.submitButton.hasClass("disabled")||s.submitButton.addClass("disabled"),s.submitButton.removeClass("active"))},r.validateField=function(e){e.validate(),r.updateSubmitButtonAvailability()},s.formFields.profession.validators.push(new RequiredFieldValidator(s.formFields.profession,r.messages.professtionRequired)),s.formFields.profession.container.on("change",function(){r.validateField(s.formFields.profession)}),s.formFields.speciality.validators.push(new RequiredFieldValidator(s.formFields.speciality,r.messages.specialityRequired)),s.formFields.speciality.container.on("change",function(){r.validateField(s.formFields.speciality)}),s.formFields.workSetting.validators.push(new RequiredFieldValidator(s.formFields.workSetting,r.messages.workSettingRequired)),s.formFields.workSetting.container.on("change",function(){r.validateField(s.formFields.workSetting)});var o,e=function(e){32!==e.which&&13!==e.which||(e.preventDefault(),$(this).click())},i=function(e){$(e.target).find(".user-registration__checkbox-wrap").focus()};(s.formFields.eula.validators.push(new RequiredFieldValidator(s.formFields.eula)),s.formFields.eula.control.on("change",function(){r.validateField(s.formFields.eula)}),s.formFields.privacy.container.find(".user-registration__checkbox-wrap").keypress(e),s.formFields.privacy.container.find("label").click(i),s.formFields.privacy.validators.push(new RequiredFieldValidator(s.formFields.privacy)),s.formFields.privacy.control.on("change",function(){r.validateField(s.formFields.privacy)}),s.formFields.eula.container.find(".user-registration__checkbox-wrap").keypress(e),s.formFields.eula.container.find("label").click(i),s.errorMessageContainer.find("[aria-label='close dialog']").on("click",function(){clearPostLoginAction(),s.errorMessageContainer.hide()}),s.submitButton.on("click",function(e){if(!t())return s.submitButton.hasClass("disabled")||s.submitButton.addClass("disabled"),s.submitButton.removeClass("active"),e.preventDefault(),void e.stopPropagation();var i=!0;for(var a in s.formFields)s.formFields[a].showValidationStatus(),s.formFields[a].isValid||(i=!1);if(i)return s.submitButton.addClass("disabled"),s.submitButton.unbind("click"),s.submitButton.on("click",function(e){e.preventDefault(),e.stopPropagation()}),void ejpAnalytics.track("Create Account");e.preventDefault(),e.stopPropagation()}),!isMobileDevice()||navigator.userAgent.match(/iPad/i))&&function(){o=s.formContainer.find(".user-registration__ddl-selectize").selectize({selectOnTab:!0}),s.formContainer.find(".user-registration__ddl-selectize").find("input").attr("readonly",!0);for(var i=["profession","speciality","workSetting"],e=function(e){o[e].selectize.on("blur",function(){r.validateField(s.formFields[i[e]])})},a=0;a<o.length;a++)e(a)}()}function UserRegistrationForm(a){var s=new UserRegistrationFormBase(a);a.formFields.firstName.validators.push(new RequiredFieldValidator(a.formFields.firstName,s.messages.firstNameReqired)),a.formFields.firstName.control.on("keyup change blur input",function(){s.validateField(a.formFields.firstName)}),a.formFields.lastName.validators.push(new RequiredFieldValidator(a.formFields.lastName,s.messages.lastNameReqired)),a.formFields.lastName.control.on("keyup change blur input",function(){s.validateField(a.formFields.lastName)}),a.formFields.zipCode.validators.push(new RequiredFieldValidator(a.formFields.zipCode,s.messages.zipCodeReqired)),a.formFields.zipCode.control.on("keyup change blur input",function(){s.validateField(a.formFields.zipCode)});var i=function(){var e=a.formFields.email.control.val(),i=a.formFields.password.control.val();return""!==e&&i.toLowerCase()===e.toLowerCase()?new ValidationResult(!1,s.messages.emailEqualsPassword):new ValidationResult(!0)},t=function(e){disableSubmitButtonOnError(e,a),a.formFields.password.applyValidationResult(e)},e=function(e){a.formFields.password.showInfoMessage(e)};a.formFields.password.validators.push(new RequiredFieldCustomValidator(function(){var e=i();if(!e.isValid)return e;s.userRegistrationValidation.validatePassword(a.formFields.password.control.val(),a.formFields.email.control.val(),t)},a.formFields.password,s.messages.passwordRequired)),a.formFields.password.control.on("keyup change blur input",function(){s.validateField(a.formFields.password)}),a.formFields.password.control.focusin(function(){s.userRegistrationValidation.getPasswordStrengthSuggestion(e)});var r=function(e){disableSubmitButtonOnError(e,a),a.formFields.email.applyValidationResult(e)};a.formFields.email.validators.push(new RequiredFieldCustomValidator(function(){i(),s.userRegistrationValidation.validateEmailAddress(a.formFields.email.control.val(),r),""!==a.formFields.password.control.val()&&s.validateField(a.formFields.password)},a.formFields.email,s.messages.emailAddressReqired)),a.formFields.email.control.on("keyup change blur input",function(){s.validateField(a.formFields.email)}),this.init=function(){for(var e in"page"===a.type&&(formSource="Landing Page",ejpAnalytics.track("Registration Initiation")),a.submitButton.addClass("disabled"),a.formFields){a.formFields[e].validate(!0)}a.errorMessageContainer.hide()}}function CompleteUserRegistrationForm(i){new UserRegistrationFormBase(i);this.init=function(){for(var e in"complete"===i.type&&(formSource="Complete Registration Page",ejpAnalytics.track("Registration Initiation")),i.submitButton.addClass("disabled"),i.formFields){i.formFields[e].validate(!0,!0)}}}function disableSubmitButtonOnError(e,i){e.isValid||i.submitButton.hasClass("disabled")||i.submitButton.addClass("disabled")}function IsFieldSelectedOrCheckedOrNotEmpty(e){var i=e.control.prop("tagName").toLowerCase();if("input"===i){var a=e.control.attr("type");return"checkbox"===a?e.control.is(":checked"):"text"!==a&&"email"!==a&&"password"!==a||""!==e.control.val().trim()}return"select"!==i||"-1"!==e.container.find(":selected").val()}function ValidationResult(e,i){return{isValid:e,errorMessage:i,asyncValidationInProgress:2<arguments.length&&void 0!==arguments[2]&&arguments[2]}}function RequiredFieldValidator(e,i){var a=this;this.field=e,this.errorMessage=i,this.validate=function(){var e=a.field.control.prop("tagName").toLowerCase();if("input"===e){var i=a.field.control.attr("type");return"checkbox"===i?new ValidationResult(a.field.control.is(":checked")):("text"===i||"email"===i||"password"===i)&&""===a.field.control.val().trim()?new ValidationResult(!1,a.errorMessage):new ValidationResult(!0)}return"select"===e?new ValidationResult("-1"!==a.field.container.find(":selected").val(),a.errorMessage):new ValidationResult(!0)}}function RequiredFieldCustomValidator(i,e,a){var s=this;this.field=e,this.requiredMessage=a,this.validate=function(){var e=new RequiredFieldValidator(s.field,s.requiredMessage).validate();return e.isValid?(i(),new ValidationResult(!0,"",!0)):e}}function UserRegistrationValidation(e){var o=e,a="";return{validateEmailAddress:function(e,i){var s,a;s=i,a=o+"/IsEmailAddressValid?emailAddress="+encodeURIComponent(e),$.ajax({url:a,type:"GET",async:!0,success:function(e){s(e?new ValidationResult(e.IsValid,e.ErrorMessage):new ValidationResult(!1,"The service is irresponsible, please try again later."))},error:function(e,i,a){s(new ValidationResult(!1,"The service is irresponsible, please try again later.")),console.error("The service is irresponsible. Status: "+i+". Error: "+a)}})},validatePassword:function(e,i,a){var s,t,r;s=a,t=o+"/IsPasswordValid",r={password:e,emailAddress:i},$.ajax({url:t,type:"POST",data:JSON.stringify(r),contentType:"application/json",dataType:"json",processData:!0,async:!0,success:function(e){s(e?new ValidationResult(e.IsValid,e.ErrorMessage):new ValidationResult(!1,"The service is irresponsible, please try again later."))},error:function(e,i,a){s(new ValidationResult(!1,"The service is irresponsible, please try again later.")),console.error("The service is irresponsible. Status: "+i+". Error: "+a)}})},getPasswordStrengthSuggestion:function(e){!function(i){if(""===a){var e=o+"/GetPasswordStrengthSuggestion";$.ajax({url:e,type:"GET",async:!0,success:function(e){e&&i(a=e)},error:function(e,i,a){console.error("The service is irresponsible. Status: "+i+". Error: "+a)}})}else i(a)}(e)}}}