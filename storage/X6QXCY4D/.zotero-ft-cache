應用於心電血壓機之ECG訊號與血壓訊號的特性分析

莊爵譽

吳崇民

崑山科技大學

崑山科技大學

recall021@yahoo.com.tw cmwu@mail.ksu.edu.tw

摘要

在近代的預防醫學中，各種不同的生理參數已

廣泛應用於各種疾病的預防，以及疾病初期的偵

測，其中血壓參數常用來評估心血管疾病發生的機

率，而現今非侵入式血壓量測方法，皆透過氣泵對

腕帶施加壓力，量測時手臂遭腕帶壓迫而有不舒服

的感覺，易造成受測者緊張，導致血壓量測上之誤 差，無法做即時血壓監測。

圖2.Noninvasive measurement techniques[7]

本研究將利用類神經網路，發展新式之非侵入 式血壓量測技術，以心電圖參數計算血壓值之血壓 心電機，改善非侵入式血壓量測之氣泵對腕帶施加 壓力，所造成的不適感外，更可進行長時間的即時 血壓監測。 關鍵詞:類神經網路、血壓、心電圖、心電血壓機

在1905年KOROTKOFF提出非侵入式的腕帶 壓量測技術，即透過腕帶洩氣時，利用聽診器聆聽 血液通過血管之聲音，並觀察水銀刻度來確認收縮 壓及舒張壓的量測方法，此為水銀血壓計之量測技 術。但由於透過聽診器量測時，常會因量測者之聽 覺能力和主觀辨識的差異性，而造成量測上的誤

1. 前言
在近代的預防醫學中，各種不同的生理參數以 廣泛測量並應用於各種疾病的預防以及疾病初期 的偵測方面，例如：體脂肪的量測、 Electroencephalography(EEG) 與 Event Related Potentials(ERPs) 對 於 精 神 認 知 狀 態 的 評 估 以 及

差。隨著醫學技術的發展，現今在醫療電子化與數 位化的帶動下，操作簡單、易觀察的電子血壓計也 漸漸取代傳統水銀血壓計。電子血壓計以數位訊號 處理的方法，運用脈搏血壓的共振波形之數值比 例，計算出血壓的收縮壓與舒張壓[5][6][7]，此血 壓共振波形如圖3所示。

Electrocardiogram(ECG) 與 Heart Rate Variability

(HRV)對於身體狀態的觀察等等，而血壓的參數也

可以評估心血管疾病發生的機率[1]。

在國際間有些許學者，持續探討血壓之量測技

術 ， 血 壓 量 測 主 要 分 為 侵 入 式 量 測 (Invasive

measurement techniques)如圖1[7][8]與非侵入式量

測 (Noninvasive measurement techniques) 如 圖

2[7][8][9]兩種。其中侵入式量測數據較準確，可做

長時間即時之血壓監測，但易對人體組織遭成傷

害，相對的提高量測之危險性，此種量測方法只適

用於大型醫院，且有經過特殊訓練之醫護人員方可

進行；而非侵入式量測則不會對人體造成傷害，危

險性低，但無法做即時血壓監測，因操作方便，大 多數人都可學會，適合作為居家血壓觀測之量測技

圖3.壓力訊號與共振訊號之關係[7]

術，雖量測數據與真實數據有些許誤差，但仍屬可 接受範圍。

非侵入式血壓量測方法，皆透過氣泵對腕帶施 加壓力，量測時手臂遭腕帶壓迫而有不舒服的感

覺，易造成受測者緊張，導致血壓在量測上產生誤

差。因此本研究將發展新式之非侵入式血壓量測技

術，以心電圖參數計算血壓值，除了可改善非侵入

式血壓量測之氣泵對腕帶施加壓力，所造成的不適

感外，更可進行長時間的即時血壓監測。目前國內

外對於血壓與心電圖之關聯性的相關研究非常少

[8]，本論文將以探討心電圖中PQRST波與血壓訊

號之相關性為主，希望藉由此研究找出新的特性參

圖1.Invasive measurement techniques[8]

數發展新式之非侵入式血壓量測技術。

2. 實驗方法
本研究將建立心電圖與血壓量測電路，並進行 off line 訊號處理，並偵測心電圖中 PQRST 波與血 壓波峰，並進行相關性分析。圖 4 為本研究系統流 程圖，主要分為 2 個部分說明(1)訊號量測電路、(2) 訊號處理。

器定為 0.05Hz，使ST片的準確記錄。而通常低通 濾波器的設置為 40，100或150Hz[8]。
由於本研究主要以訊號不受電源雜訊干擾，且 能清楚分辨心電圖各特徵點，因此本研究選擇監控 模式，而設置濾波器階數以2階為主，其因於盡量 減少訊號失真之現象，如圖6所示。

圖4.系統流程圖 2.1 訊號量測電路
包含兩種生理訊號量測Blood Pressure(BP)、 Electrocardiogram(ECG)以下將介紹兩種量測電路 都包含儀表放大器、低通濾波器及高通濾波器。 血壓量測電路
由於電子血壓計量測血壓，是由腕帶氣壓的共 振訊號所組成，並非人體真實訊號，也無法做即時 量測，因此本研究以紅外線感測器針對脈搏進行即 時之動脈壓訊號量測。
量測電路主要以儀表放大器與高低通濾波器 組成。儀表放大器主要是將紅外線感測器的差動輸 入訊號放大，並且利用此電路的特性而去除共模雜 訊，其放大增益Av 10。高通濾波放大器的截止頻 率為1Hz。由於在量測時訊號可能受到電源雜訊干 擾，因此本研究將增加低通濾波器的截止頻率為40 Hz，主要可減少50或60Hz電源雜訊，而設置濾波 器階數以2階為主，其因於盡量減少訊號失真之現 象，如圖5所示。

圖6. Measurement Circuit of Electrocardiogram
並利用National Instruments開發的DAQ介面，擷取 ECG與BP訊號至MATLAB，進行offline訊號分析。
2.2 訊號處理 此部分主要進行血壓與心電圖之波峰偵測與
相關性分析，處理流程分為Peak detection with pattern’s correlation 、 Analysis of relationship between BP and ECG等兩個部分，如圖7所示。

圖7.訊號處理流程

圖5. Measurement Circuit of Blood Pressure
心電圖量測電路 心電圖量測電路以儀表放大器與高低通濾波
器組成。儀表放大器主要是將心電導程I的差動輸 入訊號放大，並且利用此電路的特性而去除共模雜 訊，其放大增益Av10[1]。Electrocardiogram常見的 設置分類為監控模式和診斷模式。在監控模式下， 高 通 濾 波 器 的 設 置 到 1Hz 和 低 通 濾 波 器 定 為 40Hz。高通濾波器則有助於減少流浪基準線和低 通濾波器可減少50或60Hz電源雜訊（50至60Hz在 於不同的國家的設置）。在診斷模式下，高通濾波

Peak detection with pattern’s correlation 此部分主要對 BP 與 ECG 等訊號進行處理，其
中 BP 訊號主要偵測手指血壓波形的所有波峰點。 而 ECG 訊號主要偵測 P、Q、R、S、T 等波的波峰 點，分別按以下 3 個步驟進行:偵測主要特徵點、 遺失之主要特徵點偵測、ECG peak detection。

(a) 偵測主要特徵點

血壓訊號之主要特徵點為動脈收縮壓為 B

wave，正常 ECG 訊號之主要特徵點為 R wave，以 下將對兩種訊號處理做說明。

血壓訊號與 ECG 訊號先進行波峰峰值偵測建立波

峰序列，如式(1)。

F(S)

=

⎧S ⎩⎨S

M M

−S +1 −

M
S

−1 M

> <

0 0

, M = 1,2,..., n

(1)

式中 S 為血壓或 ECG 之訊號，M 為第 n 筆訊號值。 將血壓訊號波峰序列中最大波峰峰值作為B
wave之參考點，如圖8中的方形。參考點再與各波 波峰進行比例篩選，當比例大於80%，會歸列為B wave序列，如圖8中的圓形。
圖8.動脈壓偵測之方式 將ECG訊號波峰序列中最大波峰峰值作為R wave之參考點，如圖9中的方形。參考點再與各波 波峰進行比例篩選，當比例大於80%，會歸列為R wave序列，如圖9中的圓形。
圖9. R wave偵測之方式 (b) 遺失之主要特徵點偵測
在主要特徵點的偵測過程中，有些主要特徵 點會因條件不符合，而沒被檢測出來，由於血壓與 心電圖皆屬於周期波，因此本研究將進一步利用平 均週期來檢查，是否有未偵測到波峰。當兩波峰間 的距離大於平均區間時，則可能有波峰遺失，如圖 10所示，此時若區間內有其它的波峰，便以樣本相 關性分析找出遺失之波峰[4]。

0.06 秒總時間為 0.12 秒，其中 0.12 秒則是考慮 ECG 主要特徵 QRS complex wave 的 QS 正常區間最大 值為 0.12 秒[10]。
當該訊號內有未偵測到波峰，便以標準樣本

進行波形相關性分析。當相關係數大於 68.2%(一 個標準差)，將新增於主要特徵點序列中，並讓標 準樣本對該波進行學習，其學習演算法為最小平均

演算法(MSE)，如式(3)。主要使樣本個人化，並提 升相關係數，降低辨識錯誤率，當遺失波峰之主要 特徵點偵測結束時，再以學習後之標準樣本對整個

序列進行相關性分析，並持續進行樣本學習，直到

無任何特徵點被偵測到為止。

w = 1 E(w − Δw)2 + w

(3)

2

式中 w 為標準樣本，△w 為偵測到波形。

(c) ECG peak detection 主要特徵偵測點結束後，此流程以 ECG 特徵
點 R wave 為參考點，進行其餘波峰(P, Q, S, T)偵 測，偵測方式則依據各波與 R wave 之時間特性來 偵測，如 PR interval 120ms to 200ms 針對 P 波偵 測、QRS complex wave 80ms to 120ms 針對 Q、S 波偵測、QT interval 300ms to 430ms 針對 T 波偵測 [2][10]。而血壓訊號則將兩波峰間之波谷為動脈舒 張壓特徵點。

Analysis of relationship between BP and ECG 為了探討動脈壓與心電圖之關係[2][8]，本研
究首先進行 ECG 與 BP 之週期相關性分析，因 BP 波峰 B 與 ECG 的 T 波峰發生時間點一致，因此設 置 T 波峰與 B 波峰之週期相關性分析，接著進行 ECG 各波至 T 波之區間與收縮壓之區間的特性分 析，如圖 11 粗線部分及 T 波至 ECG 各波之區間與 舒張壓之區間的特性分析，以找出 ECG 相對應於 收縮壓、舒張壓之特性參數。

圖10. BP與ECG波峰遺失示意圖

本研究將建立一標準樣本以進行波形之相關 性分析，標準樣本為該訊號之參考點區間，例如: BP 之標準樣本為動脈收縮壓之波形，而 ECG 屬於 複合波，當 ECG 訊號準位飄移時，其參考點可能 並非為 R wave，因此利用 MATLAB 提供 ECG function 的 R wave 作為標準樣本，標準樣本之區間 設定如式(2)。

Array = [M (s) − 0.06(s) ≤ M (s) ≥ M (s) + 0.06(s) ]

(2)

式中 M 為主要特徵時間點，並選取前 0.06 秒至後

圖11. ECG特徵參數與血壓之相關性分析[2]
2.3 ECG 血壓機之設計 將心電訊號與血壓訊號相關特性較高的參
數，做為神經元的輸入端，進行網路演算及學習， 建立心電血壓機之雛形。本系統採用多層感知器 (multilayer perceptron, MLP)，結合誤差倒傳遞演算 法(Error Back Propagation, EBP)來進行網路學習， 此組合稱之為倒傳遞類神經網路[3]，如圖12所示。

圖 15 為 ECG 訊號偵測流程圖，圖 15(a)偵測主要 參考點，圖 15(b)遺失之主要特徵點偵測，圖 15(c) 遺失之主要特徵點，圖 15(d) ECG peak detection。

圖12. 倒傳遞類神經網路架構圖[3]
3. 實驗結果
本研究邀請 5 位 20~26 歲受測者，同時進行心 電與血壓量測，如圖 13 所示。圖 13 為實際量測圖， 圖 13 中(A)為紅外線脈搏量測電路，圖 13 中(B)為 心電圖量測電路，將所量測的訊號將進行訊號處 理、相關性分析，並從相關性分析得此兩種訊號之 特性參數。

圖15. ECG訊號波峰偵測
3.2 標準樣本辨識率 ECG 的標準樣本屬於複合波，因此只觀察
ECG 的標準樣本學習後之辨識率。圖 16 為標準樣 本分析與學習，特徵樣本與未偵測波峰之波形學 習，明顯提升相關係數。

圖13. 實際量測圖
3.1 訊號處理之波峰偵測 本研究先進行訊號處理，同時進行 BP 與 ECG
之訊號處理，並依序以波峰偵測圖進行解說。 圖 14 為 BP 訊號波峰偵測圖，圖 14(a)偵測主
要參考點，圖 14(b)遺失之主要特徵點偵測，圖 14(c) 找回遺失之主要特徵點。

圖16. 標準樣本分析與學習
並統計偵測到的 R wave 數與實際觀察 R wave 數之 誤差百分比(表 1) ，標準樣本學習的確有助於降低 辨識錯誤率。
表1.R wave偵測辨識率

圖14. BP訊號波峰偵測

3.3 心電圖與血壓特性分析 訊號處理後，將心電圖中 PQRST 波與血壓訊
號波峰，並依據本研究所設計之參數進行特性分析 統計(表 2)。由表 2 中將選取相關特性高於 68.2%(一 個標準差)之區間參數(ET、RT、QT、ST、TP、TQ、 TR)作為類神經網路之輸入變數。

表2.心電圖與血壓特性分析
3.4 血壓量測結果 將 ET、RT、QT、ST、TP、TQ、TR 等區間做
為類神經網路之輸入訊號，本研究將建立七個輸入 端的倒傳遞類神經網路架構，再經由 20 筆資料學 習後，並對三位受測者進行血壓演算，演算所得量 測值與水銀血壓計量測值之結果，如表 3。其中 subject 1、3 與實際量測值有較大差異，可能是因 為類神經網路之學習資料不夠。
表3.心電血壓計演算
4. 討論
由測試的結果可以發現，雖然推算出血壓還不 是相當準確，但已相當接近水銀血壓計所量之血壓 值，未來在類神經網路之演算方面，還需要更多的 臨床測試與學習才能達到更為精確的數值，且將與 醫院合作收集侵入式血壓之量測數據，以求更精準 的計算出接近真實之血壓值。
本研究已完成心電血壓機之基本模型，經由實 際量測之結果，驗證本系統再現性良好。為了使新 式之非侵入式血壓量測技術實際運用於生活上，本 研究將改良心電圖 PQRST 波偵測方式，Offline 的 分析系統改成 Online 的分析系統，讓患者在醫院 或生活中，隨時都可以監督自我血壓，以避免意外 的發生。

致謝
在此，我們向國科會表達誠摯感謝之意， 感 謝國科會提供編號 NSC98-2221-E-168-027 計畫之 研究經費。使我們可以有令人滿意的研究成果，謹 此致謝。
參考文獻
[1] 陳政宇，李璟林，丁文宏，鄭國順，電子血 壓計之研製:基於微處理器架構的數位處理 方法，國立成功大學醫學工程研究所。
[2] 依日光，醫用電子計測技術，復漢出版社， 1995。
[3] 張斐章，張麗秋，類神經網路，東華書局， 2005。
[4] Chong-Min Wu, Quantification of Motor Unit Firing Patterns, National Cheng Kung University, Taiwan, 1998.
[5] G. Drzewiecki, R. Hood, H. Apple, “Theory of the Oscillometric Maximum and the Systolic and Diastolic Detection Ratios”, Annals of Biomedical Engineering, vol. 22, p88-96, 1994.
[6] J. G. Webster ed., Medical Instrumentation Application and Design, 3rd ed., John Wiley & Sons, 1998.
[7] Jay Horrow, MD Professor and Chair, Blood Pressure Measurement, Anesthesiology Drexel University College of Medicine Philadelphia, PA, June, 2006.
[8] JB. Mark, Atlas of cardiovascular monitoring, Churchill Livingstone, New York, 1998.
[9] Blitt CD, Hines RL, Monitoring in anesthesia and critical care medicine, Churchill, New York, p. 118, 1995.
[10] http://en.wikipedia.org/wiki/Electrocardiograph y

