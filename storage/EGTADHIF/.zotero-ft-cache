ECG/PPG 量测解决方案

Application Note
Strategic Product Center AN057 – September 2018

摘要
本应用文件介绍了心电图 (ECG) 与光电容积图 (PPG) 的基本工作原理，讨论了 ECG 与 PPG 生理信号的量测，以及 提高可靠性、实现高精度电气特性的难点。一般高精准度的 ECG 与 PPG 架构都是采用模拟前端和 ADC 组合而成的 解决方案。本文介绍的 RT1025 利用 ECG/PPG 同步采样 ADC，提供了一个可以同步撷取 ECG/PPG 以应用于血压 计算的引人注目亮点，及其高度集成的解决方案省去了多个模拟前端组件，节省空间的同时也降低了系统成本。 RT1025 符合 IEC 60601-2-27 与 China YY1079 等规范，适用于医疗级 ECG/PPG、健身与穿戴式产品的应用。

目录
1. 概述.................................................................................................................................................................................2 2. 生理讯号：ECG vs. PPG 与 PTT..................................................................................................................................2 3. 生理讯号处理的挑战 ......................................................................................................................................................4 4. ECG 量测电路 ................................................................................................................................................................5 5. PPG 量测电路 ................................................................................................................................................................6 6. RT1025 产品介绍...........................................................................................................................................................6 7. 总结.................................................................................................................................................................................8

AN057

© 2018 Richtek Technology Corporation

1

ECG/PPG 量測解決方案
1. 概述
心脏运作可以揭露人体许多极具价值的信息，包括其健康状态、生活方式，甚至是情绪状态及心脏疾病的早期发病等。 传统的医疗设备中，监测心跳速率和心脏活动是经由测量电生理讯号与心电图 (ECG) 来完成的，需要将电极连接到 身体来量测心脏组织中所引发电气活动的信号。此外，随着心跳会有一压力波通过血管进行传递，这个波会稍微改变 血管的直径，除了 ECG 外的另一选择──光体积变化描记图法 (Photoplethysmography, PPG) 就是利用这个变化， 是一种无需测量生物电信号就能获得心脏功能信息的光学技术。PPG 主要用于测量血氧饱和度 (SpO2)，但也可不进 行生物电信号测量就提供心脏功能信息。借助 PPG 技术，心率监护仪可集成到手表或护腕等可穿戴设备上，以达成 连续侦测的应用。
2. 生理讯号：ECG vs. PPG 与 PTT
心电描记术 (Electrocardiography, ECG 或者 EKG) 是一种经胸腔以时间为单位记录心脏的电生理活动，利用在人体 皮肤表面贴上的电极，可以侦测到心脏的电位传动，而心电图所记录的并不是单一心室或心房细胞的电位变化，而是 心脏整体的电位变化。心电图的结果通常以波型显示，基本包括有 P 波、QRS 波组、T 波。P 波代表的是心房收缩， QRS 波组则是心室收缩，T 波是心室舒张。有关心跳率的测量或评估，是以 R 波与 R 波的间隔时间来代表。RR 间隔 越大代表心跳率越低，RR 间隔越小代表心跳率越高。测量 ECG 信号常常要在身体多个部位连接传感器电极，在胸 部和四肢之间最多可以连接 10 个电极。

数据源：HEALTHY-AGEING

光体积变化描记图法 (Photoplethysmography，简称 PPG) 是借光电手段在活体组织中检测血液容积变化的一种无创 检测方法。当一定波长的光束照射到指端皮肤表面，每次心跳时，血管的收缩和扩张都会影响光的透射 (例如在透射 PPG 中，通过指尖的光线) 或是光的反射 (例如在反射 PPG 中，来自手腕表面附近的光线)。当光线透过皮肤组织然 后再反射到光敏传感器时，光照会有一定的衰减。像肌肉、骨骼、静脉和其他连接组织对光的吸收是基本不变的 (前 提是测量部位没有大幅度的运动)，但是动脉会不同，由于动脉里有血液的脉动，那么对光的吸收自然也会有所变化。 当我们把光转换成电信号时，正是由于动脉对光的吸收有变化而其他组织对光的吸收基本不变，得到的信号就可以分 为直流 DC 信号和交流 AC 信号。提取其中的 AC 信号，就能反应出血液流动的特点。

AN057

© 2018 Richtek Technology Corporation

2

ECG/PPG 量測解決方案

心臟舒張

心臟收縮

血管

LED

Photo Detector

PPG Optical Module

心臟收縮

Pulse Peak

心臟舒張

下图是 PPG 信号和 ECG 信号的对比

R-Wave Peak

ECG PPG

心臟收縮

Time Delay
Pulse Peak

心臟舒張

根据 PPG 与 ECG 个别的生理特征点，我们可以发现 ECG 的峰值来自于心室的收缩，而 PPG 的峰值则是因为血管 收缩所造成的，因此我们可以得到血液自心脏送出后到达量测部位的传输时间，也就是脉搏波传递时间 Pulse Transit Time (PTT)，脉搏波传递的速度与血压是直接相关的，血压高时，脉搏波传递快，反之则慢，所以通过心电信号 ECG 与脉搏波信号 PPG 获得脉搏传递时间 (PTT)，再加上常规的一些身体参数 (如身高、体重) 即可得出脉搏波传递 速度，通过建立的特征方程来估计人体脉搏的收缩压与舒张压，可实现无创连续血压测量。

AN057

© 2018 Richtek Technology Corporation

3

ECG/PPG 量测解决方案
3. 生理讯号处理的挑战
ECG 量测的挑战
一般 ECG 电极需放置在心脏两侧并紧贴皮肤，可以用来记录心电信号随时间的变化。实际 ECG 信号的幅度只有几 毫伏，频率不超过几百赫兹。ECG 测量面临诸多挑战：一方面，来自 ECG 主电源的 50Hz 至 60Hz 电容耦合干扰要 比心脏信号强许多；另一方面，身体皮肤的接触阻抗以及传感器之间阻抗的不匹配，这会导致较大的偏差并降低共模 抑制能力；此外，还要解决接触噪声以及电磁源产生的干扰问题。此类应用中一些重要的放大器参数包括共模抑制、 输入偏移电压和偏移电压漂移、输出摆幅以及放大器噪声，说明如下：
 共模抑制
如前文所述，放置在患者皮肤上的电极可能有大约数百毫伏特的直流电压，而有用讯号的电压通常小于一毫伏特。 仪表放大器配置非常适合这种情况，该放大器将消除任何与差分输入共模的讯号 (来自电极或任何共模噪声，如 60Hz 干扰)，同时放大有用的心电讯号。在这种情况下，考虑放大器电路的共模抑制参数是非常重要的，不仅针 对直流讯号，还要考虑跨频率，尤其是线路频率为 50Hz 或 60Hz 时。具有高共模抑制比的放大器将消除更多不需 要的噪声并实现更高精度的测量。
 输入偏移电压和偏移电压漂移
由于有用电压相当小，放大器需要提供增益，以提高检测电路的分辨率。此应用需要高增益，因此放大器的偏移 电压非常重要。放大器产生的任何偏移电压都将乘以电路增益，例如，假定心脏收缩在皮肤上的一个指定电极上 产生 1 毫伏特电压，假定放大器电路的增益设置为 1000，则放大器电路的理想输出为 1 伏特，但如果放大器的输 入偏移电压为 100 微伏特时，则将在输出产生 100 毫伏特的误差 (占有用讯号的 10%)。值得注意的是，放大器的 输入偏移误差以输入为参考，因此，误差将与放大器的增益成比例。
与所有电子组件一样，放大器的特性会随时间和温度发生变化，其电压偏移也是如此。放大器电压偏移是误差的 来源，随着偏移电压的漂移，此误差可能变得更大。然而，透过选择低漂移放大器 (如采用自动归零校准架构的 放大器) 或者定期执行系统校准，藉此校正失调和漂移的运算放大器，可大幅度地减小此类误差源带来的影响。
 放大器输出摆幅
在前面的示例中，电极上 1 毫伏特电压变化会在放大器电路的输出上产生 1 伏特的电压变化。对于 5 伏特单电源 系统，这代表放大器电路可精确检测 0 ~ 5 毫伏特的电压，放大器需要输出可摆动到最低与最高的电源轨。相反 地，如果放大器不支持轨对轨的输出摆动，则电压的动态范围会变小，就无法正确检测出完整的输入讯号，因而 会限制检测电路的动态范围，无法做出精确的侦测。
 放大器噪声
当评估此类应用的放大器时，另一个必须考虑的重要参数是放大器噪声。值得注意的是，放大器的噪声可能不会 随频率保持恒定，尤其是在 1/f 噪声可成为主要噪声源的低频率下；在 ECG 应用中，有用的讯号带宽通常为直流 到 100Hz，因此 1/f 噪声仍是误差源之一。
PPG 量测的挑战
测量 PPG 面临的主要挑战来自环境光和运动产生的干扰。阳光产生的直流误差相对而言比较容易消除，但日光灯和 节能灯发出的光线都带有可引起交流误差的频率分量。运动也会干扰光学系统，当光学心率监护仪用于睡眠研究时， 这可能不是问题，但如果在活动期间穿戴，则将很难消除运动伪像，光学传感器 (LED 和光电检测器) 和皮肤之间的 相对移动也会降低光信号的灵敏度。
此外，运动的频率分量也可能会被误判为心率，因此，必须测量该运动并进行补偿。设备与人体之间相贴越紧密，这 种影响就越小，但采用机械方式消除这种影响几乎是不可能的。通常可使用多种方法来测量运动的干扰，其中一种是 光学方法，即使用多个 LED 波长。共模信号表示运动，而差分信号用来检测心率。不过，最好是使用真正的运动传 感器，该传感器不仅可准确测量应用于可穿戴设备的运动，而且还可用于提供其他功能，例如跟踪活动、计算步数或 者在检测到特定 g 值时启动某个应用。

AN057

© 2018 Richtek Technology Corporation

4

ECG/PPG 量測解決方案
4. ECG 量测电路
典型的 ECG 设备通常利用 AFE 进行信号放大、滤波，然后通过一个 ADC 进行数据采集。使用低分辨率 (16 位) ADC 时，信号需要被显著增益 (增幅通常为 100 ~ 200 倍) 以达到必要的分辨率。使用高分辨率 (24 位) Σ-ΔADC 时，信号 仅需要 4 ~ 5 倍的适度增益。因此可以除去消除直流偏移所需的第二增益级和电路。这将实现面积与成本上的整体缩 减。Σ - ΔADC 方法还将保留信号的整个频率内容，并为数据后期处理提供充分的灵活性。
仪表放大器 (IA) 仪表放大器 (IA) 的主要任务是抑制共模信号 (通常是 50Hz/60Hz 干扰)，ECG 应用需要 90dB 甚至更高的共模抑制比 (CMRR) 以抑制放大电路从电源耦合的 50Hz/60Hz 信号。即使采用具有高共模抑制比 (CMRR) 的 IA，不同 ECG 电 极的差异或者是皮肤接触阻抗之间的不匹配不仅产生偏移电压漂移，也会导致 CMRR 低于所期望的水平。阻抗的不 匹配主要源于电极与皮肤的物理接触、排汗和肌肉运动等原因。随后要考虑的因素是 IA 的增益，设置 IA 增益时必须 注意避免增益过大导致削波或饱和。IA 的输入阻抗指标也很重要，因为 ECG 测量的是微弱信号。推荐选择具有高阻 输入的 IA，因为较低的输入阻抗会导致较大的信号衰减。
第二级放大 (PGA) 利用 IA 和滤波器消除噪声和干扰后，再进行第二级放大，提供额外的增益以达到 ADC 的输入量程。有些设计还添加 了一个陷波滤波器，对 50Hz/60Hz 作进一步抑制。
低通/抗混迭滤波器 (Filter) 低通滤波器用来抑制高频干扰，同时也起到一个抗混迭滤波器 (Anti-aliasing Filter) 的作用，即阻止任何大于奈奎斯特 或 1/2 采样频率的信号，避免产生 ADC 混迭。
为了进一步降低输入共模信号，ECG 设计通常还引入一级「右腿驱动器」 (VRLD)，驱动反相共模信号返回人体。为 了确保病人的安全，通常利用一个运算放大器和一个限流电阻以确保驱动到人体的是一个非常微弱的信号源。这个右 腿驱动器可以降低 ECG 电极承载信号的噪声耦合。

Filter

IA

PGA

VRLD

ECG ADC

AN057

© 2018 Richtek Technology Corporation

5

ECG/PPG 量测解决方案
5. PPG 量测电路
PPG 的量测电路包含：光发射驱动系统中的 LED，以及测量光电二极管返回信号的电路。目标是通过消耗的一定 LED 电流量 (存在一定的电流传输比)，测量尽可能高的光电流。光电二极管的输入接收信号透过转导放大器 (TIA) 而 放大、滤波，然后通过一个 ADC 进行数据采集。
环境光干扰是一个大问题，尤其是当存在调制光时，比如使用 LED 或节能灯的固态照明系统。为了获得良好的信号 响应，要透过数字信号处理降低环境光干扰的影响，这是一个关键功能，能够非常有效地抑制外部光干扰。

Photo Detector

Ambient Cancel

Filter

LED

TIA

PGA

PPG Driver

PPG ADC

LED + AMB AMB

6. RT1025 产品介绍
RT1025是一个高度集成用来量测心律与心电讯号的前端电路。RT1025整合了低噪声的电压与电流放大线路，因此 可以同时量测ECG和PPG讯号。RT1025量测心电讯号时具有大于100dB的动态输入范围，并提供从64Hz至4kHz的 高精准度撷取率。透过高集成的电路设计，仅需少数的外部零件，即可设计于低功耗的医疗级ECG/PPG、健身与穿 戴式产品的应用中。RT1025提供3.1mm x 3.4mm, 41-Ball, 0.4mm pitch, WL-CSP的封装。RT1025符合IEC 606012-27与China YY1079等规范，适用于医疗级ECG/PPG、健身与穿戴式产品的应用。

RT1025内含4kB SRAM用于资料缓冲，透过外部的晶体震荡器提供参考频率，可以利用I2C或是SPI与微处理器沟通 传递信息，以下为RT1025的应用电路。

AN057

© 2018 Richtek Technology Corporation

6

ECG/PPG 量測解決方案

ECG Electrode
Boost

RT1025

INP_ECG INN_ECG VRLD INP_PPG

AVDD_HV AVDD28 DVDD18 DVDDIO

1.8V 1.8V~3.6V
2.2uF

INN_PPG
TX1 TX2

XTALI RESETB AFE_PWD I2C / SPI
INT

32kHz / NC RESETB AFEPWD I2C / SPI
INT

VBG

1uF

GND_A GND_HV GND_D

2.8V 2.2uF

2.8V 2.2uF

MCU

2.2uF

RT1025 产品特点
 ECG 通道特性
支持双电极 (2E)模式和右腿驱动 (RLD)模式 低噪声 PGA 和高分辨率 ADC 输入阻抗：125M-500MΩ (双电极模式)，> 1GΩ (右腿驱动模式) 低输入参考噪声：0.67µVrms (64Hz ODR, Gain = 12) 动态范围：110dB @ Gain = 6 CMRR > 85dB at 60Hz 数据采样率：64SPS 至 4k SPS
 PPG 通道特性
灵活的时间控制，支持动态断电 驱动支持 H 桥和推/拉模式 LED 驱动电流范围：10 / 25 / 35 / 50 / 65 / 75 / 90 / 105mA，支持 8 位分辨率 最大输入电流范围：0.5 至 50μA 最大输入电容：1nF 输入参考噪声：50pArms @ 5μA 输入电流 CMRR > 80dB at 60Hz PGA 增益：1 至 6V/V 环境 DAC1/DAC2 范围：1 至 6μA
 其他特性
二合一生物量量测 AFE (电压/电流) 内建心跳间隔评估 集成振荡器依靠外接晶体提供高精度时钟信号 支持与 MCU 之间的 I2C 和 SPI 通讯 内建数据缓存 SRAM 超低功耗 工作环境温度范围：–20°C 至 65°C WL-CSP-41B 封装，3.1mm x 3.4mm 符合 RoHS 规范，不含卤素

AN057

© 2018 Richtek Technology Corporation

7

ECG/PPG 量测解决方案
ECG/PPG量测评估版 为 了 快 速 评 估 RT1025 的 特 性 ， 立 锜 科 技 开 发 了 ECG/PPG AFE Daughter Board (PCB107_V1) 以 及 Cardioid Evaluation Board (PCB106_V1) 与配对的安卓手机应用软件 (Cardio EVK)，相关规格书与应用数据请参考立锜科技 网站http://www.richtek.com。

Daughter Board (PCB107_V1)

Cardioid Evaluation Board (PCB106_V1)

7. 总结
RT1025 是可以同时满足 ECG/PPG 测量要求的器件，在不增加成本的前提下提供理想的特性指标，同步撷取 ECG/PPG 的讯号，可以提升 PTT 血压计算的准确度，有助于降低您的研发预算、缩短设计时间、缩小电路板面积并 减少系统的组件数量，同时也提高了方案的性能和可靠性。

相关资源
立锜科技电子报

订阅立锜科技电子报

Richtek Technology Corporation 14F, No. 8, Tai Yuen 1st Street, Chupei City Hsinchu, Taiwan, R.O.C. Tel: 886-3-5526789

Richtek products are sold by description only. Richtek reserves the right to change the circuitry and/or specifications without notice at any time. Customers should obtain the latest relevant information and data sheets before placing orders and should verify that such information is current and complete. Richtek cannot assume responsibility for use of any circuitry other than circuitry entirely embodied in a Richtek product. Information furnished by Richtek is believed to be accurate and reliable. However, no responsibility is assumed by Richtek or its subsidiaries for its use; nor for any infringements of patents or other rights of third parties which may result from its use. No license is granted by implication or otherwise under any patent or patent rights of Richtek or its subsidiaries.

AN057

© 2018 Richtek Technology Corporation

8

