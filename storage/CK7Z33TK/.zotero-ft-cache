Continuous Blood Pressure Estimation Using PPG and ECG Signal
Bo Wang, Zhipei Huang, Jiankang Wu, Zhongdi Liu, Yuanyuan Liu and Pengjie Zhang
Abstract Continuous blood pressure monitor can detect the potential risk of cardiovascular disease and provide a gold standard for clinical diagnosis. The features extracted from photoplethysmography (PPG) and electrocardiogram (ECG) signals can reﬂect the dynamics of cardiovascular system. In this paper, 39 features are extracted from PPG and ECG signals and 10 features are chosen by analyzing their correlations with blood pressure. Several machine learning algorithms are used to predict the continuous and cuff-less estimation of the diastolic blood pressure and systolic blood pressure. The results shows that compared with linear regression and support vector regression methods, the artiﬁcial neural network optimized by genetic algorithm gives a better accuracy for 1 h prediction under Advancement of Medical Instrumentation and the British Hypertension Society standard.
Keywords Photoplethysmography · Electrocardiogram Continuous blood pressure · Artiﬁcial neural network · Genetic algorithm

B. Wang · Z. Huang (B) · J. Wu · Z. Liu · Y. Liu · P. Zhang
University of Chinese Academy of Sciences, Beijing, China e-mail: zhphuang@ucas.ac.cn
B. Wang e-mail: wangbo515@mails.ucas.ac.cn
J. Wu e-mail: jkwu@ucas.ac.cn
Z. Liu e-mail: liuzhongdi17@mails.ucas.ac.cn
Y. Liu e-mail: liuyuanyuan115@mails.ucas.ac.cn

P. Zhang e-mail: zhangpengjie15@mails.ucas.ac.cn

© Springer Nature Switzerland AG 2019

61

G. Fortino and Z. Wang (eds.), Advances in Body Area Networks I,

Internet of Things, https://doi.org/10.1007/978-3-030-02819-0_6

62
1 Introduction

B. Wang et al.

According to the World Health Organization (WHO) report, the Cardiovascular diseases (CVD) has claimed 17.5 million lives in 2016 [1]. A noninvasive and continuous system for monitoring cardiovascular parameters has become particularly important. Blood pressure (BP) is a signiﬁcant indicator of the status of the cardiovascular. Long time beat-to-beat BP monitoring is very useful in many areas, especially in medical domain, such as health assessment, medical diagnosis and surgical operation.
A number of approaches have been proposed for continuous and noninvasive BP estimation. Compared with Tonometry and Volume Clamp methods, the way of BP estimation by photoplethysmography signal is more promising [2].
The pulse waves of blood are generated by the beats of heart which push the blood ﬂowing along the arterial tree. With the intermittent contraction and relaxation of heart, the propagation of blood volume produce a pulse wave which can be detected by PPG using infrared light. As BP being the pressure exerted by the blood against the vessel walls, a pulse wave velocity (PWV) method was proposed to measure the beat-to-beat BP signal through the velocity of pulse waves.
The PWV measurement method needs to know precisely the distance between sites where signals are collected, which requires the presence of a skilled operator to manually localize the carotid and femoral arteries [3]. The PWV’s inverse, pulse wave transit time (PWTT), is commonly used to replace PWV.
The PWTT method to estimate blood pressure is based on Moens-Korteweg (M-K) equation, derived by Moens and Korteweg [4]:

D

tE

PW V PW TT

ρd

(1)

where D is the length of the vessel, PWTT is the pulse wave transmit time, t is thickness of the vessel wall, E is Young’s modulus, ρ is blood density and d is the vessel’s diameter.
In recent years, there have been a lot of researches about the relationship between pulse wave transit time and blood pressure. A linear relationship proposed by Zhang et al. [5] has been widely recognized as below:

BP a ∗ PW TT + b

(2)

Practically, the PWTT is derived from the time delay between the R-wave of ECG and the peak of PPG in the same cardiac cycle. The R-wave occurs at the beginning of the heart systole when the blood ejected from heart to aorta. Therefore, the R-wave is a good reference for the beginning of the cardiac cycle.
A frequent re-calibration procedure must be applied to obtain the parameters in linear equation because of the physiological dynamics of vessel, which makes the PWTT method become inconvenient in our daily life.

Continuous Blood Pressure Estimation Using PPG …

63

The main cause of this disadvantage of traditional PWTT technic is that the single PWTT feature couldn’t reﬂect the state of human body as a complex system, we need to seek more parameters which can represent patient’s cardiovascular index at that moment. Experimental research shows that the features, extracted from PPG and ECG signals, can be used to predict many vital health concerned parameters such as blood pressure and heart rate [6]. In view of the complexity of the human’s cardiovascular system, the relationship, linear or non-linear, between features and BP is uncertain. Machine learning provides a method that can accurately and effectively achieve the relationship between the features of physiological signals and BP.
In recent representative studies [7–11], researchers applied various machine learning algorithms for BP estimation from PPG and ECG signals. This study considered too much parameters and did not draw the correction between features and BP.
In this paper, the relationship between BP and the features extracted from PPG and ECG signals is investigated. Besides, various machine learning and signal processing algorithms are exploited in estimating 1-h continuous blood pressure. In summary, after denoising the PPG and ECG signals, their informative features are extracted, and ﬁnally, these features serve as an input to a regression model, which estimates the BP value. The accuracy of each algorithms was evaluated by percent of sets which reach the Association for the Advancement of the Medical Instrumentation (AAMI) and British Hypertension Society (BHS) standards among all available datasets to come to a conclusion.
The rest of this paper is organized as follows: Sect. 2 explains the whole experimental procedure and all the algorithms using this work. Section 3 presents the results and compares them with different machine learning algorithms and ﬁnally Sect. 4 concludes the paper.

2 Experimental and Computational Details
2.1 Data Acquisition
In this experiment, the Finometer [12] was used for noninvasive beat-to-beat blood pressure monitoring, which pressed the sensors on the skin surface of arteries. Meanwhile, the PPG and ECG signal were collected by a physiological signal synchronous collecting device, shown in Fig. 1. The sampling rate of ECG and PPG signal is 1000 Hz with 16 bit resolution. All 30 sets of data with 75 min long were collected in different person.

64
Fig. 1 Data collection during the experiment. By synchronizing the time of the two device’s software platforms, we can obtain ambulatory blood pressure (ABP), PPG and ECG signal in the same cardiac cycle

B. Wang et al.

2.2 Data Pre-processing
There are three kinds of noise which may be contained in the PPG and ECG signal [7]: (A) power-line interference–ambient electromagnetic signals picking up by the device; (B) baseline wandering caused by poor contact to the wearable sensor; (C) high frequency noise, such as environment interference and muscular activities. Through analyzed the spectrum of the raw signal, there is no power-line interference, thus, we should focus on eliminating the baseline wandering and high frequency noise in data pre-processing.
By analyzing and comparing, we selected the wavelet denoising method in preprocess because it provides various merits such as a better phase response and low computational complexity.
Figure 2 shows the preprocessing diagram of PPG and ECG signal. According to Singh BN [13] study, the raw signal is decomposed to 10 levels by Daubechies 8 (DB8) mother wavelet. Afterwards, the components corresponding to the very low frequency ranging from 0 to 0.25 Hz and the high frequencies between 250 and 500 Hz are eliminated with their coefﬁcients zeroing. The conventional wavelet denoising is performed on the remaining decomposition coefﬁcients with soft thresholding strategy [7]. Figures 3 and 4 represent the performance of wavelet denoising algorithm applied on the raw data.
2.3 Feature Extraction
According to Eq. (3), the value of blood pressure is determined by various cardiovascular parameters such as the thickness of the vessel wall, the blood density and the vessel’s diameter. Besides, systemic vascular resistance and the action of the heart also affect blood pressure.

Continuous Blood Pressure Estimation Using PPG …

65

Input Signal

Wavelet Decomposition (N=10,DB8)
Zeroing 0~0.25Hz Components
Zeroing 250~500Hz Components
The Remaing Components (Soft Rigrsure)

Wavelet Reconstruction

Preprocessed Signal

Fig. 2 Through the db8 wavelet, the baseline and high frequency noise are eliminated in raw PPG and ECG signal

Amplitude

Input PPG
1

0.8

0.6

0.4

0.2

0

0

5

10

15

20

25

Time(s)

Onput PPG
1

0.8

0.6

0.4

0.2

0

0

5

10

15

20

25

Time(s)

Amplitude

Fig. 3 Example PPG signals before and after the preprocessing

Dorlas and Nijboer [14] found that the PPG’s peak amplitude is directly proportional to local vascular distensibility and the amplitude is potentially a more suitable measure than pulse arrival time for estimating continuous blood pressure [15]. Wang et al. [16] have divided the PPG area into two areas at the dicrotic notch and the ratio of the two areas can be used as an indicator of total peripheral resistance.

66

Amplitude

1 0.8 0.6 0.4 0.2
0 0
1 0.8 0.6 0.4 0.2
0 0

Input ECG

0.5

1

1.5

2

Time(s)

Onput ECG

0.5

1

1.5

2

Time(s)

Amplitude

Fig. 4 Example ECG signals before and after the preprocessing

B. Wang et al.

2.5

3

2.5

3

Takazawa et al. [17] believed that the ratio of the amplitude between peak and dicrotic notches in PPG can be served to reﬂect the compliance of the elastic arteries. The time delay between the peak and dicrotic notches in PPG is an index of arterial stiffness, proved by Millasseau et al. [18].
A K value derived from PPG also have signiﬁcant correlation with the stiffness of arterial [19]. K value is calculated as below:

K

ppgoo − ppg(t0) ppg(to) − ppg(to )

(3)

In which

1

to

ppgoo

ppg(i) to − to i to

(4)

where o and o are the starting points and ending points of PPG in each cardiac cycle. Based on the above researches, in this paper, 28 time domain features are extracted
form PPG signal which are related to the amplitude, area and time delay characters in PPG signal.
There are 4 frequency domain features extracted from PPG according to Enric’s [9] study. En is the logarithm of energy in each cardiac cycle:

to

logEn log ppg2(i)

(5)

i to

Continuous Blood Pressure Estimation Using PPG …

67

Fig. 5 Illustration of features extraction from data. The Q, R, S peaks in the ECG signal and the starting points, peaks and dicrotic notches in the PPG signal

Kaiser-Teager function is a transform applied on PPG signal:

KTE(i) ppg2(i) − ppg(i − 1)ppg(i + 1)

(6)

The statistical coefﬁcients of KTE such as mean value and variance in each cardiac cycle are chosen. Besides, the energy of Fourier transform on PPG in per cycle is also selected.
A series of peak detection algorithm [20, 21] were used to detect Q, R, S peaks in the ECG signal and the starting points, Peaks and Dicrotic notches in the PPG signal. Altogether, there are 39 features extracted from PPG and ECG signals, which can be divided into three types, showed in Fig. 5 and listed in Table 1.

2.4 Features Selection

In order to reduce the feature’s dimension, we analyzed the correction between each features and BP. Pearson Correction is a standard of relevance analysis:

ρxy

E((X −√E(X ))√(Y − E(Y ))) D(X ) D(Y )

(7)

where E is mathematical expectation and D is variance.

68
Table 1 Frequency of special characters Source Features abb. PPG PH/DNH/DPH
DNHr/DPHr RBW/RBW10-75

DBW10-75

PWA

RBAr/DBAr/DiaAr

ECG PWTT

SLP1/SLP2/SLP3 K/AmBE E/KTEMIU/KTEVAR/ENTROP WQR WRS HQR HRS PWTTRO PWTTRH

PWTTRP

B. Wang et al.
Short description Height of peak point P/DN/DP The ratio of DNH/DPH and PH Rising branch width and from 10%/25%/33%/50%/75% point of rising of branch to peak From peak to 10, 25, 33, 50, 75% point of descending points Area between pulse wave curve O-O and line OO Rising branch/Descending branch/Diastolic branch relative area Slope of line OP/PO /DP-O K and The mean value of P-E Frequency Domain Character The width of Q-R The width of R-S The Height of Q-R The Height of R-S The width of ECG-R to the onset off PPG The width of ECG-R to the 50% point of rising of PPG The width of ECG-R to the peak off PPG

Although the relevance of features to ABP could be manifestation by the Pearson correction, the correlation between different features still remained unknown. To avoid feature redundancy, referred to the research of He et al. [22], the correlation analysis was carried out between all the highest ranking features of systolic blood pressure (SBP) and diastolic blood pressure (DBP), which were signiﬁcantly correlated (|r| > 0.85). For each group of signiﬁcantly correlated features, only the one which has the highest score were selected.
Large number of features will lead to over-ﬁtting in small train sets, so the features we chosen is the balance between accuracy and over ﬁtting. Finally, 10 features are chosen to estimate DBP and SBP, respectively.

2.5 Regression Models
A series of machine learning algorithms can be used to represent such a relation in BP estimation. In this work, we selected 15 min data as the training set, which contains about 1000 pairs of feature vectors, while the rest 60 min were chosen as test set.

Continuous Blood Pressure Estimation Using PPG …

69

2.5.1 Linear Regression (LR)

LR is used to describe the linear relationship between the feature vector and the target variable. A gradient descent method is applied to search the minimum of cost function between the prediction and true values. Compared with other learning algorithms, LR is simple and easy to train. However, it is not applicable in the situation where features and target have a strong non-linear relationship [7].

2.5.2 Support Vector Regression (SVR)
SVR algorithm is a powerful technique based on statistical learning theory. The method is extremely robust and provides excellent generalization performance. There is only one category of the data in SVR and the optimal hyperplane is to make the sum of deviation in all samples can be minimized [23].

2.5.3 Artiﬁcial Neural Networks (ANN)
ANN is a powerful tool to realize a special non-linear transformation, from the input space to the output space. BP network is a kind of multilayer feed forward neural network. The error back propagation in weight updated process is the main character of BP.
Although the BP network has mature theory and wide application, it also suffers from speciﬁc problems, such as the node function, the number of hidden layers, the number of nodes per layer and the assignment of initial weight [24]. It is necessary to solve this problems and achieve optimal performance in BP network algorithm.
Genetic algorithm (GA) is an adaptive searching technique based on a selection and reproduction mechanism found in the natural evolution process. The purpose of using GA to optimize BP neural network is to get optimal weight and bias, which can avoid BP network trapping into local minima. Every individual in GA represents the initial weight and bias of BP and the ﬁtness of the individual is the error computed by the network initialized by weights. Though Genetic operator like selection, crossover and mutation, we can ﬁnd the most optimal weights of BP in train set [25].
For each models, a ﬁvefold separation of dataset samples to train and test sets is used. Unlike the traditional method, we separate the data into ﬁve parts, one is used to train and the rest four parts are used to test.

2.6 Models Evaluation
In order to compare the performance of different models in blood estimation, the root mean square error (RMSE) and the absolute error are used. The percent of set which reaches AAMI and BHS, the two main accuracy standards for blood pressure measuring devices, are also recorded for each model.

70
3 Results and Discussion

B. Wang et al.

The relationship between features and BP are analyzed by computing Person correlation. The features lies on the top ten in the rank of p value are shown in Fig. 6. The correction between those features are also analyzed, with all the value lower than 0.85, implying all ten features in the ﬁgure can be used to BP estimation. From the ﬁgure, it is evident that the features we used to estimate DBP and SBP are different, so we must build models for DBP and SBP respectively.
Table 2 compares the performance of various learning algorithms using the root mean square error. It is evident that the BP estimation using non-linear learning algorithm is much better than linear regression. Therefore, it can be inferred that

Fig. 6 Illustration of features extraction from data

Continuous Blood Pressure Estimation Using PPG …

71

Table 2 RMES (mean ± std.) in different learning models
SBP DBP

MODELS ANN 6.53 ± 2.21 3.17 ± 1.18

SVR 7.09 ± 1.80 3.98 ± 1.21

LR 14.67 ± 16.94 9.38 ± 17.33

Fig. 7 One exemplary continuous blood pressure estimation with ANN (blue square), SVR (red sphere) and LR (purple diamond) compared with real pressure in 60 cardiac cycle
there exists a considerable non linearity between features and BP. The result of ANN method optimized by Genetic algorithm is a little better than SVR method.
Figure 7 shows a comparison between different models. With the ﬁnger pressure as the benchmark, BP estimation with the ANN method is better than SVR and LR. Figure 8 presents histogram of estimation absolute error of different models in one of the dataset. It can be seen that error values are normally distributed around zero.

72

B. Wang et al.

Frequency

600 400 200
0 -20

-10

0

10

20

SBP Estimation Error (ANN)

Frequency

600 400 200
0 -20

-10

0

10

20

DBP Estimation Error (ANN)

Frequency

600 400 200
0 -20

-10

0

10

20

SBP Estimation error (SVR)

Frequency

600 400 200
0 -20

-10

0

10

20

DBP Estimation error (SVR)

Frequency

600 400 200
0 -20

-10

0

10

20

SBP Estimation error (LR)

Frequency

600 400 200
0 -20

Fig. 8 Histograms of absolute errors in different models

-10

0

10

20

DBP Estimation error (LR)

Table 3 Comparison with BHS standard

SBP

DBP

A

B

C

A

B

C

ANN

Num.

20

5

4

27

3

0

Per. (%) 67

17

13

90

10

0

SVR

Num.

19

4

4

25

3

1

Per. (%) 63

13

13

83

10

3

LR

Num.

16

5

3

23

4

1

Per. (%) 53

17

10

77

13

3

Table 3 demonstrates a comparison between different models in blood pressure estimation using British Hypertension Society (BHS) standard [26], based on the percentage of absolute error under three different thresholds. All the methods were also evaluated by Advancement of Medical Instrumentation (AAMI) standard [27], listed in Table 4. It should be noted that all the models are tested in only 30 groups of dataset, so the numbers and the percentage of the total, satisﬁed with the standard, are both presented. As seen in the table, the estimation of BP with ANN optimized by Genetic algorithm have a better performance than other algorithms.

Continuous Blood Pressure Estimation Using PPG …

Table 4 Comparison with AAMI standard

ANN SVR LR

SBP Num.
23 20 18

Per. (%) 76 67 60

DBP Num.
28 26 26

73
Per. (%) 93 86 86

4 Conclusions
In this paper, we explore the potential methods for cufﬂess continuous blood pressure estimation based on features extracted from electrocardiogram and photoplethysmogram using machine learning algorithms. All the data are collected from continuous blood pressure measuring instrument and physiological signal synchronous collecting device. 39 features are extracted form PPG and ECG signal; by correction analysis, 10 features are chosen to estimate DBP and SBP, respectively. The learning algorithms of Artiﬁcial Neural Networks, Support Vector Regression and Linear Regression are used to establish the real relationship between effective features and blood pressure. The results shows that the technique using ANN optimized by Genetic Algorithm performs better than the others, which could be potentially applied for continuous blood pressure estimation in the future.
Acknowledgements This work was supported by Special Fund for Scientiﬁc Research Cooperation of University Chinese Academy of Sciences.

References
1. World Health Statistics 2016 (2016) 2. Peter, L., Noury, N., Cerny, M.: A review of methods for non-invasive and continuous blood
pressure monitoring: pulse transit time method is promising? IRBM 35, 271–282 (2014) 3. Geddes, L.A., Voelz, M., James, S., Reiner, D.: Pulse arrival time as a method of obtaining
systolic and diastolic blood pressure indirectly. Med. Biol. Eng. Comput. 19, 671–672 (1981) 4. Isebree Moens, A.: Die Pulscurve 5. Yan, Y.S., Zhang, Y.T.: A model-based calibration method for noninvasive and cufﬂess mea-
surement of arterial blood pressure. In: Biomedical Circuits and Systems Conference, 2006, BioCAS, pp. 234–236 6. Allen, J.: Photoplethysmography and its application in clinical physiological measurement. Physiol. Meas. 28, R1–39 (2007) 7. Kachuee, M., Kiani, M.M., Mohammadzade, H., Shabany, M.: Cuff-Less Blood Pressure Estimation Algorithms for Continuous Health-Care Monitoring, pp. 1–1 (2016) 8. Kurylyak, Y., Lamonaca, F., Grimaldi, D.: A neural network-based method for continuous blood pressure estimation from a PPG signal. In: IEEE International Instrumentation and Measurement Technology Conference, pp. 280–283 9. Monte-Moreno, E.: Non-invasive estimate of blood glucose and blood pressure from a photoplethysmograph by means of machine learning techniques. Artif. Intell. Med. 53, 127–138 (2011)

74

B. Wang et al.

10. Ghosh, S., Banerjee, A., Ray, N., Wood, P.W., Boulanger, P., Padwal, R.: Continuous blood pressure prediction from pulse transit time using ECG and PPG signals. In: IEEE Healthcare Innovation Point-of-Care Technologies Conference, pp. 188–191
11. Su, P., Ding, X., Zhang, Y., Miao, F., Zhao, N.: Learning to Predict Blood Pressure with Deep Bidirectional LSTM Network (2017)
12. Imholz, B.P., Wieling, W., van Montfrans, G.A., Wesseling, K.H.: Fifteen years experience with ﬁnger arterial pressure monitoring: assessment of the technology. Cardiovasc. Res. 38, 605–616 (1998)
13. Singh, B.N., Tiwari, A.K.: Optimal selection of wavelet basis function applied to ECG signal denoising. Digit. Signal Process. 16, 275–287 (2006)
14. Dorlas, J.C., Nijboer, J.A.: Photo-electric plethysmography as a monitoring device in anaesthesia. Application and interpretation. Br. J. Anaesth. 57, 524–530 (1985)
15. Chua, E.C., Redmond, S.J., Mcdarby, G., Heneghan, C.: Towards using photo-plethysmogram amplitude to measure blood pressure during sleep. Ann. Biomed. Eng. 38, 945–954 (2010)
16. Wang, L., Pickwell-Macpherson, E., Liang, Y.P., Zhang, Y.T.: Noninvasive cardiac output estimation using a novel photoplethysmogram index. In: International Conference of the IEEE Engineering in Medicine & Biology Society, pp. 1746–1749
17. Takazawa, K., Tanaka, N., Fujita, M., Matsuoka, O., Saiki, T., Aikawa, M., Tamura, S., Ibukiyama, C.: Assesment of vasoactive agents and vascular aging by the second derivative of photoplethysmogram waveform. Hypertension 32, 365–370 (1998)
18. Millasseau, S.C., Kelly, R.P., Ritter, J.M., Chowienczyk, P.J.: Determination of age-related increases in large artery stiffness by digital pulse contour analysis. Clin. Sci. 103, 371 (2002)
19. Yang, H., Zhou, Q., Xiao, J.: Relationship between vascular elasticity and human pulse waveform based on FFT analysis of pulse waveform with different age. In: International Conference on Bioinformatics and Biomedical Engineering, pp. 1–4
20. Mahmoodabadi, S.Z., Ahmadian, A., Abolhasani, M.D., Eslami, M.: ECG feature extraction based on multiresolution wavelet transform. In: IEEE Engineering in Medicine & Biology Conference, pp. 3902–3905
21. Antonelli, L., Ohley, W., Khamlach, R.: Dicrotic notch detection using wavelet transform analysis. In: Engineering in Medicine and Biology Society, 1994. Engineering Advances: New Opportunities for Biomedical Engineers. Proceedings of the International Conference of the IEEE, vol. 1212, pp. 1216–1217
22. He, R., Huang, Z.P., Ji, L.Y., Wu, J.K.: Beat-to-beat ambulatory blood pressure estimation based on random forest. In: IEEE International Conference on Wearable and Implantable Body Sensor Networks, pp. 194–198
23. Chang, C.C., Lin, C.J.: LIBSVM: A library for Support Vector Machines. ACM (2011) 24. Peng, L.I., Liu, M., Zhang, X., Xiaohui, H.U., Pang, B., Yao, Z., Nhen, H.: Novel wavelet neural
network algorithm for continuous and noninvasive dynamic estimation of blood pressure from photoplethysmography. Sci. China Inf. Sci. 59, 1–10 (2016) 25. Goldberg, D.E.: Genetic Algorithm in Search, Optimization, and Machine Learning, vol. xiii, pp. 2104–2116 (1989) 26. O’brien, E., Petrie, J., Littler, W., Padﬁeld, P.L., O’Malley, K., Jamieson, M., Altman, D., Bland, M., Atkins, N.: The British Hypertension Society protocol for the evaluation of automated and semi-automated blood pressure measuring devices with special reference to ambulatory systems. J. Hypertens. 8, 607–619 (1990) 27. White, W.B., Berson, A.S., Robbins, C., Jamieson, M.J., Prisant, L.M., Roccella, E., Sheps, S.G.: National standard for measurement of resting and ambulatory blood pressures with automated sphygmomanometers. Hypertension 21, 504 (1993)

