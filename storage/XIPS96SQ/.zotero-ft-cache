ELECTRONICS WORLD・探索与观察

基于FastICA算法的脉搏波信号特征参数提取方法研究

重庆邮电大学光电信息感测与传输技术重庆市重点实验室 曲雷政 庞 宇 张亚华

【摘要】经过大量临床证实，脉搏波能反映许多心血管方面的生理信息，脉搏波特征变化可以反映出人体生理系统的状态。为了能够在脉搏 波信号中提取更多的生理参数，必须对脉搏波信号的各种特性进行深入的分析。利用光电容积脉搏波描记法(PPG)，人们只需要将手指轻微 的贴着摄像头就可以采集到手指图像，对图像进行独立成分分析(ICA)，找到最接近人体的脉搏波信号。这对基于智能终端分析脉搏波信号 的特征，进行呼吸、血压、心率测量的便捷性有很大的提高，为在家居环境下对人体生理参数的实时监测提供了一定的参考。 【关键词】光电脉搏波；独立成分分析；Android智能终端
Research on Feature Parameters Extraction of Pulse Wave Signal Based on FastICA Algorithm QU Leizheng，PANG Yu，ZHANG Yahua
Abstract：After a large number of clinical evidence，pulse wave can reﬂect a lot of cardiovascular physiological information，pulse wave characteristics can reﬂect the state of human physiological system.In order to extract more physiological parameters from the pulse wave signal，the characteristics of the pulse wave signal must be analyzed deeply.Using photoplethysmography(PPG)，people only need to stick the finger slightly to the camera to collect the finger image，and carry out independent component analysis(ICA)on the image to find the pulse wave signal closest to the human body. This provides a reference for real-time monitoring of human physiological parameters in the home environment. Key Words：PPG；ICA；Android intelligent terminal

0 引言
随着现代生活节奏的加快，人们的生活压力和社会压力越来越 高。各类疾病出现年轻化趋势，中国22%的中年人死于心脑血管疾 病；七成人有过劳死的危险；白领亚健康比例高达76%；慢性病患 病率已达20%，死亡数已占总死亡数的83%。中国一年用于心脑血 管疾病的治疗经费达到3000亿元。中国因疾病而导致生产力丧失， 在2005-2015年间给中国造成5500亿美元的经济损失[1]。因此，探究 其致病原因和提出有效预防、治疗的方法很重要。
随着智能手机的普及，通过使用手机检测人体生理参数，正逐 渐成为一种日常健康检测方式。目前，通过手机摄像头采集指尖图 像获取脉搏波(PPG)信号，利用手机的便携性、运算能力、光学传 感器，而不需要增加其他硬件就可以计算心率、HRV信号、呼吸等 生理参数。PPG信号中蕴含了与人体有关的生理、病理信息，能用 于心血管疾病的预防、诊断。脉搏信号易于采集已经成为移动医疗 设备的常用信号之一，利用手机检测这些信号使得人们在任何时间 地点都可以监控自己的健康状态。本文利用手机摄像头采集指端图 像，通过FastICA算法和信号分析，得到稳定的脉搏波信号，对之 后生理参数的计算提供准确性。
1 PPG信号提取原理
光电容积脉搏波（PPG）信号是利用光电技术在人体组织中监 测动脉血液容积变化的一种无创检测方法[2]。当波长为λ的单色光 照射在介质上时，透射光强I与发射光强两者之间的关系式如下：
(1) 其中ε(λ)表示吸收光强系数，ε(λ)越大则该物质对λ波长的吸 收能力越强；C表示介质的浓度一般为常数；L表示吸收介质的厚 度，即光程。心脏周期性的运动导致动脉中血流量随着搏动而变 化，因此检测光强度能实时的反映心脏搏动的状况。当心脏扩张 时，动脉血容量开始增加，吸收的光强度也增加，光接收端的光强

减少；当心脏收缩时，动脉血容量减少，吸收的光强也减小，光接 收端的光强增加[3]。将检测到的光信号转换为电信号就能获取PPG 信号。通过手机摄像头得到包含手指颜色变化的视频，采用数字 图像处理方法将其转换成数字信号，再对其进行盲源分离（ICA分 析）得到PPG信号；对 PPG信号进行筛选、滤波，并在此基础上开 发检测生理指标的软件产品。
图1 总体设计图
2 PPG信号的采集
本文采用盲源分离的方法对帧图像进行RGB基色分离，实现盲源 分离的方法有很多，我们采用最广泛的独立成分分析（ICA）[4]。因 此，我们采用ICA方法对其基色（RGB）分离后生成的三个原始观测 信号进行处理。实现ICA的算法也有很多种，这里采用FastICA算法 来实现信号的盲源分离。
脉搏波的波动会导致血液吸收光强度的不同，因此我们根据手 机摄像头采集的手指帧图像的分析，然后求得像素值的变化。由于 血液是红色的，对绿色光的吸收能力较强，因此绿色通道（G）的 变化最明显。利用手机摄像头采集手指颜色变化的视频，对视频的 帧图像进行基色分离，生成三通道图像，然后取各通道图像的像素 值的均值作为帧图像的在各个通道的特征值，对生成的数字信号进 行标准化，得到标准化的信号。对标准化信号进行独立信号分析后 得到的信号是无序的，无法直接选取信号，然后对信号进行相关性 筛选，通过与绿色通道（G）进行相关性分析，然后对选取的信号 进行滤波处理。

• 16 • 万方数据

ELECTRONICS WORLD・探索与观察

图2 基于ICA方法处理的原理图 3 PPG信号预处理

器的通带截止频率为5Hz，信号采样率为100Hz，该低通滤波器能 有效的消除高频干扰的影响（见图3）。 3.2 基线漂移的消除
相对于小波方法，形态学方法滤除基线噪声运算量小、精确度 高、速度快，更加适合在智能终端上使用，处理生理信号。基本的 数学形态变换包括腐蚀、膨胀、形态开和形态闭等运算。形态学滤 波器是利用开运算与闭运算结合达到滤除特定宽度的噪声信号，通 过使用开运算、闭运算分别消除信号的正负脉冲波的干扰。由形态 学开运算和闭运算能够组合先开后闭的形态学开闭滤波器和先闭后 开的形态学闭开滤波器。两种滤波器的表示如下。
(4) (5)

当我们用智能手机采集指端脉搏波信号的过程中，考虑到手指摆 放的位置和手指的运动等因素会造成采集到的信号有很多噪声，最常 见的噪声有高频噪声和基线漂移两种干扰。我们对其中的高频噪声和 基线漂移分别采用FIR数字低通滤波器和形态学滤波器来消除。 3.1 高频噪声的消除
实时PPG信号的检测过程中，在保证信号预处理准确性的同 时，需要提高实时性，在新的采样点即将到来时，要快速准确地对 前面采样点进行预处理，及时地识别准确的PPG信号十分必要，因 此本文选择线性的FIR数字滤波器。
FIR滤波器的单位冲激响应h(n)是有限长的，其基本结构可视 为一个非递归型的分节延时线，通过将每一节的值进行加权累加计 算后输出滤波器的最终结果。M阶FIR滤波器表达式如下式(2)，其 系统函数h(z)可表示为式(3)。
(2)

(3)

在有限Z平面中有(M-1)个零点，其(M-1)个极点均位于原点Z =

0处。用h(n)表示截取hd(n)后的冲激响应，即h(n)=ω(n)hd(n)，式子中

ω(n)为窗函数，长度为M。当

时，截取的一段h(n)与(N-

1) / 2对称，可保证所设计的滤波器具有线性相位。

图4 抑制基线漂移流程图

原始信号通过结构元素k先进行开闭(OC)运算，在进行闭开 (CO)运算，最后使用原始信号减去基线漂移信号，最终得到滤波后 的信号f，如式(6)。

(6) 手机采集图像的频率为20HZ，信号特征波的宽度大约为70个

点。结构元素k的宽度由PPG信号的采样频率和特征波形的时间宽

度t(约0.7s)所决定。用闭运算滤除因开运算加大的负脉冲，结构元

素宽度要大于脉冲宽度，需设计较大，设为

从而得到

PPG特征波形被滤除。

图5 去除基线漂移前后的PPG信号波形图

4 实验结果分析

图3 低通滤波前后的PPG信号波形图 由于PPG信号频率集中在5Hz以内，而高频噪声频率远高于10Hz，为 了保证在各种情况下都可以有效滤除高频噪声，本文设计低通滤波
万方数据

PPG信号具有一定的周期性，每个时间周期具有细微的变化， 可视为一种逼近的周期信号。针对实际采集的PPG信号，峰值有时 会出现变化平缓，同时峰值周围波动大，因此采用动态差分阈值法 可以有效的检测波谷[5]。
（下转第20页）
• 17 •

ELECTRONICS WORLD・探索与观察

额定电压为380V，额定电流44.4A，额定转速为1500r/min。按照三 相异步电机空载实验的步骤，接通电源，可在上位机LabVIEW中 实时各项参数及波形，三相异步电机空载实验的各项参数如图11所 示。由于电压、电流互感器存在电能损耗，所测电压、电流值精确 度不够，达到额定电压380V，实时电流36A。转矩-转速特性曲线 如上位机所示。
图10 电机性能参数测量装置
图11 三相异步电机各项参数

5 结束语
运用传感器对三相异步电动机基本运行参数测量，基于STC15 单片机对数据处理与分析，并通过全双工串行通信，在LabVIEW 上位机上实时显示出三相异步电机的特性参数及转矩-转速特性曲 线。该装置具有良好稳定性、快速性和安全性，能够满足实验、科 研和教学中的基本要求，并为今后研究出更全面复杂的电机测量装 置提供了坚实的基础。
参考文献 [1]杨红权,易长松,吴希再.数字式异步电机转矩转速测量装置的 研制[J].水电能源科学,2009(2):191-193. [2]何志伟,蒋豪贤,陈学辉.微型电动机起动转矩的微机测量装置[J]. 华南理工大学学报:自然科学版,1995(2). [3]刘明.嵌入式单片机技术与实践[M].北京:清华大学出版社,2010. [4]郁有文,常建.传感器原理及工程应用[M].西安:西安电子科技 大学出版社,2000. [5]赵宏杰.基于STC15F2K系列单片机串口通信控制的研究[J].电 子科学技术,2017(4):116-119. [6]徐伟专,陈洪亮,黄河.一种免扭矩仪的电动机轴功率实时测量 方法[J].风机技术,2014(S1):41-44. [7]凌晓杰,朱大卫,杨广亮,等.开口式霍尔电流传感器在工厂改造 配电系统中的应用[J].自动化博览,2015(12):110-111. [8]胡家华,徐鹏,郑昌雨,等.PL2303单片机串口转USB口实现串行 通信[J].单片机与嵌入式系统应用,2013(4):76-77.
作者简介： 翟相如（1994-），新疆塔城人，大学本科，现就读于新疆大学。 通讯作者：何山。

（上接第17页） 图6 波峰波谷的识别图

• 20 • 万方数据

图7 智能采集的脉搏波信号

5 结束语
本文利用智能手机摄像头采集PPG信号，通过一系列的处理得 到稳定的脉搏波信号。随着智能手机摄像头的发展，采集的精度会 越来越高，采集数据时间也会大大缩短，这对以后使用手机检测 检测呼吸、血氧、血压成为可能，人们可以随时知道自己的健康状 况，方便以后对老年人者进行远程医疗监测和服务。
参考文献 [1]胡琦.《中国人健康大数据》出炉 数据显示:每年因过劳死亡 的人数达60万年轻白领巨多[J].吉林医学信息,2015(1):18-19. [2]Dainis Jakovels,Uldis Rubins,Janis Spigulis.RGB Imaging System for  Mapping  and  Monitoring of Hemoglobin Distribution in Skin[J]. Proc.of SPIE Vol.8158.2012.45. [3]Liebman F M,Pearl  J,Bagno S.The electrical  conductance  properties  of   blood  in motion[J].Physics in medicine and biology,1962,7(2):177. [4]徐丽琴.典型ICA算法在盲源分离中的实现[J].科技信息,2010(26): 123-124. [5]张爱华,王平,丑永新.基于动态差分阈值的脉搏信号峰值检测 算法[J].吉林大学学报:工学版,2014,44(3):847-853.
作者简介： 曲雷政（1991-），男，硕士研究生，现就读于重庆邮电大 学，主要研究方向为生命体征信号的采集与处理，智慧医疗节点的 研制。

