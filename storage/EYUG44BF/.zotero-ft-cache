A Method for Detection of Atrial Fibrillation Using RR Intervals
K Tateno, L Glass
Department of Physiology and Centre for Nonlinear Dynamics, McGill University Montreal, Quebec, Canada

Abstract
This work describes a method for automatic detection of atrial fibrillation (AF) based on RR intervals. We define ARR to be the difference between successive RR intervals. The standard density histograms of RR and ARR intervals are determined from data in the MIT-BIH atrial fibrillatiodflutter database. The present method estimates the similarity between the standard density histograms and a test density histogram by the Kolmogorov-Smirnov( K S ) test. The algorithm returns significance ( p ) of difference between given histograms. I f the p value is smaller than
a value (Pc), the test density histogram is significantly diflerentfrom the standard density histogram. I f the test density histogram is not significantly differentfrom the
standard density histogram, we say the data is AF: Using
the standard density histogram of ARR with Pc = 0.01, the average sensitivity is 93.2% and the average specificity
is 96.7%.
1. Introduction
It is difficult to detect AF based solely on the RR intervals as recorded for example by a portable monitor [1, 2,3,41.
Several different methods for detection of AF based on RR intervals have been reported [5, 6 , 7, 8, 91. Moody and Mark [8] classify RR intervals as short, long or regular. They then construct a Markov model for the probabilities for transitions between RR intervals in each of the three different length classes. AF data has typical transition probabilities not shared by normal rhythms or other arrhythmias. Pinciroli and Castelli have investigated the morphology of histograms of RR intervals collected during atrial fibrillation and other arrhythmias [3]. They show that the histograms of the ratio between successive RR intervals show characteristic differences between
normal rhythm and AF,but do,not develop quantitative
tests for AF.
Various statistical properties of AF have been analyzed
in the past. The coefficient of variation (CV) of RR intervals is -0.23 during AF [lo]. Further, the density histogram of RR intervals during AF is skewed right [111.

Pinciroli and Castelli have also reported that a histogram of the ratio between successive RR intervals is symmetrical to the mean value [3]. Their report indicates that density histograms based on RR intervals during other arrhythmias
than AF, differ from those collected during AF,and can
therefore be used to detect AF. However, they do not provide a quantitative algorithm.
We define ARR to be the difference between successive RR intervals. Here we present a preliminary report of
a method for AF detection based on determination of
standard density histograms of RR and ARR intervals. These histograms are used as a template for detection of AF and the differences between the standard histograms and a test sample are quantitatively evaluated.

2. Methods
Figure 1 shows a typical time series of RR intervals from a patient with paroxysmal AF. When AF occurs this marker line is set to AF; otherwise it is set to N, which signifies a rhythm that is not AF (non-AF). Paroxysmal AF is often interrupted by another arrhythmia or normal sinus rhythm.
1.5

- 1.0
w $
._ 0.5

AF

N

0

500 1000 1500 2000 2500 3000

Beats

Figure 1. Time series showing the RR intervals from

subject 04043 from the MIT-BIH atrial fibrillation/flutter

database. The solid line directly under the time series of
RR intervals shows the assessment of AF as reported in the

database.

Data was obtained from the MIT-BIH atrial fibrillation/ flutter database

0276-6547100$10.00 0 2000 lEEE

391

Computers in Cardiology 2000;27:391-394.

(http://www.physionet.org/physiobank/database/afdb). The data contains 300 AF episodes, sampled at 250 Hz for 10 hours from Holter tapes of 25 subjects. During AF, we consider blocks of 100 successive beats. The mean value of RR intervals in each 100 beats block is determined. The mean value identifies the set of 100 beats as falling into one of 9 different classes, corresponding to mean values between 300-399ms, 400-499ms, 500-599ms, etc. For each class, a density histogram of RR and ARR is compiled by lumping data together from all patients. The resulting density histograms are taken to be the standard density histograms for AF, sorted by the mean RR interval.
In order to test for AF in a test record, we consider the 100 beat segment centered on each beat in the record. For each beat we determine the density histograms of RR and ARR and compare these with the standard density histograms. Similarity of the given density histograms was evaluated using the Kolmogorov-Smimov (KS) test [121. In the KS test, one assesses if two given distributions are different from each other. This test returns a p value. If the p value is greater than certain value, P,, then we say that the distributions are not significantly different from one another. In the current case, since the standard density
histograms represent AF,a value of p > P, is associated
with a positive identification of AF (or more accurately failure to reject the hypothesis that the test distribution is not AF). We assumed Pc = 0.01 throughout the present work.
For each beat, the identificationof AF in the test record is compared with the documented rhythm in the data base and can be classified in one of four categories [13]:
true positive (TP) - AF is classified as AF; true negative (TN) - non-AF is classified as non-AF; false negative (â‚¬3) - AF is classified as non-AF; false positive (Fp)non-AF is classified as AF. Sensitivity and specificity are
defined by TP/(TP+FN) and TN/(TN+Fp), respectively. The predictive value of a positive test (PV+) and the predictive value of a negative test (PV-) are defined by TP/(TP+FP) and TN/(TN+FN), respectively.
3. Results
Figure 2 shows an example of the result of the KS test based on the standard density histograms of RR and ARR. AF often shows paroxysmal stopping and starting. Using the standard density histograms based on the RR intervals, there are many false negative leading to a low sensitivity. The long stretch of AF extending from beats -1400 to -2000 is not detected using the histograms based on the RR intervals. The assessment based on ARR functions is much better. However, since the assessment is based on histograms collected over 100 beats, AF is not accurately detected at the time of transitions between AF and sinus

rhythm, and for AF of short duration. We first applied the KS test to the MIT-BIH atrial
fibrillation/flutter database that was used to construct the standard histograms. Using the standard density histogram of RR intervals, we find the sensitivity is 53.9%, and
the specificity is 98.9%. A decrease in P, increases
the sensitivity, while it decreases the specificity. The assessment of AF based on ARR works much better. From the total number of beats assessed in table 1, the sensitivity is 93.2%, and the specificity is 96.7%. The PV+ and PV-
are both 95.2% .

Table 1. Beat by beat assessment of AF based on

ARR using data in the MIT-BIH atrial fibrillation/flutter

database Subjects TP

TN FN FP

00735

313 39849 19

0

03665 10667 41501 390 155

04015 444 40542 81 2886

04043 10520 47156 41 14 73

04048

503 39007 3 10 62

04126 2789 38335 504 1180

04746 30660 16945 213

3

04908 5482 55452 328 446

04936 32828 13330 6853 583

0509 1

56 35117 1525 43

05121 28004 15504 1765 4556

05261

695 44319 239 229

06426 52603 1352 48 1 667

06453 243 34322 202 18

06995 26505 25298 969 2365

07162 36546

0

2700 0

07859 48436

0

11797 0

07879 39833 16468 202 39

07910 6597 29826 123

1

08215 32999 10224 81

0

08219 13814 4295 1 380 2096

08378 1760 35377 195 8131

08405 44350 13727 695 32

08434 2283 37386 27

102

08455 43991 15286 223

0

total 472921 689274 34416 23667

We further applied the KS test to another database which was not used to construct the standard density histograms. The AF database was obtained from 200 series (subjects 201, 202, 203, 210, 217, 219, 221, and 222) of the MIT-
BIH arrhythmia database
(http://www.physionet.org/physiobank/database/mitdb). Using the standard density histogram of RR intervals, we find the sensitivity is 25.996, and the specificity is 93.2%. The many false negatives lead to low sensitivity. Using the standard density histograms of ARR, the sensitivity is

392

AF N

1-
0

MI

uuu nn n ni

U
nn nn-mvu

0

500 1000 1500 2000 2500 3000

Beats

Figure 2. The KS test for subject 04043 of the MIT-BIH atrial fibrillatiodflutter database. Time series showing the RR intervals from subject 04043 from the MIT-BM atrial fibrillatiodflutter database. The solid line directly under the time
series of RR intervals shows the assessment of AF as reported in the database. The solid line under that represents the
assessment of AF, indicated by 1, and non-AF, indicated by 0, based on the density histogram of RR intervals. The solid line at the bottom of the figure shows the assessment of AF, indicated by 1, and non-AF, indicated by 0, based on ARR.

ae 1.5
a,
c.
.G 1.0
[r
IT 0.5

....... . .. .

10

MI

0

500

1000

1500

2000

Beats

Figure 3. The KS test for subject 217 of the MIT-BM arrhythmia database. The three solid lines underneath the data have the same meanings as in figure 2.

88.8%, and the specificity is 64.1% (from table 2). In this case, a relatively large number of false positive leads to low specificity.

4. Discussion

The current paper presents results on determination

of AF by comparing

with standard density

histograms based on RR and

When the analysis

is carried out using the RR intervals density histograms there were many false negatives leading to a low sensitivity and a low PV-. In contrast, The assessment based on
the standard density histograms of ARR is more accurate
for most subjects. However, subjects 05091 and 06453 have many false negatives. In subject 06453 the AF is frequently of short duration. Since the current method
is based on sequences of 100 beats, AF of short duration
is not well detected. This deficiency might be corrected

393

Subjects TP

201

840

202

719

203

1659

210

2461

217

246

219

1695

22 1

1878

222

786

11II
total 10284

TN 411 1130 194
0 1713 226
7 800 4481

FN 31 171 380 79 92 55 427 66 1301

FP 629 64 691 58 105 126 63 779 2515

by constructing test histograms based on fewer than 100 beats. Further work is needed to determine the optimal number of beats for AF detection.
Figure 3 illustrates the problems involved with detecting AF with short duration using the current method. When AF of short duration occurs, this leads to both false negatives and false positives (around beats 957 to 1358). The false positives lead to a low specificity. Although this lowers the quantitative evaluation of the algorithm, the method does adequately show that the predominant rhythm from beats 957 to 1358 is AF.
In some of the records, our analysis leads us to question the assessment in the database. For, example, subject 203 is an example of a atrial flutter-atrial fibrillation patient with frequent transitions between the two rhythms. However, the irregular ventricular response combined with the variability of morphology of the atrial waves, leads us to conclude that some of the atrial identifications in this patient may be more appropriately classified as a coarse AF. Thus, the AF detection algorithm here may be helpful in reexamination of the rhythm identification in the MITBIH database.
In the present work, we assume P, = 0.01. A decrease in P, improves the sensitivity and an increase in P, improves the specificity. Depending on the particular usage, other values of P, might be optimal.
Acknowledgements
This work has been partially supported by the MITACS, National Center of Excellence funded by Natural Sciences and Engineering Research Council of Canada, the Medical Research Council (Canada) and the National Center for Research Resources of the National Institutes of Health (P41 RR13622) (USA). We thank George Moody, Rahul Mehra, and David Ritscher for helpful conversations.

References
[l] Andresen D, Briiggemann T. Heart rate variability preceding onset of atrial fibrillation. Joumal of Cardiovascular Electrophysiology Supplement 1998; 9:S26-S29.
[2] Murgatroyd F, Xie B, Copie X, Blankoff I, Camm A, Malik M. Identification of atrial fibrillation episodes in ambulatory electrocardiographic recordings: validation of a method for obtaining labeled R-R interval files. Pacing and Clinical Electrophysiology 1995;18:1315-1 320.
[3] Pinciroli F, Castelli A. Pre-clinical experimentation of a quantitative synthesis of the local variability in the original R-R interval sequence in the presence of arrhytha. Automedica 1986;6:295-3 17.
[4] Slocum J, Sahakian A, Swiryn S. Computer detection of atrial fibrillation on the surface electrocardiogram. Computersin Cardiology 1987;253-254.
[5] Artis S, Mark R, Moody G. Detection of atrial fibrillation using atrial neural networks. Computers in Cardiology 1992;173-1 76.
[6] Gersch W, Eddy D, Dong Jr E. Cardiac arrhythmia classification: a heart-beat interval-Markovchain approach. Computers and Biomedical Research 1970;4:385-392.
[7] Hnatkova K, Murgatroyd F, Guo X, Camm A, Malik M. Atrial premature beats preceding episodes of paroxysmal atrial fibrillation: factorial analysis of a prediction system. Pacing and Clinical Electrophysiology 1997;20:20032007.
[8] Moody G, Mark R. A new method for detecting atrial fibrillation using R-R intervals. Computers in Cardiology 1983;227-230.
[9] Pinciroli F, Rossi R, Valenza P. PAFHPI: self-monitoring
of paroxysmal atrial fibrillation episodes in ambulatory
patients. Computers in Cardiology 1993;503-506. [IO] Meijler F, Wittkampf E Role of the atrioventricular
node in atrial fibrillation. In Falk R, Podrid P (eds.), Atrial Fibrillation: Mechanisms and Management, 2nd. Philadelphia: Loppincott-Raven Pulishers, 1997; 109-13 1. [111 Goldstein R, Barnett G. A statistical study of the ventricular irregularity of atrial fibrillation. Computersand Biomedical Research 1967;1:146-161. [12] Press W, Teukolsky S, Vetterling W, Flannery B (eds.). Numerical recipes in C: The art of scientific computing. Cambride University Press, 1992. [13] Hulley S, Cumming S (eds.). Designing clinical research. Williams & Wilkins, 1988.
Address for correspondence:
Leon Glass Dept. of Physiology and Centre for Nonlinear Dynamics, McGill University 3655 Drummond Street,Montreal, Quebec, Canada tel.: +1-514-398-4338,fax: +1-514-398-7452 glass@cnd.mcgill.ca

394

