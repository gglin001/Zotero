刘明等:基于 RR 间期差的深神经网络房颤检测

90

《 激光杂志》2015 年第 36 卷第 1 期

LASER JOURNAL( Vol. 36. No. 1. 2015)

基于 RR 间期差的深神经网络房颤检测
刘 明,万慧华,龚硕然,韩小岑
( 河北大学 电子信息工程学院,河北 保定 071002)
摘 要:提出了基于 RR 间期差的深神经网络房颤检测的方法。 先由心电信号的 RR 间期序列求得 RR 间 期差序列,然后将 RR 间期差转换为直方图序列。 将直方图作为房颤信号的输入数据,采用深神经网络来进行 房颤的检测。 通过由 MIT-BIH 房颤数据库来评价本方法检测房颤的准确率,数据库包括一个训练集和一个测 试集。 实验结果表明本方法可正确检测 95. 1% 的测试集,具有心电信号检测房颤的能力。
关键词:房颤;检测;深神经网络;RR 间期差 中图分类号:TN911, R318 文献标识码:A DOI 编码:10. 14016 / j. cnki. jgzz. 2015. 01. 090
detection of atrial fibrillation base on deep neural network of RR interval difference
LIU Ming, WAN Hui-hua, GONG Shuo-ran, HAN Xiao-qin
( College of Electronic and Information al Engineering, Hebei University, Baoding Hebei 071002,China)
Abstract:A method is proposed to detection of atrial fibrillation ( AF) based on deep neural network of difference of RR interval. Firstly,the difference sequence of RR interval is obtained based on RR interval sequence of the Electrocardiograph ( ECG) . Then the difference sequence of RR interval is transformed into histogram sequence. The histogram AF signal sequence as input data, using deep neural network to detect atrial fibrillation. The database that MIT -BIH AF signals is studied to evaluate the accuracy of the method for AF detection. It includes a training data set and a test datasets. Experiment results demonstrate that the proposed method can detection the test data set with 95. 1% correctness. Therefore the proposed method has the ability to detect of AF based on the signals.
Key words:atrial fibrillation; detection; deep neural networks; RR interval difference

心房颤动( Atrial fibrillation, AF) 简称房颤,是临 床最常见的一种心律失常疾病,其特点是紊乱的心房 活动和随之而来的脑卒、心肌梗死等并发症,导致较 高的致残 率 和 死 亡 率, 严 重 危 害 着 人 类 的 健 康 和 生 命[1] 。 研究房颤检测的算法,能及早发现并进行治 疗,从而可更多的抓住治疗的最佳时机,减少房颤的 发病 率 和 死 亡 率, 因 此 具 有 重 要 的 临 床 和 社 会 意义[2] 。
本文采用心电信号 RR 间期差来进行房颤的检 测,通常来说 RR 间期在时间上不是固定的,随着人 体生理状态的变化而波动。 在房颤时表现为 RR 间 期绝对不 规 则, 这 是 房 颤 发 生 时 的 一 重 要 心 电 图 特 征。 基于 RR 间期特征的房颤检测算法有许多,其涉 及的分析方法有变异性分析、统计模型、预测模型、复
收稿日期:2014 -11 -11 基金项目:国家自然科学基金:60903089;河北大学博士项目:Y2009157。 作者简介:刘明(1972-) ,男,汉,副教授,主要从事模式识别与图像处 理方面研究。

杂度估计、熵估计等。 Tateno K. 等分别提取 RR 间期 和 RR 间期差分值的准密度直方图[3] 然后采用柯尔 莫哥洛夫史密诺夫检验评估待测密度直方图与直方 图的差异度,若差异度小于一定阈值,则认为该段数 据对应的时间段为房颤段。 在 MIT-BIH 房颤数据库 测试,灵敏度达到了 94. 4% ,特异性达到了 97. 2% 。 Couceiro R. 等基于模型统计和频域分析方法提取出 P 波消失、心律不规则、心房活动等心电特征[4] ,并采用 三层前馈神经网络对提取特征进行学习训练,经 MIT -BIH 房颤数据库验证,其灵敏度为 93. 8% ,特异性为 96. 1% 。 陈煜 等 人 通 过 分 析 阵 发 性 房 颤 的 生 理 特 点[5] ,结合小波分解与非线性分析方法,将小波熵作 为心率变异分析的主要手段来研究这种疾病发生过 程中心率变异性( heart rate variability,HRV) 信号的特 征,进一步获得相应信号动态过程潜在的有用信息, 使用支持 向 量 机 进 行 分 类, 旨 在 完 成 对 阵 发 性 房 颤 ( paroxysmal atrial fibrillation, PAF) 信号和远离 PAF 信号的识别。 其分类灵敏度平均为 86. 16% ,特异性

刘明等:基于 RR 间期差的深神经网络房颤检测

《 激光杂志》2015 年第 36 卷第 1 期

LASER JOURNAL( Vol. 36. No. 1. 2015)

91

平均为 89. 68% 。 如前所述,国内外学者对房颤检测方法进行了广
泛和深入的研究,提出了很多基于 RR 间期特征的方 法。 但是房颤检测仍然不够准确,究其原因:特征提 取方法还没有解决好,由于心电信号复杂多变,且受 到多种噪声干扰,现有统计方法和一般的模式识别方 法效果较差。 基于上述分析,本文将深度神经网络引 入到房颤检测中,通过深度学习解决特征提取问题, 首先对由房颤信号的 RR 间期序列求得 RR 间期差序 列,然后将 RR 间期差转换为直方图序列。 将直方图 作为房颤信号的输入数据,采用深神经网络来进行房 颤的检测。
1方法
RR 间期数据缺乏定位标志,所以在截取数据片 段时可能发生比较大的偏移。 对于深度置信网络中 每个神经元对应的数据样本不断变化,难以从训练集 中学到稳定的统计特征,降低深神经网络的性能。 为 了克服这一问题,可从 RR 间期数据中提取差分直方 图( 对信号进行差分运算后再计算直方图) ,作为深度 置信网的输入。
1. 1 RR 间期差直方图 本文从 RR 间期随时间的变化规律入手,进行房
颤检测的研究,房颤时,RR 间期表现出无规律的特 性,如图 1 所示,其中中间部分是房颤,两侧为正常。
图 1 RR 间期变化图
本文采用的是 RR 间期差的直方图,直方图技术 是一种统计报告图,由一系列高度不等的纵向条纹或 线段表示数据分布的情况, 一般用横轴表示数据类 型,纵轴表示分布情况。 因而,可通过分析 RR 间期 差直方图的分布情况来检测房颤。 本文选取的是 RR 间期差数据而不是 RR 间期数据,其原因是:在实际 心电信号中,RR 间期的分布一般相对集中,因而其直 方图表现往往趋于集中,不够稳定,而 RR 间期差去 除了这一变化趋势,其直方图更加稳定。
经过下面的操作可以得到 RR 间期差直方图。 1) 首先得到 RR 间期的差序列 ΔRR ΔRR( n)= abs (RR (n+1 ) -RR( n) ) ,n = 1,…N-1
(1) 式中:RR( n) 为从第 n 个心电信号周期和第 n+1 个心电信号周期的 RR 间期,N 为 RR 间期的总数。

2) HΔRR 为 RR 间期差的直方图

∑∑ HΔRR(i) =

M i=1

N j=1

sgn

æ
ç

è

éëêê

( ΔRRj - ΔRRmin ) × ΔRRmax - ΔRRmin

M ùûçç

=

=

i

ö
÷

ø

(2)

其中,HΔRR 为直方图数组,i 表示直方图的横坐

标的数,其最大值为 M,ΔRRmin、ΔRRmax 分别为 ΔRR 间 期的最大、最小值,取定值;M 为直方图宽度,取定值;

N 为 ΔRR 间期序列长度,取定值;sgn 为符号函数,当

n>0 时输出 1,n<0 时输出-1,n = 0 时输出 0;“[ ]” 为

取整符号,即表示不超过符号内数值的最大整数,采

用的直方图参数为:ΔRRmax = 1200 ms,ΔRRmin = -1200 ms,M = 127,N = 127。

1. 2 深置信网络 在房颤识别中,特征提取是核心,由于心电信号
复杂多变,且受到多种噪声干扰,现有房颤检测难以 提取稳定、能有效判别房颤的特征,因此将深神经网 络引入本课题,深神经网络是特征提取和识别相结合 的方法,通过对大量的数据进行学习,来自动的提取 特征进行识别。 本文选取深度置信网[6] ( deep belief networks,简称 DBNs) 来进行研究,它是一个概率生成 模型,与传统的判别模型的神经网络相对,生成模型 是建立一个观测数据和标签之间的联合分布。
DBNs 由多 个 限 制 玻 尔 兹 曼 机 ( Restricted Boltzmann Machines, RBM) 层组成,RBM 是一种可用随机 神经网络来解释的概率图模型,具有强大的无监督学 习能力,能够学习数据中的复杂规则,且有快速学习 的优点,其结构图 2 如下。 该网络被“限制”为一个可 视层和一个隐层,层间存在连接,但层内的单元间不 存在连接。 隐层单元被训练去捕捉在可视层表现出 来的高阶数据的相关性。

图 2 RBM 模块
限制玻尔兹曼机可被视为一个无向图( Undirected graph) 模型,如图 2 所示,其中 h 为隐含层,可视为 特征提取器,w 为连接矩阵,v 为可见层。 假设每个节 点取值都在集合{0,1} 中,即坌i,j,vi ∈{0,1},hj ∈ {0,1} ,对于一组给定的状态( v,h) ,限制玻尔兹曼机 作为一个系统所具备的能量定义为

刘明等:基于 RR 间期差的深神经网络房颤检测

92

《 激光杂志》2015 年第 36 卷第 1 期

LASER JOURNAL( Vol. 36. No. 1. 2015)

n

m

nm

∑ ∑ ∑∑ E( v,h θ) = - aivi - bjhj -

vi Wij hj

i=1

j=1

i=1 j=1

(3)

其中 θ = { ai ,bj,Wij} 是 RBM 模型的参数,均为实 数,ai 表示可见节点 i 的偏置,bj 表示隐含层节点 j 的 偏置,Wij为可见节点 i 与隐含层节点 j 之间的连接矩 阵。 当参数确定时,基于该能量函数,我们可以得到

( v,h) 的联合概率分布

∑ P( v,h

θ)

=

e

-E( v,h| θ)
Z( θ)

,

Z( θ)

=-

e -E(v,h| θ)
v,h

(4)

其中 Z(θ)为归一化因子(也称为配分函数)。 我

们假设限制玻尔兹曼机处于常温(T = 1),故在上式中

省略了温度变量 T。

基于以上的定义,我们可以很容易算出,给定某

层单元状态时,另一层单元状态的条件分布:

∑ P( hj = 1 v,θ) = σ (bj + vjWij ) , j

∑ P( vi = 1 h,θ) = σ (ai + ) hjWij

(5)

j

其中,σ( ·) 为 sigmoid 激活函数,定义为 σ( x)

= 1 / (1+exp ( - x) ) 。 由于在 RBM 中,同层单元之间

互不相连,因此,给定某层单元状态时,另一层单元之

间的状态条件分布相互独立,即:

m

n

P(h v) = ∏P(hj v), P(v h) = ∏P(vi h)

j=1

i=1

(6)

利用对 数 似 然 概 率 logP ( v; θ ) 梯 度 可 推 导 出

RBM 的各参数的更新准则:

ΔWij = E ( data vi hj ) -E ( model vi hj )

Δai = Edata( vi ) -E ( model vi )

Δbj = E ( data i hj ) -E ( model hj )

(7)

其中:Edata( ·) 是在观测数据训练集中的期望,

Emodel( ·) 是模型中定义的期望。 精心训练 RBM 对

成功应 用 深 度 学 习 是 一 个 关 键, 文 献[7] 提 供 了 对

RBM 实际训练的指导。

通过自 底 向 上 组 合 多 个 RBM 可 以 构 建 一 个

DBN,如图 3 所示。 根据贪婪学习的思想,对 DBN 的

每一层进行无监督学习,最后对整个网络用监督学习

来进行微调,其方法就是:根据无监督学习来调节网

络参数,使得 RBM 达到能量平衡,得第一层的输出,

把第一层的输出作为第二层的输入,依次下去,直到

最后一层,完成无监督学习后然后再以原是外界输入

和目标输出对整个网络采用有监督学习,以最大似然

函数为目标调节各层参数,使达到网络最优,在最顶

层放置分类器,进行特征提取后再进行分类,本文使 用的分类器是 softmax。

图 3 DBN 模块

3 实验结果

本文用 MIT-BIH 房颤数据库来验证本文提出的 算法 检 测 房 颤 的 性 能。 对 房 颤 的 检 测, 用 灵 敏 度 (SE) 、特异性( SP) 两个参数来评价提出算法的性能。 本文中 RR 间期由采样点的数目表示,因为心电信号 是由 128Hz 采样的,所以 RR 间期的单位是 1 / 128s。
本文将所有数据分为 2 组:房颤数据和正常数 据,其中训练集房颤和正常各是 3000,测试集房颤和 正常各是 2000。 首先对数据进行预处理,最终得到 RR 间期差的直方图,在传统的方法中,进行 RR 间期 差的计算时采用的是相减,但是 RR 间期表示的是时 间的长短和正负无关,因此本文在此计算时加入绝对 值这一步骤,通过实验结果可知,加绝对值之后其正 确率可提高 3% 。 然后采用深度置信网来进行房颤的 自动检测。
表 1 列举了本论文算法与已有研究在 MIT -BIH 房颤数据库的房颤检测验证结果,从中可看到,本论 文提出的算法在灵敏度和特异性方面均获得了最高 的准确率。
表 1 MIT-BIH 房颤数据库准确率对比

方法

灵敏度 SE( % ) 特异性 SP( % )

本论文算法 Babaeizadeh S 等[8]
Dash S. 等[9] TatenoK. 等[3] CoUCeiro R. 等[4] GhodratiA. 等[10] KikillusN. 等[11]

95. 1 92 94. 4 94. 4 93. 8 86 94. 1

97. 3 97 95. 1 97. 2 96. 1 90 93. 4

4结论
房颤是临 床 最 常 见 的 心 律 失 常 之 一, 患 病 率 在

刘明等:基于 RR 间期差的深神经网络房颤检测

《 激光杂志》2015 年第 36 卷第 1 期

LASER JOURNAL( Vol. 36. No. 1. 2015)

93

0. 4% 至 1% ,且随着年龄增长患病率逐渐升高[12,13] , 在>80 岁人群中甚至高达 8% [14] 。 而发病率也与患 病率类似,随着年龄增长有显著的升高[15] 。 因此,房 颤的及早发现和辅助诊断研究,对改善病人的治疗对 策和提高治疗质量,减少病人危重病症发生率和死亡 率等有重要的临床和社会意义。 Dash S. 等提出了一 种实时的房颤自动检测算法[9] ,该方法采用了三种不 同的统计学方法分别对 RR 间期的变异性、随机性以 及复杂性等特征进行评估。 在 MIT-BIH 房颤数据库 的准 确 性 验 证 中 获 得 了 较 好 的 结 果: 灵 敏 度 为 94. 4% ,特异性为 95. 1% 。 Babaeizadeh S. 等 先 采 用 马尔可夫过程模型计算 RR 马尔可夫分数[8] ,用以表 征房颤段与非房颤段的 RR 间期序列差异,经 MIT BIH 心律失常数据库测试,其灵敏度为 92% ,特异性 为 97% 。 和上面几种方法相比,本研究采用 RR 间期 差来作为输入数据,然后使用深度置信网进行房颤的 自动检测,其准确率有所提升,这为发展更多的房颤 自动检测的工具提供了新思路。
本文基于 RR 间期差来检测房颤。 RR 间期由表 面 ECG 信号得到,而表面 ECG 信号是非侵入性的并 容易得到。 RR 间期反映了许多相互制约的因素如交 感神经、迷走神经、激素等对心脏持续而精细调节的 复杂过程,并且这些因素是互相影响的。 在房颤未发 生时,RR 间期在生理条件变化时是有规律的,其通过 RR 间期差表现为:一条围绕“0” 值微小变化的曲线。 但在房颤时 RR 间期出现紊乱,RR 间期差表现为围 绕“0” 值上下的剧烈变化。 通过 RR 间期差的直方图 能很直观地看出这一变化,因此本文选取 RR 间期差 作为输入数据。 由于心电信号复杂多变,且受到多种 噪声干扰,现有房颤检测难以提取稳定、能有效判别 房颤的特征,甚至有时医生进行诊断时也无法判断, 因此本文选取深度置信网,特征提取和分类融合的方 法,通过对大量数据进行学习,实现房颤的自动检测。
本文结果和其他方法比较有更高的性能,说明本 方法具有心电信号自动检测房颤的能力。
参考文献
[1] Bohnen M. , et al. . Quality of life with atrial fibrillation: do the spouses suffer as much as the patients? [ J] . Pacing Cl in Electrophysiol, 2011,34(7) :804-809.
[2] 黄忠朝. 基于体表心电图的心房颤动特征提取及临床辅 助诊断研究[ D] . 浙江大学,2006.
[3] Task Force of European Society of Cardiology,the North A-

merican Society of Pacing, Electro—Physiology. Heart rate variability standards of measurement,physiological interpretation,and clinical use[ J] . European Heart Journal,1996, 17 :354 -381 . [4] Couceiro R. , Carvalho P. . Detection of atrial fibrillation using model - based ecg analysis [ C ] . 19th International Conference on Pattern Recognition, 2008, 2225-2229. [5] 陈煜. 基于多尺度小波熵的阵发性房颤识别方法 [ J]. 航天医学与医学工程, 2013, 5(26) : 352-355. [6] Yoshua Bengio. A fast learning algorithm for deep belief nets [ J] . Neural Computation,2006,18(7) : 1527-1554. [7] HINTON G. A practical guide to training restricted boltzmann machines[ D] . Toronto:University of Toronto,2010,1 -20. [8] S. Babaeizadeh,R. E. Gregg,E. D. Helfenbein,J. M. Lindauer,S. H. Zhou. Improvements in Atrial Fibrillation Detection for Real-Time Monitoring[ J] . Journal of Electrocardiology, 2009,42(6) :522-526. [9] S. Dash, K. H. Chon, S. Lu, E. A. Raeder. Automatic Real Time Detection of Atrial Fibrillation[ J] . Annals of Biomedical Engineering,2009,37(9) :1701-1709. [10] A. Ghodrati,B. Murray,S. Marinello. Rr Interval Analysis for Detection of Atrial Fibrillation in Ecg Monitors [ J] . 2008 30th Annual International Conference of the Ieee Engineering in Medicine and Biology Society,2008, ( 1 - 8 ) :601 604,5942. [11] N. Kikillus, G. Hammer, N. Lentz, E Stockwald, A. Bolz. Three Different Algorithms for Identifying Patients Suffering from Atrial Fibrillation During Atrial Fibrillation Free Phases of the Ecg [ J] . Computers in Cardiology, 2007, ( 2 ) : 801 -804 ,824 . [12] Go AS,Hylek EM, Phillips KA, et a1. Prevalence of diagnosed atrial fibrillation in adults: national implications for rhythm management and Stroke prevention:the An Ticoagulation and Risk Factors in Atrial Fibri1lation( ATRIA) Study [ J] . JAMA,2001,285:2370-2375. [13] Feinberg WM, Blackshear JL, Laupacis A, et a1. Prevalence,age distribution,and gender of patients with atrial fibrillation. Analysis and implications[ J] . Arch Intern Med, 1995 ,155 :469 -473 . [14] Furberg CD,Psaty BM,Manolio TA,et a1. Prevalence of atrial fibrillation in elderly subjects ( the Cardiovascular Health Study) [ J] . Am J Cardi01,1994,74:236-241. [15] Psaty BM,Manolio TA,Kuller LH,et a1. Incidence of and risk factors for atrial fibrillation in older adults[ J] . Circulation,1997 ,96 :2455 -2461 .

