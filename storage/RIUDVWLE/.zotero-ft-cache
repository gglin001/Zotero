⊕
國立中山大學機械與機電工程研究所 碩士論文
利用非侵入式 Plethysmography 信號評估 手術病患舒張壓變化趨勢之研究
The Study of the Variation Trend for Diastolic Pressure of the Surgical Patients utilizing Non-Invasive Plethysmography Signal
研究生：陳敬修 撰 指導教授：嚴成文 教授 中華民國 九十三年 六月

博碩士論文授權書
(國科會科學技術資料中心版本 92.2.17) 本授權書所授權之論文為本人在 國 立 中 山＿大學(學院)＿機械與機電工程 系所 ＿ 控制＿ 組＿＿九十二＿＿學年度第＿二＿學期取得＿碩＿士學位之論文。 論文名稱：利用非侵入式 Plethysmography 信號評估手術病患舒張壓變化趨勢之研究
■同意 □不同意 (政府機關重製上網) 本人具有著作財產權之論文全文資料，授予行政院國家科學委員會科學技 術資料中心、國家圖書館及本人畢業學校圖書館，得不限地域、時間與次 數以微縮、光碟或數位化等各種方式重製後散布發行或上載網路。 本論文為本人向經濟部智慧財產局申請專利(未申請者本條款請不予理會) 的附件之一，申請文號為：＿＿＿＿＿＿，註明文號者請將全文資料延後 半年再公開。
-------------------------------------------------------------------------■同意 □不同意 (圖書館影印)
本人具有著作財產權之論文全文資料，授予教育部指定送繳之圖書館及本 人畢業學校圖書館，為學術研究之目的以各種方法重製，或為上述目的再 授權他人以各種方法重製，不限地域與時間，惟每人以一份為限。

上述授權內容均無須訂立讓與及授權契約書。依本授權之發行權為非專屬性發行 權利。依本授權所為之收錄、重製、發行及學術研發利用均為無償。上述同意與不同 意之欄位若未鉤選，本人同意視同授權。

指導教授姓名: 嚴成文 教授

研究生簽名:

學號: M9138624

(親筆正楷)

(務必填寫)

日期:民國 93 年 8 月 3 日

1. 本授權書 (得自http://sticnet.stic.gov.tw/sticweb/html/theses/authorize.html 下載
或至http://www.stic.gov.tw首頁右下方下載) 請以黑筆撰寫並影印裝訂於書名頁之次頁。
2. 授權第一項者，請確認學校是否代收，若無者，請個別再寄論文一本至台北市(106-36)和平
東路二段 106 號 1702 室 國科會科學技術資料中心 王淑貞。(本授權書諮詢電 話:02-27377746)
3. 本授權書於民國 85 年 4 月 10 日送請內政部著作權委員會(現為經濟部智慧財產局)修正定
稿，89.11.21 部份修正。
4. 本案依據教育部國家圖書館 85.4.19 台(85)圖編字第 712 號函辦理。

目錄
目錄…………………………………………………………………..…..i 圖目錄…………………………………………………………………...iv 表目錄………………………………………………………………….viii 中文摘要..………………………………………………………….……ix Abstract…………….……………………………………………………x 第一章 緒論………………………………………………...………….1
1.1 前言……………………………………………..……………..1 1.2 研究動機與目的………………………………..….………….2 1.3 本研究遭遇之困難…………………………………………….4 1.4 研究方法………………………………………….……………6 1.5 論文架構……………………………………………………….6
第二章 基本醫學背景、原理與方法…………………………………7 2.1 臨床血壓量測原理…………………………………………..7 2.1.1 非侵入式血壓（NIBP）量測原理………………..…7 2.1.2 侵入式血壓（ABP）量測原理……………………….9 2.1.3 臨床血壓量測之現況………………………….……10 2.1.4 sABP 重要特徵………………………………….……..11
i

2.2 血管容積變化信號量測原理………………………………12 2.2.1 何謂「血管容積變化信號（PPG）」…………………12 2.2.2 sPPG 量測方式與原理………………………………....14 2.2.3 sPPG 臨床使用之現況………………………………....16 2.2.4 sPPG 重要特徵…………………………………..……..17
2.3 sPPG 與 ABP 於生理上之相關性……………………….…….19
第三章 工程分析方法與原理………………………………..………20 3.1 週期信號峰谷值偵測…………………………………..…….20 3.1.1 峰谷值偵測之重要性………………………..………20 3.1.2 峰谷偵測演算法………………………………………21 3.1.3 峰值與谷值標示………………………………………25 3.2 重搏波（Dicrotic Notch）之偵測………………………..…..30 3.2.1 sDicrotic Notch 之特徵………………………….…..30 3.2.2 小波轉換（Wavelet Transform）之介紹……….………31 3.2.3 利用小波轉換標示 Dicrotic Notch……..………….…38 3.3 利用小波（Wavelet）粹取低頻變化趨勢…………………40 3.4 相關性分析與事件標示……………………………….……..47 3.4.1 相關性分析之對象……………………………………47 3.4.2 相關係數………………………………………….….47
ii

3.4.3 sABP 與 PPG 之相關性分析………………………….47 3.4.4 PPG 事件標示………………………..………………51 第四章 實驗結果……………………………………………………54 4.1 病例選擇……………………………………………….……54 4.2 實驗步驟……………….……………………………………..54 4.3 實驗結果……………………………………………………..55 第五章 討論與結論……………………………………….…………62 5.1 結果討論……………………………………………………62 5.2 結論………………………………………………..…………62 參考文獻……………………………………………………….……….63
iii

圖目錄
圖 2.1 以科氏音法量測血壓之原理示意圖…………………………...8 圖 2.2 以科氏音法量測血壓之步驟…………………………………...8 圖 2.3 利用 A-Line 連續量測動脈壓…………………………………10 圖 2.4 心電圖（ECG）與連續動脈壓波形（ABP）…………………….10 圖 2.5 ABP 原始波形………………………………………………….11 圖 2.6 心臟收縮時手指末端量測之 PPG（紅色波形）……………….13 圖 2.7 心臟舒張時手指末端量測之 PPG（紫色波形）………………13 圖 2.8 一個完整循環週期所量測之 PPG（藍色虛線）……………….14 圖 2.9（1） 反射式血管管徑變化偵測示意圖………………………...15 圖 2.9（2） 穿透式血管管徑變化偵測示意圖………………………...15 圖 2.10 血管徑的連續變化波形…..………………………………….15 圖 2.11 Dicrotic Notch 於 PPG 波形中的位置………………………17 圖 2.12 血管本身作用過大時，造成 Dicrotic Notch 往上移動………18 圖 2.13 血管本身作用較小時，造成 Dicrotic Notch 往下移動……....18 圖 2.14 選定 PPG 波形中波峰至 Dicrotic Notch 的垂直高度「a」…....18 圖 3.1 由 ABP 信號計算舒張壓………………………………………21 圖 3.2 Navakatikyan 等人之信號峰-谷（peaks-valleys）偵測演算法...22
iv

圖 3.3 Improved_PVQA 演算流程……………………………………22 圖 3.4(a) 原始信號（上圖）…………………………………………....23 圖 3.4(b) 可能極值位置之標示（下圖紅點）…………………………23 圖 3.5（1） 所有極值點的大小值……………………………………...24 圖 3.5（2） 較大落差偵測暨門檻值（紅色橫線）選擇………………...24 圖 3.6(a) 由信號週期中 NBFS 來判斷谷值位置…………………….25 圖 3.6(b) 真正谷值位置與大小標示…………………………………25 圖 3.7 ABP 與 PPG 信號之峰谷值（Demo case I）……………………26 圖 3.8 ABP 與 PPG 信號之峰谷值（Demo case II）…………………...27 圖 3.9 ABP 與 PPG 信號之峰谷值（Demo case III）………………….28 圖 3.10 ABP 與 PPG 信號之峰谷值（Demo case IV）………………...29 圖 3.11 PPG 信號波形中 Dicrotic Notch 產生的位置………………..30 圖 3.12 Dicrotic Notch 不明顯之 PPG 信號波形……………………31 圖 3.13 傅利葉轉換將一段時間軸上的信號轉換至頻域…………...31 圖 3.14 時間軸上的信號經 STFT 轉換得到頻率-時間關係圖……...32 圖 3.15 時間軸上的信號經過小波轉換後時間-頻域的關係………...34 圖 3.16 小波轉換與其他轉換的比較………………………………...34 圖 3.17 Sine Wave 與 Wavelet 的比較………………………………35 圖 3.18 經過傅利葉轉換以及小波轉換的訊號……………………...35
v

圖 3.19 經過高通濾波器以及低通濾波器的訊號…………………...36 圖 3.20 表示 wavelet decomposition tree…………..…………………37 圖 3.21 Mexican hat wavelet 函數性質……………………………….38 圖 3.22 PPG 波形及其小波轉換與 DN 標示（Demo Case I）………...39 圖 3.23 PPG 波形及其小波轉換與 DN 標示（Demo Case II）………..39 圖 3.24 PPG 波形及其小波轉換與 DN 標示（Demo Case III）………39 圖 3.25 PPG 波形及其小波轉換與 DN 標示（Demo Case IV）………39 圖 3.26 利用 Mexican Hat 小波轉換結果標示 DN 位置之流程圖…..40 圖 3.27（1） MWA 方法中之順向計算……………………………….41 圖 3.27（2） MWA 方法中之逆向計算……………………………….42 圖 3.28 利用 MWA 計算低頻趨勢之應用實例………………………43 圖 3.29 Bior3.9 小波之特性…………………………………………..44 圖 3.30 利用 Bior3.9 小波計算低頻趨勢之應用實例………………45 圖 3.31 2000 個取樣點的 ABP 波形………………………………..48 圖 3.32 長時間序列的舒張壓（Diastolic）變化趨勢…………………48 圖 3.33 圖 3.32 之低頻變化趨勢……………………………………..48 圖 3.34 在一段 PPG 波形中標示出的峰谷值與 dicrotic notch 位置...49 圖 3.35 PPG 特徵參數之低頻變化趨勢…………...…………………49 圖 3.36 PPG 與 Diastolic 之間的相關係數（Demo Case I）…………50
vi

圖 3.37 PPG 與 Diastolic 之間的相關係數（Demo Case II）…………50 圖 3.38 PPG 與 Diastolic.之間的相關係數（Demo Case III）………...51 圖 3.39 PPG 事件標示（Demo Case I）………………………………..52 圖 3.40 PPG 事件標示（Demo Case II）……………………………….52 圖 3.41 PPG 事件標示（Demo Case III）……………………………...53 圖 4.1 實驗步驟流程圖………………………………………………54 圖 4.2 血壓上升之信號區段一………………………………………56 圖 4.3 血壓上升之信號區段二………………………………………56 圖 4.4 血壓上升之信號區段三………………………………………57 圖 4.5 血壓上升之信號區段四………………………………………57 圖 4.6 血壓平穩之信號區段一…………………………..…………..58 圖 4.7 血壓下降之信號區段二…………………………..…………..58 圖 4.8 血壓平穩之信號區段三…………………………..…………..59 圖 4.9 血壓平穩之信號區段四…………………………..…………..59
vii

表目錄
表 1. MWA 方法之效能分析…………………………………………43 表 2. Bior3.9 wavelet 方法之效能分析……………...………………..46 表 3. 74 筆 ABP 與 PPG 資料相關性分析……………………...……..55 表 4. 不同 PPG 事件標示門檻值所統計之正確率…………………..61
viii

中文摘要
本研究主要目的，是希望利用非侵入之血管容積變化信號 （Photo-Plethysmography, PPG），來評估手術病患舒張壓的變化趨 勢。現今醫療上所使用的血壓量測方式分為兩大類：侵入式（Invasive） 與非侵入式（Non-Invasive）。此兩種量測方法各有其優、缺點；對於 侵入式血壓而言，大部分使用時機是在進行手術外科時才會使用，其 所量測的血壓值為血管中的連續絕對壓力，此亦為其優點，但是因為 是侵入式的量測，所以需要在專業醫師評估後才能以此方式量測血 壓，具有一定的不便性；而非侵入式血壓量測雖然具有不侵犯人體的 優點，但同時亦具有量測值為估測值的缺點，且每次量測都存在時間 盲點；本研究的血壓評估方法是介於侵入式與非侵入式之血壓量測， 不但為非侵入式，而且具有血壓變化趨勢連續評估的優點，可以降低 非侵入式血壓量測過程中，因時間盲點所造成的不確定性，因此適用 於輔助非侵入式血壓量測。本研究之評估對象為非外因性血壓變化之 手術病患，非外因性指的是沒有大量失血與輸血；並嘗試以單一種 PPG 訊號之特徵參數，連續評估一分鐘內的血壓上升變化趨勢。
ix

Abstract
The purpose of this research is the estimation for the trend of diastolic pressure of surgical patients utilizing non-invasive photo-plethysmography (PPG) signal. There are two major ways to measure blood pressure during medical treatment : invasive and non-invasive methods. Both them have advantages and disadvantages. For invasive method, it is used for surgical operations. Although it can response the true situation of arterial blood pressure, the damage and uncomfortable are the most disadvantages for itself. And for non-invasive method, it is convenient to use but the measurement results have lower accuracy. In this research, we try to estimate the continuous trend of diastolic pressure utilizing PPG signal. And calculate the accuracy of the results.
x

第一章 緒論
1.1 前言
隨著各種文明疾病以及生活上種種意外傷害的發生，手術治療的 需求越來越多，所謂手術治療，指的就是由專業醫師直接對人體進行 人為侵入的一種治療方式，例如：將人體腹腔切開，進行闌尾切除、 取出結石、腫瘤切除、內出血縫合、脊椎治療，甚至是臟器移植等治 療；在醫學上，手術是指外科治療的手段或是技術而言，包括手法以 及手術相關儀器、裝置與器械的操作，將人體的解剖構造作治療性的 去除或改變。手術的過程通常必須在病患身上做一切口，以除去或修 補、矯正或改變病人身體組織，使病情獲得改善，大部份手術會先經 由門診來安排手術行程，但是在許多緊急狀況下（例如：車禍、意外 災害），也會施行緊急手術，以在第一時間搶救病人的生命，扭轉病 情危機。由於手術治療是一種侵入式的行為，對人體是一種極大的傷 害，因此在進行手術治療前，都必須經由各專科醫師做過向詳細評估 後才得以進行；每一位手術病患在進行手術治療時，都會有一組專業 醫護人員為其組成醫療團隊，其中包括：手術主刀醫師、麻醉醫師、 麻醉技師、刷手護士、流動護士、恢復室護士、住院醫師與其他助手 等，其中，麻醉醫師與麻醉技師必須要負責除了手術治療以外大部分 的醫療行為，例如：手術麻醉工作、手術中監控病患生理狀態、控制
1

麻醉深度、給藥、必要時輸血、手術後催醒等，在整個過程中亦要隨 時記錄相關資訊以供麻醉醫師參考與日後建檔之用，對每一個手術治 療的過程來說，其工作內容與份量可以說相當繁重，也相當依賴醫護 人員主觀的判斷與臨床經驗來照護每一位接受手術治療的病患。但是 在許多情況中，手術病患在接受手術治療時，會發生不可預期之事， 例如：不明原因失血、血壓突然升高或下降等；如果要以生理信號監 視器來反應這些狀況，尤其是利用非侵入式血壓計（Non-Invasive Blood Pressure, NIBP）的話，將會喪失監測生理狀態變化的第一時 間，因為在手術房中每次 NIBP 儀器可量測的最短間距為一分鐘，但 是通常臨床上沒有特殊狀況時，平均 3〜5 分鐘才會量測一次血壓， 如果病患的血壓變化較為劇烈，則儀器需要化較多的時間來計算平均 而得到血壓值，如此一來，在這些量測的空檔時間內將會造成監視病 患生理狀態的一個盲點；雖然，可以使用侵入式動脈導管（Arterial Line, A-Line）來量測手術病患的連續動脈血壓，但是並非每一種手 術或病患都適合或是需要使用此種血壓監視方法，所以絕大部分的手 術中，都還是以傳統 NIBP 來監視血壓，也因此普遍地存在了生理信 號監測的盲點。
1.2 研究動機與目的
基於前一小節所描述的生理訊息監視上之缺憾，我們希望能提供
2

一些辦法來加以改善。在手術過程中，量測血壓的方式有兩種：侵入 式（Invasive）與非侵入式(Non-Invasive)；侵入式血壓量測顧名思義 就是直接量測血管內的血流壓力，雖然此種方式可以量得人體連續的 血壓變化狀態，但是由於為非侵入式量測，對人體傷害較大，因此除 非必要，否則一般不會使用侵入式的方式來監視手術病患的血壓狀 態。另一種非侵入式的血壓量測方式，是利用手臂上的充氣袖帶以科 氏音為準則，量測血管內的收縮壓與舒張壓，所量得的壓力為不連續 的估測血壓值，同時在充放氣與量測過程中，會有一段時間盲點。
有鑑於此，為了能避免非侵入式血壓量測時間盲點的缺憾，又能 兼顧侵入式血壓連續量測的優點，在本研究中選擇利用非侵入式的 「血管容積變化信號（Photo-Plethysmography, PPG）」來嘗試評估血 壓的連續變化狀態，而評估的目標—連續血壓變化狀態的信號來源， 是擷取自必須使用侵入式血壓量測的手術病患，以侵入式動脈壓力導 管（A-Line）所量測得到的橈動脈壓力（Arterial Blood Pressure, ABP）；由於在手術麻醉過程中，血壓的突然上升通常代表較為重要 的警訊，因此本研究的目的希望將手術時血壓升高的時間區段標示出 來，以提供臨床醫師一個指標性的參考依據；另外，由於手術治療過 程中，周邊血管的狀態對臨床麻醉醫師來說亦是一項重要的資訊，而 此一資訊大部分可以由連續血壓信號所獲得的舒張壓變化來評估，因
3

此，為了日後的延續性，本研究目的，即是著重於利用 plethysmography 信號評估手術病患在進行手術治療的過程中，舒張壓升高變化的趨 勢。由於以往的文獻回顧中，尚未發現以 PPG 訊號直接連續評估血 壓狀態的相關文獻或報導，因此本研究為一初步研究，並嘗試利用單 一種 PPG 生理訊號所粹取的特徵參數，來連續評估血壓上升的變化 趨勢。
1.3 本研究遭遇之困難
本研究在過程中所遇到的幾個困難可以歸納城下列幾項： （A）病例篩選：醫護人員對失血量估測的不確定性。
本研究的對象是以非外因性血壓上升之手術病患為主，所謂外因 性指的是已知大量失血與正在輸血的病患，因為此種病例其血管壓力 與管徑的關係在生理機制上不同於一般病例，因此必須要排除失血量 過多或是手術過程中輸血之病患，但是失血量的判斷是由臨床護士以 目測來估計，經常會造成誤差。 （B）生理干擾：
（1）環境溫度之影響： 溫度會影響人體周邊血管的收縮，導致 PPG 訊號的失真。
（2）感測器人為振動之影響： 人為振動會使得 PPG 感測器無法固定在皮膚同一位置，使
4

得 PPG 訊號無法正確量測。 （3）藥物動力學效應：
不同的麻醉藥劑有不同的藥物動力學反應，同時在手術過 程中採用固定時間給藥，因此大部分手術時間中，血壓的大幅 度變化會被大量麻醉藥劑、止痛藥劑所抑制，使得含有血壓上 升區段的訊號量減少。 （4）病患血管病變之影響：
血管病變（例如：血管硬化、血管瘤）會影響血管的擴張、 收縮，進而影響 PPG 訊號。 （5）影響循環系統之因子過於複雜：
心血管循環系統在人體中是一種複雜的運作機制，雖然 ABP 與 PPG 有著相關性，但是能影響 PPG 訊號的因素並非只 有血壓狀態（例如：自律神經系統亦會影響血管管徑的變化）。 （C）訊號本質研究：PPG 訊號之基礎研究仍未萌芽： PPG 訊號的量測儀器在以往並不精準，以致於醫學上並未獲得重 視，至使得其相關的基礎研究並未大量進行，因此在 PPG 訊號波形 中何種參數是由何種生理狀態所引起的，難以釐清，本研究僅能從與 臨床醫師的討論與臨床觀察中，設法定義出對本研究有用的參數。 雖然本研究存在上述之困難點，但在研究過程中仍盡力排除各種
5

困難與不確定性。
1.4 研究方法
本論文中所使用的工程分析方法分為時域與頻域分析兩部分；時 域分析方法主要是改良自 2002 年由 Navakatikyan 等人[1]所提出來的 峰谷偵測方法，而頻域分析則是以小波轉換（Wavelet Transform）為 主[2][3]，搭配時域與頻域兩種分析方法，可以同時標示出 ABP 與 PPG 信號之波峰及波谷位置與大小，並可以找出血管容積變化信號（PPG） 的重搏波（Dicrotic Notch）位置，進而選取 PPG 中的特徵參數；另 外，本研究著重在血壓上升區段的變化趨勢，這種變化趨勢是屬於較 低頻的變化，因此本研究亦使用小波轉換，來濾除高頻的部份。
1.5 論文架構
本論文共分為五個章節，主要包含兩大類：醫學背景介紹與工程 分析技術之應用；各章節主旨如下：
第一章 說明研究的緣由、動機與採用的方法。 第二章 介紹本研究中基本的醫學背景與原理。 第三章 介紹本研究中使用的工程分析工具、原理以及實驗方法。 第四章 實驗結果。 第五章 結果討論與結論。
6

第二章 基本醫學背景、原理與方法
2.1 臨床血壓量測原理
2.1.1 非侵入式血壓（NIBP）量測原理 在臨床血壓的偵測原理中，分為非侵入式（Non-Invasive）與侵
入式（Invasive）兩大類[4]。非侵入式血壓（Non-Invasive Blood Pressure, NIBP）之量測原理[5]是利用科氏音來判別收縮壓與舒張壓的大小（血 壓單位：毫米汞柱, mmHg）；其傳統方法是透過聽診器監測束縛在胳 臂上的袖帶充放氣過程中，血液流過所產生之聲音；由於袖帶充滿氣 後，袖帶內壓力大於血管內壓力，手臂的血液無法通過，因此聽診器 無法聽到任何聲音，接著袖帶內的空氣會緩慢排出，使的袖帶內壓力 減小，血液得以流過，當第一個聲音出現時其水銀柱相對應之壓力值 即為柯氏音法的收縮壓，而後聲音漸漸變響隨後又變得低沉，最後消 失，聲音從低沉到消失時的壓力值即為舒張壓。圖 2.1 為 NIBP 血壓 量測法之示意圖，圖中(A)部分為科氏音判斷準則，(B)部分紅色斜線 表示袖帶放氣時的帶內壓力變化，藍色曲線為血管內血壓之變化，(C) 部分顯示袖帶放置位置；如圖 2.1(B)中左上方起紅色斜線與藍色波形 交叉的第一個點即為柯氏音法的收縮壓；而最右下方紅色斜線與藍色 波形交叉的最後一個點為柯氏音法之舒張壓。中間的數個交叉點所聽 到的科氏音為血液擾流的聲音，無法判斷出真正血壓值。NIBP 的量
7

測步驟如圖 2.2 所示。
(A) (B) (C) 圖 2.1 以科氏音法量測血壓之原理示意圖[5]。
圖 2.2 以科氏音法量測血壓之步驟[6]。
8

上圖 2.2 大致上的步驟是：將袖帶綁在手臂處→將聽診器置於袖帶下 方血管處→將袖帶充氣直到無法聽見血液擾流聲音為止→將袖帶緩 慢放氣→聽診器聽到的第一聲血液擾流聲音時，其壓力表壓力即為收 縮壓→聽診器持續聽到血液擾流聲音，直到聲音消失時的壓力表壓力 即為舒張壓。利用科氏音來量測血壓，會有一段因為袖帶充放氣而造 成的時間間隔，亦即在此一時間間隔內，無法得知血壓的狀態，造成 血壓量測的時間盲點；另一方面，利用此種非侵入式血壓量測原理來 量測血壓值，其優點雖為非侵入式、量測方便，但缺點則是量測的方 式為間接式，比較無法精確得知血壓真正的值，並且因為存在量測上 的時間盲點，而無法真正反應血壓的連續動態變化。
2.1.2 侵入式血壓（ABP）量測原理 第二種侵入式血壓（Invasive Blood Pressure, IBP；or called Arterial
Blood Pressure, ABP）量測原理，是利用橈動脈導管（Arterial Line, A-Line）置入於手臂動脈中，如圖 2.3 所示[7]，直接量測動脈血管中 的壓力值，由於血管中血液的流動是藉由心臟做功將血液推至全身， 因此血液流動的速度與壓力會受心搏週期影響而有著週期性的改 變；另外，由於侵入式血壓量測原理是直接量取動脈血管中的壓力， 因此量測的結果在時間軸上為連續的壓力變化，且經校準後血壓值為 絕對壓力（單位：毫米汞柱, mmHg），同時，每一個 ABP 血壓週期
9

的波峰即對應收縮壓，波谷則對應舒張壓。心電圖與連續動脈壓波形 如圖 2.4 所示。侵入式血壓量測原理的優點為血壓值準確、壓力值呈 連續變化，但是其缺點為因其侵入人體，故需要專業醫師經評估後才 可使用此方式量測血壓，方便性與安全性遠不如非侵入式血壓量測方 法，也因為如此，在手術臨床上除非有絕對的必要，否則較少使用侵 入式方法來量測血壓。
圖 2.3 利用 A-Line 連續量測動脈壓[7]。
圖 2.4 心電圖（ECG）與連續動脈壓波形（ABP）。
2.1.3 臨床血壓量測之現況 不論是手術治療過程或是生活中的應用，現今血壓的量測仍是以
非侵入式量測方法為主，原因是其具有的方便性與安全性，以 A-Line
10

置入的侵入式血壓量測，大多只用於手術過程中經專業醫師評估有其 必要性後，才會使用。血壓量測在近年來已經成為一項全民運動，隨 著國人飲食、生活的不正常，心血管疾病發生率越來越高，尤其老年 人經常發生的中風更不能忽視，因此，國內許多醫師都建議每個人都 應養成每天測量血壓的習慣，才能保持血壓的穩定性，預防心血管疾 病的發生。

2.1.4 sABP 重要特徵

本 研 究 著 重 的 ABP 波 形 重 要 特 徵 主 要 有 三 個 ： 收 縮 壓

（Systolic）、舒張壓（Diastolic）與平均血壓（Mean Pressure）[8]；

ABP 原始波形如圖 2.5 所示：

Systolic Pressure

圖 2.5 ABP 原始波形。

Diastolic Pressure

由於 ABP 所量測的物理量是血管內的連續變化壓力，因此隨著心搏 的週期影響，ABP 的波峰振幅大小即為收縮壓，而波谷振幅大小即 為舒張壓；平均血壓可由收縮壓與舒張壓計算得來[4]，其公式如（2-1） 式所示：

11

Mean

Pressure

=

Diastolic

+

1 3

(Systolic

−

Diastolic

)

（2-1）

因為本研究的目的是要評估連續血壓的變化「趨勢（trend）」，因此在 本研究中並未計算出血壓的真正大小，僅求出其在時間軸上的連續變 化趨勢波形。

2.2 血管容積變化信號量測原理
2.2.1 何謂「血管容積變化信號（PPG）」 血管容積變化信號（PPG）與血壓同為在循環系統的作用下而產
生的物理量，其本質為一體兩面；血管容積變化信號，顧名思義就是 因心臟搏動週期，而使得血管內單位面積的血流量成週期性的變化 [9]；PPG 訊號是由兩部分所合成的，在正常情況下，圖 2.6 表示當心 臟收縮時，會對全身血管做功，而造成血管內的壓力、血流體積產生 週期連續性變化，此時由手指量測得到的 PPG 波形就會如圖 2.6 紅色 曲線所示。

12

圖 2.6 心臟收縮時手指末端量測之 PPG（紅色波形）[9]。
當心臟舒張時其壓力相對的小，此時前一次心臟收縮所打出的血液， 在循環後撞擊心臟辦膜而使得血液有反折的現象，此時由手指量測得 到的 PPG 波形就會如圖 2.7 紫色曲線所示，所以一個完整週期的 PPG 波形是由上述兩種效應綜合的結果，亦即如圖 2.8 中藍色虛線的波 形，亦即紅色與紫色曲線作摺積的結果。
圖 2.7 心臟舒張時手指末端量測之 PPG（紫色波形）[9]。
13

圖 2.8 一個完整循環週期所量測之 PPG（藍色虛線）[9]。
由上述的結果我們可以知道，一個完整週期的 PPG 包含了心臟收縮 與血管壁本身壓力作用的綜合效應，但是除此之外，PPG 與 ABP 也 會同時受到自律神經系統與血管本身狀態（例如：血管順應性、血液 黏稠度等）的影響，不過，PPG 與 ABP 之間的相對關係仍然維持不 變，因此在大部分的情況下，我們可以直接由 PPG 與 ABP 的實驗數 據來分析它們之間的定性關係。
2.2.2 sPPG 量測方式與原理 在前一小節中說明了血管中血液的流動受到心臟搏動的影響，而
有著週期性的變化，進而造成血壓的週期性變化，在富有彈性的血管 中存在連續的壓力變化，勢必會造成血管管徑因壓力的做功而改變其 直徑，這種血管管徑的變化也會因為連續血壓的影響呈現連續性，欲 量測此種物理量，目前最常使用的方法就是利用光學檢測；其方法是
14

利用血管管徑變化時，會造成投射光線的偏折，再由這些偏折的角度 計算出血管徑的連續變化波形。其量測原理如圖 2.9（1）與圖 2.9（2） 所示，量測結果如圖 2.10 所示，圖 2.9（1）為反射式光學感測器， LED 所發射的光束會在真皮層反射至感測器；圖 2.9（2）為穿透式 感測器，LED 所發射之紅外線會穿過手指組織，由下方接收器接收 訊號。
圖 2.9（1） 反射式血管管徑變化偵測示意圖[10]。
圖 2.9（2） 穿透式血管管徑變化偵測示意圖。
圖 2.10 血管徑的連續變化波形。
15

圖 2.9 中紅色的管狀組織為人體周邊血管；由於血管管徑的變化，也 代 表 著 血 管 的 容 積 變 化 ， 因 此 圖 2.10 的 波 形 在 醫 學 上 稱 為 「Photo-Plethysmograph, PPG」；PPG 是利用光學感測器量測人體末稍 微血管的管徑變化，所以其優點為非侵入式，也因而量測方便，其缺 點則是容易受到外界雜訊或干擾影響量測的波形，另外，體溫亦會影 響周邊血管的狀態，因此，如果體溫變動幅度太大，PPG 的準確度也 會降低。而對於血管硬化的患者來說，雖然血管徑的變化較不明顯， 但仍能量測的到 PPG 波形。
2.2.3 sPPG 臨床使用之現況 由於 PPG 信號的物理意義是血管容積的相對變化量，因此其波
形振幅至今仍難以正規化成為有實用價值的單位刻度，更不用說能夠 將其正規化成與血壓有關係的訊號[11]；另一方面，目前所普遍使用 的 PPG 量測儀器，都會自動將 PPG 信號波形作調校，所以量測得到 的波形與人體產生的原始 PPG 信號波形會有一定程度上的差異，但 每一個週期信號波形中的相對特徵不會有太大的變化；就信號波形部 分，雖然有一些 PPG 波形相關的研究[12][13][14]，但是目前在臨床 上鮮少被醫師作為有用的參考依據。
16

2.2.4 sPPG 重要特徵 PPG 可以反應血管容積的變化，但無法代表血管容積的絕對值，
因此 PPG 波形在時間軸上所繪出的振幅純粹只代表資料擷取進來時 的電壓大小，如果要跟 ABP 作相關性分析，就必須在 PPG 波形中找 到適合的特徵參數；由於在本研究中，著重於 ABP 中舒張壓的變化， 因此我們在 PPG 波形中要先去除受心臟收縮壓影響較多的部分，在 2.2.1 小節中我們已經知道 PPG 波形是由心臟收縮與血管壁作用效應 作摺積的結果，由此可知下圖 2.11 中心臟收縮與血管壁作用效應曲 線的交界處是一個重要的臨界指標，其反映在 PPG 波形上就產生了 重搏波（Dicrotic Notch），如圖 2.11 箭頭所指處，以此 Dicrotic Notch 可視為一臨界點（Critical Point），往左邊推至上一個週期的結尾處其 波形受心臟收縮的影響比例較多，而在 Dicrotic Notch 右邊至下一個 週期開始為止的波形受血管本身作用效應的影響比例較大。
圖 2.11 Dicrotic Notch 於 PPG 波形中的位置[9]。
就整體的循環系統來看，心臟收縮時，如果血管本身的作用太大，會
17

阻礙心臟收縮時所傳遞的壓力波，因此 Dicrotic Notch 的位置就會往 上移動，如圖 2.12 所示，而此時 ABP 所量測的舒張壓也會呈現升高 的趨勢；反之，則 Dicrotic Notch 位置往下移動，且 ABP 之舒張壓呈 現下降趨勢，如圖 2.13 所示。
圖 2.12 血管本身作用過大時，造成 Dicrotic Notch 往上移動。
圖 2.13 血管本身作用較小時，造成 Dicrotic Notch 往下移動。
由上述的結果，我們可以找到一個適合的參數：波峰至 Dicrotic Notch 的垂直高度「a」，如圖 2.14 所示。
圖 2.14 選定 PPG 波形中波峰（Peak）至 Dicrotic Notch 的垂直高度「a」。
18

接下來我們於 PPG 信號中計算每一個心跳週期（HR），心跳週期即 為 PPG 信號中波峰至波峰的間距，同時求出 Dicrotic Notch 往後 0.1 秒位置的斜率（Slop(DN)），由於此三者參數的組合，在與舒張壓變化 趨勢作相關性分析時有顯著的影響，因此我們利用此三個參數計算出 PPG 特徵變化趨勢，如（2-2）式。

PPG Feature Trend = Slop(DN ) × a HR

（2-2）

上式（2-2）為實驗之經驗公式。

2.3 sPPG 與 ABP 於生理上之相關性
在 2.2.1 小節中曾經提及血管容積變化信號（PPG）與血壓同為 在循環系統的作用下而產生的物理量，其本質為一體兩面；每一次當 心臟收縮將血液輸送至全身時，血壓會隨其收縮成週期性變化，由於 血管富有彈性，因此血壓週期性的變化，會使得通過單位截面積的血 流量也呈現週期性的訊號波形，此即為血管容積的週期性變化；但是 可惜的是至目前為止，PPG 訊號無法被正規化成與血壓有相關的單位 刻度，也無法直接由時域訊號的波形來直接決定血壓的變化程度，因 此本研究試圖從 PPG 波形中找出一些可用的特徵參數，而此特徵參 數的變化趨勢也希望能夠盡量接近血壓變化趨勢。

19

第三章 工程分析方法與原理
3.1 週期信號峰谷值偵測
3.3.1 峰谷值偵測之重要性 自然界的信號大多屬於隨機信號（stochastic signals），人體生理
信號亦是如此，雖然此類信號的產生是屬於隨機分佈，但是仍然有一 定的軌跡可尋，例如：心電圖信號是量測心臟收縮與舒張時的電位變 化；對於下一時刻的心電圖取樣信號而言，其電位是隨機產生的，但 是心臟不斷的收縮與舒張則造成了一個生理上的循環週期，許多的專 業醫師就可以從這些週期中來判斷是否有疾病的發生。同樣的血壓與 血管容積變化也會隨著循環系統的週期而產生週期性的信號波，而每 一個週期中都包含了許多生理上的資訊，通常生理信號（例如：連續 血壓、PPG 等）中一個週期的定義是由心臟收縮開始至下一個收縮開 始前，也就是每一個週期信號中波谷（valley）與波谷所包圍的時間 區段；為了能將每一個生理信號週期的資訊粹取出來，勢必要計算出 每一個週期間波峰、波谷的位置，才能進一步針對每一個單一週期做 特徵粹取的演算。
本研究中，我們主要是要找出舒張壓的變化趨勢，因此藉由標示 出 ABP 波形的波谷位置，就可以得到舒張壓。如圖 3.1 紅點所示。
20

圖 3.1 由 ABP 信號計算舒張壓。
由於 ABP 信號波形中，波谷位置是一個非常明顯的特徵，除非導線 脫落等非自然因素之影響，否則其波谷位置是非常容易利用時域波形 分析的方法就可以找出來；下一節中將介紹本研究搜尋 ABP 信號波 形波谷位置的方法。
3.1.2 峰谷偵測演算法 本研究中所使用的峰谷偵測演算法（peak-valley detection），是改
良自 2002 年由 Navakatikyan 等人所提出來的方法[1]，當時主要是使 用於量化血壓波形之特徵；本研究將 Navakatikyan 等人之演算法稱為 PQ 演算法（Peak Quantification Algorithm, PQA），而改良之方法稱為 「改良式 PVQ 演算法（Improved-PVQA）」，並利用此一方法來計算 出 ABP 與 PPG 信號波形的峰-谷（peak-valley）值。Navakatikyan 等 人之 PQA 的演算法概念如圖 3.2 所示，整個演算法包含三個部分： 信號濾波（步驟 1、2）、初步偵測（步驟 3~7）以及最終偵測參數計 算（步驟 8、9）。
21

圖 3.2 Navakatikyan 等人之信號峰-谷（peaks-valleys）偵測演算法[1]。
而本研究的 Improved-PVQA 則將圖 3.2 改良為如圖 3.3 所示之演算概 念。
圖 3.3 Improved_PVQA 演算流程。
22

首先原始信號若含有高頻雜訊時，我們可以選擇先以 0.2~30Hz 之帶 通濾波器將高頻雜訊移除，以避免影響極值的偵測；第 3 個步驟區域 極值搜尋，是要先搜尋整段信號中的所有可能之極值大小與位置，下 圖 3.4 為原始信號與可能極值位置之標示示意圖。
圖 3.4(a) 原始信號（上圖）與圖 3.4 (b) 可能極值位置之標示（下圖紅點）。
區域極值的搜尋方法是在整段信號中，找尋整段信號中所有線段轉折 點處，為可能之極值點，並記錄其大小與位置；這些極值點有可能成 為一個週期信號中的波峰與波谷，因此我們必須將其間的區域極值消 去，不同於 Navakatikyan 等人的較大落差判斷法（Bigger Fall Side Determination ）， 本 研 究 使 用 的 較 大 落 差 偵 測 （ Bigger Fall Side Detection, BFS）是將所有極值點的大小值以時間軸正方向依次相 減，再利用（3-1）式將大於零的部分歸零，並取小於零的部分乘以
23

負一；圖 3.5（1）表示所有極值點的大小值，圖 3.5（2）為經過（3-1） 式運算的結果：

圖 3.5（1） 所有極值點的大小值。

BFS

=

0 −

[F

(n)

−

F

(n

+

1)]

, if F (n) − F (n +1) ≥ 0 , if F (n) − F (n +1) < 0

其中，F(n)表示週期信號中第 n 個極值點的大小值。

(3-1)

圖 3.5（2） 較大落差偵測暨門檻值（紅色橫線）選擇。
圖 3.5（2）中紅色橫線為最大落差偵測（Biggest fall detection）的門 檻值，由於每一個信號週期中，谷值對峰值相減的差值會是此一週期 中的最小值（負值），因此經過上述的較大落差偵測後，再以門檻值 判斷出最大落差的位置，其即為真正的谷值位置，如圖 3.6(a)(b)所示；
24

門檻值的設定如（3-2）式：

( ) Threshold

=

Mean(BFS

)

+

1 2

Standard

Deviation(BFS )

(3-2)

圖 3.6(a) 由信號週期中 Negative Biggest Fall Side 來判斷谷值位置。
圖 3.6(b) 真正谷值位置與大小標示。
最後，再將真正谷值位置的下一個極值點設定為峰值位置，如此便可 以得到整段信號中峰谷值的最近似位置。 3.1.3 峰值與谷值標示
在本小節中，將利用 3.1.2 小節的方法，透過幾個應用實例，來
25

測試找出幾種不同趨勢 ABP 與 PPG 信號之峰谷值。圖 3.7~3.10 分別 為十分鐘的 ABP 與 PPG 訊號，標示出峰谷位置與大小的結果；並將 其結果對應至原始訊號，以檢驗峰谷位置的搜尋結果是否正確。
圖 3.7 ABP 與 PPG 信號之峰谷值（Demo case I）。
26

圖 3.8 ABP 與 PPG 信號之峰谷值（Demo case II）。
27

圖 3.9 ABP 與 PPG 信號之峰谷值（Demo case III）。
28

圖 3.10 ABP 與 PPG 信號之峰谷值（Demo case IV）。
29

3.2 重搏波（Dicrotic Notch）之偵測
3.2.1 sDicrotic Notch 之特徵 在 PPG 的信號波形中，我們主要偵測的特徵是心臟收縮與舒張
的臨界點，醫學上稱為重搏波（Dicrotic Notch），如下圖 3.11 中箭 頭所指處：
圖 3.11 PPG 信號波形中 Dicrotic Notch 產生的位置。
Dicrotic Notch（DN）在 PPG 信號中大部分亦屬於區域最小值之一， 既然以 3.1 節的峰谷偵測演算法即可找出此一 DN 位置，何以需要將 其獨立於一章節來介紹？其原因是在大部分的情況下，PPG 信號的 Dicrotic Notch 其線段轉折處不明顯，同時由於在臨床上，Dicrotic Notch 產生的位置會隨時間有所不同，也會受到許多生理因素的影 響，而造成 dicrotic notch 不明顯，因此如果從時域分析的角度著手找 出其位置，會有一定程度的困難；有鑑於此，我們採用小波轉換來找 出此一重搏波的位置[2][3]。下圖 3.12 為 Dicrotic Notch 不明顯之 PPG 信號波形。
30

圖 3.12 Dicrotic Notch 不明顯之 PPG 信號波形。
3.2.2 小波轉換（Wavelet Transform）之介紹 （一）傅利葉轉換（Fourier transform）
在介紹小波轉換（wavelet transform）之前，我們可以先由傳統 的傅利葉轉換（Fourier transform）來瞭解小波轉換的優點。圖 3.13 表示在時間軸上的信號經過傅利葉轉換後，就可以得到頻域的資訊。
圖 3.13 傅利葉轉換將一段時間軸上的信號轉換至頻域[15]。
由上圖 3.13 我們可以明顯的瞭解，時間軸上的訊號經過傅利葉轉換
31

後，就可以得到此段信號在頻域上的全部資訊；換句話說，傅利葉轉 換可以展現一段特定時間信號中所包含的所有頻率資訊，包括頻率成 分與能量大小，但是在這個轉換的過程中，卻會使得信號相對於時間 的資訊喪失掉；亦即我們無法由頻譜的結果得知，原信號在哪一個時 刻發生了什麼事件。不隨時間改變的信號稱為 stationary 的信號，傅 利葉轉換對於 stationary signal 並不會造成上述的問題，但是不幸的 是，自然界中的信號大都是隨著時間在改變，亦稱為 non-stationary 的信號，通常我們所感興趣的不僅只是某段時間軸信號中的頻率成 分，也希望知道這個頻率成分及期能量大小事發生在該時間軸的哪一 個位置。 （二）短時間傅利葉轉換（STFT）
為了彌補傅利葉轉換的缺失，英國科學家 Dennis Gabor 於 1946 年提出了短時間傅利葉轉換（STFT, Short-Time Fourier Transform）， 經由這種轉換方式，可以得到頻率與時間的關係，如圖 3.14 所示。
圖 3.14 時間軸上的信號經 STFT 轉換得到頻率-時間關係圖[15]。
32

我們可由圖 3.14 中發現，在進行 STFT 轉換時，會先將信號取一段視 窗（Window），而這個動作就會使得 STFT 受到限制。另外，根據海 森堡測不準原理（Heisenberg uncertainty principle），在時-頻域裏無法 準確獲得時間-頻率資訊的相互關係，也就是無法準確測的知道某個 特定的頻譜資訊存在於哪一段時間中，因為這個問題與信號做 STFT 後的解析度（resolution）有關。 （三）小波轉換（wavelet transform）
自 90 年代起，小波轉換由理論性的研究變成工程上的應用後， 就一直是個很重要的分析工具之一；小波轉換 (wavelet transform) 是 將 STFT 中所使用的固定視窗（window）改變為可改變區域大小的視 窗，針對我們所關心的資訊，我們可以藉由此種方式來改變頻域的解 析度；亦即當我們需要精準的低頻資訊時，我們可以將所取的視窗長 度增加，得到長時間的信號區段；當我們需要精確的高頻資訊時，可 以將所取的視窗長度縮短，取得短時間的信號區段。小波轉換不僅提 供時間與頻率的關係，也提供了時間與頻域能量大小的關係。 圖 3.15 表示時間軸上的信號經過小波轉換後時間-頻域的關係，而圖 3.16 則 顯示了小波轉換與其他轉換的比較。
33

圖 3.15 時間軸上的信號經過小波轉換後時間-頻域的關係[15]。
圖 3.16 小波轉換與其他轉換的比較[15]。
「小波（wavelet）」的定義為：在某個時間區段內，波形振福的平均 值為零。由圖 3.17 可以知道正弦波發生在某個特定時間，不管延伸 到多大的時間，它都是如此的規律，而小波的發生是不規則的，可是 是對稱的。傅利葉分析是將訊號用不同頻率的正弦波來表示，小波分 析也類似，只不過是將訊號用不規則的小波來表示。
34

圖 3.17 Sine Wave 與 Wavelet 的比較[15]。
為了說明傅利葉轉換以及小波轉換的不同，我們可以從圖 3.18 來看， 傅利葉轉以不同頻率的正弦波形換構成了一個訊號頻率波形的大約 輪廓，而小波轉換則是用不同大小的小碎波組成一個訊號波形的細微 部分。
圖 3.18 經過傅利葉轉換以及小波轉換的訊號[15]。
在訊號分析中，低頻資訊通常代表了比較重要的部分，圖 3.19 是一 個經過離散小波轉換 (DWT) 並且做減少取樣 (down-sampling) 的 訊號。訊號分別通過高通濾波器 (high pass) 以及低通濾波器 (low
35

pass)。高頻資訊表示波形的細微變化；低頻資訊則代表著訊號大略的 波 形 。 而 其 中 的 符 號 cD 表 示 的 是 ”details” ， cA 表 示 的 是”approximations”。
圖 3.19 經過高通濾波器以及低通濾波器的訊號[15]。
分解訊號 (decomposition) 的處理過程可以重複進行，也就是將一個 訊號分解成許多低解析度 (lower-resolution components) 的組成。經 由這樣的分解，可以建構出一棵小波分解樹 (wavelet decomposition tree)，如圖 3.20 所示。
36

圖 3.20 表示 wavelet decomposition tree[15]。
要如何獲得上述高通與低通率波器的參數，就涉及到不同小波族群 （wavelet families）的選擇。本研究所選擇的小波族群是 Mexican Hat Wavelet，其數學函數定義如（3-3）式：
(3-3)
37

而其函數性質如下圖 3.21 所示。
圖 3.21 Mexican hat wavelet 函數性質。
3.2.3 利用小波轉換標示 Dicrotic Notch 在本小節中，將利用小波轉換的方法，來測試找出 PPG 信號之
Dicrotic Notch（DN）。承續上一章節，在本研究中，我們將 PPG 訊 號經過 Mexican Hat Wavelet 拆解 20 次後，觀察其每一個 Scale 的結 果與 Dicrotic Notch 位置的特徵，發現以 scale 為 15 的 Mexican Hat Wavelet 所轉換的結果，可以有效掌握到 PPG 訊號 Dicrotic Notch 的 位置，圖 3.22~3.25 中，黑色曲線為原始 PPG 訊號波形，紅色曲線為 原始 PPG 訊號經小波轉換（Mexican Hat Wavelet, Scale =15th）後的訊 號波形，由圖中可以發現 PPG 的 DN 所在位置（紫色方格點）經過 小波轉換後，落在紅色曲線週期中的區域極值位置；
38

圖 3.22 PPG 波形及其小波轉換與 DN 標示（Demo Case I）。
圖 3.23 PPG 波形及其小波轉換與 DN 標示（Demo Case II）。
圖 3.24 PPG 波形及其小波轉換與 DN 標示（Demo Case III）。
圖 3.25 PPG 波形及其小波轉換與 DN 標示（Demo Case IV）。
接下來是使用前幾個章節所介紹的峰谷偵測法，分別處理原始 PPG 訊號與其小波轉換結果，搭配兩者的結果來自動地標示出 DN 位置。 首先使用峰谷偵測法計算出 PPG 訊號之峰值與小波轉換後之谷值 後，搜尋出小波轉換結果的谷值中，最靠近 PPG 峰值者，即為 PPG 訊號中 DN 之最近似位置。其步驟流程圖如下圖 3.26 所示：
39

圖 3.26 利用 Mexican Hat 小波轉換結果自動標示 DN 位置之流程圖。
3.3 利用小波（Wavelet）粹取低頻變化趨勢
本研究中所要評估的對象為舒張壓的變化趨勢，因此我們為了粹 取這種變化的趨勢，我們比較了兩種不同的方法：Moving Window Average 與小波轉換。
Moving window average（MWA Method）的方法，是在欲處理的 訊號中，以 10 個取樣點為視窗寬度，原始訊號取樣頻率為 300Hz， 亦即移動視窗的長度為 1/30 秒，並將此視窗中的取樣點平均，其平 均值重新設定為視窗的第一個點，之後再將視窗往後位移一個取樣 點，視窗長度維持在 1/30 秒，重複上述作法，直到移動視窗的第一 點 index 大於或等於原訊號長度減去移動視窗長度；接下來由於位移 視窗的長度已經小於 10，因此我們將視窗長度依次減少一個取樣點，
40

並重複位移與平均的動作，且將平均值同樣設定為視窗的第一個點， 直到視窗長度等於 1；此為 MWA 方法的前半階段，後半階段的方法 與前半階段相同，唯一不同的是前半階段演算方向是順向計算，而後 半階段是逆向計算，整個演算法的示意圖如下圖 3.27（1）（2）所示：
圖 3.27（1） MWA 方法中之順向計算。
41

圖 3.27（2） MWA 方法中之逆向計算。
作一次完整的 MWA 運算，包含順向計算與逆向計算兩部分，經由 MWA 可以取得訊號的變化趨勢，而且經過 MWA 處理過的訊號，與 原訊號沒有相位差與長度不同的問題存在。下圖是 MWA 的應用實 例：黑色曲線是原始波形，我們希望透過 MWA 得到黑色曲線的低頻 變化趨勢，下圖 3.28（A）、（B）、（C）的紅色曲線部分，分別為原始 訊號作 1 次、3 次與 5 次 MWA 的結果；由結果可以發現，MWA 在 低頻變化趨勢的粹取上，有著不錯的效果。
（A）
MWA Order=1
42

（B）
MWA Order=3

（C）
MWA Order=5

圖 3.28 利用 MWA 計算低頻趨勢之應用實例。

上圖中，利用此種 MWA 所計算出來的低頻變化趨勢（紅色曲線），

理論上會很接近黑色曲線的 mean 值，因此為了檢驗此種計算低頻趨

勢變化的方法是否可行與正確，我們隨機選取 10 筆資料，分別以

MWA Order=3 來計算其黑色曲線與紅色曲線相減的差值，再將此差

值取絕對值後計算其 mean，並作一統計結果，如果統計的結果越接

近零，表示紅色曲線越接近原始訊號的低頻趨勢，也顯示了此種方法

的可行性與正確性。

表 1. MWA 方法之效能分析。 第 n 筆資料 相減結果之 Mean 值

1

0.000414

2

0.004529

3

0.001237

4

0.002047

5

0.000974

6

0.015251

43

7 8 9 10 十筆平均

0.016411 0.001911 0.002096 0.000549 0.005±0.006

由上表中可以發現，原始訊號與低頻變化趨勢的差異相當微小，也證 明了 MWA 方法的正確性。
另外一種趨勢計算方法，是利用小波來去除高頻部分，以得到低 頻變化趨勢，所使用的小波為 Bior3.9；其特性如下圖 3.29 所示：

圖 3.29 Bior3.9 小波之特性。
利用小波分析可以將一段訊號不斷地拆解成高、低頻部分，而且同時 每經一次小波運算，其訊號長度就會減少一半；如果欲還原至原訊 號，只需將高、低頻部分作逆轉換即可還原回原訊號；因為我們希望 得到低頻的變化趨勢，同時訊號長度不會縮減，所以我們的作法是， 將原訊號以小波拆解 5 次，將拆解出來的高頻部分全部變為 0，再作 小波逆轉換，將訊號長度還原回去，如此一來還原回去的訊號不僅長 度可以還原，同時也只保留住低頻的成分。下圖 3.30（A）、（B）、（C）
44

的例子中，紅色曲線部分，分別為原始訊號（黑色曲線）作 1 次、3 次與 5 次 Bior3.9 wavelet 的結果：
（A）
Wavelet Scale=1
（B）
Wavelet Scale =3
（C）
Wavelet Scale =5
圖 3.30 利用 Bior3.9 小波計算低頻趨勢之應用實例。
由上圖可知，當小波的 scale 越大時，其得到的低頻趨勢會越平滑， 但是由於在小波處理過程中會使用 zero padding，所以 scale 越大，其 經過小波處理後的訊號長度會較原始波形長。
同樣的為了檢驗此種計算低頻趨勢變化的方法是否可行與正 確，我們隨機選取 10 筆資料，分別計算其黑色曲線與紅色曲線相減
45

的差值，再將此差值取絕對值後計算其 mean，並作一統計結果，如 果統計的結果越接近零，表示紅色曲線越接近原始訊號的低頻趨勢， 也顯示了此種方法的可行性與正確性，同時我們將其結果與 MWA 方 法作比較，如下表 2 所示：

表 2. Bior3.9 wavelet 方法之效能分析。

第 n 筆資料 相減結果之 Mean 值

相減結果之 Mean 值

(MWA Method, order=3) (Wavelet Method, scale=3)

1

0.000414

0.000065

2

0.004529

0.000140

3

0.001237

0.000299

4

0.002047

0.000790

5

0.000974

0.000949

6

0.015251

0.000676

7

0.016411

0.000009

8

0.001911

0.000099

9

0.002096

0.000030

10 十筆平均

0.000549 0.005±0.006

0.000471 0.0004±0.0003

由上表中發現，小波分析對於計算低頻趨勢的結果，較優於 MWA 的 方法，所以本研究將以 bior3.9 小波來計算訊號之低頻變化趨勢；但 是經小波所計算的低頻趨勢會有長度不等的問題，MWA 則無，不過 在本研究中著重的是低頻的變化趨勢，因此以小波方法所造成的長度 問題可以忽略。

46

3.4 相關性分析與事件標示
3.4.1 相關性分析之對象 為了能利用 PPG 信號來評估舒張壓變化的趨勢，本研究處理的
相關性問題是針對由 ABP 所計算出來的舒張壓變化趨勢以及由 PPG 所計算出來的特徵參數變化趨勢。

3.4.2 相關係數 相關係數公式定義如下：

n
∑

(X

i

−

X

)(Yi

−

Y

)

R=

i=1

n
∑

(

X

i

−

X

)2

n
∑

(Yi

−Y

)2

i=1

i=1

（3-4）

其中，X、Y 表示欲計算相關性之兩組變數， X 、Y 分別為其平均值， R 為相關係數。

3.4.3 sABP 與 PPG 之相關性分析 經由侵入式動脈導管（A-Line）所量測的血壓值為隨時間連續變
化的壓力波，其單位為毫米汞柱（mmHg）。我們的目的是評估舒張 壓的「變化趨勢」，並非要估測出血壓大小的值，因此我們並未將資 料擷取進來的 ABP 信號刻度還原成毫米汞柱（mmHg）；圖 3.31 表示 一筆 ABP 在時間軸上的片段波形。
47

圖 3.31 2000 個取樣點的 ABP 波形（sampling rate：300Hz）。
在 ABP 波形中，每個週期的波谷就代表舒張壓的絕對值，如上圖 3.31 中的圓點，將所有圓點連接起來，則可以在時間軸上看出舒張壓變化 的趨勢，如下圖 3.32 所示。
圖 3.32 長時間序列的舒張壓（Diastolic）變化趨勢。
圖 3.32 中，含有許多高頻成分，因此我們利用前面介紹過的 Bior3.9 小波來計算其低頻趨勢，其結果如下圖 3.33 所示：
圖 3.33 圖 3.32 之低頻變化趨勢。
48

在 2.2.4 節中談論到 PPG 的重要特徵，其 Dicrotic Notch 的標示是利 用小波轉換（wavelet）來找出此一特徵點，並透過自動化峰谷偵測演 算法來標示出峰值（peak）與谷值（valley）位置。圖 3.34 表示一段 PPG 波形標示出峰谷值與 Dicrotic Notch。
圖 3.34 在一段 PPG 波形中標示出的峰谷值與 dicrotic notch 位置。
當峰谷值與 Dicrotic Notch 位置標定完成後，就可以由 PPG 波形求出 2.2.4 小節中特徵參數的變化趨勢，並同時將此變化趨勢以 Bior3.9 小 波來計算其低頻趨勢，其結果如圖 3.35 所示：
圖 3.35 PPG 特徵參數之低頻變化趨勢。
最後計算時間長度為 10 分鐘的 PPG 特徵變化趨勢與舒張壓變化 趨勢之間的相關係數。
49

圖 3.36 PPG 與 Diastolic Pressure 之間的相關係數（Demo Case I）。 圖 3.37 PPG 與 Diastolic Pressure 之間的相關係數（Demo Case II）。
50

圖 3.38 PPG 與 Diastolic Pressure 之間的相關係數（Demo Case III）。

3.4.4 s PPG 事件標示 在前幾個章節中，我們可以利用 Correlation Coefficients 來計算
舒張壓與 PPG 特徵參數兩者變化趨勢的相關係數；本小節將單純由 PPG 特徵參數的變化趨勢為出發點，從其計算的結果中，標示出舒張 壓可能有明顯變化的時間點，並由此結果對應回原始舒張壓變化趨勢 圖，以瞭解是否能由單純的 PPG 特徵變化趨勢標示出舒張壓變化的 時間點。
PPG 事件標示的方法，與 3.1.2 小節中所使用的方法相同，唯一 不同的是（3-2）式的門檻值修改為如下（3-5）式所示：

( ) Threshold = Mean(BFS ) + Standard Deviation(BFS )

（3-5）

下圖 3.39、3.40、3.41 是 PPG 事件標示的測試結果，圖中波形曲線分
51

別為舒張壓與 PPG 特徵參數之變化趨勢，垂直標記位置則是由 PPG 特徵參數所計算並標示之可能舒張壓變化時間點。
圖 3.39 PPG 事件標示（Demo Case I）。
由圖 3.39 可以看出，垂直標記位置對應至舒張壓變化趨勢圖中，恰 好是舒張壓即將上升的時間點。
圖 3.40 PPG 事件標示（Demo Case II）。
52

圖 3.41 PPG 事件標示（Demo Case III）。
圖 3.40 與 3.41 也可以明顯看出，事件標示記號所對應的位置，都是 舒張壓出現上升變化的鄰近位置，但是在血壓沒有上升時，PPG 訊號 也會因為其他生理因素而有所變動，導致標示錯誤，此一部份將在第 四章實驗結果中討論。
53

第四章 實驗結果

4.1 病例選擇
本研究分析所需資料是由中國醫藥大學附設醫院麻醉部所提 供，以非侵入式資料擷取系統為架構；並經由麻醉專科醫師排除因外 因性影響血壓上升之訊號資料，以及去除含有雜訊、干擾等品質不良 之訊號。上述外因性之訊號資料指的是大量失血與輸血的病例訊號。

4.2 實驗步驟
實驗步驟如下圖 4.1 所示，首先同步由病患身上擷取 ABP 與 PPG 訊號，利用第三章的方法計算出舒張壓與 PPG 特徵參數的變化趨勢， 再評估此兩者之相關係數，並同時在 PPG 特徵參數的變化趨勢上標 示出可能為舒張壓上升的時間區段，最後統計事件標示的正確率。

Arterial Blood Pressure
Peak-Valley Detection Wavelet Transform (bior3.9)
Trend of Diastolic Pressure

PhotoPlethysmography
Peak-Valley Detection Wavelet Transform (Mexican Hat, bior3.9)
Trend of PPG Features

Correlation Analysis
Estimation

Event Marking

圖4.1 實驗步驟流程圖。

Statistics of Accuracy

54

4.3 實驗結果
首先探討 PPG 特徵參數的變化趨勢與舒張壓變化趨勢是否有相
關性，下表為 74 筆 ABP 與 PPG 資料的相關性分析，資料包含血壓
上升、下降與平穩狀態之區段，，每一筆資料長度為 10 分鐘的訊號：
表 3. 74 筆 ABP 與 PPG 資料相關性分析（n：第 n 筆資料，R：相關係數）
nRnRnRnRnR
1 0.16 16 0.74 31 0.93 46 0.32 61 0.40 2 0.80 17 0.64 32 0.92 47 0.19 62 0.09 3 -0.28 18 0.64 33 -0.34 48 0.84 63 0.77 4 -0.35 19 0.12 34 0.61 49 0.75 64 0.18 5 0.06 20 0.53 35 0.68 50 0.81 65 0.19 6 -0.20 21 0.72 36 0.94 51 0.93 66 0.27 7 -0.15 22 -0.18 37 0.60 52 -0.06 67 0.16 8 0.32 23 0.84 38 0.92 53 0.44 68 0.10 9 0.64 24 -0.33 39 0.85 54 0.61 69 0.06 10 0.96 25 0.10 40 -0.21 55 0.80 70 0.40 11 0.58 26 0.74 41 -0.37 56 0.59 71 0.84 12 0.90 27 0.29 42 0.87 57 0.48 72 0.70 13 0.74 28 0.75 43 0.52 58 0.10 73 0.97 14 0.90 29 -0.10 44 0.58 59 0.17 74 0.79 15 0.78 30 -0.19 45 0.39 60 0.52
Mean±SD ： 0.44±0.40
由上表中我們可以發現，有些相關性呈現負值，有些成現正值，經過
實際的觀察結果，發現當血壓有上升現象時，其相關性大都呈現高度
正相關，如圖 4.2〜4.5 所示，而血壓下降或是呈現平穩時，則沒有規
則，可能為正、負或是零相關，如圖 4.6〜4.9 所示。
55

圖 4.2 血壓上升之信號區段一。 圖 4.3 血壓上升之信號區段二。
56

圖 4.4 血壓上升之信號區段三。 圖 4.5 血壓上升之信號區段四。
57

圖 4.6 血壓平穩之信號區段一。 圖 4.7 血壓下降之信號區段二。
58

圖 4.8 血壓平穩之信號區段三。
圖 4.9 血壓平穩之信號區段四。
由上幾圖可以觀察到，當血壓下降或呈現平穩時，PPG 會因為其他生 理因素的影響而導致標示錯誤；在前幾章節中，我們已經介紹過使用 特徵參數的目的，是希望能從 PPG 訊號中粹取出一些特徵參數的組 合，使其變化趨勢能逼近血壓的變化趨勢，因此是否當血壓上升時，
59

能夠有效反映在 PPG 特徵變化趨勢上的振幅變化，則需要作一些試 驗；本研究統計 PPG 特徵參數變化趨勢中的振幅大小，再依經驗法 則乘上一加權值α，訂出 PPG 事件標示的門檻值，亦即門檻值 = (74 筆資料之最大落差平均值)×α，目的是希望藉由門檻值的調整來計算 PPG 事件標示的正確率，正確率的計算公式如下（4-1）式所示：

Accuracy（％）= 100－ [100×（FP+FN）]/Total Events

(4-1)

其中，FP（False Positive）是指：不是正確血壓上升時間點，但卻被 標示為血壓上升區段。FN（False Negative）：是正確血壓上升時間 點，但卻沒有被標示為血壓上升區段。

上述的血壓上升定義，是將 10 分鐘長度的分析訊號以 1 分鐘為分析 視窗長度，同時以 30 秒為一個 shift 單位往後位移，如果該分析視窗 中的平均血壓大於前一個視窗中平均血壓的 20％，即定義為血壓上 升。在此，每一筆分析資料的第一個分析視窗皆不列入計算，因為第 一個分析視窗並無歷史資料可供比較。下表是以 PPG 事件標示門檻 值為 4、5、6、7、8 以及無門檻值所計算的結果，分析資料筆數為 74 筆。

60

表 4. 不同 PPG 事件標示門檻值所統計之正確率。

門檻值 無
4 5 6 7 8

正確率 （％）

FN（個數） 血壓上升 FP（個數） 非血壓上

次數

升次數

33.11

49

203

842

1129

62.16

136

203

368

1129

66.44

143

203

304

1129

69.97

156

203

244

1129

73.35

167

203

188

1129

77.85

174

203

121

1129

以％20 為血壓上升定義的條件下，血壓上升與非上升的次數分別為 203 與 1129 次，而此一次數會因血壓上升的定義不同而有所改變， 同時在所有訊號中，非血壓上升次數會大於血壓上升的次數；由上表 可知，當門檻值逐漸調高時，正確率會隨之逐漸上升，此乃因為 FP 的個數因門檻值的作用而大幅下降，但是 FN 卻會因為門檻值而上 升，是屬合理現象，如果希望得到較高的正確率，勢必會導致 FN 的 比例升高，而本研究的重點在於希望能在正確率與 FN 比例取得一個 平衡點，因為血壓上升卻沒有被偵測到的情況會比正確率下降還要嚴 重。綜合上述的結果，此一研究仍須進行長期且大量的觀察與分析。 至目前為止，本研究乃一初步研究，並已建構一分析平台以利進行長 期研究之用，於臨床上尚不能直接提供臨床應用。

61

第五章 討論與結論
5.1 結果討論
經由實驗可以得到一些結果，雖然在長時間的觀察中，血壓上升 時其相關性大多會呈現正的相關性，但是當血壓穩定或是下降時，其 相關性會呈現不確定性，同時若將分析的時距縮短，則會因為歷史資 料比數太少，無法正確判斷變化趨勢，造成相關性偏低，在這些許許 多多的情況下，不論血壓是上升或是下降，PPG 訊號都會因為各種生 理狀態的調控而有所反應，因此想要由單一 PPG 訊號來評估血壓的 變化情形，就本研究的結果來看，仍有一定的困難度，亦即想要由非 侵入式的方式來連續評估血壓變化趨勢，仍然必須搭配其他種非侵入 式生理訊號才有可能。
5.2 結論
在手術過程中，影響血壓變化與 PPG 波形的因素相當複雜，如 果希望由單純由 PPG 信號來反應各種血壓變化的情形，勢必還要經 過非常長時間的分析與研究，尤其是選擇或是製作一個穩定性、精確 度高的 PPG Sensor 是非常必要的。本研究主要目的，就是希望探討 由單一 PPG 訊號來評估血壓的可能性，但就其結果來看，仍須進行 更多醫學與工程上的基礎研究，才能獲得更有價值的結果。
62

參考文獻
[1] Michael A. Navakatikyan, Carolyn J. Barrett, Geoffrey A. Head, James H. Ricketts, Associate Member, IEEE, and Simon C. Malpas, “A Real-Time Algorithm for the Quantification of Blood Pressure Waveforms”, IEEE Transactions on Biomedical Engineering, Vol. 49, No. 7, JULY, (2002).
[2] Lynn Antonelli, William Ohley, and Rachid Khamlach, “Dicrotic Notch Detection Using Wavelet Transform Analysis”, Proceedings of the 16th Annual International Conference of the IEEE, Vol. 2, p.p. 1216-1217, Nov., (1994).
[3] Lynn Antonelli, Rachid Khamlach, and William Ohley, “Wavelet Transform Analysis of the Arterial Pressure Waveform”, Proceedings of the IEEE-SP International Symposium, p.p. 568-571, Oct., (1994).
[4] 林茂村 等 編譯, “人體生理學”, 文京圖書股份有限公司, 1998. [5] http://www.medphys.ucl.ac.uk/teaching/undergrad/projects/2003/gro
up_03/how.html [6] http://www.steeles.com/catalog/takingBP.html [7] http://www.ebme.co.uk/arts/iabp/ [8] Beate H. McGhee, BSN, MN, APN, Maj Elizabeth J. Bridges, USAF,
NC, “Monitoring Arterial Blood Pressure: What You May Not Know”, Critical care nurse, Vol. 22, No. 2, p.p. 60-78, APRIL (2002). [9] http://www.micromedical.co.uk/products/cardio/theory.asp [10] http://www.medis-de.com/en/ppg.html [11] Joseph J. Carr, and John M. Brown, “Introduction to Biomedical
Equipment Technology”, Fourth Edition, p.p. 278, chap 9. [12] Joydeep Bhattacharya, Partha Pratim Kanjilal, Member, IEEE, and V.
63

Muralidhar, “Analysis and Characterization of Photo-Plethysmographic Signal”, IEEE transactions on biomedical engineering, Vol. 48, No. 1, p.p. 5-11, January (2001). [13] Joydeep Bhattacharya and Partha Pratim Kanjilal, “Assessing Determinism of Photo-plethysmographic Signal”, IEEE transactions on systems, man, and cybernetics-part A: systems and humans, Vol. 29, No. 4, p.p. 406-410, July (1999). [14] José Luis Hernández Cáceres, Karelia Cabañas, Jersys O. Falcón Rodríguez, Rolando Hong1, Abel García Lanz and Luis García Domínguez, “THE PHOTOPLETHISMOGRAPHIC SIGNAL PROCESSED WITH NONLINEAR TIME SERIES ANALYSIS TOOLS”, REVISTA CUBANA DE INFORMÁTICA MÉDICA ARTÍCULOS ORIGINALES, No. 1, (2000). [15] Matlab Wavelet Toolbox Manual.
64

