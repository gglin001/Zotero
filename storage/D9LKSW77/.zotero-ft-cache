Advances in Engineering Research, volume 178 Mizoram Science Congress 2018 (MSC 2018)
Correlation analysis between drowsiness and heart rate variability parameters
Reginald H. Vanlalchaka*, N. P. Maity, Zonunmawii
Department of Electronics and Communication Engineering, Mizoram University, Tanhril 796004, Mizoram, India Corresponding author: rh73058@gmail.com

Electrocardiography (ECG) is an important physiological signal that reflects the autonomic nervous system (ANS) activity. The correlation between ANS measures and sleepiness has been used to assess the drowsiness of a person from spectral analysis of heart rate variability (HRV). Power spectral analysis of HRV derived from RR interval time series gives three frequency bands, namely very low frequency band (0.0030.04 Hz), low frequency band (0.04-0.15 Hz) and high frequency band (0.15-0.4 Hz). Drowsiness has an adverse effect on the reaction time, alertness and concentration level of vehicle driver that can reduce driver performance. Surveys suggest that driver fatigue is one of the main causes of road accidents, contributing up to 20% of all road accidents. Researches have shown that bio-signals like electrocardiography, electroencephalography, blood pressure, etc. are affected by the mental state of the individual, and thus, these physiological signals can be used to assess the mental state of individuals. Hence, it is possible to make a system to monitor the driver drowsiness based on bio-signal. Recording EEG and EOG involves attaching electrodes on the head which is not comfortable, and may cause distraction to the driver. ECG is thus a better choice as it is possible to set up non-intrusively by placing electrically conductive fabric on the steering wheel and driver seat as electrodes. Non-contact electrodes have also been tested. Low frequency band power spectrum is related with sympathetic and parasympathetic activity of ANS, whereas high frequency band power spectrum is related with parasympathetic activity of ANS. The sympathetic nervous system signals the body to be in a more alert state whereas the parasympathetic nervous system signals the body to be in a more relaxed state. The objective of this paper is to analyze the changes in spectral components of HRV when one becomes drowsy and detect drowsiness.
Keywords: ECG, QRS detection, RR interval, heart ratevariabilty (HRV), frequency domain analysis.

INTRODUCTION
Different methods have been proposed for detecting driver drowsiness. The methods can be classified into three categories. The first method is based on driving information. It measures the steering wheel movement and deviation of the vehicle from the lane (Assari and Rahmati, 2011). But these measures work in limited conditions as these parameters are affected by the road and driving condition (Sahayadhas et al., 2012). The second method is based on facial expression. In this method, physical changes like eye closure, yawning, eyebrow movement and head nodding are monitored.
Using image processing technique (Coetzer and

Hancke, 2011). This method is non-intrusive, but it is not accurate as it is affected by ambient light and individual driver behavior while driving such as talking (Abtahi et al., 2011). Infrared lightning is being used to remove the illumination drawback (Assari and Rahmati, 2011). The third one is a bio-signal based method. This method is based on the strong correlation of brain and heart activity with drowsiness. It uses physiological signal like EEG (electroencephalography), EOG (electro-oculography) and ECG (Saroj and Craig, 2002). Physiological signals start changing from the early stage of drowsiness, making this method to be more suitable for drowsiness detection (Sahayadhas et al., 2012). Figure 1 shows a typical QRS complex waveform (Nakagawa et al., 2006).

Copyright © 2018, the Authors. Published by Atlantis Press.

This is an open access article under the CC BY-NC license (http://creativecommons.org/licenses/by-nc/4.0/).

47

Advances in Engineering Research, volume 178

Figure 1: A typical complex QRS waveform.
MATERIALS AND METHODS
ECG is the recording of electrical activity of the heart over a period of time as detected by electrodes attached to the outer surface of skin. The raw ECG itself is noisy and need to be processed for extracting useful information from it. ECG signal processing is done in two steps: preprocessing and feature extraction. Preprocessing step involves removing low frequency baseline wondering, high frequency noise and QRS detection (Vishnubhotla, 2013), and feature extraction extracts useful information like heart rate (beats per minute) and R to R time interval from the ECG signal.
R peak detection method

1[2x(n 1)  x(n  2)  2x(n 1)  x(n  2)] 8
. Then a squaring function is applied to the entire differentiated signal. The operation can be represented by the formula y(n)  [x(n)]2
. The squaring function gives a positive signal, and amplifies the derivative output nonlinearly. The output of the square function is passed through a moving window integrator of length 30 samples which can be represented by the formula
1 [x(n)  x(n 1)  ...  x(n  29)] 30
. In the next step, a set of weighted unit samples at the moving window integration waveform maxima are produced to localize the QRS complex to a single instant of time. Then the R peak is detected using adaptive threshold detection from integration waveform. Two threshold values have been used that continuously adapt to the changing integration output waveform. Thresold2 is used in the search back process when no QRS is detected within 1.66 times the current R peak to R peak time period. The set of thresholds are obtained using
SPK1=0.125PEAK1+0.875SPK1 (if PEAK1 is the signal peak)
NPK1=0.125PEAK1+0.875NPK1 (if PEAK1 is the noise peak)

Thresold1=0.125NPK1 +0.25 (SPK1-NPK1) Thresold2=0.5*Thresold1

Figure 2: Schematic showing Pan and Tomkins algorithm.

Where all variables refer to the integration waveform: PEAK1 is the current peak, SPK1 is the running estimate of the signal peak, NPK1 is the running estimate of the noise peak, Thresold1 is the first threshold used, and Thresold2 is the second threshold used.
RESULTS

A QRS detection algorithm has been developed by Pan and Tompkins (1985). Figure 2 shows the schematic diagram of Pan and Tompkins algorithm. The signal is passed through a band pass filter made by cascading low pass filter with a cut off frequency of 11 Hz, and high pass filter with a cut off frequency of 5 Hz to remove the baseline wandering, muscle noise, mains interference and T-wave interference. 5-15 Hz frequency band maximizes the QRS energy in the signal. Then, the filtered signal is differentiated to obtain high slopes for the QRS complex using the formula

HRV analysis
The time interval between two adjacent R peaks is termed as RR interval or normal to normal (NN) interval. Figure 3 shows HRV analysis, HRV refers to the variation in the beat to beat interval over time. These beat to beat intervals can be measured as the RR interval. The variation in RR interval reflects the influence of autonomic nervous system on the heart activity (Stanciu et al., 2007). HRV analysis can be done in time domain as well as frequency domain. In this work frequency domain analysis has been used. Fast Fourier transform (FFT) and

48

Advances in Engineering Research, volume 178 Figure 3: RR interval varying from 0.6 second to 1 second.
Figure 4: LF/HF ratio calculated using FFT and Lomb periodogram.
49

Advances in Engineering Research, volume 178

Lomb periodogram have been used to decompose the HRV signal into its spectral components.
Frequency domain analysis using FFT
The unevenly sampled RR time series is resampled and interpolated using spline interpolation to obtain a uniformly sampled time series. Then power spectral density is calculated using FFT for two minutes window with 50% overlapping. The power spectral density of RR time series consists of very low frequency band (0.003-0.04 Hz), low frequency band (0.04-0.15 Hz) and high frequency band (0.15-0.4 Hz). Normalized units of LF and HF components are obtained by the equation (Robert, 2007).
LForHFX 100 LF or HF (nu)= LF  HF
Frequency domain analysis using Lomb periodogram
The Lomb periodogram method can directly compute the power spectral density from the non-uniformly sampled RR time series and avoids the low-pass effect of the resampling. The Lomb normalized periodogram of a nonuniformly sampled data sequence is defined by

Px ( f ) =

N

2N



  1   2σ2

   

n1

[(x(tn)  x)cos(2
N
cos2(2 f (tn
n1

f (tn   ))

))]



n1

[(x(tn
N

)



x)

sin(2

f

(tn



))]2

 

sin2(2 f (tn ))
n1

 

where x and σ2 are the mean and variance of the

x(tn )

series {

}, τ is the frequency dependent time delay

defined to make the periodogram insensitive to time

shift (Laguna et al., 1998), (Thong et al., 2004). τ is de-

fined by

N

sin(4 ftn )

tan(4

f) 

n1 N

cos(4 ftn )

n1

DISCUSSION
Drowsiness detection
For the experiment the subject was deprived of sleep.

During the experiment the subject is allowed to rest on a chair watching videos. ECG of the subject as well as video of the subject during the experiment was recorded. The status of the subject was observed visually as well as through questionnaire. As the subject became sleepy, the LF components showed a decreasing trend whereas the HF component showed an increasing trend. Thus, the LF/HF ratio showed a decreasing trend as the subject became sleepy. When the subject underwent microsleep (short period of falling sleep), LF/HF ratio becomes very low. Figure 4 shows the sympathovagal balance during the experiment. The ratio calculated using FFT shows slightly higher value than that of Lomb method at some points. Based on the FFT method, when the subject enters the first microsleep stage for the first time, the LF/ HF ratio is found to be around 0.7±0.05. This value may differ from person to person.
CONCLUSION
In this paper the HRV parameters have been calculated using FFT and Lomb periodogram method, and the changes in the parameters obtain have been studied during drowsiness. The result of this experiment showed clear changes in sympathetic and parasympathetic activity of ANS during drowsiness, resulting in changes in LF and HF components of power spectral density of HRV. During drowsiness, the spectral density of LF component of HRV shows decreasing trend whereas that of HF component shows increasing trend.
REFERENCES
Abtahi, S., Hariri, B., Shirmohammadi, S. (2011). Driver drowsiness monitoring based on yawning detection. IEEE Instrumentation and Measurement Technology Conference, pp. 1–4.
Assari, A.M., Rahmati, M. (2011). Driver drowsiness detection using face expression recognition. IEEE International Conference on Signal and Image Processing Applications (ICSIPA 2011), pp. 337–340.
Burr, R. L. (2007). Interpretation of normalized spectral heart rate variability indices in sleep research: a critical review. Sleep, 30: 913–919.
Coetzer, R.C., Hancke, G.P. (2011). Eye detection for a real-time vehicle driver fatigue monitoring system. IEEE Intelligent Vehicles Symposium (IV) BadenBaden, Germany, pp. 66–71.
Laguna, P., George, B.M., Roger, G.M. (1998). Power spectral density of unevenly sampled data by leastsquare analysis: performance and application to heart rate signals. Available: https:// preview.academic.microsoft.com/ paper/2171801645/reference. Accessed 03 June 2018.

50

Advances in Engineering Research, volume 178

Lal, S. K., Craig, A. (2002). Driver fatigue: electroencephalography and psychological assessment. Psychophysiology, 39: 313–321.
Nakagawa, T., Kawachi, T., Arimitsu, S., Kanno, M., Sa-
saki, K., Hosaka, H. (2006). Drowsiness detection us-
ing spectrum analysis of eye movements and effective stimuli to keep drivers awake. Proceedings of Smart Systems 2006 & ICMA 2006, pp. 113-119.
Pan, J. and Tompkins, W.J. (1985). A real-time QRS detection algorithm. IEE Transaction on Biomedical Engineering, 32: 230–235.
Sahayadhas, A., Sundaraj, K., Murugappan, M. (2012).
Detecting driver drowsiness based on sensors: a re-

view. Sensors, 12: 16937–16953. Stanciu, M., Faur, D., Boev, A., Stanciu, A. (2007). ECG
measurement and acquisition system for heart rate variability analysis. In 6TH International Conference on Electromechanical and Power Systems. Available: http://img2018nice.pw/daniela- faurpolitehnica.html. Accessed: 20 July 2018. Thong, T., McNames, J. and Aboy, M. (2004). Lomb-Wech periodogram for non-uniform sampling. The 26th Annual International Conference of the IEEE EMBS San Francisco, CA, USA, pp. 271–274. Vishnubhotla, R. (2009). Pre-processing of ECG signal for ambulatory use. NIU Engineering Review, 1: 7–11.

51

