Proceedings of the 28th IEEE EMBS Annual International Conference New York City, USA, Aug 30-Sept 3, 2006

FrD05.3

Adaptive blood pressure estimation from wearable PPG sensors using peripheral artery pulse wave velocity measurements and multi-channel blind identification of local arterial dynamics.
Devin B. McCombie, Andrew T. Reisner, H. Harry Asada


Abstract‚ÄîA method for estimating pulse wave velocity (PWV) using circulatory waveform signals derived from multiple photoplethysmograph (PPG) sensors is described. The method employs two wearable in-line PPG sensors placed at a known distance from one another at the ulnar and digital artery. A technique for calibrating the measured pulse wave velocity to arterial blood pressure using hydrostatic pressure variation is presented. Additionally, a framework is described for estimating local arterial dynamics using PPG waveforms and multi-channel blind system ID. Initial results implementing the method on data derived from a human subject at different arterial pressures is presented. Results show that the method is capable of measuring the changes in arterial PWV that result from fluctuations in mean arterial pressure.
I. INTRODUCTION
Hypertension is a major health problem in the United States today with an estimated 27% of all adult Americans suffering from this condition [1].
Today the gold standard for non-invasive blood pressure monitoring is the sphygmomanometer [2]. This device is capable of providing measurements at discrete intervals through the periodic inflation/deflation of a pneumatic cuff. However, this method is rather interfering and does not provide a convenient solution for a non-obtrusive wearable device that can provide continuous blood pressure monitoring.
Several non-invasive techniques have been proposed to solve the problem of a wearable arterial blood pressure monitoring device. Two methods include, calibration and scaling of the voltage output of a pressurized photopelthysmograph sensor to correspond to the internal arterial blood pressure [3], and estimation of arterial blood pressure using calibrated pulse transit time measurements derived from an ECG and peripheral PPG sensor [4][5].
The non-invasive blood pressure measurement method proposed in this paper is based upon the direct correlation of pulse wave velocity in the peripheral arteries with arterial blood pressure. Pulse wave velocity measurements are derived from two in-line PPG sensors located a known
D. B. McCombie is with the Massachusetts Institute of Technology, Cambridge, MA 02139 USA (phone: 617-258-0813; e-mail: mccombie@ mit.edu).
A. T. Reisner is with the Massachusetts General Hospital, Boston, MA (email: areisner@partners.org)
H. H. Asada is with Massachusetts Institute of Technology, Cambridge, MA 02139 USA (e-mail: asada@mit.edu).

distance apart on the same appendage, one along the ulnar artery at the wrist and the second along the digital artery at the base of the pinky finger. A method of calibrating these pulse wave velocity measurements to arterial blood pressure (ABP) will also be presented.
Additionally a method for identifying the local arterial dynamics between the two sensors will be presented. This system identification methodology may allow more accurate pulse wave velocity estimates because it acts as an integral estimation method utilizing an entire data set rather than providing estimates based on a point-to-point detection method. The identified dynamics may also provide additional information regarding local changes in the vasculature which may serve as a tool to augment the PWV to ABP calibration method and/or estimate the duration of its accuracy.
The scope of this paper is to describe the measurement of pulse wave velocity (PWV) using peripheral PPG measurements and to present a means of calibrating those measurements to peripheral arterial blood pressure. Initial results demonstrating the feasibility of the measurement and calibration method will also be presented. Additionally, a framework for identifying the local arterial dynamics using circulatory waveforms from the two in-line PPG sensors used to measure PWV will be described. A proof will be presented that shows that these dynamics can be identified from a pair of PPG signals given certain mild assumptions.
II. METHODS
A. Pulse wave velocity measurements
Measurement of peripheral pulse wave velocity is performed using two photoplethysmograph sensors as shown in Fig. 1. The photodiode of the leading sensor is located directly above the ulnar artery at the wrist joint. The photodiode of the lagging sensor is located above the digital
artery of the pinky finger. The pulse transit distance ( 'x )
between the two sensors is measured as the distance between the up stream edges of the two photodiodes.
The pulse transit time ( 't ) of the pressure pulse is
measured as the difference in time between the time of the onset of the pulse wave measured at the lagging sensor and the time of the onset of the pulse wave at the leading sensor.

1-4244-0033-3/06/$20.00 ¬©2006 IEEE.

3521

Fig.1. PPG sensor arrangement used to measure peripheral pulse wave velocity
Peripheral pulse wave velocity (c) can then be determined

from transit time and transit distance as shown in (1).

c

¬®¬ß ¬©

'x 't

¬∏¬∑ ¬π

(1)

B. Calibration of PWV to ABP
The mapping between pulse wave velocity (c) and arterial blood pressure (P) is based on the relationship that each of them shares with arterial vessel elasticity (E).
The relationship between vessel elasticity and the wave speed of a pressure pulse in a thin walled vessel can be described by the Moens-Kortweg equation [6] as shown in (2)

Eh

c

(2)

2 RU

The vessel wall elasticity can be written as a function of

pressure based on the work of Hughes et al [6] as in (3).

E E0e9P

(3)

Combining these two equations provides us with the

relationship between pulse wave velocity and arterial blood

pressure (4).

P

1 9

ln¬®¬®¬©¬ß

2 RUc 2 hE0

¬∏¬∏¬π¬∑

(4)

Calibration of the measured wave speed to the arterial

pressure requires us to identify a minimum of two different

terms in (4). Those two terms represent the scaling term on

the natural logarithm (k1) as well as a constant term (k2) as

shown in (5).

  P k1 ln c2  k2

(5)

In order to identify these two terms and calibrate this

equation, the change in measured peripheral pulse wave

velocity will be observed in response to a known change in

peripheral arterial pressure. Additionally, an initial single

pressure measurement from an oscillimetric cuff will be

required.

A change in peripheral arterial pressure will be achieved

by altering the height of the wrist and hand relative to the

heart thus changing the hydrostatic pressure being added to

the pulse pressure of the peripheral artery at the

measurement sites. Adjusting the hydrostatic pressure by

raising and lowering the arm is a technique first described

by Shaltis et al [7] to assist in calibrating the magnitude of

the PPG voltage to the magnitude of the arterial blood

pressure. For our purposes we will use the method to

quantify the relationship between peripheral wave speed and

peripheral arterial pressure. Using wave speed

measurements taken at two distinct heights will allow us to

generate an equation to solve for the unknown constant, k1 and quantify the slope of the pressure vs. natural log of the

squared wave speed as in (6).

>    @ P1  P2 'P Ug'h k1 ln c12  ln c22

(6)

In order to determine the constant term, k2 in the pulse wave velocity to pressure equation we must take a single

pressure reading with an oscillimetric cuff. Using the

diastolic measurement for P, which correlates to the onset

pressure of the circulatory waveforms and our pulse wave

velocity estimates this constant can be determined as in (7).

  k2 P  k1 ln c2

(7)

Further investigation will be required to reveal the

duration to which these calibrated constants provide

accurate pressure estimates from measured pulse wave

velocity measurements.

C. Identification of Local Arterial Dynamics
A technique known as Blind System Identification (MBSI) has previously been developed [8] for identifying the arterial hemodynamics given two measured circulatory signals. The technique has successfully been applied to multiple blood pressure waveforms.
The sensor arrangement that we propose for measuring the peripheral wave speed also provides us the necessary architecture for applying MBSI, namely it provides us with two circulatory waveforms taken form distinct measurement sites sharing a common input.

u(t)

H1(z)

y1 (t)

H2(z)

y2 (t)

Fig.3. Block diagram of two-channel system
The basics of the MBSI formulation for a two-sensor system sharing a common input (Fig. 3) can be expressed as an equality as shown in (8).

H 2 (z)Y1(z) H1(z)Y2 (z)

(8)

Using a time series of measured output data from the two

channels the model parameters of Hi(z), i =1,2; can be identified from the outputs alone by forming an over

constrained set of linear equations.

Based on a distributed transmission line model of the

arterial system we can identify the common input to a pair of

circulatory measurements taken along the same vascular

branch. At any measurement point along the vessel the

measured pressure is the sum of an incident pressure wave

and a reflected pressure wave as in (9).

3522

Px, t  PI (x, t)  PR (x, t)

(9)

If the microcirculation is modeled as a terminal resistance

at the end of the line (x = l) than a relationship can be

developed between the incident and reflective pressure at

this resistance as in (10). Where * , represents the reflection

coefficient, which is a function of both the terminal

resistance and the characteristic impedance of the line.

PR l, t *PI l, t 

(10)

From the definitions in (9) and (10) and neglecting losses

in the transmission line the measured pressure waveform at

any point, x can be expressed as a function of the incident

pressure wave at the origin, where x = 0 as in (11).

Px, t  PI (0, t  TI )  *PI (0, t  TR )

(11)

This expression can be represented in discrete time using

the delay operator, z as in (12).

  P[x, n] z NI  *z NR P[0, n]

(12)

Based on this expression the common input to a pair of

circulatory waveform measurements taken along the same

vascular branch is the incident pressure wave at the branch

origin. Thus from a pair of circulatory signals along the

same branch the MBSI framework allows identification of

two transfer functions each containing an incident delay, a

reflected delay, and a reflection coefficient as in (13).

H (x, z) z NI  *z NR

(13)

The MBSI methodology along with knowledge of the distance separating the two sensors allows us to estimate pulse wave velocity from the identified model delays. By operating across an entire windowed data segment this type of integral wave speed estimation may provide superior estimates compared to point-to-point waveform feature detection methods. Additionally, MBSI provides us with information regarding the reflection coefficient which may be useful in future calibration methods or for monitoring the local vascular state.
Fortunately, the MBSI algorithm is unaffected by the loss of scale imposed by the use of PPG sensor signals because of the structure of the inequality. However, a problem exists when applying MBSI directly to the measured PPG signals because they contain information in addition to the arterial pressure signal. In fact, the majority of the PPG signal is comprised of a large slowly fluctuating DC offset. The voltage output of the two PPG signals (Vi) can be described as in (14) where yi(t) represents the arterial contribution to the PPG signal and di(t) represents the DC offset. This offset is distinct to each channel and is based on numerous issues related to the tissue composition of the measurement site and the PPG sensor device.

V1(t) y1(t)  d1(t)

(14)

V2 (t) y2 (t)  d2 (t)

The arterial contributions to the two PPG signals can be

described as a function of the local arterial dynamics and

their common input as in (15).

y1(t) h1(t) * u(t)

(15)

y2 (t) h2 (t) * u(t)

It must be noted that the local arterial dynamics as defined

here also include contributions from any transduction

dynamics relating the arterial pressure signal to the PPG

sensor voltage. The arterial pressure component of the PPG

signal y(t) , can be written in terms of its mean value y(t) ,

and its deviation from the mean ~y (t) as in (16).

y1(t) y1(t)  ~y1(t) y2 (t) y2 (t)  ~y2 (t)

(16)

It can be shown that by properly filtering the measured

PPG signal the zero mean pulsatile portion of the PPG signal
~yi (t) can be obtained and when used in the MBSI algorithm

will allow us to correctly identify the local arterial dynamics

hi (t) without prior knowledge of either yi (t) or di (t) .

Because the DC component of the PPG signal is a very

low frequency signal that varies slowly in time in

comparison to the pulsatile arterial signal we can consider it

nearly constant across small time windows and a low pass

filter H LP (z) can be designed to obtain only the mean

amplitude portion of the PPG signal Vi(t), which includes di(t) as in (17).

H LP (z)V1(z) Y1(z)  D1(z)

(17)

H LP (z)V2 (z) Y2 (z)  D2 (z)

The low pass filtered signal can be used to obtain the

pulsatile portion of the PPG signal from the measured PPG

signal as in (18).

~ Y1

(

z

)

V1(z)  H LP (z)V1(z)

~ Y2

(

z

)

V2 (z)  H LP (z)V2 (z)

(18)

Using the definitions of Vi(z) in (14) and (16) the

equations in (18) can be rewritten as shown in (19).

~ Yi

(

z)

Hi (z)U (z) 
Di (z)  H LP (z)>Hi (z)U (z)  Di (z)@

(19)

The disturbance term in (19) cancels according to the

relationship in (17) and we are left with the equations in

(20).

~ Y1

(

z)

H1(z)>1  H LP (z)@U (z)

~ Y2

(

z

)

H2 (z)>1  H LP (z)@U (z)

(20)

We have therefore defined a new multi-channel system

composed of the local arterial dynamics and the averaging

filter that shares a common input. This new system can be

used to form the MBSI equality of (8) as in (21).

H1(z)>1  H LP (z)@Y~2 (z) H 2 (z)>1  H LP (z)@Y~1(z) (21)

Because any terms common to both sides of the equality

3523

are cancelled we can simply identify the local arterial
dynamics using the pulsatile arterial PPG component ~yi (t)

as in (22) without even increasing the persistence of

excitation conditions on the input.

H1(z)Y~2 (z) H2 (z)Y~1(z)

(22)

III. RESULTS/DISCUSSION

Two reflective-type PPG sensors (»ú = 660 nm) were

constructed and enclosed within elastic cuffs of adjustable

bias pressure. The output of the PPG sensors were

conditioned with a standard analog pre-amplifier and bandlimiting 2nd order lowpass butterworth filter (Fc = 25 Hz).
All signals were sampled at 20 kHz using a 16-bit data

acquisition system (Ni-Daq PCI-6251) and collected using

the LabView¬Æ 7.1 software environment.

PPG sensor data was collected on a male subject between

the ages of 25-34 in accordance with an experimental

protocol approved by the Massachusetts Institute of

Technology‚Äôs Committee on the Use of Humans as

Experimental Subjects (COUHES Approval No.

0403000233) and following Federal regulations for the

protection of human subjects established by 45 CFR 46.

The feasibility of measuring pulse wave velocity using the

two closely spaced PPG sensors and the ability to resolve

the change in pulse wave velocity due to hydrostatic

pressure variation were investigated. PPG waveform data

was collected with the lower arm, wrist, and hand parallel to

the horizontal plane resting on a rigid platform. The height

of the rigid platform was adjusted between three known

increments. The height difference between the three

platform positions ( 'h ) was 12 cm. Each height change

corresponds to a change in hydrostatic pressure in the

peripheral artery ( 'P ) of 8.8 mmHg. Prior to the

experiment the blood pressure of the test subject was

measured using an Omron¬Æ HEM-608 oscillimetric blood

pressure monitor and found to be 128/78 mmHg. Thirty

cardiac cycles (~ 30 seconds) of PPG sensor data from the

two sensors were collected and processed at each height.

The data was processed using an algorithm written in

MATLAB¬Æ to automatically detect the onset of each of the

circulatory waveforms collected from the leading and

lagging sensor.

The distance ( 'x ) between the leading and lagging

photodiodes was 13.1 cm. The peripheral pulse wave

velocity measurement results at the three different heights

are displayed in table 1.

Arterial Pressure PWV Mean PWV Std. Dev.

P + 8.8mmHg

8.1 m/s

0.7 m/s

P

7.7 m/s

0.7 m/s

P ‚Äì 8.8mmHg

6.9 m/s

0.5 m/s

Table 1. Pulse wave velocity estimates using inline PPG sensors

The high variability in the PWV estimates may be the result of the algorithm used to identify beat onset. The high

sampling rate of the measurements may be another source of error when using LabView¬Æ in the Windows XP environment and future tests may require a real-time acquisition environment.
IV. CONCLUSION
In this paper we have described a method that uses two PPG sensors to measures peripheral pulse wave velocity. We have described a means of individually calibrating the measured pulse wave velocity to peripheral arterial blood pressure using hydrostatic pressure variation. We have shown that it is experimentally possible to measure the peripheral pulse wave velocity using two PPG sensors located at the wrist and finger. Experimentation has also shown that it is possible to observe the alterations in pulse wave speed measurements produced by varying inter-arterial hydrostatic pressure. A framework has been presented to characterize the local arterial dynamics using two PPG sensors and blind system identification and how this information could be used to improve PWV estimation.
In the future perhaps the vessel elasticity information embedded in the identified model coefficients alone may provide enough data to calibrate PWV to arterial blood pressure.
REFERENCES
[1] Lawrence J. Appel, MD, MPH; Michael W. Brands, PhD; Stephen R. Daniels, MD, PhD; Njeri Karanja, PhD; Patricia J. Elmer, PhD; Frank M. Sacks, MD. (2006). Dietary Approaches to Prevent and Treat Hypertension. Hypertension [Online]. 47:296-308. Available: http://hyper.ahajournals.org
[2] Home Health Monitoring of High Blood Pressure (2005, April 23) American Heart Association [Online]. Available: http://www.americanheart.org
[3] P. Shaltis, A. Reisner, H. Asada, ‚ÄúCalibration of the Photoplethysmogram to Arterial Blood Pressure: Capabilities and Limitations for Continuous Pressure Monitoring,‚Äù 2005 27th Annual International Conference of the IEEE/EMBS, Shanghai, China, Sept. 1-4, 2005.
[4] C. Poon and Y. Zhang, ‚ÄúCuff-less and Non-invasive Measurements of Arterial Blood Pressure by Pulse Transit Time.‚Äù in Proc. of the 27th IEEE International Engineering in Medicine and Biology Conference, EMBC 2005, Shanghai, China, vol. 1, pp. 913-916.
[5] W. Chen, T. Kobayashi, S. Ichikawa, Y. Takeuchi, T. Togawa, ‚ÄúContinuous estimation of systolic blood pressure using the pulse arrival time and intermittent calibration,‚Äù Med. Boil. Eng. Comp., vol. 38(5), pp 567-574, Sept. 2000.
[6] W. O‚ÄôRourke ed., M, ‚ÄúMcDonald‚Äôs Blood Flow in Arteries: Theoretical, Experimental and Clinical Principles,‚Äù Oxford University Press, London, 1997. pp. 54-72
[7] P. Shaltis, A. Reisner, H. Asada, ‚ÄúA Hydrostatic Pressure Approach to Cuffless Blood Pressure Monitoring,‚Äù 2004 26th Annual International Conference of the IEEE/EMBS, San Fransisco, CA, USA, Sept. 1-5, 2004.
[8] D. McCombie, A. Reisner, and H. Asada, ‚ÄúLaguerre Model Blind System Identification: Cardiovascular Dynamics Estimated from Multiple Peripheral Circulatory Signals,‚Äù IEEE Trans. Biomed, vol. 52(11), pp. 1889-1901, Nov. 2005
[9] A. Reisner, D. McCombie, and H. Asada, ‚ÄúEstimation of Cardiac Output from Peripheral Pressure Waveforms using Laguerre Model Blind System Identification.‚Äù in Proc. of the 26th IEEE International Engineering in Medicine and Biology Conference, EMBC 2004, San Francisco, CA, vol. 1, pp. 913-916.

3524

