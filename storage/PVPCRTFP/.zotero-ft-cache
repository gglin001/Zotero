Tampere University of Technology
Comparison of HRV parameters derived from photoplethysmography and electrocardiography signals
Citation Jeyhani, V., Mahdiani, S., Peltokangas, M., & Vehkaoja, A. (2015). Comparison of HRV parameters derived from photoplethysmography and electrocardiography signals. In 2015 37th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC) (pp. 5952-5955). DOI: 10.1109/EMBC.2015.7319747 Year 2015 Version Peer reviewed version (post-print) Link to publication TUTCRIS Portal (http://www.tut.fi/tutcris) Published in 2015 37th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC) DOI 10.1109/EMBC.2015.7319747 Copyright © 2015 IEEE. Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses, in any current or future media, including reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for resale or redistribution to servers or lists, or reuse of any copyrighted component of this work in other works. Take down policy If you believe that this document breaches copyright, please contact tutcris@tut.fi, and we will remove access to the work immediately and investigate your claim.
Download date:24.04.2019

Comparison of HRV Parameters Derived from Photoplethysmography and Electrocardiography Signals*
Vala Jeyhani1, Shadi Mahdiani2, Mikko Peltokangas1 and Antti Vehkaoja1

Abstract— Heart rate variability (HRV) has become a useful tool in analysis of cardiovascular system in both research and clinical ﬁelds. HRV has been also used in other applications such as stress level estimation in wearable devices. HRV is normally obtained from ECG as the time interval of two successive R waves. Recently PPG has been proposed as an alternative for ECG in HRV analysis to overcome some difﬁculties in measurement of ECG. In addition, PPG-HRV is also used in some commercial devices such as modern optical wrist-worn heart rate monitors. However, some researches have shown that PPG is not a surrogate for heart rate variability analysis. In this work, HRV analysis was applied on beat-to-beat intervals obtained from ECG and PPG in 19 healthy male subjects. Some important HRV parameters were calculated from PPG-HRV and ECG-HRV. Maximum of PPG and its second derivative were considered as two methods for obtaining the beat-to-beat signals from PPG and the results were compared with those achieved from ECG-HRV. Our results show that the smallest error happens in SDNN and SD2 with relative error of 2.46% and 2%, respectively. The most affected parameter is pNN50 with relative error of 29.89%. In addition, in our trial, using the maximum of PPG gave better results than its second derivative.

I. INTRODUCTION
Heart rate variability (HRV) signal is a popular noninvasive marker of the autonomic nervous system and is widely used to assess cardiac health. For heart rate and HRV monitoring applications, ECG is usually measured either with disposable adhesive electrodes attached to torso or with textile electrodes worn on the chest as in traditional heart rate monitors. Both of these electrode types may cause discomfort and inconvenience. ECG signals are mostly affected by different noise and artifact sources. In addition, morphological variations in the ECG signal can affect the recognition of R waves from tall peaked P and T waves [1]. Because of the aforementioned drawbacks, photoplethysmography (PPG) signal has been introduced as an alternative for ECG and is used in some applications such as modern optical wrist-worn heart rate monitors.
PPG signal is often recorded by using a pulse oximeter which emits light to skin and measures changes in light absorption. These pulses do not include high frequency components at the location of the corresponding heartbeats as the ECG does. Although, this may introduce some other

*The work was partially funded by the Finnish Funding Agency for

Technology and Innovation (TEKES) as a part of project VitalSens (decision

ID 40103/14).

Vala Jeyhani, Shadi Mahdiani, Mikko Peltokangas and Antti

Vehkaoja are with the Department of Automation Science

and Engineering, Tampere University of Technology, Tampere,

FI-33720,

Finland

1firstname.lastname@tut.fi

2firstname.lastname@student.tut.fi

problems such as ﬁnding the correct peaks or waves in general or choosing such ﬁducial points in the peak that gives the best accuracy for the temporal location of the peak relative to ECG R-peaks.
In previous years, many works have been done to understand if pulse rate variability (PRV) can be used instead of HRV. Some of the studies have shown that PRV is a surrogate for HRV [1-6] while in some others the opposite result has been concluded [7-9]. These different conclusions underscore the need to provide more results regarding the problem.
Chiu et al. studied several methods for locating the wave front of the arterial blood pressure signal in [10], which can be directly extended to volumetric PPG signal. In their study, high-ﬁdelity aortic pressure recordings were obtained with a multi-sensor micromanometer catheter. Additionally non-invasive brachial and radial pressure waveforms were measured with external piezoelectric transducers from 11 subjects. The maximum second derivative and the intersecting tangent methods were proven to be the most consistent methods for this task.
In this work, ECG-HRV and PPG-HRV are compared for 19 healthy subjects. Useful HRV parameters are directly presented in this study, which were obtained from PPG and ECG signals for each subject. In addition, two different ways of deﬁning the ﬁducial points in the PPG signals have been considered for reconstructing of PRV to study which method gives better results.
The outline of the paper is organized as follows. In Section II, the procedure of gathering the signals, analysis, and their parameters are described. The results of comparisons are given in Section III. Finally, some concluding remarks are given in Section IV.
II. METHODS
In order to obtain HRV parameters from ECG signals, interpolation, R wave detection and generating the R-R interval signals are usually performed. The similar procedure can be applied to PPG signals and their second derivatives, which constructs a P-P interval signal for each. These steps are described in following.
All the processing tasks are done in MATLAB (2014b) from MathWorks Inc., Natick, MA, USA. The results of HRV parameters were also veriﬁed by Kubios software, which is an open license HRV analysis software developed in University of Kuopio, Finland [11].
A. Database
The signals in this work were measured from 19 subjects with the monitoring system proposed in [12]. ECG and PPG

signals were measured with sampling rate of 250 and 500 samples per second, respectively. The signals were recorded using two different sensor nodes of the wireless body sensor network (WBSN), thus preserving their temporal relation with each other. The resolution of the A/D converters in the WBSN sensor nodes was 16 bits.
All the subjects were healthy male with age of 38.2±13.1. One 5 minute long segment was selected from each recording for the analysis. PPG signals were ﬁltered by a FIR bandpass ﬁlter with cut-off frequencies of 0.5 and 10 Hz.
The data collection and preservation has been done according to the principles of World Medical Association’s Declaration of Helsinki.
B. Interpolation
To have a better resolution for peak detection procedures a cubic interpolation was applied on the signals. In [13] by using the cubic interpolation a resolution of 1 ms and deviation of ±1 ms was achieved in more than 99% of the RR intervals for the sampling rate of 250 Hz compared to the original 1kHz sampling rate. In our work, all the signals (both ECG and PPG signals) were interpolated to 1000 Hz samples per second.
C. R and Pulse Wave Detection
The detection of R wave ﬁducial points was done by the widely used algorithm proposed by Pan and Tompkins in 1985 [14]. This method is based on analysis of slope, amplitude, and width of the QRS complex.
The steps of detection include band-pass ﬁltering, differentiation, squaring and integration. By the band-pass ﬁlter all the additional frequencies other than QRS frequency band are removed, which results in reducing T wave interference, baseline drift and power line interference. Differentiation and squaring emphasize high frequency components and attenuate non-signiﬁcant waves. Finally, the moving window integrator produces a signal that includes information about both the slope and the width of the QRS complex.
The peaks of the PPG signals and their second derivatives were detected by scaling the signals, thresholding, local peak detection and removing too close detected points and keeping the larger ones.
All the detected points were double checked visually to make sure that there was no missing wave or false detection. The difference between the locations of the successive detected peaks represents the beat-to-beat interval signal which was then used for the HRV analysis.
D. HRV Parameters
To show the effect of using PPG instead of ECG in HRV analysis, some of the important time domain HRV parameters were calculated. Based on [15] the deﬁnitions are as follows
• SDNN: Standard deviation of all RR intervals • RMSSD: Root mean-square of successive differences of
adjacent RR intervals • pNN50: Percentage of pairs of adjacent RR intervals
differing by more than 50 ms.

R-R intervals from ECG 1.5

RRI (s)

1

0.5

0

1

2

3

4

5

Beat-to-beat intervals from PPG 1.5

PPI (s)

1

0.5

0

1

2

3

4

5

Error of beat-to-beat intervals from PPG 50

Residual (ms)

0

-50

0

1

2

3

4

5

Beat-to-beat intervals from second derivative of PPG 1.5

PPI (s)

1

0.5

0

1

2

3

4

5

Error of beat-to-beat intervals from second derivative of PPG 50

Residual (ms)

0

-50

0

1

2

3

4

5

Time (min)

Fig. 1. Peak-to-peak intervals obtained from maximum of PPG and its derivative for subject number 8. The errors of these signals with respect to ECG-RRIs are also illustrated.

• SD1: Standard deviation of data against the axis x = y in Poincare´ plot
• SD2: Standard deviation of data against the axis, which is orthogonal to the axis x = y (crosses this axis at the mean value of the data) in Poincare´ plot.
Poincare´ plots were constructed by plotting the R-R interval signal as a function of itself with a delay of one sample. Poincare´ plots were also checked for false detection of R and pulse waves.
III. RESULTS AND DISCUSSION
The HRV analysis results for 19 subjects are presented. One subject was discarded because of poor signal-to-noise ratio of the PPG signal, which resulted in large errors in the heartbeat detection. All the results were veriﬁed by Kubios software to make sure about their validity.
Fig. 1 shows the R-R interval (RRI) signal and P-P interval (PPI) signals obtained in two different ways for the subject number 8; one with the maximum of PPG and the other with

TABLE I HRV PARAMETERS FOR 18 SUBJECTS FROM BEAT-TO-BEAT ANNOTATION OBTAINED FROM ECG, PPG AND ITS SECOND DERIVATIVE (PPG*).

SDNN (ms)

rMSSD (ms)

pNN50 (%)

SD1 (ms)

SD2 (ms)

ECG PPG PPG* ECG PPG PPG* ECG PPG PPG* ECG PPG PPG* ECG PPG PPG*

P1 47.34 47.67 48.46 28.45 29.40 31.98 7.55 8.46 12.99 20.15 20.82 22.64 64.04 64.31 64.90

P2 26.20 27.61 28.54 20.48 22.27 24.14 0.61 1.82 1.82 14.50 15.77 17.09 34.14 35.77 36.62

P3 60.26 63.05 63.23 54.47 58.19 57.91 36.14 37.07 38.63 38.58 41.21 41.01 75.94 78.98 79.34

P4 105.69 107.02 108.74 103.52 105.10 108.08 64.96 67.52 70.09 73.35 74.48 76.59 130.91 132.43 134.03

P5 76.82 79.35 82.67 59.95 58.02 64.02 37.39 35.41 41.24 42.45 41.08 45.33 98.73 101.59 105.61

P6 30.95 31.99 32.21 17.82 18.67 18.93 1.21 1.82 1.52 12.62 13.22 13.40 42.00 43.32 43.62

P7 50.66 52.34 51.00 51.79 54.17 52.18 30.56 37.21 32.56 36.71 38.39 36.98 61.63 63.57 62.16

P8 74.75 77.23 77.40 56.43 62.19 61.97 31.49 37.13 37.79 39.96 44.04 43.89 98.09 99.93 100.22

P9 62.48 63.98 64.07 41.24 43.88 42.99 24.63 26.22 25.47 29.21 31.08 30.45 83.42 84.89 85.28

P10 54.41 54.38 55.22 39.40 38.63 40.67 21.21 25.54 25.11 27.92 27.38 28.82 71.97 72.12 72.85

P11 44.44 43.50 47.32 24.60 25.31 31.66 3.04 5.79 11.25 17.42 17.92 22.42 60.57 59.04 63.25

P12 38.08 37.89 39.40 26.32 24.55 27.41 5.39 4.30 6.72 18.64 17.39 19.41 50.57 50.75 52.29

P13 33.04 32.95 33.98 13.80 14.07 15.71 0.00 0.00 0.00 9.77 9.96 11.13 45.74 45.60 46.83

P14 30.18 28.75 31.80 35.39 30.98 39.22 13.21 8.30 20.00 25.07 21.95 27.79 34.73 34.38 35.56

P15 61.05 61.69 62.52 37.42 37.59 38.99 15.71 16.86 18.00 26.50 26.62 27.61 82.09 83.01 83.93

P16 69.36 69.51 70.33 39.66 39.44 41.76 14.68 13.85 18.28 28.08 27.92 29.57 93.93 94.17 94.92

P17 39.43 40.32 40.68 24.57 25.99 26.23 5.19 7.08 5.90 17.39 18.40 18.57 52.62 54.06 54.58

P18 14.06 14.84 14.84 7.49 8.81 8.76 0.00 0.00 0.00 5.31 6.24 6.20 19.20 20.03 20.06

Poincare´ Plot of First 100 R-R Intervals for Subject 8
1.1
SD2 SD1 1

RRIn+1 (s)

0.9 0.9

1

1.1

RRIn (s)

From ECG From PPG From Second Derivative of PPG Variance for RRI from ECG Variance for RRI Second Derivative of PPG
Fig. 2. A part of Poincare´ plot for the ﬁrst 100 samples of R-R intervals for subject 8. The semi-major and semi-minor axes of ellipses represent SD2 and SD1, respectively. Two ellipses belong to R-R intervals from ECG and second derivative of PPG.

maximum of its second derivative. The differences between these two signals and R-R intervals from ECG are also illustrated. The Root Mean Square Errors (RMSEs) for PPG beat-to-beat and the one obtained from second derivative of PPG are 7.096 and 6.579 ms, respectively. Mean Absolute Errors (MAEs) for these signals are 5.538 and 5.238 ms,

respectively. Therefore, there is no signiﬁcant improvement in the signal obtained from the second derivative of PPG compared to the one resulted from PPG peaks.
Fig. 2 shows the Poincare plots for subject 8. For a better illustration, only the ﬁrst 100 samples of beat-to-beat interval signals are used in this ﬁgure. Two ellipses are related to ECG and second derivative of PPG. The semi-major and semi-minor axes of ellipses represent SD2 and SD1, respectively. It can be seen that there are some samples in which, the results from PPG is closer to ECG-HRV samples than the ones derived from second derivative of PPG.
Table I shows the HRV parameters for 18 subjects. HRV analysis is done for beat-to-beat intervals obtained from ECG, as ground truth, PPG and its second derivative. The relative errors (in percentage) for HRV parameters are shown in Table II. It can be seen that the accuracy of the HRV parameters varies between individuals. In some cases pNN50 is the most affected parameter (e.g. in subjects 2, 8, 12) while in subject 3 pNN50 has less error than rMSSD and SD1. Although, pNN50 has the largest error (can be seen from the mean values) with the mean relative error of 29.89% and 42.75% for beat-to-beat interval obtained from maximum of PPG and its second derivative, respectively. On the other hand, mean of relative errors for other HRV parameters are small. This table also indicates that in most cases the error for HRV parameters from the second derivative of PPG is larger than the error of those derived from PPG, except for a few cases.
IV. CONCLUSIONS
In this work, PPG signal measured from a ﬁnger has been studied as an alternative for ECG in HRV analysis. The study is done on 19 healthy male subjects. In addition,

TABLE II RELATIVE ERROR FOR HRV PARAMETERS OBTAINED FROM PPG AND
ITS SECOND DERIVATIVE (PPG*). ALL THE VALUES ARE IN PERCENTAGE. THE LAST ROW INDICATES THE MEAN ERROR VALUE FOR
EACH METHOD AND EACH HRV PARAMETER.

Method SDNN rMSSD pNN50 SD1 SD2

P1

PPG 0.70 3.33 12.00 3.33 0.42 PPG* 2.38 12.40 72.00 12.40 1.33

P2

PPG 5.38 8.74 199.98 8.74 4.78 PPG* 8.92 17.85 199.98 17.85 7.27

P3

PPG 4.63 6.83 PPG* 4.93 6.31

2.60 5.90

6.83 4.00 6.31 4.49

P4

PPG 1.25 1.53 PPG* 2.88 4.41

3.95 7.89

1.53 1.16 4.41 2.39

P5

PPG 3.30 3.22 PPG* 7.62 6.78

5.30 3.22 2.89 10.29 6.78 6.96

P6

PPG 3.34 4.80 PPG* 4.06 6.21

50.46 4.80 3.15 25.39 6.21 3.86

P7

PPG 3.31 4.59 PPG* 0.66 0.74

21.78 4.59 3.15 6.55 0.74 0.86

P8

PPG 3.32 10.21 17.91 10.21 1.88 PPG* 3.54 9.83 19.98 9.83 2.17

P9

PPG 2.40 6.42 PPG* 2.55 4.25

6.46 3.42

6.42 1.77 4.25 2.23

P10

PPG 0.05 PPG* 1.49

1.94 3.23

20.41 1.94 0.21 18.37 3.23 1.22

P11

PPG 2.13 PPG* 6.47

2.89 28.71

90.58 2.89 2.52 270.00 28.71 4.43

P12

PPG 0.51 PPG* 3.46

6.72 4.14

20.21 6.72 0.35 24.66 4.14 3.41

P13

PPG 0.25 PPG* 2.87

1.95 13.87

0.00 0.00

1.95 0.31 13.88 2.38

P14

PPG 4.74 PPG* 5.35

12.47 10.82

37.14 51.43

12.47 1.00 10.82 2.39

P15

PPG 1.06 PPG* 2.41

0.44 4.18

7.27 0.44 1.12 14.55 4.18 2.24

P16

PPG 0.21 PPG* 1.39

0.57 5.30

5.66 0.57 0.25 24.53 5.30 1.05

P17

PPG 2.26 PPG* 3.17

5.80 6.77

36.36 5.81 2.77 13.64 6.79 3.75

P18

PPG 5.54 PPG* 5.54

17.52 16.93

0.00 0.00

17.52 4.32 16.93 4.46

Mean

PPG PPG*

2.47 3.87

5.55 9.04

29.89 5.56 2.00 42.75 9.04 3.16

two different locations for ﬁnding the ﬁducial points are considered in PPG. Some common HRV parameters have been calculated for each method and compared with the ones obtained from ECG to validate the accuracy of PPG based HRV monitoring. In our study, the largest error was obtained for pNN50 parameter with the relative error of 29.89%. The errors for the other HRV parameters were less than 6%.
Choosing PPG for HRV analysis depends on the application and the margins deﬁned for categorizing the status of the person being monitored. In addition, HRV parameters are affected by age, gender and are measure-dependent patterns. These variations might have a different impact on PPG (e.g. changing the pulse transit time by age, because of the variation of the stiffness of the arteries) which may complicate the analysis.
In addition, using second derivative of PPG did not give

any better results in our trial; even though opposite results
have been reported earlier [10]. This issue probably depends
on the subjects and measurement speciﬁcations and need
further evaluation.
The most important parts of the future work would be
evaluation of other ways to deﬁne the peak location in the
PPG signal and also to evaluate the accuracy of PPG based
HRV parameters with elderly as well cardiovascular patients.
REFERENCES
[1] M. Bolanos, H. Nazeran, and E. Haltiwanger, ”Comparison of Heart Rate Variability Signal Features Derived from Electrocardiography and Photoplethysmography in Healthy Individuals,” in 28th Ann. Int. Conf. IEEE Engineering in Medicine and Biology Society, 2006. EMBS 06, pp. 42894294.
[2] N. Selvaraj, A. Jaryal, J. Santhosh, K. K. Deepak, and S. Anand, ”Assessment of heart rate variability derived from ﬁnger-tip photoplethysmography as compared to electrocardiography,” J. Med. Eng. Technol., vol. 32, no. 6, pp. 479-484, Dec. 2008.
[3] S. Lu, H. Zhao, K. Ju, K. Shin, M. Lee, K. Shelley, and K. H. Chon, ”Can photoplethysmography variability serve as an alternative approach to obtain heart rate variability information?,” J. Clin. Monit. Comput., vol. 22, no. 1, pp. 23-29, Feb. 2008.
[4] W. Johnston and Y. Mendelson, ”Extracting heart rate variability from a wearable reﬂectance pulse oximeter,” in Bioengineering Conf., 2005. Proc. IEEE 31st Ann. Northeast, pp. 157-158.
[5] V. S. Murthy, S. Ramamoorthy, N. Srinivasan, S. Rajagopal, and M. M. Rao, ”Analysis of photoplethysmographic signals of cardiovascular patients,” in Proc. 23rd Ann. Int. Conf. IEEE Engineering in Medicine and Biology Society, 2001, vol. 3, pp. 2204-2207.
[6] X. F. Teng and Y. T. Zhang, ”Study on the peak interval variability of photoplethysmogtaphic signals,” in IEEE EMBS Asian-Paciﬁc Conf. Biomedical Engineering, 2003, pp. 140141.
[7] F. C. Chang, C. K. Chang, C. C. Chiu, S. F. Hsu, and Y. D. Lin, ”Variations of HRV analysis in different approaches,” in Computers in Cardiology, 2007, pp. 17-20.
[8] I. Constant, D. Laude, I. Murat, and J. L. Elghozi, ”Pulse rate variability is not a surrogate for heart rate variability,” Clinical Science, vol. 97, no. 4, pp. 391-397, Oct. 1999.
[9] G. Lu and F. Yang, ”Limitations of Oximetry to Measure Heart Rate Variability Measures,” Cardiovascular Engineering, vol. 9, no. 3, pp.119-125, Sep. 2009.
[10] Y. C. Chiu, P. W. Arand, S. G. Shroff, T. Feldman, and J. D. Carroll, ”Determination of pulse wave velocities with computerized algorithms,” American heart journal , vol. 121, no. 5, pp. 1460-1470, May 1991.
[11] M. P. Tarvainen, J.-P. Niskanen, J. A. Lipponen, P. O. Ranta-aho, P. A. Karjalainen, ”Kubios HRV - A Software for Advanced Heart Rate Variability Analysis,” in 4th European Conf. Int. Federation for Medical and Biological Engineering, vol. 22, pp. 1022-1025, 2009.
[12] M. Peltokangas, A. Vehkaoja, J. Verho, M. Huotari, J. Roning, and J. Lekkala, ”Monitoring Arterial Pulse Waves With Synchronous Body Sensor Network,” IEEE Journal of Biomedical and Health Informatics, vol. 18, no. 6, pp. 1781-1787, Nov. 2014.
[13] I. Daskalov and I. Christov, ”Improvement of resolution in measurement of electrocardiogram RR intervals by interpolation,” Medical Engineering & Physics, vol. 19, no. 4, pp. 375-379, June 1997.
[14] J. Pan and W. J. Tompkins, ”A real-time QRS detection algorithm,” IEEE Trans. Biomed. Eng., vol. BME-32, no. 3, pp. 230-236, Mar. 1985.
[15] T. F. of the European Society of Cardiology the North American Society of Pacing Electrophysiology, ”Heart Rate Variability: Standards of Measurement, Physiological Interpretation, and Clinical Use,” Circulation, Vol. 93, No. 5, pp. 1043-1065, Mar. 1996.

