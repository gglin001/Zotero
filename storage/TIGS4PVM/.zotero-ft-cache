兰州理工大学 博士学位论文 心电波形检测与心率变异性分析方法研究 姓名：董红生 申请学位级别：博士 专业：控制理论与控制工程 指导教师：郝晓弘；张爱华
20120606

、！州瑚Ｔ人学博ｆｊ学ｆ？，沦文
摘要
，ｔＬ，电信号和心率变异信号蕴含着丰富的心脏及其神经系统活动信息，对这些信息的 提取和处理在心脏疾病的预防、诊断和治疗等方面具有重要的意义。论义在前人研究成 果的基础上，开展了心电信号预处理、心电特征波检测及心率变异性分析的研究工作。
本文简要阐述了ＥＣＧ信号及ＨＲＶ信号的生理机理、典型特征信息及其临床诊断意 义，综述了目前心电信号预处理、心电特征波形识别及特征信息提取、ＨＲＶ信号分析的 国内外研究现状。针对典型的ＥＣＧ和ＨＲＶ分析方法存在的一些不足，采用新的信号分 析手段，在改进和创新ＥＣＧ和ＨＲＶ分析方法上进行了研究尝试，取得了一些有价值的 研究成果，对于开发研制新型心电分析系统有重要意义。论文主要的研究成果包括以下 几个方面：
１）针对小波变换的阀值去噪易在心电信号的Ｑ、Ｓ波处出现Ｇｉｂｂｓ振荡现象及消除 基线漂移时可能导致Ｔ波、ＳＴ段波形形态失真的问题，提出了将平稳小波变换和自适 应滤波方法相结合的一次性ＥＣＧ消噪方法。算法在低尺度分量上通过阈值去噪方法滤 除心电的工频和肌电等干扰，在高尺度分量上引入自适应滤波算法滤除基线漂移，重构 后很好地保持了ＥＣＧ的波形形态，达到了一次性消噪的目的。仿真实验表明算法有效 地克服了Ｇｉｂｂｓ震荡现象，降低了心电信号Ｔ波、ＳＴ段波形滤波后的失真度，为提取 准确的心电特征信息奠定了基础。
２）提出了非线性能量算子和小波分解相结合的Ｒ波检测算法。该算法采用Ｍａｒｒｄｘ波 为基本小波，通过检测３尺度分量的极值点标定Ｒ波的位置，既有效地抑制了噪声干扰的 影响，又克服了传统样条小波变换Ｒ波检测需定位过零点的不便。对３尺度分量引入平滑 非线性能量算子运算，突出了Ｒ波尖峰，抑制了高大Ｔ波、大Ｐ波对Ｒ检测的影响，与传 统小波变换的Ｒ波检测算法相比，算法的检测率高、抗干扰能力强、计算量小、实时性 好，对ＭＩＴ－ＢＩＨ的心律失常数据库的实际心电数据的仿真实验表明了算法的有效性。
３）提出了基于Ｈｉｌｂｅｒｔ时频谱的ＨＲＶ信号的时频分析方法。通过分析不同生理病 理状况下ＨＲＶ信号的Ｈｉｌｂｅｒｔ时频谱的差异，依据短时程ＨＲＶ信号的频域指标，在不 同生理频带上绘制Ｈｉｌｂｅｒｔ能量棒形图，提取了各频带能量特征作为定量评价心率变异 性的时频特征，分析了心率改变和时频特征的相关性，指出心率改变是ＨＲＶ信号分析 应考虑的一个重要因素。通过对年轻人和老年人、健康人和心衰病人样本数据的统计分 析表明提取的时频特征有很好的区分性能，准确地反映了心脏的交感和迷走神经系统的 调控作用及受损状况。
４）采用改进的ＨＨＴ分析方法对室速或室颤事件的发生进行预测分析。首先，将心 脏复律除颤器存储的室速或室颤事件发作前的ＲＲ间期序列变换为瞬时心率信号，利用 小波包变换将其预分解为几个窄带信号，然后对各窄带分量信号进行ＥＭＤ分解，通过相 关性阈值判别剔除虚假模态分量后获取瞬时心率信号的Ｈｉｌｂｅｒｔ边际谱，并提取各生理频

段幅值特征作为室速或室颤事件预测特征。仿真实验表明室速或室颤事件发作前瞬时心 率信号的高频、甚高频幅值及总幅值较正常窦性心率信号显著升高，而低高频幅值比显 著降低。提示室速或室颤事件发作前心脏交感和迷走神经活动均有所增强，以迷走神经 活动增强更为显著，引起心脏自主神经系统调节失衡。统计分析结果显示改进的ＨＨＴ方 法谱特征的区分性能明显优于传统的ＨＨＴ方法。
５）提出了ＨＨＴ的边际谱熵及能量谱熵的概念及分析方法。通过对混有不同程度白 噪声的常规信号和混沌时间序列复杂性的分析，显示出边际谱熵和能量谱熵在刻画信号 复杂度变化、抗脉冲干扰性能优于传统复杂度和熵分析方法，应用于年轻人、老年人及 房颤病人的ＨＲＶ信号分析，两种频域谱熵能从ＨＲＶ信号中敏感地检测出生理和病理状 态的变化，分析性能优于传统的功率谱熵的方法。
６）提出了基于分频段Ｈｉｌｂｃｒｔ时频谱熵的ＨＲＶ信号的分析方法。通过提取不同生 理频段的Ｈｉｌｂｅｒｔ谱熵作为心率变异性的特征评价指标。Ｈｉｌｂｅｒｔ谱熵特征反映了ＨＲＶ信 号能量在时频域分布的不确定性，而按频段适当分离各种生理因素的Ｈｉｌｂｅｒｔ谱熵和不 同的生理病理机理联系紧密，有利于表征心脏自主神经系统的调控规律。通过对年轻人、 老年人及房颤病人和健康人、充血性心力衰竭病人的ＨＲＶ信号的仿真分析表明，算法 有效地区分了各样本组，准确反映了不同生理病理状况下的心脏交感神经和迷走神经调 节的变化规律。
论文最后对课题的研究工作进行了总结，并对今后研究提出了设想。
关键词：心电信号；预处理；特征波形识别；心率变异性；特征提取 课题研究得到国家自然科学基金项目（编号：３０６７０５２９）和国家自然科学基金项目（编号：１１０７２０９９）
的资助。
Ｉｌ

≥州理Ｔ人学博Ｉｊ学ｆ？，沦文

Ａｂ ｓｔｒａｃｔ

Ａ ｌａｒｇｅ ａｍｏｕｎｔ ｏｆ ｉｎｆｏｒｍａｔｉｏｎ ａｂｏｕｔ ｈｅａｒｔ ｆｕｎｃｔｉｏｎ ａｎｄ ｉｔｓ ｎｅｒｖｏｕｓ ａｃｔｉｖｉｔｙ ｉｓ ｃｏｎｔａｉｎｅｄ
ｉｎ ＥＣＧ ａｎｄ ＨＲＶ ｓｉｇｎａｌ．Ｔｈｅｒｅｆｏｒｅ，ｉｔ ｉｓ ｇｒｅａｔｌｙ ｓｉｇｎｉｆｉｃａｎｔ ｔｏ ｅｘｔｒａｃｔ ａｎｄ ｐｒｏｃｅｓｓ ｔｈｅ
ｉｎｆｏｒｍａｔｉｏｎ ｆｏｒ ｔｈｅ ｐｒｅｖｅｎｔｉｏｎ，ｄｉａｇｎｏｓｉｓ ａｎｄ ｔｈｅｒａｐｙ ｅｔｃ．ｏｆ ｈｅａｒｔ ｄｉｓｅａｓｅ．Ｔｈｅ ｔｈｅｓｉｓ ｍａｉｎｌｙ

ｄｉｓｃｕｓｓｅｓ ｔｈｅ ＥＣＧ ｐｒｅｐｒｏｃｅｓｓｉｎｇ，ｆｅａｔｕｒｅ ａｎａｌｙｓｉｓ ａｎｄ ｈｅａｒｔ ｒａｔｅ ｖａｒｉａｂｉｌｉｔｙ，ｗｈｉｃｈ ｉｓ ｂａｓｅｄ ｏｎ

ｔｈｅ ｐｒｅｄｅｃｅｓｓｏｒｓ’ｒｅｓｅａｒｃｈ ｒｅｓｕｌｔｓ ａｎｄ ｌｉｔｅｒａｔｕｒｅ ｍａｔｅｒｉａｌ．
Ｔｈｅ ｐｈｙｓｉｏｌｏｇｉｃ ｐｒｉｎｃｉｐｌｅ ａｎｄ ｍｅｃｈａｎｉｓｍ，ｔｙｐｉｃａｌ ｆｅａｔｕｒｅ ａｎｄ ｃｌｉｎｉｃａｌ ｄｉａｇｎｏｓｔｉｃ ｖａｌｕｅ ｏｆ ＥＣＧ ａｎｄ ＨＲＶ ｓｉｇｎａｌ ａｒｅ ｂｒｉｅｆｌｙ ｉｌｌｕｓｔｒａｔｅｄ ｉｎ ｔｈｉｓ ｔｈｅｓｉｓ；ｔｈｅ ｐｒｅｓｅｎｔ ｄｅｖｅｌｏｐｉｎｇ ｓｔａｔｕｓ ｏｆ

ｐｒｅｐｒｏｃｅｓｓ ｍｅｔｈｏｄｓ ｏｆ ＥＣＧ ｓｉｇｎａｌ ａｎｄ ｔｈｅ ｍｅｔｈｏｄｓ ｏｆ ｆｅａｔｕｒｅ ｗａｖｅｆｏｒｍ ｒｅｃｏｇｎｉｔｉｏｎ ｏｆ ＥＣＧ
ｓｉｇｎａｌ ａｎｄ ＨＲＶ ａｎａｌｙｓｉｓ ｍｅｔｈｏｄｓ ａｒｅ ｓｕｍｍａｒｉｚｅｄ．Ａｃｃｏｒｄｉｎｇ ｔｏ ｔｈｅ ｅｘｉｓｔｉｎｇ ｄｅｆｉｃｉｅｎｃｉｅｓ ｏｆ ｔｈｅ ｔｙｐｉｃａｌ ａｎａｌｙｓｉｓ－ａｌｇｏｒｉｔｈｍ，ｓｏｍｅ ｓｔｕｄｉｅｓ ｈａｖｅ ｂｅｅｎ ｔｒｉｅｄ ｔｏ ｉｍｐｒｏｖｅ ａｎｄ ｉｎｎｏｖａｔｅ ｔｈｅ ａｎａｌｙｓｉｓ ｍｅｔｈｏｄｓ ｏｆ ＥＣＧ ａｎｄ ＨＲＶ ｓｉｇｎａｌ ｂａｓｅｄ ｏｎ ｔｈｅ ｎｅｗ ｓｉｇｎａｌ ａｎａｌｙｓｉｓ ｍｅｔｈｏｄｓ，ａｎｄ ｓｏｍｅ ｒｅｓｅａｒｃｈ ｏｕｔｃｏｍｅｓ ｈａｖｅ ｂｅｅｎ ｏｂｔａｉｎｅｄ，ｗｈｉｃｈ ｔｕｒｎｓ ｏｕｔ ｔｏ ｂｅ ｓｉｇｎｉｆｉｃａｎｔ ｔｏ ｄｅｖｅｌｏｐ ｎｅｗ

ＥＣＧ ａｕｔｏｍａｔｉｃ ａｎａｌｙｓｉｓ ｓｙｓｔｅｍ．Ｉｔ ｍａｉｎｌｙ ｉｎｃｌｕｄｅｓ ｔｈｅ ｆｏｌｌｏｗｉｎｇ ｒｅｓｅａｒｃｈ ｗｏｒｋｓ：

，

１）Ａｓ ｔｏ ｔｈｅ ｄｅ—ｎｏｉｓｉｎｇ ｍｅｔｈｏｄ ｏｆ ｗａｖｅｌｅｔ ｔｈｒｅｓｈｏｌｄ，Ｇｉｂｂｓ ｏｓｃｉｌｌａｔｏｒｙ ｐｈｅｎｏｍｅｎａ ｅａｓｉｌｙ ｏｃｃｕｒｓ ｉｎ Ｑ，Ｓ ｗａｖｅｆｏｒｍ ｏｆ ＥＣＧ ｓｉｇｎａｌ ａｎｄ ｔｈｅ ｓｅｒｉｏｕｓ ｄｉｓｔｏｒｔｉｏｎ ｆｏｒ Ｔ ｗａｖｅｆｏｒｍ ａｎｄ ＳＴ

ｓｅｇｍｅｎｔ ｗａｖｅｆｏｒｍ ｏｆ ＥＣＧ ｓｉｇｎａｌ ｃａｎ ｂｅ ｅａｓｉｌｙ ｃａｕｓｅｄ ｗｈｅｎ ｂａｓｅｌｉｎｅ ｄｒｉｆｔ ｉｓ ｅｌｉｍｉｎａｔｅｄ．Ｔｏ
ｓｏｌｖｅ ｔｈｉｓ ｐｒｏｂｌｅｍ，ｔｈｅ ｏｎｅ－ｏｆｆ ｄｅｎｏｉｓｉｎｇ ｍｅｔｈｏｄ ｏｆ ＥＣＧ ｓｉｇｎａｌ ｃｏｍｂｉｎｉｎｇ ｓｔａｔｉｏｎａｒｙ ｗａｖｅｌｅｔ
ｔｒａｎｓｆｏｒｍ ａｎｄ ａｄａｐｔｉｖｅ ｆｉｌｔｅｒ ｉｓ ｐｒｏｐｏｓｅｄ．Ｔｈｅ ｐｏｗｅｒ－ｌｉｎｅ ｉｎｔｅｒｆｅｒｅｎｃｅ ａｎｄ ＥＭＧ ｎｏｉｓｅ ｉｓ

ｅｌｉｍｉｎａｔｅｄ ｂａｓｅｄ ｏｎ ｔｈｅ ｄｅ－ｎｏｉｓｉｎｇ ｍｅｔｈｏｄ ｏｆ ｗａｖｅｌｅｔ ｔｈｒｅｓｈｏｌｄ ｉｎ ｌｏｗ ｓｃａｌｅ ｄｅｃｏｍｐｏｓｉｔｉｏｎ

ｃｏｍｐｏｎｅｎｔ．ａｎｄ ｔｈｅ ａｄａｐｔｉｖｅ ｆｉｌｔｅｒ ｉｓ ｉｎｔｒｏｄｕｃｅｄ ＳＯ ａＳ ｔｏ ｅｌｉｍｉｎａｔｅ ｂａｓｅｌｉｎｅ ｄｒｉｆｔ ｉｎ ｌａｒｇｅ ｓｃａｌｅ

ｒｅｍａｉｎ ｄｅｃｏｍｐｏｓｉｔｉｏｎ ｃｏｍｐｏｎｅｎｔ，ｔｈｅ ＥＣＧ ｗａｖｅｆｏｒｒｎ ｆｏｒｍ

ｗｅｌｌ ａｆｔｅｒ ｔｈｅ ｒｅｃｏｎｓｔｒｕｃｔｉｏｎ，ｔｈｅ

ｏｎｅ－ｏｆｆ ｄｅｎｏｉｓｉｎｇ ｉｓ ａｃｈｉｅｖｅｄ．Ｓｉｍｕｌａｔｉｏｎ ａｎｄ ｃｏｍｐａｒｉｓｏｎ ｔｅｓｔ ｒｅｓｕｌｔ ｓｈｏｗｓ ｔｈａｔ ｔｈｉｓ

ｓｙｎｔｈｅｔｉｃａｌ ｆｉｌｔｅｒ Ｃａｎ ａｖｏｉｄ Ｇｉｂｂｓ ｏｓｃｉｌｌａｔｏｒｙ ｐｈｅｎｏｍｅｎａ ｅｆｆｅｃｔｉｖｅｌｙ ａｎｄ ｒｅｄｕｃｅ ｔｈｅ ｄｉｓｔｏｒｔｉｏｎ

ｆｏｒ Ｔ ｗａｖｅｆｏｒｍ ａｎｄ ＳＴ ｓｅｇｍｅｎｔ ｗａｖｅｆｏｒｍ ｏｆ ＥＣＧ ｓｉｇｎａｌ，ｗｈｉｃｈ ｌａｉｄ ｆｏｕｎｄａｔｉｏｎ ｆｏｒ ａｃｃｕｒａｔｅ

ｆｅａｔｕｒｅ ｉｎｆｏｒｍａｔｉｏｎ ｅｘｔｒａｃｔｉｏｎ ｏｆ ＥＣＧ ｓｉｇｎａｌ．
２）Ｔｈｅ ｃｏｍｂｉｎａｔｉｏｎ ａｌｇｏｒｉｔｈｍ ｏｆ ｗａｖｅｌｅｔ ｔｒａｎｓｆｏｒｍ ａｎｄ ｎｏｎｌｉｎｅａｒ ｅｎｅｒｇｙ ｏｐｅｒａｔｏｒ ｉｓ

ｐｒｏｐｏｓｅｄ ｆｏｒ Ｒ ｗａｖｅｆｏｒｍ ｄｅｔｅｃｔｉｏｎ ｏｆ ＥＣＧ ｓｉｇｎａｌ，ｗｈｉｃｈ ｕｓｅｓ Ｍａｒｒ ｗａｖｅｌｅｔ ａｓ ｗａｖｅｌｅｔ ｂａｓｉｓ．
Ｔｈｒｏｕｇｈ ｄｅｍａｒｃａｔｉｎｇ ｔｈｅ ｌｏｃａｔｉｏｎ ｏｆ Ｒ ｗａｖｅｆｏｒｍ ｂｙ ｔｈｅ ｅｘｔｒｅｍｅ ｖａｌｕｅ ｐｏｉｎｔ ｏｎ ３ ｓｃａｌｅ
ｃｏｍｐｏｎｅｎｔ ｏｆ ｗａｖｅｌｅｔ ｄｅｃｏｍｐｏｓｉｔｉｏｎ，ｔｈｅ ｅｆｆｅｃｔ ｏｆ ｎｏｉｓｅ ｉｓ ｅｆｆｅｃｔｉｖｅｌｙ ｒｅｓｔｒａｉｎｓ，ａｎｄ ｔｈｅ ｄｉｓａｄｖａｎｔａｇｅ ｔｈａｔ ｔｈｅ ｌｏｃａｔｉｏｎ ｏｆ Ｚｅｒｏ—ｃｒｏｓｓｉｎｇｓ ａｒｅ ｎｅｅｄｅｄ ｆｏｒ Ｒ ｗａｖｅｆｏｒｍ ｄｅｔｅｃｔｉｏｎ ｂｙ
ｓｐｌｉｎｅ ｗａｖｅｌｅｔ ｔｒａｎｓｆｏｒｍ ｉｓ ｏｖｅｒｃｏｍｅ．Ｓｍｏｏｔｈ ｎｏｎｌｉｎｅａｒ ｅｎｅｒｇｙ ｏｐｅｒａｔｏｒ ｉｓ ｏｐｅｒａｔｅｄ ｏｎ ３
ｓｃａｌｅ ｃｏｍｐｏｎｅｎｔ ＳＯ ａｓ ｔｏ ｐｒｏｔｒｕｄｅ Ｒ ｗａｖｅｆｏｒｍ ｐｅａｋ ａｎｄ ｓｕｐｐｒｅｓｓ ｈｉｇｈ Ｔ ｗａｖｅｆｏｒｍ ａｎｄ Ｐ ｗａｖｅｆｏｎｎ．Ｉｎ ｃｏｍｐａｒｉｓｏｎ ｗｉｔｈ ｔｈｅ Ｒ ｗａｖｅｆｏｎｎ ｄｅｔｅｃｔｉｏｎ ｍｅｔｈｏｄ ｏｆ ｔｒａｄｉｔｉｏｎａｌ ｗａｖｅｌｅｔ

ＩＩＩ

ｔｒａｎｓｆｏｒｍ，ｔｈｅ ｍｅｔｈｏｄ ｓｈｏｗｓ ｈｉｇｈ ｄｅｔｅｃｔｉｏｎ ｒａｔｅ，ｂｅｔｔｅｒ ａｂｉｌｉｔｙ ｔｏ ａｎｔｉ．ｉｎｔｅｒｆｅｒｅｎｃｅ．ｍｕｃｈ Ｉｅｓｓ
ｃｏｍｐｕｔａｔｉｏｎ ａｎｄ ｇｏｏｄ ｒｅａｌ—ｔｉｍｅ ｐｅｒｆｏｒｍａｎｃｅ．Ｓｉｍｕｌａｔｉｏｎ ｔｅｓｔ ｓｈｏｗｓ ｔｈａｔ ｔｈｅ ｍｅｔｈｏｄ ｉｓ

ｅｆｆｅｃｔｉｖｅ ｆｏｒ ａｃｔｕａｌ ＥＣＧ ｄａｔａ ｉｎ ｔｈｅ ＭＩＴ／ＢＩＨ ａｒｒｈｙｔｈｍｉａ ｄａｔａ．

３）Ａ ｔｉｍｅ－ｆｒｅｑｕｅｎｃｙ ａｎａｌｙｓｉｓ ｍｅｔｈｏｄ ｉｓ ｐｒｏｐｏｓｅｄ ｆｏｒ ＨＲＶ ｓｉｇｎａｌ ｂａｓｅｄ ｏｎ Ｈｉｌｂｅｒｔ

ｔｉｍｅ‘ｆｒｅｑｕｅｎｃｙ ｓｐｅｃｔｒｕｍ．Ｔｈｅ ｍｅｔｈｏｄ ａｎａｌｙｚｅｓ ｔｈｅ ｄｉｆｆｅｒｅｎｃｅ ｏｆ Ｈｉｌｂｅｒｔ ｔｉｍｅ．ｆｒｅｑｕｅｎｃｙ ｓｐｅｃｔｒｕｍ ｆｏｒ ＨＲＶ ｓｉｇｎａｌ ｕｎｄｅｒ ｄｉｆｆｅｒｅｎｔ ｐｈｙｓｉｏｌｏｇｉｃａｌ ｏｒ ｐａｔｈｏｌｏｇｉｃａｌ ｃｏｎｄｉｔｉｏｎｓ，ａｎｄ ｔｈｅ

Ｈｉｌｂｅｒｔ ｅｎｅｒｇｙ ｂａｒ ｃｈａｒｔ ｏｆ ＨＲＶ ｓｉｇｎａｌ ｉｓ ｐｌｏｔｔｅｄ ｉｎ ｔｈｅ ｄｉｆｆｅｒｅｎｔ ｐｈｙｓｉｏｌｏｇｉｃａｌ ｆｒｅｑｕｅｎｃｙ ｂａｎｄ ｂｙ ｍｅ ｃｈａｒａｃｔｅｒｉｓｔｉｃ ｉｎｄｅｘ ｏｆ ｓｈｏｒｔ－ｔｉｍｅ ＨＲＶ ｓｉｇｎａｌ ｉｎ ｔｈｅ ｌｉｎｅａｒ ｆｒｅｑｕｅｎｃｙ ｄｏｍａｉｎ．ｔｈｅ
ｅｎｅｒｇｙ ｆｅａｔｕｒｅｓ ａｒｅ ｅｘｔｒａｃｔｅｄ ｉｎ ｔｈｅ ｄｉｆｆｅｒｅｎｔ ｐｈｙｓｉｏｌｏｇｉｃａｌ ｆｒｅｑｕｅｎｃｙ ｂａｎｄ ａｓ ｔｈｅ

ｔｉｍｅ·ｆｒｅｑｕｅｎｃｙ ｆｅａｔｕｒｅ ｏｆ ｑｕａｎｔｉｔａｔｉｖｅ ｅｖａｌｕａｔｉｎｇ ｆｏｒ ｈｅａｒｔ ｒａｔｅ ｖａｒｉａｂｉｌｉｔｙ，ｔｈｅ ｃｏｒｒｅｌａｔｉｏｎ ｂｅｔｗｅｅｎ ｔｈｅ ｈｅａｒｔ ｒａｔｅ ｃｈａｎｇｅ ａｎｄ ｔｈｅ ｔｉｍｅ－ｆｒｅｑｕｅｎｃｙ ｆｅａｔｕｒｅｓ ｉｓ ｓｔｕｄｉｅｄ ｉｎ ｔｈｉｓ ｐａｐｅｒ，ａｎｄ

ｐｏｉｎｔｓ ｏｕｔ ｔｈａｔ ｔｈｅ ｃｈａｎｇｅ ｏｆ ｈｅａｒｔ ｒａｔｅ ｉｓ ａ ｉｍｐｏｒｔａｎｔ ｆａｃｔｏｒ ｃｏｎｓｉｄｅｒｅｄ ｉｎ ＨＲＶ ｓｉｇｎａｌ

ａｎａｌｙｓｉｓ．Ｓｉｍｕｌａｔｉｏｎ ｔｅｓｔｓ ｔｏ ＨＲＶ ｓｉｇｎａｌ ｏｆ ｔｈｅ ｙｏｕｎｇ，ｏｌｄ ａｎｄ ｈｅａｒｔ ｆａｉｌｕｒｅ ｐａｔｉｅｎｔｓ ｓｈｏｗ ｔｈａｔ

ｔｈｅ ｎｅｗ ｔｉｍｅ－ｆｒｅｑｕｅｎｃｙ ｆｅａｔｕｒｅｓ ｈａｖｅ ｇｏｏｄ ｄｉｆｆｅｒｅｎｔｉａｔｉｎｇ ｐｅｒｆｏｒｍａｎｃｅ，ａｎｄ Ｃａｎ ａｃｃｕｒａｔｅｌｙ ｒｅｆｌｅｃｔ ｔｈｅ ｒｅｇｕｌａｔｏｒｙ ｆｕｎｃｔｉｏｎ ａｎｄ ｄａｍａｇｅ ｏｆ ｓｙｍｐａｔｈｅｔｉｃ ａｎｄ ｖａｇａｌ ｎｅｒｖｏｕｓ ｓｙｓｔｅｍ ｏｆ ｈｅａｒｔ．

４）Ｔｈｅ ｖｅｎｔｒｉｃｕｌａｒ ｔａｃｈｙｃａｒｄｉａ（ＶＴ）ａｎｄ ｖｅｎｔｒｉｃｕｌａｒ ｆｉｂｒｉｌｌａｔｉｏｎ（ＶＦ）ｅｖｅｎｔ ｉｓ ｐｒｅｄｉｃｔｅｄ

ｂａｓｅｄ ｏｎ ｉｍｐｒｏｖｅｄ ＨＨＴ ｍｅｔｈｏｄ．Ｆｉｒｓｔｌｙ，ｔｈｅ ＲＲ ｉｎｔｅｒｖａｌ ｓｅｒｉｅｓ ｐｒｅｃｅｄｉｎｇ ｔｈｅ ｏｎｓｅｔ ｏｆ ＶＴ／ＶＦ ｅｖｅｎｔｓ ｉｓ ｔｒａｎｓｆｏｒｍｅｄ ｉｎｓｔａｎｔａｎｅｏｕｓ ｈｅａｒｔ ｒａｔｅ（ＩＨＲ）ｓｅｒｉｅｓ，ａｎｄ ｉｔ ｉＳ ｐｒｅ．ｄｅｃｏｍｐｏｓｅｄ ｉｎｔｏ ａ

ｓｅｒｉｅｓ ｏｆ ｎａｒｒｏｗ—ｂａｎｄｓ ｓｉｇｎａｌ ｂｙ ｗａｖｅｌｅｔ ｐａｃｋｅｔ ｔｒａｎｓｆｏｒｍ，ｔｈｅｎ ＥＭＤ ｄｅｃｏｍｐｏｓｉｔｉｏｎ ｉｓ

ｃａｒｒｉｅｄ ｏｕｔ ｆｏｒ ｅａｃｈ ｎａｒｒｏｗ－ｂａｎｄ ｃｏｍｐｏｎｅｎｔ，ｔｈｅ ｕｎｄｅｓｉｒａｂｌｅ ｃｏｍｐｏｎｅｎｔｓ ａｒｅ ｒｅｍｏｖｅｄ ｂｙ ｔｈｅ ｃｏｒｒｅｌａｔｉｏｎ ｔｈｒｅｓｈｏｌｄ ｉｄｅｎｔｉｆｉｃａｔｉｏｎ，ｔｈｅ ｎｅｗ ｉｎｔｒｉｎｓｉｃ ｍｏｄｅ ｆｕｎｃｔｉｏｎ（ＩＭＦ）ｃｏｍｐｏｎｅｎｔｓ ａｎｄ

ａｍｐｌｉｔｕｄｅ Ｈｉｌｂｅｒｔ ｍａｒｇｉｎａｌ ｓｐｅｃｔｒｕｍ ｏｆ ＩＨＲ ｓｅｒｉｅｓ ａｒｅ ｏｂｔａｉｎｅｄ，ｔｈｅ

ｆｅａｔｕｒｅｓ ｏｆ ｄｉｆｊｆ；ｅｆ铋ｔ

ｐｈｙｓｉｏｌｏｇｉｃａｌ ｆｒｅｑｕｅｎｃｙ ｂａｎｄ ａｒｅ ｅｘｔｒａｃｔｅｄ ｔｏ ｂｅ ｕｓｅｄ ｆｏｒ ｐｒｅｄｉｃｔｉｏｎ ｆｅａｔｕｒｅｓ ｏｆ ＶＴ／ＶＦ ｅｖｅｎｔｓ．

ａｍｐｌｉｔｕｄｅ Ｓｉｍｕｌａｔｉｏｎ ｔｅｓｔ ｓｈｏｗｓ ｔｈａｔ ｈｉｇｈ ｆｒｅｑｕｅｎｃｙ ａｍｐｌｉｔｕｄｅ，ｖｅｒｙ ｈｉｇｈ ｆｒｅｑｕｅｎｃｙ

ａｎｄ ｔｏｔａｌ

ａｍｐｌｉｔｕｄｅ ｏｆ ＩＨＲ ｓｅｒｉｅｓ ｐｒｅｃｅｄｉｎｇ ｔｈｅ ｏｎｓｅｔ ｏｆ＼１八僵ａｒｅ ｓｉｇｎｉｆｉｃａｎｔｌｙ ｈｉｇｈｅｌ＂ｔｈａｎ ｔｈａｔ ｏｆ

ｎｏｒｍａｌ ｓｉｎｕｓ ｒｈｙｔｈｍ，ａｎｄ ｌｏｗ－ｔｏ—ｈｉｇｈ ｆｒｅｑｕｅｎｃｙ ａｍｐｌｉｔｕｄｅ ｒａｔｉｏ ｉｓ ｓｉｇｎｉｆｉｃａｎｔｌｙ ｌｏｗｅｒ ｔｈａｎ

ｓｙｍｐａｔｈｅｔｉｃ ｔｈａｔ ｏｆ ｎｏｒｍａｌ ｓｉｎｕｓ ｒｈｙｔｈｍ．Ｉｔ ｓｕｇｇｅｓｔｓ ｔｈａｔ ｔｈｅ ａｃｔｉｖｉｔｙ ｏｆ

ａｎｄ ｖａｇａｌ ｎｅｒｖｅ

ｏｆ＼弋№ｅｖｅｎｔ。ａｎｄ ａｐｐｅａｒｓ ｔｏ ｉｎｃｒｅａｓｅ ｐｒｅｃｅｄｉｎｇ ｔｈｅ ｏｎｓｅｔ

ｔｈｅ ａｃｔｉｖｉｔｙ ｏｆ ｖａｇａｌ ｎｅｒｖｅ ｉｓ

ｍｏｒｅ ｍａｒｋｅｄ，ｗｈｉｃｈ ｃａｕｓｅｓ ｉｍｂａｌａｎｃｅ ｏｆ ｔｈｅ ｓｙｍｐａｔｈｅｔｉｃ ａｎｄ ｖａｇａｌ ｎｅｒｖｅ ａｃｔｉｖｉｔｙ．

Ｓｉｍｕｌａｔｉｏｎ ｔｅｓｔ ｉｓ ｃａｒｒｉｅｄ ｏｕｔ ｆｏｒ·ｔｈｅ ｉｍｐｒｏｖｅｄ ＨＨＴ ｍｅｔｈｏｄ ａｎｄ ｔｈｅ ｔｒａｄｉｔｉｏｎａｌ ＨＨＴ，ｔｈｅ

ｓｔａｔｉｓｔｉｃａｌ ａｎａｌｙｓｉｓ ｓｈｏｗ ｔｈａｔ ｔｈｅ ｄｉｆｆｅｒｅｎｔｉａｔｅｄ ｐｅｒｆｏｒｍａｎｃｅ ｏｆ ｔｈｅ ｉｍｐｒｏｖｅｄ ＨＨＴ ｉｓ ｍｏｆｅ

ｂｅｔｔｅｒ ｔｈａｎ ｔｈａｔ ｏｆ ｔｒａｄｉｔｉｏｎａｌ ＨＨＴ．

５）Ｔｈｅ ｃｏｎｃｅｐｔｉｏｎ ｏｆ ＨＨＴ ｍａｒｇｉｎａｌ ｓｐｅｃｔｒｕｍ ｅｎｔｒｏｐｙ ａｎｄ ｅｎｅｒｇｙ ｓｐｅｃｔｒｕｍ ｅｎｔｒｏｐｙ ａｎｄ ｔｈｅ ａｎａｌｙｓｉｓ ｍｅｔｈｏｄ ｏｆ ＨＲＶ ｓｉｇｎａｌ ａｒｅ ｐｒｏｐｏｓｅｄ．Ｔｈｅ ｃｏｍｐｌｅｘｉｔｙ ａｎａｌｙｓｉｓ ｉｓ ｐｒｏｃｅｓｓｅｄ ｆｏｒ ｔｈｅ
ｃｏｎｖｅｎｔｉｏｎａｌ ｓｉｇｎａｌ ｗｉｔｈ ｓｏｍｅ ｄｅｇｒｅｅ ｏｆ ｗｈｉｔｅ ｎｏｉｓｅ ａｎｄ ｃｈａｏｔｉｃ ｔｉｍｅ ｓｅｒｉｅｓ．Ｔｈｅ ｒｅｓｕｌｔｓ ｓｈｅＷ

ＩＶ

ｔｈａｔ ｔｈｅ ｍｅｍｏｄ ｉｓ ｓｕｐｅｒｉｏｒ ｔｏ ｔｈｅ ａｎａｌｙｓｉｓ ｍｅｔｈｏｄ ｏｆ ｔｈｅ ｔｒａｄｉｔｉｏｎａｌ ｃｏｍｐｌｅｘｉｔｙ ａｎｄ ｅｎｔｒｏｐｙ ｍ ｄｅｐｉｃｔｉｎｇ ｓｉｇｎａｌ ｃｏｍｐｌｅｘｉｔｙ ａｎｄ ａｎｔｉ．ｐｕｌｓｅ ｉｎｔｅｒｆｅｒｅｎｃｅ．Ａｐｐｌｙｉｎｇ ｔｈｅ ｎｅｗ ａｐｐｒｏａｃｈ ｔｏ ＨＲｖ ｓｉｇｎａｌ ｏｆ ｔｈｅ ｙｏｕｎｇ，ｏｌｄｅｒ ａｎｄ ａｔｒｉａｌ ｆｉｂｒｉｌｌａｔｉｏｎ ｐａｔｉｅｎｔｓ，ｔｈｅ ｒｅｓｕｌｔｓ ｓｈｏｗ ｔｈａｔ ｔｈｅ ｔ、７Ｉｒｏ ｅｎ仃ｏｐｙ ｏｆ行ｅｑｕｅＩｌｃｙ ｄｏｍａｉｎ Ｃａｎ ｓｅｎｓｉｔｉｖｅｌｙ ｄｅｔｅｃｔ ｔｈｅ ｐｈｙｓｉｏｌｏｇｉｃａｌ ａｎｄ ｐａｔｈｏｌｏｇｉｃａｌ ｃｈａｎｇｅｓ ｔｒｏｍ ＨＲＶ ｓｉｇｎａｌ．ａｎｄ ｉｔｓ ａｎａｌｙｔｉｃａｌ ｐｅｒｆｏｒｍａｃｅ ｉｓ ｂｅｔｔｅｒ ｔｈａｎ ｔｈａｔ ｏｆ ｔｈｅ ｔｒａｄｉｔｉｏｎａｌ ｐｏｗｅｒ ｓｐｅｃ仃ｕｍ

ｅｎｔｒｏｐｙ ｍｅｔｈｏｄ．

６、Ｔｈｅ ｎｅｗ ｍｅｔｈｏｄ ｏｆ ＨＲＶ ｓｉｇｎａｌ ａｎａｌｙｓｉｓ ｉｓ ｐｒｏｐｏｓｅｄ ｂａｓｅｄ ｏｎ ｔｈｅ Ｈｉｌｂｅｒｔ ｓｐｅｃｔｎ眦

ｅｎｔｒｏｐｙ ｄｉｖｉｄｉｎｇ ｆｒｅｑｕｅｎｃｙ ｒａｎｇｅ．ｔｈｅ Ｈｉｌｂｅｒｔ ｓｐｅｃｔｒｕｍ ｅｎｔｒｏｐｙ ｏｆ ＨＲＶ ｓｉｇｎａｌ ｉｎ ｄｉｆｆｅｒｅｎｔ
ｆｒｅｑｕｅｎｃｙ ｒａｎｇｅ ｉｓ ｃａｌｃｕｌａｔｅｄ，ｗｈｉｃｈ ｉｓ ｕｓｅｄ ａｓ ｔｈｅ ｃｈａｒａｃｔｅｒｉｓｔｉｃ ｅｖａｌｕａｔｉｏｎ ｉｎｄｅｘ ０ｆ ｈｅ硪ｒａｔｅ

ｖａｒｉａｂｉｌｉｔｙ．Ｔｈｅ Ｈｉｌｂｅｒｔ ｓｐｅｃｔｒｕｍ ｅｎｔｒｏｐｙ ｃａｎ ｒｅｆｌｅｃｔ ｔｈｅ ｕｎｃｅｒｔａｉｎｔｙ ｏｆ ＨＲＶ ｓｉｇｎａｌ ｅｎｅｒｇｙ ｏｎ

ｔｉｍｅ．舭ｑｕｅＩｌｃｙ ｄｉｓｔｒｉｂｕｔｉｏｎｓ，ｔｈｅ Ｈｉｌｂｅｒｔ ｓｐｏｃｔｒｕｍ ｅｎｔｒｏｐｙ ｆｅａｔｕｒｅｓ ｏｆ ＨＲＶ ｓｉｇｎａｌ ｂａｓｅｄ ０ｎ

ｆｒｅｑｕｅｎｃｙ舢ｇｅ ａｐｐｒｏｐｒｉａｔｅ ｓｅｐａｒａｔｉｏｎ ｆｏｒ ｖａｒｉｏｕｓ ｐｈｙｓｉｏｌｏｇｉｃａｌ ｆａｃｔｏｒｓ ｂｙ ｄｉｖｉｄｉｎｇ

ａｒｅ ｍｏｒｅ

ｃｌｏｓｅｌｙ ｌｉｎｋｅｄ ｔｏ ｄｉｆｆｅｒｅｎｔ ｐｈｙｓｉｏｌｏｇｉｃａｌ ａｎｄ ｐａｔｈｏｌｏｇｉｃａｌ ｆｕｎｃｔｉｏｎｓ ａｎｄ ｍｏｒｅ ｃｏｎｄｕｃｉｖｃ ｔｏ

ｍａｎｉｆｅｓｔ ｔｈｅ ｒｅｇｕｌａｔｉｏｎ ｌａｗ ｏｆ ａｕｔｏｎｏｍｉｃ ｎｅｒｖｏｕｓ ｓｙｓｔｅｍ ｏｆ ｈｅａｒｔ．Ｔｈｅ ｒｅｓｕｌｔｓ ｏｆ ｔｈｅ

ｓｉｍｕｌａｔｉｏｎ ｔｅｓｔ ｔｏ ＨＲＶ ｓｉｇｎａｌ ｏｆ ｔｈｅ ｓａｍｐｌｅ ｇｒｏｕｐ ｆｏｒ ｔｈｅ ｙｏｕｎｇ，ｅｌｄｅｒ ａｎｄ ｐａｔｉｅｎｔｓ ｗｉｔｈ ａｔｒｉａｌ

ｆｉｂｒｉｌｌａｔｉｏｎ．ａｎｄ ｔｈｅ ｓａｍｐｌｅ ｇｒｏｕｐ ｆｏｒ ｈｅａｌｔｈ ｐｅｒｓｏｎ ａｎｄ ｃｏｎｇｅｓｔｉｖｅ ｈｅａｒｔ ｆａｉｌｕｒｅ（ＣＨＦ）ｐａｔｉｅｎｔｓ ｓｈｏｗ血ａｔ ｍｉｓ ｍｅｍｏｄ Ｃａｎ ｅｆｆｅｃｔｉｖｅｌｙ ｄｉｆｆｅｒｅｎｔｉａｔｅ ｄｉｆｆｅｒｅｎｔ ｓａｍｐｌｅ ｇｒｏｕｐ，ａｎｄ Ｃａｎ ａｃｃｕｒａｔｅｌｙ ｒｅｆｌｅｃｔ ｔｈｅ ｆｅ窒＝ｕｌａｔｉｏｎ ｌａｗ ｏｆ ｓｙｍｐａｔｈｅｔｉｃ ａｎｄ ｖａｇａｌ ｎｅｒｖｏｕｓ ｓｙｓｔｅｍ ｏｆ ｈｅａｒｔ ｉｎ ｄｉ仃ｅｒｅｎｔ
ｐｈｙｓｉｏｌｏｇｉｃａｌ ａｎｄ ｐａｔｈｏｌｏｇｉｃａｌ ｆｕｎｃｔｉｏｎｓ． Ａｔ ｌａｓｔ，ｔｈｅ ｄｉｓｓｅｒｔａｔｉｏｎ ｓｕｍｓ ｕｐ ｔｈｅ ｒｅｓｅａｒｃｈ ｏｆ ｔｈｉｓ ｐｒｏｊｅｃｔ ａｎｄ ｍａｋｅｓ ｔｈｅ ｅｘｐｅｃｔａｔｉｏｎ

ａｂｏｕｔ ｔｈｅ ｄｅｖｅｌｏｐｍｅｎｔ ｄｉｒｅｃｔｉｏｎ ｏｆ ｔｈｅ ａｓｓｉｇｎｍｅｎｔ·

Ｋｅｙ Ｗｏｒｄｓ：ＥＣＧ ｓｉｇｎａｌ；ｐｒｅｐｒｏｃｅｓｓ；ｒｅｃｏｇｎｉｔｉｏｎ ｏｆ ｆｅａｔｕｒｅ ｗａｖｅｆｏｒｍ；ＨＲＶ；ｆｅａｔｌｌｍ
ｅｘｔｒａｃｔｉｏｎ

砸ｓ ｗｏｒｋ ｉｓ跚ｐｐｏｎｃｄ ｂｙ ｔｈｅ Ｎａｔｉｏｎａｌ Ｎａｔｕｒａｌ Ｓｃｉｅｎｃｅ Ｆｏｕｎｄａｔｉｏｎ ｏｆ Ｃｈｉｎａ（Ｇｒａｎｔ Ｎｏ·３０６７０５２９）ａｎｄ
（Ｇｒａｎｔ Ｎｏ．１ １０７２０９９）．

Ｖ

心电波Ｉ臣枪洲。ｊ心牢变开什分析方法研究
插图索引
图１．１典型正常心电信号………………………………………………………………．．２ 图２．１典型的心电信号频谱能量分布…………………………………………………１８ 图２．２ ５０Ｈｚ工频自适应陷波器………………………………………………………．．２２ 图２．３小波变换的时频窗Ｕ特点………………………………………………………．２７ 图２．４三层多分辨率分析结构图………………………………………………………２７ 图２．５离散正交小波变换分解…………………………………………………………２９ 图２．６离散正交小波变换重构…………………………………………………………２９ 图２．７离散平稳小波分解框图…………………………………………………………．２９ 图２．８离散平稳小波滤波器计算………………………………………………………２９ 图２．９ ｃｏｉｆ３小波的尺度函数和小波函数………………………………………………３２ 图２．１０ ｃｏ／ｆ３小波的分解与重构滤波器…………………………………………………３２ 图２．１１ ＥＣＧＳＹＮ动态心电模型的产生的标准心电图………………………………．３２ 图２．１２加入基线漂移的标准心电图…………………………………………………．３３ 图２．１３ ｃｏｉｌ３小波８尺度小波分解……………………………………………………．３４ 图２．１４去除基线漂移的心电信号……………………………………………………．３４ 图２．１ ５实际心电信号的基线漂移的滤除……………………………………………．３５ 图２．１６含有工频干扰的标准心电信号的心电图……………………………………。３５ 图２．１７混有工频干扰的心电信号小波分解…………………………………………．．３６ 图２．１８滤除工频干扰的心电图………………………………………………………．．３６ 图２．１９原始心电图（１０３．ｄａｔ）…………………………………………………………………………．３７ 图２．２０叠加工频干扰的心电图…………………………………………………………３７ 图２．２１除去工频的心电图……………………………………………………………．．３７ 图２．２２ Ｐｅｎａｌｉｚｅｄ阈值的软硬阈值去噪…………………………………………………３８ 图２．２３实际心电信号（１０６．ｄａｔ）……………………………………………………．．３９ 图２．２４滤除了肌电干扰信号的心电图………………………………………………．．３９ 图２．２５标准心电信号和迭加白噪声的心电信号………………………………………４０ 图２．２６离散正交小波和离散平稳小波消噪结果……………………………………。４ｌ 图２．２７基于平稳小波变换的自适应滤波器构成……………………………………．．４２ 图２．２８基于平稳小波变换的自适应滤波算法的基线漂移滤除……………………一４３ 图３．１心电信号的差分阈值法处理……………………………………………………４６ 图３．２小波六层分解及其各层系数分布………………………………………………．４８ 图３．３心电信号的Ｍａｒｒ小波变换……………………………………………………。５２ 图３．４尺度３小波分解信号的ＳＮＥＯ处理……………………………………………．５２
Ｖｌ

二州理Ｔ人。ｊ：：孵ｌ？‘７：ｆ？，沦艾
图３．５低频干扰严重的ＥＣＧ信号的小波分解………………………………………．．５３ 图３．６高频干扰严重的ＥＣＧ信号的小波分解………………………………………．．５３ 图３．７心电数据的Ｒ波检测算法的处理（１ １４．ｄａｔ）…………………………………５４ 图３．８心电数据的Ｒ波峰定位（１ １ ４．ｄａｔ）………………………………………………．５５ 图３．９心电数据的Ｒ波检测算法的处理（２０３．ｄａｔ）…………………………………５５ 图３．１０心电数据的Ｒ波峰定位（２０３．ｄａｔ）…………………………………………．５５ 图３．１１噪声污染严重的心电信号Ｒ检测……………………………………………．５６ 图４．１典型的ＩＭＦ分量信号……………………………………………………………７０ 图４．２二次调频信号的时频分布………………………………………………………．７８ 图４．３不同采样频率下的Ｈｉｌｂｅｒｔ时频谱………………………………………………８２ 图４．４年轻人和老年人ＨＲＶ信号……………………………………………………．８４ 图４．５ ＨＲＶ信号的Ｈｉｌｂｅｒｔ能量棒形图………………………………………………．．８５ 图４．６样本数据的总能量、各生理频段能量及时频特征的分布……………………８６ 图４．７总能量及各生理频段的Ｈｉｌｂｅｒｔ能量棒形图……………………………………８８ 图４．８健康人的时频特征尾厂、局ｒ随心率变化的线性拟合结果……………………．８９ 图４．９ ＲＲ间期信号处理的系统框图…………………………………………………一９２ 图４．１０记录００１３的ＲＲ间期序列……………………………………………………．．９２
图４．１１Ⅵ序列和ＣＯＮ序列的自适应方差滤波……………………………………．９３
图４．１２ ＩＨＲ序列和２Ｈｚ重采样序列…………………………………………………．９４ 图４．１３改进的ＨＨＴ算法的流程………………………………………………………．．９５ 图４．１４传统ＨＨＴ方法对ＩＨＲ序列的分解及功率谱…ｊ………………………………９６ 图４．１５改进ＨＨＴ方法对ＩＨＲ信号的ＥＭＤ分解及功率谱…………………………９７ 图４．１６ ＩＨＲ序列的Ｈｉｌｂｅｒｔ谱…………………………………………………………．９８ 图４．１７ ＩＨＲ序列的Ｈｉｌｂｅｒｔ边际谱……………………………………………………．．９８ 图４．１８ ＩＨＲ序列的边际谱特征条形图………………………………………………．．９９ 图５．１均值二值符号化过程…………………………………………………………．．１０２ 图５．２一阶差分符号化过程…………………………………………………………。１ ０２ 图５．３多值符号化过程………………………………………………………………．１ ０３ 图５．４几种常规信号…………………………………………………………………。１１６ 图５．５ Ｌｏｇｉｓｔｉｃ序列加随机强干扰前后的波形………………………………………１ １ ８ 图５．６ Ｌｏｇｉｓｔｉｃ序列加噪前后复杂度和熵变化………………………………………．１１ ８ 图５．７ ＨＲＶ信号、Ｈｉｌｂｅｒｔ时频谱、Ｈｉｌｂｅｒｔ频率边际谱及能量谱…………………１２０ 图５．８两组实验对象ＨＨＴ边际谱熵、能量谱熵及功率谱熵………………………１２１ 图５．９ ＨＲＶ信号及其ＥＭＤ分解（Ｃ１，－，Ｃ４分量）………………………………………１３２ 图５．１０ ＥＭＤ分量时频谱……………………………………………………………．．１２３
ＶＩＩ

心电波７髟柃测‘ｊ心牢变开州：分析方法研究
图５．１ｌ ＨＲＶ信号的Ｈｉｌｂｅｒｔ时频谱划分……………………………………………．１２４ 图５．１２ ＨＲＶ信号和Ｈｉｌｂｅｒｔ时频谱…………………………………………………．１２５ 图５．１３样本组多频段谱熵统计分布…………………………………………………１２６ 图５．１４样本组全频段谱熵分布特征…………………………………………………１２７ 图５．１５相邻连续数据段的第２频段谱熵统计分布…………………………………１２８ 图５．１６伞频段Ｈｉｌｂｅｒｔ时频谱熵分布特征……………………………………………１２８ 图５．１７传统Ｈｉｌｂｅｒｔ时频谱熵分布特征………………………………………………１２８
ｖｉｉｉ

兰州理Ｔ人学博Ｉ‘学ｆｔ论文
附表索引
表１．１常用的ＨＲＶ时域统计指标………………………………………………………４ 表１．２常用的ＨＲＶ频域统计指标……………………………………………………。５ 表２．１不同阈值选取方法的ＳＮＲ………………………………………………………３８ 表３．１ ＭＩＴ．ＢＩＨ数据库部分心电数据文件Ｒ波的检测统计………………………．．５８ 表４．１实验对象（１）的样本数据统计分析结果……………………………………。８７ 表４．２实验对象（２）的样本数据统计分析结果……………………………………．．８８ 表４．３边际谱特征的统计结果（均值４－标准差）及双侧ｔ检验……………………．．９９ 表５．１几种常规实验信号的复杂度计算结果…………………………“……………１１７ 表５．２加噪前后复杂度和熵序列的相对变异系数……………………………………１１９ 表５．３三组对象ＨＨＴ边际谱熵、能量谱熵和功率谱熵的统计结果………………１２１ 表５．４ Ｉ，Ⅱ，ＩＩＩ组全频段的Ｈｉｌｂｅｒｔ时频谱熵（叨统计检验…………………………．１２７

兰州理Ｔ人学博Ｉｊ学位论文
第１章绪论
１．１课题研究意义
心血管系统疾病是威胁人类生命的重大疾病，具有高发病、高致残率和高死亡率等 特点。世界卫生组织的统计显示，全球每年约有１７００万人死于各类心血管系统疾病。 随着我国经济高速发展，人民生活不断提高，心血管系统病在我国的发病率和死亡率逐 年增加，并呈现年轻化、平民化、乡村化的趋势。根据《中国心血管病报告２０１０）的有 关数据显示，目Ｉｊ｛『我国包括冠心病、脑卒中、心力衰竭及高血压在内的心血管病病人估 计已经达到２．３亿【ｌ】，每年有３００万人死亡，已成为我国重大的公共卫生问题。对于心 脏系统疾病的诊断、治疗及预防仍是当今医学界面临的巨大挑战。
心电信号（Ｅｌｅｃｔｒｏｃａｒｄｉｏｇｒａｍ，ＥＣＧ）是人类最早研究并应用于临床医学的生物电 信号之一，它反映了心脏在兴奋产生、传导和恢复过程中的电变化，是心脏电活动的一 种客观表示，在不同层面上反映了心脏的工作状态【２１。因此，对于心脏疾病的临床诊断 和治疗具有非常重要的参考价值。近年来，人们逐渐认识到自主神经系统（交感神经和 迷走神经）对正常及异常心脏的功能及电生理活动起着重要的作用。大量研究，已充分 肯定了自主神经活动与多种疾病相关，特别是与某些心血管疾病的死亡率有关【３＇４ｊ。心率 变异性（Ｈｅａｒｔ ｒａｔｅ ｖａｒｉａｂｉｌｉｔｙ，ＨＲＶ）是指心脏搏动周期存在的微小变异现象，ＨＲＶ可 作为反映心脏交感神经和迷走神经活动紧张性和均衡性的一种非侵入性指标【５】，也是心 电自动分析系统重要的组成部分。
目前，ＥＣＧ的计算机辅助分析是计算机在生物医学工程领域应用最成功的范例之 一。从心电数据采集、预处理、波形识别、特征提取到自动分析诊断等的每项技术的发 展和完善都凝聚了生物医学工程领域研究者的智慧。心电信号分析系统的任务是实现大 量临床心电数据的准确、快速、全面的自动分析，减轻人工分析的工作量。国外对于 ＥＣＧ分析技术的研究水平较高，已开发出性能可靠、功能齐全的心电自动分析系统。国 内的研究与国外先进水平还有一定的差距。研制高水平的ＥＣＧ自动分析系统是生物医 学工程人员一项重要的使命。
心电信号分析涉及的理论和技术众多，是～个多学科融合的庞大课题。目前，心电 信号自动分析在临床应用中所占比例仍不是很大，其分析的准确性还无法与临床心电专 家相比。心电特征波检测的是否可靠，特征信息提取是否准确是一个重要的原因。ＨＲＶ 分析是心脏自主神经功能的定量分析方法，具有无创性和较高的敏感性，应用价值巨大。 但目前ＨＲＶ的线性分析方法还不能全面揭示ＨＲＶ蕴含的生理病理信息，其检测也不是 一个成熟的临床监测项目。ＨＲＶ的非线性分析方法是一个有价值的研究方向，但研究

量曼曼鼍曼皇曼蔓舅舅ＩＩＩ｜——一ｔ—Ｌ，Ｉ【—！波彤Ｉ伶，ｉ曼Ⅲ０曼ｏｊ—曼ｔ５曼：爷曼娈异曼忡分曼析曼方ｊ蔓土｛ｉ曼）ｆ哆曼ｔ 皇曼曼曼曼鼍曼鼍曼曼皇曼曼
正处于初步的探索阶段，所得结果无对照标准，生理意义也无充分解释，临床还无法得 到应用。因此，无论从基础理论还是临床科研ＨＲＶ的研究都有待突破。
总之，已有的心电信号分析方法仍存在着诸多的缺陷和不足，在理论研究和临床应 用方面都有改进和创新的空间。本研究立足于前人研究的基础之上，在心电预处理、特 征波检测及心率变异性分析方面丌展研究工作，为临床提供准确、可靠的诊断信息和研 制新型心电分析系统有重要意义。
１．２心电信号和心率变异信号的生理基础及诊断意义
１．２．１心电信号和心率变异信号的生理基础 心脏搏动及其节律性是人体生命和生理状态的重要标志之一。心电生理学的研究表
明，心电信号来源于心肌细胞的生物电变化。心肌细胞的电激动称为除极，心肌细胞恢 复为静息状态称为复极，心电信号的产生与心肌细胞的除极和复极过程密切相关。心脏 电激动起源于窦房结，沿特化的心脏传导系统下传，其传播方向、途径、次序及时问存 在一定的规律。若心脏不能及时发出电激动，则心脏陷于停博。人体体液中充满电解质， 具有导电性能，心脏电激动过程产生的有序生物电变化通过体液传至身体表面，使身体 各部位出现有规律而各向异性的电位变化，通过测量电极采集体表特定点电位变化，并 放大、显示及记录，即为体表心电信号，也即是通常的ＥＣＧ信号【６】。
一个心动周期正常心电信号波形如图１．１所示。它是由特征波及其特征间期组成， 每个心动周期包含一个Ｐ波，一个ＱＲＳ波群和一个Ｔ波，有时还会出现一个小的Ｕ波。 特征波及特征间期的含义如下：
图１．１典型正常心电信号 Ｐ波：由左右心房的除极过程引起，其波形小而圆钝，时宽为０．０８ｓ．０．１ｌｓ，波幅不 超过０．２５ｍＶ。 ＱＲＳ波：反映左右心室除极产生的电位变化，在Ｐ波之后出现，为心电信号中最高 大和最快速的波形。典型的ＱＲＳ波群包括三个相连的波，第一个向下的波为Ｑ波，紧 接着为高而尖峭的向上的Ｒ波，最后是一个向下的ｓ波。在体表不同位置（使用不同导
２

兰州理Ｔ人·’｝博卜’≯ｆｔ论艾

联记录）时，三个波不一定都有，大小方向也会不同。 Ｔ波：代表心室复极时的电位变化，方向与Ｒ波方向相同，时宽为０．０５ｓ．０．２５ｓ，波
幅一般为０．１ｍＶ．０．８ｍＶ。

Ｕ波：Ｔ波之后可能出现的一个低而宽的波，与Ｔ波方向一致，其机理不十分清楚，

可能反映普顷野纤维复极的电位变化。

ＱＲＳ间期：从Ｑ波开始至Ｓ波结束之间的时程，反映心室除极时间。正常ＱＲＳ间 期为０．０４ｓ．０．１ｓ，若ＱＲＳ间期＞Ｏ．１２ｓ，反映室内传导阻滞。
ＰＲ间期：从Ｐ波开始到ＱＲＳ波开始之间的时程，反映激动由窦房结产生经由结间 束、房室交界和左右束支抵达心室，并引起心室兴奋所需要的时间，又称为房室传导时

间。正常为０．１２ｓ．０．２ｓ。当发生房室传导阻滞时，ＰＲ问期增长。如当ＰＲ间期＞Ｏ．２１ｓ。则 为Ｉ度房室传导阻滞。

ＱＴ间期：从ＱＲＳ波开始到Ｔ波终点的时程，反映心室除极和复极时间的总和。许 多因素可影响ＱＴ间期，如心肌缺血、低血钾、低血钙等可使ＱＴ问期延长，ＱＴ间期延 长使心室肌复极不均一，易诱发折返激动，导致严重室性心率失常。ＱＴ间期随受心率

变化的影响，心率越慢，ＱＴ间期越长；心率越快，ＱＴ间期越短。通常用ＱＴｃ问期修正

心率对ＱＴ间期影响，Ｊ下常ＱＴ。问期小于０．４３￣ｏ．４４ｓ。

ＳＴ段：指从ＱＲＳ波群终止点到Ｔ波起点之间的波形线段，反映心室部分己完全进

入去极化状态，正常时与基线平齐。

，

ＰＰ间期：相邻Ｐ波之间的间距称为ＰＰ间期，反映心房率。正常情况下，ＰＰ间期

与ＲＲ间期一致。在Ⅱ度或Ⅱ度以上房室传导阻滞和某些心率失常，两者可不一致。

ＲＲ间期：相邻ＱＲＳ波群之间的间距称为ＲＲ间期，反映心室率。正常情况下，ＲＫ 问期与ＰＰ问期一致。
在心电信号的测试中，对电极的放置部位和导联的连接方式临床有明确的规定。目

前，国际公认的是标准１２导联，包括心电标准导联（Ｉ、ＩＩ、ＩＩＩ）、加压单极肢体导联 （ａＶＲ、ａＶＬ、ａＶＦ）及胸导联（ＶＩ，－－－Ｖ６），共有１２个导联，具体可参考文献［５】。

人体心脏系统除了本身的节律性放电引发心脏搏动之外，同时也受到自主神经系统 （交感神经和迷走神经）的调控。迷走神经可支配窦房结、房室交界区和心房肌。刺激

迷走神经可使房室结的传导减慢，甚至导致完全性房室传导阻滞。窦房结对迷走神经刺 激的反映时限非常短，刺激迷走神经会立即在第一次或第二次心跳时出现高峰反应，停 止刺激后反应的恢复稍慢，但也小于５ｓ。因此，ＨＲＶ频谱的高频成分是迷走神经活动的

生理基础。交感神经可支配整个心脏，包括窦房结、房室交界区、心房肌及心室肌。刺 激交感神经导致心率加快及心肌收缩增强，电脉冲传导速度加快，传导时间缩短。刺激

交感神经会有一定的延迟效应，大约为５ｓ，之后心率逐渐增加，持续２０ｓ一３０ｓ达到稳态。 因此，一般认为ＨＲｖ频谱的低频成分主要反映交感神经活动的情况。

传统的医学通常用体内平衡原理解释心率的变异性，认为ＨＲＶ的存在仅仅是对外

心ｆＵ波形伶测ｏｊ心ｊ爷变异‘ｒｐ分卞Ｊ ｒ方法ｉｉ）｜宄
界环境干扰的短暂响应，干扰过后，人体通过体内功能的调节作用又恢复到原有的有序 状态。而人体在衰老和患病时，就不大可能维持恒定的心率。然而，现代医学研究认为 混沌特性是健康心脏的重要标志，而心率变异性降低是心脏混沌特性减弱的表现，或许 和某种生理病变相关联，这一点和传统医学原理相悖【７１。现代医学研究表明产生心率波 动性的因素包括脑的高级神经活动、中枢神经系统的自发性节律活动、呼吸活动以及由 压力、化学感受器传入的心血管反射活动等，十分复杂。这些因素最终表现为交感神经 和迷走神经的对心脏系统的综合调节作用，交感神经通过释放。肾上腺素和去甲肾上腺素 使得心率加快而迷走神经通过释放的乙酞胆碱产生对心率的抑制作用。因此，ＨＲＶ反 映了神经、体液因素对心血管系统精细调节情况，体现了神经、体液因素与窦房结调节 相互作用的均衡性以及神经、体液的变化程度。
目前，ＨＲＶ的时域和频域特征指标在临床上使用普遍【８’９】。ＨＲＶ时域指标包括统计 学分析指标和几何学分析指标。常用的统计参数指标如表１．１所示。常用的几何学指标包 括三角指数和ＴＩＮＮ。
表１．１常用的ＨＲＶ时域统计指标
注：ＲＲｌ为第ｆ个５ｍｉｎ的ＲＲ间期的均值，ＲＲ５旆为２８８ ｄ＇Ｒｇｆ的均值· １）三角指数：ＲＲ间期总个数除以ＲＲ间期直方图的高度，在计算ＲＲ间期直方图时，
横坐标的时间单位为１／１２８秒，无量纲。 ２）ＴＩＮＮ：利用最小方差法求出全部ＲＲ间期的直方图的近似三角形底边的宽度，单
位为ｍｓ。 ＨＲＶ频域指标是基于ＨＲＶ的功率谱分析给出的，功率谱提供了其能量随频率变化分
布的基本信息，典型的ＨＲＶ功率谱上有三个分离的谱峰。大致集中于０．０４Ｈｚ、Ｏ．１Ｈｚ和
４

曼曼曼曼皇曼曼曼曼曼曼曼曼曼曼曼曼曼曼曼曼曼曼曼曼曼曼兰！蔓州曼理曼Ｔ！曼人皂学曼博曼曼ｆ。！曼≥曼付 曼｜论ｉ—丈

Ｉ—

ＩＩ曼曼曼曼

大于０．１５Ｈｚ频段，将各频段下的面积可作为功率谱能量的测定值，即为ＨＲＶ的频域指标。 频域指标反映了自主神经在各频率段对心率的调制，而且是将各种生理因素作适当的分 离，因而能准确反映ＨＲＶ的真实情况，临床应用价值较大。常用的短时程（５ｍｉｎ）ＨＲＶ 的频域指标如表１．２所示。在提取短时程频域指标时，应保持平卧休息状态，避免各种暂 时影响自主神经活动的因素，如兴奋交谈、深度呼吸、吸烟、饮酒等。长时程（２４ｈ）ＨＲＶ 的频域指标，由于不能很好地控制各种因素，指标只能反映ＨＲＶ总体的大致情况。
表１．２常用的ＨＲＶ频域统计指标

时域和频域指标都可用来检测心脏系统不同生理、病理状态下的自主神经张力的改 变。因此，它们之间必然存在一定的相关性【ｌｏＪ。研究表明ＰＮＮ５０、ｒＭＳＳＤ和ＨＦ以及ＳＤＮＮＩ 和ＶＬＦ、ＬＦ、ＨＦ之间存在较强的相关性，而ＳＤＮＮ、ＳＤＡＮＮ分别和ＴＰ、ＵＬＦ也具有一 定的相关性。除了时域和频域之间的相关性外，由于某些时域指标和相同的调制机制相 联系。在这些时域参数之间存在也存在一定的相关性。通过对心梗两周后病人的ＨＲＶ时 域指标测试，Ｂｉｇｇｅｒ等人发现ＳＤＮＮ和ＳＤＡＮＮ，ｒＭＳＳＤ和ＰＮＮ５０具有较强的相关性【ｌｏＪ； Ｋｌｅｉｇｅｒ等人研究－ｊ＇１４个健康对象的ＨＲＶ时域指标测试，结果发现ｒＭＳＳＤ和ＰＮＮ５０的相关 系数为０．９６［１ｌｌ。关于指标之间的相关性研究，为进一步解释、分析指标的生理意义提供 理论的依据，同时在反映病症的一致性上得到更充分结果。 １．２．２心电信号和心率变异信号的诊断意义
心电诊断方法是心血管疾病诊断中一种十分重要的方法，对于鉴别各种类型的心律
５

心ＩＵ波形伶测ｏｊ心哞：变异。ｒｆ：分沂方法ｆｉＪｌ’ｔ
失常，提示心房、心室肥大，辅助诊断心肌梗死、心肌炎等疾病均有很高的价值。 心律失常通常指心搏的频率、节律、起源位置、传导速度与激动顺序发生的异常。
心律失常会影响心脏Ｊ下常的同步收缩时序，并降低心脏泵血的效率，某些室性心律失常 还被认为是威胁生命的前兆【１２，１３ｌ。多数不同类型心律失常的ＱＲＳ波群形态和ＲＲ间期的 变化都比较明显。房性早搏是发生率较高的心律失常，其典型表现为：提前出现畸变的 Ｐ波；ＰＲ间期均大于０．１２ｓ；ＱＲＳ波群的形态、时限和窦性心律一致；出现不完全性代 偿间歇。其临床诊断意义为：房性早搏呈频发性、成对性或多形性时，临床多为房性心 动过速、心房颤动的先兆。室性心动过速可分为非阵发性室性心动过速和阵发性室性心 动过速，当室性异位起搏点自律性增高，接近或超过窦房结的频率时，就可与窦房结竞 相控制心脏，形成非阵发性室性心动过速。阵发性室性心动过速频率为１００－－３００／ｍｉｎ， 且具有骤然发作、骤然终止的特点。临床诊断意义为：非阵发性室性心动过速少见于正 常人，多见于病理状态如机械心肌梗塞，急性心肌炎等。因其不引起血液动力学障碍， 一般不需要治疗，治疗主要针对基础病因。阵发性室性心动过速属于恶性室性心律失常 不仅可引起血量动力学障碍，导致充血性心力衰竭、休克、心肌梗死和脑血管意外，还 可演变为心室颤动，引起心脏骤停。临床遇到阵发性室性心动过速，必须进一步检查， 找出基础病因。另外，心电信号的某些特征性改变和演变是心肌梗死的可靠诊断依据， 心也有助于诊断心肌受损、供血不足、药物和电解质紊乱等病症，但特征性不强。对于 瓣膜活动、心音变化、心脏功能状态等，心电信号不能直接给出诊断，但可作为一种电 信息的时间标记。心电信号也广泛应用于手术麻醉、用药观察、航天及运动的心电监测 及各种危重病人的抢救等。
近年来，人们在许多心血管领域广泛研究了ＨＲＶ的临床意义，并已取得了大量的临 床资料和成果。ＨＲＶ分析在急性心肌梗塞、心脏猝死发生机理的研究及临床治疗、监护、 预后评价方面已得到了肯定应用价值和临床的指导意义【１４１。Ａｌｇｒａ等人对，心．ｆｆａｔ管疾病患 者的ＨＲＶ分析，在二年的随访中有２４５人发生心源性猝死，均存在ＨＲＶ不同程度的降低， 他们认为ＨＲＶ降低可作为显示心源性猝死高危因素的独立指标，并且ＳＤＮＮ＜２５ｍｓ的患 者较ＳＤＮＮ＞４０ｍｓ的患者猝死危险性增加４．１倍【１５】。临床研究表明心肌梗死病人的ＨＲＶ降 低，尤其在梗死后几小时到２～３周时最明显，在梗死后６～１２个月的时间内，ＨＲＶ有所 恢复，但仍低于正常。因此，ＨＲＶ降低是估测心肌梗死病人预后不良的一个良好独立指 标【１６’１７】。冠心病患者的短暂心肌缺血发作诱发了有意义的ＨＲＶ变化，说明自主神经失调 对冠状动脉有一定的影响【１８】。Ｋｕｂｏｔａ等人对变异性心绞痛病人的观察发现，在心肌 缺血发作前５０ｍｉｎＬＦ和ＬＦ／ＨＦ均有增加【１９】，而Ｉｎａｚｕｎｍｉ等人观察结果是心绞痛发作 前２ｍｉｎ，ＨＦ显著提高【２０１。研究表明在变异性心绞痛病人心肌缺血发作前交感和迷 走神经活性增强对发病过程起到了十分重要的作用。心衰病人的ＨＲＶ降低，说明 心衰患者交感及迷走神经均损害，以迷走神经损害更为严重，且自主神经对心脏 调节的昼夜节律消失【２１，２２］。研究也表明ＨＲＶ与心衰严重程度和预后明显相关【２３１。
６

兰州艘Ｔ人’≥博ｌｊ学ｆｔ论殳
ＨＲｖ测试也被应用于麻醉监测及临床手术之中，可通过ＨＲＶ测试束评估麻醉 药物对自主神经系统的影响程度及了解手术中前后自主神经对心脏调节功能的变 化及损伤恢复的情况。ＨＲＶ分析有助于评估和早期珍断某些非心血管领域的疾病 或综合征【２４，２５】。ＨＲＶ测定也被应用于评估各种因素对人体的影响及健康指导【２６，２７１。
总之，ＥＣＧ和ＨＲＶ分析是临床医学重要的诊断方法，在疾病诊断、治疗及预后等方 面都具有十分重要的意义。
１．３心电信号和心率变异信号分析的研究现状
１．３．１心电信号分析的研究现状
体表心电信号是在有噪声情况下的采集的生物电信号，其特点表现为：１）心电信 号是微弱生物电信号，其幅度为０．８ ｍＶ－ｌｍＶ，频谱多集中在Ｏ．０５～１００Ｈｚ之间。２）实 际心电信号波形将随人体各种生理因素的变化而发生细微地改变，而对于不同人，不同 病症，心电信号形态大小差异较大。心电信号很难统一的描述，表现出较强的不确定性。 ３）心电信号中混有各种强干扰，如工频干扰、基线漂移、肌电干扰及运动伪迹等不同 类型的噪声，且各种噪声频带相互重叠。心电信号分析主要包括心电预处理、特征波形 检测、心电自动诊断及心率变异分析等方面。
心电预处理是指对心电的各类干扰信号的滤波处理。目前，基于各种数字滤波器的 ＥＣＧ噪声抑制方法已成为主流的心电预处理方式，许多学者为此做了大量的研究工作。 对于滤除心电信号工频干扰的研究开展较早，平滑滤波是较早被人们采用的方法，平滑 滤波处理速度快，设计简单，滤波效果较好。但会引起ＱＲＳ波的较大削峰，使得信号 衰减较大。Ａｌｓｔｅ提出采用具有线性相位滤波器消除工频干扰，滤波器具有很高的阻带 衰减，而通带衰减小于０．５ｄＢ，获得很好滤波效果，且易于实现【２引。Ｗａｒｉａｒ等人提出了 简单整系数ＦＩＲ滤波器，计算过程大大简化，但采用的滤波器阶次较低，对滤波效果有 一定的影响【捌。Ｓａｎｄｅｒ等人设计了５０／６０Ｈｚ的陷波器用于从高分辨的ＥＣＧ信号中消除 工频干扰【３０１。由于采用整系数的滤波技术，其算法复杂度低，效率高。Ｌｅｖｋｏｖ提出了 一种对心电信号的线性段和非线性段分别采用不同处理方式的工频滤波方法【３１１。孙京霞 等人改进了Ｌｅｖｋｏｖ滤波方法，引入了ＱＲＳ开关函数，以减小对ＱＲＳ复合波的削峰【３２１。 Ｌｉ Ｇａｎｇ等人提出了一种自适应相干模板法的工频干扰滤波方法【３３１。首先从原始心电信 号中获得工频干扰的模板信号，再将原始信号和工频模板信号求差，以达到滤去工频的 目的，算法复杂度减小，并克服了自适应滤波需要提供参考信号的不足。纪跃波等人将 零相位数字滤波应用于心电信号工频干扰的滤除，获得了好的滤波效果，但零相位数字 滤波的处理时间增加，在实时和长序列滤波应用中受到局限【３４１。Ｋａｕｒ提出移动平均滤 波和ＩＩＲ陷波器消除工频干扰后，再引入小波变换法进一步改善了滤波效果【３５１。
消除心电信号的基线漂移是心电信号预处理的一个重要而困难的问题。拟合纠正法
７

是常用的一种方法，它是采用三次样条、多项式及其他恰当函数等曲线拟合方法估计出 基线漂移曲线，然后用原始信号减去漂移曲线，就可以获得消除基线漂移的证常心电信 号［３６１。学者们也提出了其他一些算法，夏恒超等人针对三次样条插值消除基线漂移的不 足，提出了一种新的基于三次样条插值技术的心电信号基线漂移滤波方法，滤波性能有
一定改善【３７】。Ｋｅｓｅｌｂｒｅｎｅｒ等人采用非线性中值滤波消除严重的基线漂秽３８】。Ｘｕｅ等人采
用基于神经网络的非线性自适应滤波器来消除基线漂移及伪迹，但算法的运算量较大， 且受到ＱＲＳ波群变异的影响【３９】。李小燕等人设计了一种新的基于小波变换的自适应滤 波器，在消除心电信号基线漂移的同时，对低频段影响较小，可满足ＳＴ段测量的要求 ［４０ｌ。Ｂａｒａｔｉ等人采用ＩＣＡ方法消除单通道ＥＣＧ信号的基线漂移，通过对原始心电信号 增加延时以构建多通道滤波数据，滤波效果较好【４１１。Ｚｈａｏ提出了经验模态分解（ＥＭＤ） 和５０Ｈｚ陷波器相结合的方法消除工频干扰和基线漂移，并给出了滤波方法的评价【４２１。 毛玲等人采用广义形态滤波分离基线漂移信号，算法较好地保持了ＥＣＧ信号的原有特 征形态【４３】。
肌电干扰的频带范围很广，部分频段与心电信号的频率范围相互重叠，消除比较困 难。传统方法是采用低通滤波器消除高频肌电干扰，但效果不能令人满意。近年来，小 波变换是解决这一问题的较有效的手段。Ｄｏｎｏｈｏ等人提出的小波阈值去噪法通过对小波 系数进行阈值处理可实现对肌电干扰的抑制，由于阈值函数的限制，去噪效果有待进一 步改善Ⅲ】。高清维等人提出了基于平稳小波变换的ＥＣＧ消噪除方法，通过对各层平稳小 波变换细节信号的噪声均方差的估计，选取合理阈值对各层细节信号进行阈值处理，重
构后滤除肌电干扰噪纠４５１。
目前，可以同时消除工频干扰、基线漂移和肌电干扰的一次性滤波方法受到研究者 很大的重视。Ｔｈａｋｏｒ设计一种可去除肌电干扰在内的三种干扰的自适应滤波器【矧。罗小 刚提出了将基于小波变换与形态滤波相结合的ＥＣＧ综合滤波算法，算法充分利用小波去 噪和形态滤波的优点，使用形态滤波方法去除基线干扰信号后，采用小波分解重构滤波 算法消除工频及高频噪声，由于小波分解尺度低，算法的运算速度大大降低【４７】。
心电信号是由一些周期性的特征波形组成，每个具体的波都对应着特定的心脏活动 和电生理阶段。对这些特殊波形准确地检测是提取心电信息特征、心电诊断的关键，而 ＱＲＳ波群的正确识别和判定是首先要解决问题，否则，其后进行的各类判别都将失去了 意义【４８】。ＱＲＳ波群的特征提取包括ＱＲＳ波群的位置、宽度、面积的检测。其相关算法 包括如下几个方面：
１）ＱＲＳ波群实时检测方法：目前，ＱＲＳ波群实时检测以软件方法为主，主要包括 峰值检测法和可变斜率阈值法。在通常情况下，在心电信号中，Ｒ波峰值最大，采用逐 点比较方法寻找其最大值，通过设置阈值比较，超过阈值即为Ｒ波的峰值。典型的算法
是Ａｈｌｓｔｒｏｍ提出应用于Ｈｏｌｔｅｒ实时检测系统ＱＲＳ波群检测算法，该算法在ＥＣＧ一阶和 二阶差分基础上，设置阀值来检测ＱＲＳ波【４９１。由于强噪声或高大Ｐ、Ｔ波的影响，采用 固定阀值势必产生误检，当存在心律失常或ＱＲＳ波幅度较小时，又会导致漏检。在固

兰州理Ｔ人·筝博卜学ｆ世论文
定阀值的研究基础上，提出了可变阀值检测算法【５０．５１１。算法思想是根据ＱＲＳ复合波的 上升沿和下降沿斜率最大，而Ｔ波、Ｐ波及基线漂移曲线的斜率较小，可通过斜率阈值 来检测ＱＲＳ复合波，即大于斜率阈值的曲线所在的部分为ＱＲＳ复合波。而阈值调整按 每次心动周期的前次心拍斜率最大值的７０％。这种算法可根据ＥＣＧ信号幅度的变化对 阈值做及时的调整，避免了高Ｐ波、高Ｔ波、心电信号幅度变化以及基线漂移时出现误 检测的情况。Ｐａｎ等人提出一种ＱＲＳ波形实时检测算法，心电信号经带通（５～１５Ｈｚ） 数字滤波，对滤波信号微分后进行平方运算，以突出微分后的频响曲线斜率，这有利于 减少Ｔ波的影响。对处理后的信号再做移动窗口积分，积分结果包含了ＱＲＳ波的斜率 和宽度信息，利用滤波后信号的阈值和窗口积分后阈值进行检测，该算法采用了双重阈 值法，且阈值的大小随信号的波动而调整，有效地降低了漏检和误检率。经ＭＩＴ／ＢＩＨ 心电数据库实测，检验正确率为９９．３％。但波形形态变化较大时易产生漏检和误检【５引。
２）ＱＲＳ波群的模型检测方法：ＱＲＳ波群模型检测方法包括滤波器法、随机信号统 计法、小波分析法、神经网络理论以及模式识别等。目前，关于滤波器法已经提出了二 阶导数算法、移动窗口积分算法、正交滤波算法等不同的算法【２】。二阶导数算法是取心 电的一阶与二阶导数的平方和作为ＱＲＳ波群输出标记信号，采用求导数方法突出了ＱＲＳ 波群上升速率变化最快处，可以根据输出脉冲的宽度较精确地估计Ｒ波的宽度。移动窗 口积分法的求导平方运算与二阶导数算法相同，最后是对求导的平方数据进行移动窗口 积分，这种方法对高频随机噪声敏感性较低。正交滤波算法将心电信号输入到两个相位 固定相差为ｒｄ２的滤波器中，在实际应用中，具有固定的ｕ／２相位差的两个滤波器，可 以利用奇对称和偶对称序列的线性相位ＦＩＲ滤波器近似实现，滤波器输出为一对互为希 尔伯特变换的输出，通过检测包络的幅值可以检测出ＱＲＳ波群，同时从ＱＲＳ波对应的 脉冲包络的宽度可近似计算出ＱＲＳ波的时宽。滤波器法的算法简单，速度快，易于硬 件实现。但当信号频谱和噪声频谱发生交叉时，在降噪的同时，平滑了信号中的高频成 分，损失了这些突变点可能携带的重要信息。干扰严重或非典型Ｒ波的情况下，误检及 漏检率较大。
心电信号各心动周期之间对应波形的差异较小，可以将ＱＲＳ波、Ｔ波等近似为一个 个固定模板，将对ＱＲＳ波的识别转化为对ＱＲＳ波模板与其它模板的鉴别，称这种方法为 模板匹配法（又称相关法）。其算法原理是先通过学习的方式获得ＥＣＧ波形模板信号， 然后将ＥＣＧ采样点与存储的模板信号逐点比较，当耦合的相关性最大时，即可提取到 ＱＲＳ波群。这种方法不仅可检测到ＯＲＳ波群，而且可提取心律失常情况下的ＱＲＳ波，算 法抗工频干扰性能较好，但对高频噪声和基线漂移敏感，干扰较大时，需重新获得模板，
待处理信号与模板相差较大时，易造成漏榭５３，５４］。
小波变换技术在提高ＱＲＳ波检测的抗干扰及准确性方面取得了很好的效果，文献 【５５］对这方面的研究进展进行综述。小波变换法应用于ＱＲＳ波判别，具有不需要预消噪 和检测率高的特点。根据小波变换的尺度和信号频率间的关系，可以发现ＱＲＳ波群的
９

，Ｃ、ｌＵ波形伶测’ｊ心率变异ｒ｝分析方；』：研究
能量大多集中在２３尺度上，而基线漂移、运动伪迹等能量大多集中在２５尺度以上，故 一般取２３、２４尺度上的小波变换作分析信号。根据小波变换理论，Ｒ波峰点与模极大值 ．模极小值对的过零点有稳定的位移关系。因此，利用小波变换检测ＱＲＳ波是通过检测 Ｒ波的模极大值对的方法定位Ｒ波，选取一较小尺度由Ｒ波峰点位置开始向前、向后搜 索ＱＲＳ波的起点和终点，避免了ＱＲＳ波的宽度失真和基漂的影响。对于严重干扰和非 典型Ｒ波的情况，需对模极大值点进行提炼，以避免噪声对模极值点的干扰。小波变换 的ＱＲＳ波检测的典型算法及改进算法参见文献［５６，５７】。
文献【５８］提出了将小波分解与自适应滤波相结合的ＱＲＳ波的检测方法。算法有较强 的抗干扰能力和跟踪性能。文献［５９］提出了数学形态学方法和小波变换的相结合的ＱＲＳ 波检测新算法，解决其他算法无法消除的干扰问题，算法的检测准确率高，并减小了运 算时间。文献［６０］采用二次微分小波进行Ｒ波定位，使Ｒ波在小波尺度上对应于单峰值 点，从而减少了搜索过程。小波变换方法在心电信号的ＱＲＳ波群检测上拥有不容置疑 的优越性，其检测的准确性可达９９％以上，但一般计算量都较大，应用于实时检测受到 一定的限制。随着微处理器性能的提高和计算机多微处理器技术的发展，这一问题可以 获得较好的解决。因此，小波变换及其改进方法将越来越受到人们所青睐。
神经网络具有自学习的特点，能够适应信号的变化，其判别速度也比较快，不足之 处是样本训练时期较为耗时。Ｘｕｅ等人将基于人工神经网络的自适应匹配滤波器用于心 电信号ＱＲＳ波的检测，检测的正确率高达９９．５％ｔ６ｌ】。由于神经网络法的计算难度较大， 有些技术问题尚在探索之中，广泛应用受到一定的限制，但其发展前景令人注目。
３）ＱＲＳ波群的数学形态学检测方法 数学形态学是基于集合论方法，已经在二值图像和灰度图像的处理和分析中得到广 泛的应用。它的基本思想是用具有一定形态的结构元素去度量和提取信号的形态信息， 以达到分析和识别的目的。Ｔｒａｈａｎｉａｓ提出基于数学形态学的ＱＲＳ复合波检测的新方法， 它利用对心电信号波峰和波谷所作的形态运算检测ＱＲＳ波峰、波谷的形态，被提取信 号波峰、波谷的形态由结构元素决定。零幅度的水平线段集合被作为结构元素，由于 ＱＲＳ波包括陡峭的正或负波峰，且其周围区域不包括结构元素，故能被有效识别出来【６２１。 由于仅做形态（开／关）运算，故该方法运算简单，抗噪声能力强。 Ｐ波和Ｔ波的识别与定位一直是一个有待完善的问题。最初多采用类似于ＱＲＳ波 的斜率阈值法，由于Ｐ，Ｔ波幅值较低，斜率特征不明显，对于低平的Ｐ，Ｔ波易出现 误判。冯涣清等人采用双基准导联及多基线体系方法处理Ｐ、Ｔ波低平时基线漂移的影 响，但会受高频干扰【６３１。万相奎等人利用Ｐ波的四类基本形态，根据小波变换后Ｐ波对 应的模极大值对的特点，结合幅值和斜率判据，提出了一种基于小波一幅值．斜率的Ｐ波 检测方法。对临床采集的ＥＣＧ数据和ＭＩＴ／ＢＩＨ数据的进行Ｐ波检测，正确检测率达到 ９６％ｔ６４１。总的来说，对Ｐ波、Ｔ波的检测算法抗干扰能力较差，异常Ｐ波、Ｔ波的检测 效果不能满足要求，提高Ｐ波、Ｔ波的检测准确性仍是一个有待解决难题。 目前，对于心电特征波检测的研究方向仍是以提高检测率和减少检测时间为主，近
１０

兰州理Ｔ人学ｆ【ｌ｝ｌ。学位论文
几年来，不同的分析方法相结合的综合检测受到较多关注。除了上述波形波信息之外， ＥＣＧ信号也将波形的时限、时段、频谱、波形形状等作为特征信息。田立军等人将ＲＲ 间期和ＱＲＳ波的面积高度比作为ＥＣＧ信号的特征量，由此定义了９种心律失常【６５１。 Ｎｙｇａｒｄｓ分析了１．７＂－－－９Ｈｚ频谱的最大峰值附近的能量相对值，根据这些相对能量和最大 的频谱成分，判断心室纤颤和心动过速ｍ】。
在时频域提取ＥＣＧ信号特征是心电信号特征提取的新的研究方向，小波变换是采 用较多的时频分析方法，但由于小波基函数长度有限，对信号进行小波变换时会发生能 量的泄漏，这对于信号时频域的精确分析产生影响。小波分析的结果很多程度上受小波 基选择和分解尺度的影响，缺乏自适应特性。Ｈｕａｎｇ等人提出的经验模态分解的信号处 理方法受到关注，它一种自适应的信号分解方法【６。７１。文献［６８］和［６９］提出了基于经验模 态分解（ＥＭＤ）的ＱＲＳ波检验算法，经过ＭＩＴ．ＢＩＨ心律失常数据库全部数据的验证， 平均检测率达到９９．７８％，且具有良好的抗噪性。
１．３．２心率变异分析的研究现状
随着对ＨＲＶ研究的不断深入，其蕴含的生理病理信息将进一步被揭示，使得ＨＲＶ 有更多的应用空间和应用价值。目前，心率变异性分析方法主要有时域分析法、频域分。 析法、时频分析法以及非线性分析法［７０－７３１。
１）时域分析法：时域分析是测量心率变异信号最简单的方法，它是一种统计学分析 方法，通过统计学离散趋势分析法分析ＲＲ间期变化。时域分析包括长时程数据分析和 短时程数据分析，短时程分析的条件较容易控制，受外界的干扰小，在临床和实验研究 多采用短时程心电信号以获取ＨＲＶ信息。具体分析方法有统计学分析和几何图形分析。 统计学分析通过计算一系列有关ＲＲ间期的数理统计指标，来评价心率变异性的临床价 值。常用的统计指标如表１．１所示。几何图形分析是对Ｉ汛问期的分布进行分析，获取 ＲＲ间期的变异信息。常用的有ＲＲ间期直方图、ＲＲ间期差值直方图及ＨＲＶ的时间序 列图。时域的分析方法计算简单，意义直观，易于为临床医生所接受，并积累大量的经 验值，但是这种方法丢失了信号的时序信息，灵敏度、特异性低，不能进一步区分心脏 交感、迷走神经的张力及其均衡性的变化，在实际应用时要结合频域的分析方法或作为 评价其他分析方法的参考指标。
２）频域分析法：频域分析法又称功率谱估计分析法。目前，主要应用基于ＦＦＴ的经 典谱估计法和基于ＡＲ模型的现代谱估计法对ＲＲ间期序列进行谱估计【Ｊ７４】。在频域分析 中，一般将ＨＲＶ的功率谱划分为３个频段：超低频段（０．００３－４２．０４Ｈｚ）；低频段 （Ｏ．０４￣０．１５Ｈｚ）；高频段ＨＦ（Ｏ．１５～０．４Ｈｚ）。频域分析是将各种生理因素作适当分离后 进行分析，其生理意义比较明确，为自主神经系统调节功能的定量分析提供了工具，因 而有较大的临床应用价值。频域分析法也存在一定的问题，如经典谱估计方法有频谱分 辨率低、受窗函数影响及方差性能不好等问题，当数据较短时，这些问题变得更为突出。

心ＩＵ波形伶涮‘ｊ心牢变异忡分析方法研究

ＡＲ算法是常用的现代谱估计方法，具有较高的谱分辨率，能消除谱泄露现象，但自回

归模型阶数的确定存在一定困难。

’

基于线性分析的时域和频域分析在ＨＲＶ分析中已经趋于成熟，时域和频域指标能

在一定程度上反映出自主神经的活动水平，对于病人的监护和治疗具有一定的指导意

义。但是时域分析在反映的心率变化的涨落机制十分有限，而频域分析方法是建立在平

稳模型的基础上，不能够反映ＨＲＶ的动态特征和细节。这种心率波动的节律变化和其

它的多种生理节律（如呼吸）相互作用及微小的干扰的影响（如心室早收缩等），使得ＲＲ问 期序列表现出较强的非平稳性，用线性方法不能完全解释。大量医学实践中也证明了各

种商业仪器中的ＨＲＶ的计算指标具有非常大的局限性。时频联合分析和非线性动力学

的发展为ＨＲＶ分析提供了新方法，被认为有可能彻底改变生理学的传统面貌。

３）时频分析方法：常用的时频分析法包括短时傅里叶变换、Ｗｉｇｎｅｒ．Ｖｉｌｌｅ分布法、 小波变换等【｜７５】。ＨＲＶ信号时频分析可以清楚地刻画ＨＲＶ的谱状态的改变。Ｃｈａｎ等人

采用ＳＴＦＴ方法分析了药物麻醉、体位变化时，发现时频谱能更明显地体现瞬时事件发

生的情况【．７６】。Ｍａｒｔｉｎｍａｋｉ等人则采用ＳＴＦＴ方法分析正常状态、迷走神经阻滞、交感神

经阻滞三种状态下，坐姿变为站姿过程时，高频能量随时问的改变的情况，研究结果表

明由坐姿变为站立与自主神经的迷走神经调节的密切关系【＿７１７１。

Ｗｉｇｎｅｒ－Ｖｉｌｌｅ分布是一种具有高分辨率和良好时频聚集性的时频分布，但对于多分

量信号，Ｗｉｇｎｅｒ－ｖｉｌｌｅ分布出现了较严重的交叉项。通过添加平滑窗，可减小交叉项，称

为平滑伪Ｗｉｇｎｅｒ－ｖｉｌｌｅ分布。Ｃｈａｎ等人采用平滑伪Ｗｉｇｎｅｒ－ｖｉｌｌｅ分布分析了心力衰竭病人 的心率变异性，通过一些新的时频特征的提取，检验了１３．受体阻滞剂对该疾病的治疗

效梨７引。Ｋｕｕｓｅｌａ等人利用Ｗｉｇｎｅｒ－Ｖｉｌｌｅ分布分析了健康人的ＲＲ间期和收缩压的变异性，

结果显示］＂Ｗｉｇｎｅｒ－Ｖｉｌｌｅ分布在捕捉与时间相关信息方面具有优越性，并提出低频段内 存在两个波峰的重要概念【．７９】。

小波变换在ＨＲＶ信号分析方面已得到较多应用，并显示了优越的信号分析能力。

Ｇａｍｅｒｏ等人采用正交小波变换分析ＨＲＶ与心肌缺血的关联。结果表明在低频段和高频

段，心肌缺血时的频谱能量和正常时存在显著差异，说明心肌缺血可引起较高程度的心

率变异，反映出心脏缺血对心脏自主神经系统的影响【８们。Ｖｉｇｏ等人利用小波分析法研究 了年轻人和老年人的ＨＲＶ信号，以反映自主神经调节功能随年龄变化的改变情况【８¨。

Ｂｕｒｒｉ等人利用小波变换方法分析了室性心律失常发生前心率变异性的变化【８２】。

４）非线性分析方法：ＨＲＶ信号被普遍认为是混沌或含有混沌成分的信号【８３】。因此，

越来越多的学者将焦点集中于采用混沌理论和分形理论的非线性动力学理论研究复杂

的ＨＲＶ，希望通过非线性的分析方法充分发掘潜藏在ＨＲＶ信号中的信息。关联维数、

李雅普诺夫指数、散点图、功率谱指数、复杂度、各种熵分析及非稳定周期轨道等非线

性分析方法都被引入到分析ＨＲＶ信号的复杂性。目前，各种非线性方法在ＨＲＶ中的应

用成为国内外学者的一个研究热点。

１２

兰州理Ｔ人学博ｆｊ学ｆｔ论艾
将ＨＲＶ信号作为混沌信号来研究，最常用的方法就是用刻画混沌吸引子的分数维 数。ＨＲＶ信号的分形维数可以反映交感神经和迷走神经对心脏的调节过程。当交感神经 活动增强，而迷走神经活动减弱时，分性维数值减小。分形维数可用容量维和关联维表 示。由于关联维比容量维更准确且容易计算，故关联维是更为常用的指标。徐秋萍等人 研究了冠心病患者心率变化的混沌动力学特性，发现随着冠状动脉病变程度加重，关联 维数减小。ＲＲ间期之间的自相似复杂性减小，心脏应变能力下降【８４１。Ｉｍｒｚｕｎ等人使用 关联维的相关积分方法研究了健康人和室性早搏患者的ＲＲ间期，结果发现基于关联维 的关联积分方法较好地揭示了健康人和室性早搏患者的心脏混沌特性，且有很好的区分 性能【８５】。由于准确地计算时间序列的关联维数，往往需要大量数据点，对于用数小时的 心电数据仅提取出一个ＨＲＶ信号的关联维数，其临床意义有限。文献［８６】提出了一种 ＨＲＶ的动态分形维数的计算，并应用于体位改变和发生心肌缺血时的ＨＲＶ信号的分析， 动态分形维数值灵敏地检测出了ＨＲＶ信号的生理和病理变化。
Ｌｙａｐｏｎｏｖ指数可作为衡量ＨＲｖ信号在相空间周围收敛和发散程度的一个指标，可以 反映ＨＲＶ序列的混沌特性【８７】。刘心东等人采用Ｌｙａｐｏｎｏｖ指数分析了ＲＲ间期序列的混沌 特性，提出Ｌｙａｐｏｎｏｖ指数或许为室性心律失常病人的提供早期诊断依据【船】。在非线性动 力学理论中，熵是常用作动力系统复杂程度的度量。熵为零，表示系统是有规则的；熵 为无穷大则表示系统是完全随机的。近似熵是Ｐｉｎｃｕｓ在１９９１年提出的一个适合于对短程 数据进行分析的刻画系统复杂性的统计量指标【８９】。Ｐｉｎｅｕｓ等人分析了成人和儿童、ｆ卧位 和立位的ＨＲＶ信号，发现近似熵可以区别不同的对象。Ｆｅｒｒａｒｉｏ等人采用近似熵分析了
长程和短程ＨＲＶ信号，为早期诊断胎儿宫内窘迫提供一个参考指树９０１。杨福生等人通过
近似熵研究改变体位和心肌缺血情况下的ＨＲＶ的改变，结果发现可以通过ＨＲＶ的近似熵 的相对变化来判定受试者的生理状态改变【９１１。近似熵分析法的优点是所需要的分析数据 较短，抗干扰能力较强，包含了时间顺序信息。应用于ＨＲＶ信号分析时，近似熵可以反 映心率的调节机制。样本熵与近似熵的概念相似，但较近似熵有更好的相对一致性，在 生物医学信号的分析中获得较多应用【９２１。
复杂性测度具有算法简单，运算速度快的优点。目前，复杂度的定义有多种，ＬＺ 复杂度使用最为广泛，当其越接近ｌ，则说明时间序列越复杂，反之则越规则。ＨＲＶ序 列的复杂性可以反映ＲＲ间期序列的随机程度，或者说可以体现心脏受自主神经系统调 节的有序程度【９３１。张红煊等人采用Ｌ．Ｚ复杂度对发生恶性室性心律失常的ＨＲＶ信号的复 杂性进行了分析，结果表明利用Ｌ．－Ｚ复杂度对于恶性室性心律失常的识别率可达到 １００％１９４］。胡江和等人利用Ｌ．Ｚ复杂度对心律失常病人在服用氟卡尼前后的ＨＲＶ信号进行 测试，发现Ｌ．Ｚ复杂度指标能相对稳定地反映药物对病人ＨＲＶ作用，且动态地反映了药 物持续抑￥０ＨＲＶ的变化过程【９５１。叶志前等人将Ｌ－Ｚ复杂度用于麻醉状态下ＨＲＶ信号复杂 性变化的研究，发现Ｌ．Ｚ复杂度显著低于清醒状态，提示ＨＲＶ的复杂度变化可以作为麻 醉深度监测的一项重要指标ｍ】。

心ｌＵ波形怜测’ｊ心：年变异‘ｎ分析方ｉ左Ｊ｜ｉＪ『究
Ｌｏｒｅｎｚ散点图也是常用的非线性的研究方法，它是以图形的方式来对问题进行分 析研究。在运用Ｌｏｒｅｎｚ散点图对ＨＲＶ作非线性分析时，以某一个Ｉ状问期为横坐标，以相 邻的下一个ＲＲ间期为纵坐标绘制的图形。当数据达到一定数量时，就形成了ＨＲＶ散点 状图形，根据散点轨迹的不同形态特征，可以从总体上反映出心率变异性的变化规律， 直观的获得其中所包含的信息和对应的病理状况【９７】。成年人的Ｊ下常窦性心律的Ｌｏｒｅｎｚ散 点图多集中在４５０，呈现出“彗星状＂图形，而在各种心血管疾病患者和一些老年人群 中，则常常呈现出各种不同的图形特征，如扇形、短棒形等。散点图分析法还引入了向 量长度指数和向量角度指数作为量化参数，其中前者反映了ＲＲ间期的总体变化程度， 后者反映了相邻Ｉｍ间期的变化程度。由于Ｌｏｒｅｎｚ散点图在表达ＨＲＶ与某些疾病的联系上 简单直观，因此在临床上应用较多，但是其物理意义不是十分明确【９引。
总之，通过对ＨＲＶ信号更深入、更全面研究，将帮助人们从多个角度、多个层次充
分揭示ＨＲＶ信号中蕴含的生理病理信息。从近年来国内外ＨＩＷ分析方法的研究进展来
看，其中一些方法特别是非线性分析方法仍处于初步探索阶段，应用于临床实际还待时 日。线性分析和非线性分析方法的有机结合将是今后的ＨＲＶ研究的重要方向。时频分析 方法由于其自身有很多的优点，也将成为今后ＨＲＶ研究一个热点。
１．４实验数据来源
ＰｈｙｓｉｏＮｅｔ是一个基于Ｗｅｂ的复杂生理和生物医学信号的研究资源网站，其网址为 ｈｔｔｐ：／／ｗｗｗ．ｐｈｙｓｉｏｎｅｔ．ｏｒｇ。在美国国家卫生研究院（Ｎａｔｉｏｎａｌ Ｉｎｓｔｉｔｕｔｅ ｏｆＨｅａｌｔｈ’ｓ Ｎａｔｉｏｎａｌ Ｃｅｎｔｅｒ，ＮＩＨ）的资助下，１９９９年由美国麻省理工学院（ＭＩＴ）健康科学与技术中心联合 多家医学机构共同创建，旨在促进研究数据和分析软件的共享，激励对生物医学和生理 信号的最新研究，为相关研究人员提供相互协作的一个平台【９９，１００］。
ＰｈｙｓｉｏＮｅｔ由ＰｈｙｓｉｏＮｅｔ、ＰｈｙｓｉｏＢａｎｋ和ＰｈｙｓｉｏＴｏｏｌｋｉｔ－－＂个相互关联的部分组成。其中 ＰｈｙｓｉｏＢａｎｋ是一个免费共享的，并不断扩充的、记录了复杂生理信号和相关数据的大型 的数据文档集合，其中收录了３０多个大型数据库，主要包括：
１）ＥＣＧ数据库：如ＭＩＴ．ＢＩＨ心律失常心电数据库、ＣＵＶＴ室扑、室颤等恶性心律失 常数据库及用于测试的ＥＣＧ数据库等；
２）多参数数据库：如多参数智能重症监护数据库（ＭＩＭＩＣ ＩＩ）等典型生理信号数 据库，其数据包含有ＥＣＧ信号、血压信号、呼吸信号、脉搏信号及脑电（ＥＥＧ）信号等 多种典型生理信号；
３）Ｉｎｔｅｒｂｅａｔ（ＲＲ）Ｉｎｔｅｒｖａｌ Ｄａｔａｂａｓｅｓ； ４）Ｇａｔｅ Ｄａｔａｂａｓｅｓ； ５）Ｎｅｕｒｏｌｏｇｉｃａｌ Ｄａｔａｂａｓｅｓ； ６）Ｉｍａｇｅ Ｄａｔａｂａｓｅｓ； ７）Ｓｙｎｔｈｅｔｉｃ Ｄａｔａｂａｓｅ￥。
１４

兰州理Ｔ人学博Ｉｊ学ｆ矗沦文
数据库中数据来源于正常人、各种病人（如心脏猝死、心力衰竭、心律失常、癫痫、 睡眠呼吸暂停综合症等）及运动、休息等不同状态下的数据，样本选取范围广泛，‘其中 大部分数据都进行详细的注释，并将数据被划分为３类，即Ｃｌａｓｓ ｌ、２、３。Ｃｌａｓｓ １－专家 已经作出了标注；Ｃｌａｓｓ ２：原始数据；Ｃｌａｓｓ３：处于研究进展之中。因此，ＰｈｙｓｉｏＢａｎｋ 数据库中的数据足已满足生物医学各领域研究者的需要。
ＰｈｙｓｉｏＢａｎｋ数据库中的每一条数据记录包括至少三类文件，头文件（．ｈｅａ）、数据 文件（．ｄａｔ）和注释文件（．ａｔｒ，．ａｌ，．ａｉＭ等），头文件是描述数据属性的文本文件，其内容 包括记录名、信号数目、贮存格式、信号数量和类型、采样频率、数字化特征、记录的 持续时间和起始时间等信息。一般 Ｉ土ｔＰｈｙｓｉｏＴｏｏｌｋｉｔ软件库的ＷＦＤＢ库函数的ｇｅｔｉｎｆｏ、 ｐｕｔｉｎｆｏｉ函数读和写的字符。数据文件是定义了相应存贮格式的数字化采样点的二进制存 储文件。数据存贮格式在头文件中说明，一个数据组有相同的数据存贮格式，常用的是 ８位和１６位格式。注释文件是记录了对信号特征的注释信息。
ＰｈｙｓｉｏＴｏｏｌｋｉｔ是一个功能强大，包含有多种软件包且不断扩充的软件库，主要用于 生理信号的读取、分析、仿真、显示及描述等。主要有ＷＦＤＢ（Ｗａｖｅｆｏｒｍ Ｄａｔａｂａｓｅ）数 据库开发工具包、仿真软件、绘图软件、生理信号处理软件等。ＷＦＤＢ工具包由ＷＦＤＢ Ｌｉｂｒａｒｙ，ＷＦＤＢ应用程序和ＷＡＶＥ共三部分组成。ＷＦＤＢ Ｌｉｂｒａｒｙ是一个可用Ｃ，Ｊａｖａ， Ｍａｔｌａｂ等语言调用的函数集合。其作用是读／写数据文件、注释文件、头文件。ＷＦＤＢ应 用程序是一个功能强大的命令工具集，用于实现信号分析和处理。ＷＡＶＥ是用于波形分 析、显示和注释编辑的窗口应用程序，能实现如快速定位、搜索特定的注释类型等多种 功能。
ＰｈｙｓｉｏＮｅｔ是一个开放式的网络资源平台，可通过Ｉｎｔｅｒｎｅｔ自由地访问。通过这旷平台 研究者可免费获取原始数据和分析工具，进行数据合作分析和新算法的评估。网站同时 也提供最新研究进展著作论文、常见问题讨论及对用户的服务和培训等资源。ＰｈｙｓｉｏＮｅｔ 提供的数据资源是科学和严谨的，具有很高的权威性。
本论文中分析的ＥＣＧ和ＨＲＶ数据资料均来源于ＰｈｙｓｉｏＮｅｔ获取。其中ＥＣＧ数据取自美 国麻省理工学院提供的ＭＩＴ—ＢＩＨ心电数据库，共计３８个心电记录数据，每一个记录时间 约为３０分钟，由两路导联信号组成，信号的采样率为３６０Ｈｚ，Ａ／Ｄ分辨率为１ １Ｂｉｔ。健康 年轻人和健康老年人的ＨＲＶ数据取自ＭＩＴ．ＢＩＨ的Ｆａｎｔａｓｉａ Ｄａｔａｂａｓｅ，房颤病人的ＨＲＶ数
据取自ＭＩＴ．ＢＩＨ的Ｔｈｅ ＭＩＴ．ＢＩＨ Ａｔｒｉａｌ Ｆｉｂｒｉｌｌａｔｉｏｎ Ｄａｔａｂａｓｅ和Ｔｈｅ Ｌｏｎｇ—Ｔｅｒｍ ＡＦ
Ｄａｔａｂａｓｅ。正常人的ＨＲＶ数据取自Ｔｈｅ Ｍｒｒ．ＢＩＨ Ｎｏｒｍａｌ Ｓｉｎｕｓ Ｒｈｙｔｈｍ ＲＲ Ｉｎｔｅｒｖａｌ Ｄａｔａｂａｓｅ，慢性充血性心力衰竭病人的ＨＲＶ数据取Ｉ刍Ｔｈｅ ＭＩＴ．ＢＩＨ ＢＩＤＭＣ Ｃｏｎｇｅｓｔｉｖｅ Ｈｅａｒｔ Ｆａｉｌｕｒｅ Ｄａｔａｂａｓｅ数据库。由于仿真实验数据都取自国际上公认的标准心电数据库， 其实验数据来源十分可靠。
为了对各种ＥＣＧ信号处理算法的评测，ＭｃＳｈａｒｒｙ等人提出了动态心电产生模型，即 ＥＣＧＳＹ＇Ｎ心电模型【１２３１。该模型是一种基于时变微分方程的模型，同时考虑了逐次心跳
１５

心ｌＵ波形伶测‘ｊ心：爷变异。ｒｆ：分析方泫ｆｉＪｆ究
在形态和时问问隔上的变异性。实际上，该动态模型采用了５个高斯函数分别拟合ＥＣＧ 信号的Ｐ、Ｑ、Ｒ、Ｓ、Ｔ波形，然后将其叠加而获得一个完整ＥＣＧ波形。通过充分灵活地 选择模型的时域和频域特征参数可以任意调整ＥＣＧ信号的形态结构，从而可产生几乎和 实际心电一样的心电波形信号。模型也允许输出特定形态的心电波形信号。因此，在一 定程度上，ＥＣＧＳＹＮ心电模型可以输出满足各种生理条件的仿真ＥＣＧ信号。
该模型的心电信号产生可以分为两个步骤，第一步产生采样频率为‰的一内部时间 序列，该序列包含和实际ＲＲ问期序列相一致的平均心率、心率标准差及频谱特征信息； 第二步在每一个心动周期产生特定位置和特定峰值高度的一定形态的ＥＣＧ波形。在实际 应用时需要注意磊ｆＪ立取为尼曙的整数倍。关于该模型构建及不同形态心电信号输出的详细 原理可参考文献［１０ｌ】。
为了验证基于平稳小波变换的自适应心电信号去噪方法的有效性，通过设定 ＥＣＧＳＹＮ，ｔ二，电模型的参数，产生了算法需要的ＥＣＧ的原始波形。
１．５论文内容安排
论文将时频分析和非线性分析等信号处理的新方法应用于ＥＣＧ和ＨＲＶ信号的分 析，提出了有关ＥＣＧ信号预处理、特征波检测及ＨＲＶ特征提取与分析的新方法。各章 的主要内容安排如下：
第一章主要介绍了研究课题的来源及课题研究的意义，指出课题研究目的在于发展 心电信号处理及特征提取的新算法，以便为临床提供更可靠的诊断信息。分析了ＥＣＧ 信号和ＨＲＶ信号产生机理，给出了ＥＣＧ信号和ＨＲＶ信号的相关特征信息的定义及生 理含义，讨论了其临床诊断意义；综述了ＥＣＧ信号预处理技术，特征波检测和特征信 息提取以及ＨＲＶ信号分析方法的国内外研究现状，说明了各方法的优势与不足。
第二章主要研究了心电信号的预处理方法。讨论了不同ＥＣＧ信号预处理方法，提 出了一种平稳小波变换和自适应滤波相结合ＥＣＧ信号综合滤波方法，具有一次性可以 滤除多种不同噪声信号，并很好地解决小波消噪易出现Ｇｉｂｂｓ振荡现象及低频成分损失 的问题。
第三章主要研究了心电信号的Ｒ特征波识别与定位问题。分析了差分阈值法和小波 变换法两种典型的Ｒ波的检测方法。提出了基于平滑非线性能量算子的Ｒ波检测算法， 通过对干扰严重的ＥＣＧ信号的实验获得了满意的检测结果，与小波变换法相比，算法 计算复杂性降低。
第四章主要研究了基于Ｈｉｌｂｅｒｔ时频谱及其边际谱的ＨＲＶ信号分析方法。简要介绍 了希尔伯特．黄变换（Ｈｉｌｂｅｒｔ－Ｈｕａｎｇ ｔｒａｎｓｆｏｒｍ，ＨＨＴ）的基本理论，提出两种新的ＨＲＶ信 号频谱分析方法，通过分析不同病症的ＨＲＶ信号的Ｈｉｌｂｅｒｔ时频谱及其边际谱的差异， 在时频谱和边际谱上定义和提取了ＨＲＶ信号谱特征，结合不同病症分析了谱特征的区 分性能。
１６

兰州Ｉ理Ｔ人学博Ｉ！学ｆ汪论文
第五章主要研究了ＨＲＶ信号的非线性复杂度和熵分析方法。介绍了复杂度和熵分 析方法的基本概念。提出了基于Ｈｉｌｂｅｒｔ边际谱熵、能量谱熵及分频段Ｈｉｌｂｅｒｔ时频谱熵 的ＨＲＶ信号分析方法，应用于不同生理病理状况的ＨＲＶ信号分析获得了很好的分析效 果，性能优于传统分析方法。
论文最后对全文进行了总结，给出了研究结论和下一步研究工作的设想。
１７

心Ｉ【！波形伶测’ｊ心牢变异忡分析方法研究
第２章基于平稳小波变换的自适应心电信号滤波方法
２．１引言
在生物医学信号分析时经常会遇到有用信号叠加无用噪声的问题。从原始信号中消 除或减弱干扰噪声是生物医学信号处理中的一个重要问题。心电信号是弱电信号，在采 集、放大及传输的过程中，会有许多干扰耦合带到心电信号中，从而降低心电信号的信 噪比。因此，从被噪声污染的心电信号中获取“干净”的心电数据，确保医学诊断信息的 准确是心电信号预处理的主要任务。
心电信号通常包含多种信号噪声，且各种干扰之间的频谱可能相互重叠，更重要的 是有些干扰可能与心电信号本身的基频相重合。如基线漂移的频率很低，其范围为 ０．０５Ｈｚ至几Ｈｚ。而心电信号的Ｐ波、Ｔ波及ＳＴ段的频率范围为０．５Ｈｚ至１０Ｈｚ，两者 的频谱非常接近，在消除噪声的同时，不可避免地对心电信号有用成分造成一定的损失。 总的来说，心电信号预处理大多是针对单一干扰进行设计的，如工频干扰的消除，要消 除基线漂移或肌电干扰，则需要再次进行滤波处理。许多算法较多考虑了对干扰的滤除， 而忽略对特征信号的完整性保护，导致滤波后出现特征波被衰减，甚至消失的情况。本 章研究目的是提出一种心电信号的一次性滤波方法，且无特征波失真。
２．２心电信号的能量分布和噪声分析
典型的心电信号的整个心动周期的频谱估计图如图２．１所示，可以明显看出心电信号 各波的能量主要集中在低频区域，且随着频率的增高，相应的能量逐渐降低。心电信号 的整体频谱范围在０．０５Ｈｚ＂－＂１００Ｈｚ，但能量主要集中在０．５＂－＇４５Ｈｚ，能量的最高点在８～ １５Ｈｚ附近；ＱＲＳ波群的频谱带宽为３＂－＇４０ Ｈｚ，积聚了将近９９％的能量，波峰能量集中 在６～１８Ｈｚ附近，Ｐ波的频谱带宽为０＂－＂１８Ｈｚ，波峰能量集中在５＂－＇１２Ｈｚ；Ｔ波的频谱带宽 为０＂－＇８Ｈｚ，波峰能量集中在０＂－＇８Ｈｚ区间【１０２】。
畸Ｏ‘ ● 蕾
Ｏ·４
Ｏ．： Ｏ且
■●（Ｉ蛐
图２．１典型的心电信号频谱能量分布
１８

兰州砷Ｔ人学博ｆｊ学化论殳

在采集、放大及传输心电信号的过程中，由于受人体、采集仪器、电磁环境、操作

水平等的影响，不可避免会有许多干扰耦合到心电信号，主要干扰表现形式如下：

１）电源工频干扰

“

产生的原因主要由于电源磁场作用于心电图仪的导联与人体之间的环形电路所致，

表现为心电信号上有明显的币弦波或正弦波的叠加信号，其频率为５０ＨｚＩ频及其谐波构

成，幅度较低。

２）基线漂移

产生的原因主要由于人体呼吸运动、电极接触不良等因素所导致。表现为心电信号

上叠加缓慢变化的信号，其频率一般小于１Ｈｚ，幅度为ＥＣＧ峰．峰的１５％。

３）肌电干扰

产生的原因主要由于人体活动，肌肉紧张所引起的干扰。表现为不规则的快速变化

波形，其频率范围较宽，一般在５，－一２ｋＨｚ之间，幅度为毫伏级。

４）运动伪迹

产生的原因主要由于电极与人体问轻微移动或抖动而引入的干扰，表现为信号基线

的短暂变化，但不是基线的跃变，其持续时间为ｌｏｏ～５００ｍｓ，频率一般在７Ｈｚ以下，幅

度较大。

５）其他随机噪声

心电信号还受到其他的随机噪声和环境干扰的影响，如加性白噪声、极化噪声、仪

器内部噪声等。

由此可见，噪声信号基本覆盖了有用的心电信号的全频率范围。而其中５０Ｈｚ及其倍

频附近的工频干扰、１Ｈｚ以下的基线漂移以及肌电干扰噪声是最主要的干扰源，在心电

信号预处理中必须消除或抑制，以提高心电信号的信噪比。

对于心电信号预处理一般要从硬件电路优化设计和软件数字滤波器的设计两个方

面考虑。根据心电信号的频谱分布特点，在硬件方面来看，消除基线漂移的干扰应考虑

分别设计下限频率为０．５Ｈｚ的高通滤波器：消除肌电等高频干扰应考虑设计上限频率为

１００Ｈｚ的低通滤波器，同时还应考虑设计５０Ｈｚ的陷波器来滤除工频干扰。由于硬件滤波

器的元器件精度、稳定性要求以及难以实现严格线性相位等问题，使得仅采用硬件滤波

不能满足滤波性能的要求。随着数字信号处理技术的发展，设计高精度、高可靠性、简

洁灵活的数字滤波器成为可能。目前，滤除心电信号干扰更多采用的是具有线性相位的

数字滤波方法，并已逐渐显示出取代硬件滤波器的趋势。

２．３常用的心电信号去噪方法

２．３．１工频干扰的抑制 ２．３．１．１平均滤波器

１９

－ｔ５ＩＵ波形伶测－ｊ心平爱＂件分ｆ『ｒ方ｆｊ：硎’Ｅ

平均滤波是较早被应用的数字滤波方法，其特点是算法简单，处理速度快，滤波效 果较好。由于平均滤波算法的实时性好，被广泛应用于实时心电监护设备中或基于单片 机心电数据采集系统中。
Ⅳ点平均滤波器的差分方程为

ｙ（刀）２专篆ｘ（胛一后）２专瞰甩）＋ｘ（即．１）．．．＋ｘ（ｎ－Ｎ－１）］ Ｑ．１’

Ⅳ点平均滤波器频率特Ｈ（性ｚ）为：土蜂：上ｅ巾（删２—ｓｉｎ（ｃｏ—Ｎ＇２）

（２．２）

一 Ⅳｌ—ｅ１。 Ｎ

ｓｉｎ（ｃｏ／２）

可见，其频率特性为ｓｉｎｅ函数，在２，唬／Ｎ ｋ＝ｏ，１，…，Ⅳ一１处，其幅值为零，主瓣 的单边的带宽为２７ｒ／Ｎ。显然，平均滤波的Ⅳ值不宜取得过大，否则将使其主瓣的单边 带宽大大减小，这可能造成滤波时有用信号受到损失。
利用平均滤波滤除心电信号中的５０Ｈｚ工频干扰时，应将心电信号的采样频率取为

工频的整数倍，即刀韦够，石为心电信号的采样频率，石为工频干扰信号的频率。这样， 对于工频干扰信号的每一个周期包含有疗个等间隔采样点，求取其平均值必为零，则可 完全消除了工频干扰信号。从实际滤波效果看，滤波器能较好地滤除了５０Ｈｚ工频，但

对ＥＣＧ中的ＱＲＳ波有较大削峰，信号衰减较大。因此，在实际应用中受到一定的限制。

２．３．１．２梳状滤波器

梳状滤波器的名称源于该滤波器的传递函数的幅频特性形如梳状。其特点是运算量

小、形式灵活简单，是一种快速的数字滤波器。梳状滤波器被广泛应用去除工频及其高

次谐波的干扰。

最简单的梳状滤波器的传递函数为

酢）＝孚

（２．３）

２丁ｓｉｎ（ｃｏＮ／２） 则雕）在２兀内有Ⅳ个等分的零点均匀分布于单位圆上。酢）的频率响应为

日（ｅｐ）＝Ｔ１－ｅ－ｊａ＇ｖ＝ｊ２ｅ－Ｊ，口ｍ

（２．４）

其幅频响应曲线呈梳状，且在每一个峰值和过零点之间都有一个幅度逐渐衰减的 “过渡带＂，滤波前后信号产生一定的线性相移。若用于滤除工频干扰，会使心电信号 产生较大失真。改进的方法是在单位圆上的每一个零点位置处又引入一个极点，以抵消 其零点，使得幅频响应的每两个过零点之间变得比较平坦，从而减小滤波后对幅值的衰 减。选择合适的滤波参数，可保证滤波器对有用信号基本无衰减和滤波后基本不产生相 移【１０３１。改进的梳状滤波器可用于消除ＥＣＧ的工频干扰且能有效地防止信号的失真。
２．３．１．３ Ｌｅｖｋｏｖ滤波器

兰州理Ｔ人学ｆ｛Ｉｉ ｌｊ学ｆｔ论文

Ｌｅｖｋｏｖ滤波器是Ｌｅｖｋｏｖ在１９８４年提出一种对ＥＣＧ信号的线性段和非线性段采用

不同处理方式的数字滤波方｝！去【３１１。其基本原理是从原始ＥＣＧ信号中直接减去在该线性

段中确定的干扰信号的幅值。它要求原始ＥＣＧ信号满足三个条件：

１）采样频率￡应是工频干扰的整数倍；

２）在一个工频干扰周期ｒ内，工频干扰采样点的幅值的代数和为０。

３）在一个线性段中，要求滤波后相邻的心电信号采样点的差值相等，而非线性段

不满足该条件。

设原始不含噪声的心电信号为翰，则实际心电信号为 岛＝ｔ＋Ⅵ
其中：Ｍ为干扰信号，研为包含有噪声的采样心电信号。

（２．５）

依此不同时刻信号和噪声的计算值，容易推导线性段计算的通式为 Ｘｉ＋ｌ＝［（墨＋ｓｊ＋ｌ＋ｓ“２＋ｓｆ＋３＋ｓ“４）一（Ｊｆ＋５一Ｊ，）】／５ ｗｆ＋ｌ＝ｓ“ｌ一靠ｌ

（２．６） （２．７）

由于工频干扰的相位在短时间内不会有太大的变化。因此，对于在非线性段时，可

用最近线性段计算的噪声作为当前噪声的一个预测值，求得信号值。

．蠡．

改进的Ｌｅｖｋｏｖ滤波方法中引入了判定线性段和非线性段的指标Ｍ。算法的滤波效

果与选择合适的Ｍ值有关【３２１。当Ｍ取值过小时，遇到幅值较高的噪声干扰，会把信号

当作非线性的ＱＲＳ波处理，可能出现滤波不干净的现象。当Ｍ值较大时，工频干扰可

以被消除的很干净，但很有可能把ＱＲｓ波当作线性段来处理，出现ＱＲＳ波被严重削峰。

改进Ｌｅｖｋｏｖ滤波法算法简单，参数可调，运算量小，可实现实时心电信号滤波处理，
”
但在噪声较强时，将会造成ＱＲＳ波群的削峰现象，滤波效果不能令人满意。

２．３．１．４自适应工频陷波器

自适应滤波技术特点是只需要很少或根本不需要任何有关信号和噪声的先验知识

的情况下，直接利用观测数据不断递归更新自身的参数，以逐步逼近某～最优值，能自

动跟踪信号频率漂移，具有非常好的适应性【２１。在自适应噪声抵消系统中，当噪声为５０Ｈｚ

工频干扰时，自适应抵消系统即为自适应工频陷波器。含有两个调节权值的自适应陷波

器如图２．５所示。

设原始信号是含有５０ＨｚＩ频干扰的心电信号。参考输入和心电信号同步采样，是一

余弦波Ｂｃｏｓ（∞ｏ尼瓦＋伊）信号，采样频－率ｆ，＝ｌ／Ｔ，，乃为采样周期，参考输入，－∞经９００相移后

变为ｒｅ（０，则有

‘（七）＝Ｂｃｏｓ（‰螺＋伊）
吃（七）＝Ｂｓｉｎ（ｃｏｏ尼Ｚ＋伊）

（２．８）

２１

。心ｌＵ波形伶测’ｊ心：＃变异忡分析方法ｆｉＪ『究

图２．２ ５０Ｈｚ工频自适应陷波器

自适应滤波器的权值调节可以采用最小均方误差算法（Ｌｅａｓｔ Ｍｅａｎ Ｓｑｕａｒｅ，ＬＭＳ）。 基本的ＬＭＳ的迭代算法可以表示为

Ｐ（尼）＝石（尼）一Ｒ１（后）∥（尼）

（２．９）

Ｗ（ｋ＋１）＝形（七）＋２，ｔｔｅ（ｋ）Ｒ（ｋ）

（２．１０）

式中，职幼为ｋ时刻自适应滤波器的权矢量，顶幼为ｋ时刻的输入信号，Ｒ（妨是参考输入矢

量，Ｐ（幼为ｋ时刻误差输出信号，∥是步长因子。 式（２．１０）给出了一种非常简单的权矢量的递推算法，称为Ｗｉｄｒｏｗ．ＨｏｆｊＦ ＬＭＳ自适

应算法。该自适应滤波方法可以根据信号的变化自动调节权矢量以获得最佳输出。ＬＭＳ

算法收敛的条件为

０＜∥＜１／２。＝ｘ

（２．１ １）

其中，厶删是输入信号自相关矩阵的最大特征值。 可以推出，自适应数字陷波器的传递函数为

日（ｚ）：塑：——』芸亟缝乓兰二ｊ百 （２．１２） 、’Ｘ（ｚ）ｌ一２（１一胪２）ｃｏｓ（国ｏｔ）ｚ叫＋（１—２１，ｔＢ２）ｚ一２
陷波器的带宽Ｂ鼢

，，，，Ｒ２
Ｂ形＝三竺，－
２：

（２．１３）

可以看出，陷波器传递函数的零点Ｚ。＝Ｐ＋胁Ｌ，即它对缸助中频率为ＣＯｏ的信号有极强

的衰减作用。极点Ｉ ｚ，Ｉ￣１一加２（胪２＜＜１）在单位圆内，保证了陷波器的稳定，减小胪２，
可以有效地减小带宽，增大品质因数。

由自适应滤波理论可知，固定步长的ＬＭＳ算法在对收敛速度、时变系统的跟踪能力

和稳态失调之间的要求上存在很大矛盾。为此，已提出了各种变步长自适应滤波算法。

文献［１０４］提出步长因子的调整原则是在初始收敛阶段或未知系统参数发生变化时，步长 应比较大，以便有较快的收敛速度和对时变系统的跟踪速度：而在算法收敛后，应保持 很小的调整步长以达到很小的稳态失调噪声。根据这一步长调整原则，文中引入了
Ｓｉｇｍｏｉｄｉ函数，其算法的步勘是ｅ（ｎ）的Ｓｉｇｍｏｉｄｉ函数，即

兰州Ｉ理丁人学博卜亨：１ｔ沦艾

…一

ｊｕ（ｋ）＝∥（１／（１＋ｅｘｐ（－ａｌｅ（ｋ）１））－０．５）

（２．１４）

该算法能同时获得较快的收敛速度、跟踪速度和较小的稳态误差。不足之处在于

Ｓｉｇｍｏｉｄ函数过于复杂，且在误差Ｐ（幼接近零处变化太大，使得在自适应稳态阶段算法

仍有较大的步长变化。文献［１０５１提出了另一满足步长调整原则的∥和Ｐ（ｐ的函数关系为

∥（后）＝ｐ（１一ｅｘｐ（－ａｅ（ｋ）‘）

（２．１５）

其中，参数ａ＞Ｏ控制函数的形状，参数胗Ｏ控制函数的取值范围；步长∥和误差ｅ的函数关
系比Ｓｉ舯ｏｉｄ函数简单，且在误差ｅ接近零处具有缓慢变化的特性，克服了Ｓｉ舯ｏｉｄ函数在
自适应稳态阶段步长调整过程中的不足。 自适应滤波的权值调节的另一种形式是递推最ｄ、－－－－乘法（Ｒｅｃｕｒｓｉｖｅ Ｌｅａｓｔ Ｓｑｕａｒｅｓ
ＲＬＳ），ＲＬＳ自适应滤波算法采用二乘方的时间平均的最小化准则取代最小均方准则， 并按时间进行迭代计算。即要求使从初始时刻到当前所有误差的平方和为最小，再按这 一准则确定权矢量矾误差最小依据的准则为

占（甩）。ｉｎ＝∑刀一‘ｅ２（七）

（２．１６）

式中，Ａ为遗忘因子。 一般来说，ＲＬＳ自适应算法与ＬＭＳ自适应算法相比，权值有更快的收敛速度。缺
点是每次迭代计算量较大，由于在生物医学应用中数据的计算量不是太大，ＲＬＳ自适应 算法可获得更好性能。

２．３．２基线漂移的消除

２．３．２．１基线拟合方法

通常基线拟合多采用简洁、快速的分段拟合法。其基本原理是通过对采样的心电数

据分段进行三次多项式或抛物线拟合，获取基线漂移曲线，然后用原始心电曲线减去拟

合曲线来消除基线漂移。算法的关键是插值点选择，插值点应该是心电信号的零电位点，

通常采用ＴＰ段。

为了自动寻找ＴＰ段确定插值点，需要估计出Ｔ波终止点。可以采用Ｂａｚｅｔｔ公式计

算ＱＴ间期为ｆ９６】

ＱＴ＝ｏ．３９４－面

（２．１７）

从Ｑ波起点跳过ＱＴ间期，即到达Ｔ波的终点，在此之后的若干毫秒处选择插值点。

Ｂａｚｅｔｔ公式的估计误差可达＿４０ｍｓ。选用Ａｓｈｍｓｎ公式估计ＱＴ间期较为准确，即

ＱＴ＝Ｋｌｏｇ（１０ＲＲ＋０．０７）

（２．１８）

ｆ０．３７５
其中，Ｋ＝｛０．３８０ １０．３８５

儿童 成年男性 成年女性

心ｌＵ波形榆测’ｊ心：午变异性分析方法研究

为了实际计算方便，可以从Ｒ波峰值往后越过Ｑｒ间期来确定插值点新。为了防止

在发生室性早搏等心律失常的情况下，插值点落在ｒ波的下降沿上，可在插值点之后的

６０ｍｓ范围内寻找心电波形斜率为最小的点，作为实际插值点。

设两个相邻心动周期之间的分段拟合曲线为多。，对于整段采样心电数据的拟合曲线

多是由各分段拟合曲线光滑衔接而成，即

多＝多。ｏ多２ ｏ…ｏ多。

（２．１９）

则消除基线漂移后心电数据为

Ｊ，训＝Ｙｍ一多

（２．２０）

式中，粥Ⅲ是基线校Ｊ下后的心电信号，‰是原始心电信号。

２．３．２．２ ＦＩＲ滤波器的基线漂移的消除

ＦＩＲ滤波器只有零点，不易获得较好的通带与阻带衰减特性。要取得好的衰减特性，
一般要求雕）的阶次要高。ＦＩＲ滤波器有如下突出的优点：１）ＦＩＲ系统总是稳定的；２）
容易实现线性相位；３）允许设计多通带（或多阻带）滤波器。
设ＦＩＲ数字滤波器的单位冲激响应＾（以）为一个Ⅳ点有限长序列（嘶姘１），其Ｚ
变换为

日（ｚ）＝∑ｈ（ｎ）ｚ１

（２．２１）

由式（２．３５）可看出，酢）是ｒ１的Ⅳ－１次多项式，它在有限ｚ平面（０＜ｌｚＩ＜∞）内有
批１个零点，在ｚ平面原点ｚ＝０处有Ⅳ－１阶极点。因此，ＦＩＲ滤波器总是稳定的。 ＦＩＲ滤波器在单位圆上的频率响应为

Ｈ（ｅｐ）＝Ｈ（ｚ）ｔ：；∥＝∑＾（甩）Ｐ咖

（２．２２）

对于ｈ（ｎ）偶对称时，其频率响应为

球归）：Ｐ州≯艺坳）ｅｏｓ［（掣叫缈】

（２．２３）

幅频响应为

：＝肛以 １以ｃｏｓ［（掣罕一一，，１）缈】

（２． ２４）

（２．２４）Ｈ（ｃｏ）Ｚｈ（）ｃｏ

相频响应为

ｐ（缈）：一（掣矽

（２．２５）

可见，ＦＩＲ滤波器是具有准确的线性相位的滤波器。 ＦＩＲ滤波器设计的基本思想：根据要求的频率响应Ｈｄ（ｅｔ。＇），找出一单位样值响应ｈ（ｎ） 为有限长的时间离散系统，使其频率响应俄扩）尽可能地逼近要求的频响频率响应

兰州理Ｔ人学博ｆ’学化沦爻

１）对给定理想滤波器频率响应协（扩）进行Ⅳ点等间隔采样，即Ⅳｄ（ｅＪＷ）Ｉ。掀Ⅳ

２）以Ｈｄ（尼）为实际ＦＩＲ滤波器的频率特性的抽样值日（后），即令

Ｈ（后）２ Ｈｄ（尼）＝日ｄ（Ｐｐ）ｌ，．，：抛ＪⅣ，肛ｏ，ｌ，…，Ｎ－１

（２·２６）

３）根据频域内插公式，利用Ｎ个频率抽样值俄助内插得到实际ＦＩＲ滤波器的频率 响应Ｉ－Ｉ（ｄ。３，即

Ｈ（ｅ弘１）＝＝∑芝Ｈ（聊尼）小厂沏国一一等尼和）

（２．

』’

（２．２７）ｋｆｆｉＯ

其中，．Ｊｑｃｏ）是内插函数

他砖等Ｐ巾∞

＠２８，

，０３瘕、，

酢兮口。掣。篓∥疵踯） Ｈ（Ｐ扣）：口吖Ｔ。艺专。Ⅳ疵日（尼）

ｓｉｎ［Ｎ（主一丙）】 功疵、

（２．２９）

ｓｉｎ（ ｉ—Ｎ１

从式（２．２９）可以看到，在Ⅳ个频率采样点上，设计的滤波器，实际的频率响应严

格地与理想滤波器的频率响应数值相等。在采样点之间，频率响应由各采样点的内插函 数延伸叠加而形成，因而有一定的逼近误码差，误差大小取决于理想频率响应曲线的光 滑程度及抽样密度。因此，若获得逼近误差不满足要求时，可通过改变取样方式和增加

采样密度的方式来修正ＦＩＲ滤波器设计。

利用频率采样设计方法可以设计滤除基线漂移的高通ＦＩＲ滤波器，设其理想频率响 应特性为

刚门＝｛ｏ Ｉ矧二荔

晓３。，

２．３．３小波变换的心电消噪
２．３．３．１小波变换的基本理论
１９８４年法国年轻的地球物理学家Ｊｅａｎ Ｍｏｒｌｅｔ在分析石油勘探的地震信号时提出小 波变换的概念。它继承和发展了短时傅里叶变换的局部化思想，克服了窗口大小不随频 率变化和缺乏离散正交基的缺点。对于小波变换在信号消噪中应用进行了广泛深入的研

究，出现了大量研究成剁１０６］。 小波（Ｗａｖｅｌｅｔ）是指小区域的波，是一种特殊的长度有限、平均值为零的波形，
其特点：１）“小”，即在时域都具有紧支集或近似紧支集；２）正负交替的波动性，即 直流分量为零。
对于能量有限的信号ｘ（ｔ）ｆｆｑ连续小波变换定义为在￡２（Ｒ）的Ｈｉｌｂｅｒｔ空间上的内积：

啪沏如帆∥））２丽Ｉ脚∥’（学渺

（２．３１）

式中，ｙ（ｆ）为基本小波，ａ为尺度因子，ｂ为时间因子，ｙ’（ｆ）表示∥（ｆ）的共轭。ｙ舶（ｆ）

川，＝百１掣础 为基本小波伸缩和平移的小波序列。 其逆变换为

㈦３２）

虬．。（ｆ）的傅里叶变换为

痧。．６（功）＝√矽（口∞弦一脚

（２．３３）

则小波变换的频域表示为

Ｗｘ（ａ，ｂ）＝１ｉｘ，∞），∥４，６（∞））＝瓦ａ￡ｘ（∞）痧‘（ａｏ））口弦７如 （２．３４）
设ｇ／（ｔ）的时间中心为ｔｏ，时宽为Ａｔ，矽（缈）的频率中心为ＣＯｏ，带宽为彳∞，则∥柚（ｆ） 的时频窗为

【６＋口气一口△ｆ，６＋口气＋口Ａｔ］×［（Ｏｏ－Ａｃｏ，，ｃｏｏ＋６ｃｏ．］

（２．３５）

显然，ｂ仅影响窗口在相平面时间轴上的位置，而ａ不仅影响窗口在频率轴上的位 置，也影响窗口的形状。少。ｊ（ｆ）确定的时频窗口面积与沙（ｆ）的相同，但形状各异。当尺 度因子ａ减小时，窗口宽度（即时间观察范围）减小，而窗口高度（即频率观察范围） 增加，相当于用高频小波作细节观察；当尺度因子ａ增大时，窗口宽度（即时间观察范 围）增大，而窗口高度（即频率观察范围）减小，相当于用低频小波作概貌观察。如图 ２．７所示。因此，小波变换具有敏感的“变焦”性。
由于小波变换提供了一个在时频平面上可调的分析窗口。信号的时、频分辨率可以 随分析任务的需要作出相应调整。在低频时小波变换的时间分辨率较差，而频率分辨率 较高；在高频时小波变换的时间分辨率较高，而频率分辨率较低，自动满足了信号分析 客观实际的需要。
在计算机上实现小波变换时，连续小波必须进行离散化处理。在离散化时，为了便 于计算机处理，通常将尺度因子ａ和平移因子ｂ分别取作ａ＝２ｊ，６＝七２，，由此得到的 小波称为二进小波，即

兰州胖Ｔ人学博卜学化论之

．．

似｛

４±／２

■ｌ

一！ｌ

…

㈣垃＂讷＿｜．……十；五……一ｉ－－１Ｌ＿Ｊ‘‘＇』●∞ 一

缸－－∞１·）卜∞……。｛．．Ｌ一．……；惫＿…＾……“｛．…－。＿南¨｛．…．－ ２．Ｊ￡
弛＝２）∞以■…三三兰纠三２……主三三ｊ…

允ｔ２

，

图２．３小波变换的时频窗Ｉ＝１特点

缈ｍ（ｆ）＝２－ｆ２沙（２一，ｔ－ｋ） ／，ｋ∈Ｚ

若吵似（ｒ），＿，，ｋ∈Ｚ是￡２俾）上的Ｒｉｅｓｚ基，且满足

（‰‰，）嘞驴％妥∥卸’

（２．３６）
眩３７）

则称生成∥从（ｆ）的基本小波∥（ｆ）为正交小波。 Ｍａｌｌａｔ在构造正交小波基时提出了多分辨率分析的概念，从空间的概念上形象地说
明了小波的多分辨率特性，给出了正交小波的构造方法及正交小波变换的快速算法，即 Ｍａｌｌａｔ算法。一个三层小波分解树如图２．４所示。从图中可以看出，多分辨率分析仅对 低频空间进一步分解，使频率的分辨率变得越来越高，而高频空间则不予考虑。

图２．４三层多分辨率分析结构图

若以巧表示图中的低频部分９，砀表示分解中的高频部分西，则多分辨率分析的子

空间可以用有限个子空间来逼近，即有

％＝巧０％＝匕ｏ％ｏ呢＝…＝％０％ｏ％一Ｉ…％０％

（２．３８）

由多分辨率分析可知，一个离散数字信号顶，１）可表示为

石（，１）＝ｃ。ｘ＋∑ｄ册ｘ
ｊ＝ｌ

（２．３９）

式（２．３９）表明，既可由信号缸以）求出任意尺度／下的低频信号铲（即逼近信号）

和高频信号如（即细节信号）。也可由各尺度下的细节信号和逼近信号重构原信号缸刀）。

心ｌＵ波形柃测‘ｊ，Ｌ、牢变异悱分析方法研究

尺度函数哆．。（ｆ）是巧中的规范正交基，而小波函数∥”（ｆ）是嘭中的规范Ｊ下交基， 且巧＋。＝¨ｏ％。因此，在相邻尺度下的尺度函数和尺度函数之间必然存在一定的关系， 即满足二尺度差分方程，即

ｃｐ（ｔ）；，ｆ２∑ｈ（ｋ）（ｐ（２ｔ一七）
★∞２７
ｇｔ（ｔ）＝压∑ｇ（尼）妒（２ｆ一尼）
ｋ＝－ｏｏ
其中，加权系数乃（ｐ，甙助分别由下式求出：

（２．４０） ’

五（尼）＝（纯。（ｆ），旷。。（ｆ））＝万１ ｐ（吾）妒＋（ｆ＿ｋ）ｄｔ

～ｚ

二

（２．４１）

ｇ（尼）＝（Ｉｃ，，。ｏ），‰。ｏ））＝了１ｉ肜（吾）伊＋ｏ—ｋ）ｄｔ

可见，＾∞和烈妨与，无关。因此，可将＾（幼、烈助和两通道滤波器组相对应，即ＪＩｌ（幼 （称为低通滤波器系数）对应低通滤波器曰∽，而烈助（称为高通滤波器系数）对应低 通滤波器Ｇ（ｚ），从而把多分辨率分析和滤波器组相结合。
通过滤波器组，Ｍａｌｌａｔ给出的离散正交小波变换的快速金字塔算法，即Ｍａｌｌａｔ算法。 若缸幼为原始信号序列，令ｃｏ＝ｘ（ｋ），则信号的离散正交小波变换分解为

＝

Ｚ

、－●＿、ｌ ％“ 珊肼 ＝ 日Ｇ ，Ｌ，－，Ｚ、，、Ｊ 勺勺

产０，１，…Ｊ－１

（２．４２）

式中，印ｌ为尺度系数，略ｌ为小波系数，酢）、Ｇ（ｚ）分别为低通滤波器和高通滤波器， Ｄ０为下抽样算子，劝最大分解尺度，信号的小波分解框图如图２．５所示。
由于映射｛Ｄｏ坝力，ＤＯＧ仞）为正交变换，所以从印Ｉ和办ｌ很容易经反变换得到９，则 重构公式为

ｃ，＝Ｚ１日‘（ｚ）ｃ，＋ｌ＋ＺｌＧ＋（ｚ）ｄ，＋Ｉ

（２．４３）

式（２．４３）也可写为

Ｃｊ＝Ｒ（Ｃｊ＋Ｉ，ｄ，＋Ｉ）

（２．４４）

式中，Ｚｌ为上抽样算子，∥∞、Ｇ‘∽分别为重构低通滤波器和重构高通滤波器，Ｒ为对应

的重构算子。信号的小波重构框图如图２．６所示。使用正交小波对信号作多分辨率分解与

重构的过程中，分解和重构所用的滤波器是相同。
从滤波器组的角度看，若酢）的频带在Ｏ～ｘ／２，Ｇ（ｚ）的频带在∥２－。ｘ，，ｌｌＶｚ，ｃｏ（ｋ）所处的

频带是Ｏ呵，ｅｌ∞在Ｏ，－－ａ＇／２，ｄｌ∞在ｚｒ／２－，ａｒ：对ｃｌ∞再分解后，ｃｚ（ｋ）在肚兀珥，而姒动在７ｒ乒¨吮。

可见，Ｍａｌｌａｔ算法实现了信号按频带的逐级剖分。因此，信号ｘ（Ｏ在不同尺度分解的逼近

信号ｃ瘌细节信号西具有不同频带，而在不同的尺度上一定包含有缸力的不同频率信息。

兰仆ｆ理Ｔ人学博ｆｊ。筝化论文

若对包含有不同频率信息的细节信号进行阈值的取舍，丢弃其中的干扰成分后，再对信 号进行重构，则重构信号的干扰得到了非常好的抑制，即为小波变换消噪的基本原理。

下抽样

争ｌ

争ｌ

Ｅ抽样

如如

第』层

第一ｌ层

第一ｌ层

第』层

图２．５离散正交小波变换分解

图２．６离散正交小波变换重构

从离散正交小波变换分解可知，由于下抽样算子Ｄｏ的作用，每进行一级分解，数据

的长度就会减少一半，若，较大时，数据量得较少将很可观。离散平稳小波变换是一种非

正交的小波变换，具有冗余性和平移不变性。它不再进行下抽样输出低通和高通滤波器

系数，而是在各级滤波器的值之间进行插值操作，通过对每两个滤波器系数间插零来实

现滤波器的延展，这样每次平稳小波变换的逼近信号和细节信号长度与原始信号等长，

每种分辨率下的信号和原始信号一一对应，对于阈值法去噪中抑￥１１Ｇｉｂｂｓ振荡起了很关

键的作用【１０‘７１。离散平稳小波分解框图如图２．７所示。

设ｚ表示插零补零算子，即对所有的整数，，有 （Ｚｘ）２，＝ｘ，，（乙）２『＋Ｉ＝０

（２．４５）

若离敖正交小波滤波器刀∽、Ｇ０）的滤波器系数分别为Ｈ，＝（‰，…，＾¨，…帆ｈ．，）和 Ｇｉ＝（ｇ¨，…，鼠，＇．一，ｇｕ），其中下标ｉ表示第ｉ级滤波器；下橱表示鳓个系数。

令Ｈｉ＝ＺｆＥ－ｌ，Ｇｉ＝ＺｊＧｔ＿ｌ，其中，Ｚ／为插值补零算子，则有ｈ删，＝ｈＨ∥ｇｆ ２ｔ，＝ｇ¨，
当，不等于２‘的整数倍时，ｈ，，＝０，ｇ；，＝０。其滤波器的计算如图２．８所示。觏（助为原始

信号序列，令ｃｏ＝ｘ（ｋ），序ｏ】＝村，Ｇ【０】＝Ｇ，则信号的离散平稳小波变换分解为

一翊ｕｋ＿，

（“２．１４…６）

【－ｄ川＝Ｇｔ：Ｊｃ．，

铀．删∞一匝）啼卧弹恸

９—啼
第ｊ层

生
ｉ＋ｌ层

删谤一一匝卜一卧删国

图２．７离散平稳小波分解框图

图２．８离散平稳小波滤波器计算

平稳小波变换是原始信号的冗余表达，其小波系数由许多不同的基生成，因而离散

平稳小波逆变换算子并不是唯一的，可使用不同的方法进行重构，而不同的逆变换结果

是一致的ｆ１０７１。

２．３．３．２基于小波变换的滤波方法

心ｌＵ波形伶测ｏｊ心：社变异ｒｋ分析方法研究

小波滤波过程一般分三个步骤，即先对原始信号进行小波变换，然后对小波系数做 非线性处理，以滤除噪声，最后进行小波重构。其中对小波系数的非线性处理是滤波问

题的核心【１０６１。Ｄｏｎｏｈｏ等人提出的小波变换的阈值滤波是目前应用最为广泛滤波方法。 其基本思想是通过设定一适当阈值，当小波系数小于给定阈值时，则考虑该系数是由噪

声产生，可将其置零或适当收缩，而大于阈值的系数应做保留【４４１。小波的阈值滤波方法 的关键是阈值的选取，Ｐａｎ等人提出可构造一个均方差函数的近似函数，通过极小化该

函数得到均方差意义下的自适应最优阈值的滤波算法【１０８１。另外两种小波滤波是基于信 号小波系数在各尺度间的相关性进行滤波的空间域相关滤波法和基于信号和噪声具有

不同的奇异性进行滤波的奇异性检测滤波法【１０９，１１０】。空间域相关滤波法的滤波效果与相 关系数的定义直接相关，而奇异性检测滤波法的信号重构的算法复杂。对于小波系数的

重要程度判断、阈值函数选取以及阈值确定是小波阈值滤波的几个关键问题。 １）小波系数的显著性函数

小波滤波都是通过判断小波系数所含信息量大小或被噪声污染程度来确定对小波 系数的处理，如置零、收缩及保留。对于度量小波系数重要与否的指标一般称为小波系 数的显著性函数，如Ｍａｌｌａｔ根据小波系数随尺度变化的趋势来决定取舍【１１ ０１。若要获得 性能优良的滤波方法，应考虑小波域的相关性及先验信息，从而构造合适的小波系数显

著性函数。 ２）阈值函数选取

阈值函数选取的的基本思想是去除小幅值的系数，对幅值较大的系数进行收缩或保 留，主要分为软阈值函数，硬阈值函数和半软阈值函数。
软阀值函数：

一Ｗ：
一．ｋ

ｌ【ｓｇｎ（ｗｊ

圳Ｍ。ｔ｜－名）

Ｉｗ．ｊ ｔｌ≥五
ｏｔｈｅｒｗｉｓｅ

４７）０ （２．／

硬阈值函数：

诼“＿＝｛％。Ｉ ｌｗｊ，ｔＩ执

““
【０

ｏｔｈｅｒｗｉｓｅ

（２．４８）

其中，ｗｊ七为小波分解的系数，Ａ为选定的阈值。． 硬阈值法可以很好的保留信号或图像的边缘等局部特征，但由于在“处是不连续
性，往往使得滤波结果会出现伪Ｇｉｂｂｓ现象等视觉失真。软阈值法滤波则相对平滑的多，

但滤波结果有较大偏差。 ３）阈值确定·

如何确定阈值是小波阈值滤波的一个重要问题。小波阈值分为全局阈值和自适应阈

值，若在整个滤波过程中阈值固定不变，即对所有小波系数采用相同的阈值进行处理， 就称为全局阈值；自适应阈值是根据小波系数的局部特征进行阈值化处理，可适应于不

同尺度上系数特征的阈值。目前，已提出了不同的阈值确定方法，包括固定阈值、极小

兰州删Ｔ人学博ｌｊ学ｆ＿论文

＾＝盯厮 化风险阈值、假设检验法和ＢａｙｅｓＳｈｒｉｎｋ阈值等。如固定的阈值形式为

（２．４９）

其中： Ⅳ为信号长度，盯为噪声标准差。

在实际阈值选取中，噪声信号的标准差盯的估计方法是取小波系数在各个尺度下绝

对值的中值，再将系数适当扩大，即

盯＝一 盯：—ｍｅｄｉａｎ—（ｗｉ．ｋ） ０．６７４５

（ｋ２． 一．）５Ｕ０Ｊ）

其中，Ｍ七为高频小波系数，ｍｅｄｉａｎ是表示求中值的运算。

４）小波基的选取

对于相同的工程应用问题，若选取不同的小波基函数，分析结果有时相差甚远。小

波基的选择是小波分析中的一个难点问题，一般希望所选的小波基能同时具有下列性

质：（１）对称或反对称；（２）较短的支撑；（３）正交性；（４）较高的消失矩。对于一个小波 基同时具有以上特性不太现实，在应用中只能针对具择恰体问题选当的小波基。不同的

标准，小波基有不同的类型，其选择方法较难总结成一般原则，通常可从紧支性和衰减

性、正则性、对称性、消失矩四个方面考虑。紧支性与衰减性可保证优良的时频局部特

性，利于算法的实现；正则性对信号或图象的重构及获得较好的平滑效果十分有用：对

称性关系到小波滤波特性是否具有线性相位；消失矩与有效地检测奇异点相关。

心电信号的滤波对于实时性、相移方面的要求不高，所以在选取小波基时，对小波

的支撑长度和对称性可不作特殊考虑。考虑小波基应具有好的Ｊ下则性，可采用Ｃｏｉｆｌｅｔｓ

小波和Ｓｙｍｌｅｔｓ小波，它们既具有正交性同时又具有双正交性，在频域方面表现有较好

的局部性。Ｃｏｉｆｌｅｔｓ小波可应用于消除基线漂移和肌电干扰，Ｓｙｍｌｅｔｓ小波可应用于消除

工频干扰。

２．３．３．３基于小波变换的心电信号的滤波实验

Ｃｏｉｆｌｅｔｓ函数系通常表示为ｃｏｉｆＮ（胪ｌ，２，３，４，５），支撑长度为６Ｎ－１，滤波器长度为

６Ｎ，具有近似对称性，小波函数的消失矩阶数为２Ｎ，尺度函数的消失矩阶数为２Ｎ－１。

采用ｃｏｉ小波对心电信号进行多级分解。

小波的尺度函数，小波函数以及分解滤

波器和重．１３构滤波器图形如图

。

和图２．１０所ｃｏ示ｉｙ３２．９

为了比较去噪效果，定义信噪比（ＳＮＲ）为

．Ⅳ

一２

册叫胪ｋ（善杀务）

Ｑ５Ｄ

式中，Ｙｉ表示含噪信号，麓表示原始标准信号。希望ＳＮＲ越大越好。 １）去除基线漂移的实验 通过设定ＥＣＧＳＹＮ动态心电模型的心电参数可以产生任意形态的心电信号。利用
ＥＣＧＳＹＮ动态心电模型产生原始标准心电信号如图２．１１所示。

３１

心Ｉ【！波形伶测‘ｊ心牢，受异忡分析方法研究

１：厂一百一一＿

；１

¨ｌ

：１

一

。。｝

ｌ

』

｝ｌ

¨｝

ｊ｛

１

－ｔ

ｊ＼

。Ｌ叫卜＿二～一ｊ
４弩—｝ ：—１—１一占矗～１■—；一≮

ａ）

＇‘ｒ————…·一…一

＾ ＝！

ｌ；

｝。

：

ｆＩ

０ ５｝

１

ｊＩ

ｏ卜——，＾、ｉ｝ｒ＼…．…｛

：４

４．｝

：ｆ １．

Ｌ＿…一。一——－———…ｊ Ｊ～ｆ Ｖｆ

ｄ

●

２

●

●

●

＂口

¨

＊

ｍ

ｂ）

图２．９ ｃｏｉｐ小波的尺度函数和小波函数

ａ）尺度函数

ｂ）小波函数

０．８

０．６

０．４

０．２

０

－０．２

０

５

１０

１５

加

ｃ）

图２．１０ ｃｏｉｐ小波的分解与重构滤波器 ａ）分解低通滤波器ｂ）分解高通滤波器Ｃ）重构低通滤波器ｄ）重构高通滤波器

图２．１ １ ＥＣＧＳＹＮ动态心电模型的产生的标准心电图 对标准心电加入基线漂移噪声，在可标准心电上模拟叠加幅度ｌｍＶ直流和幅度为 ０．３ｍＶ，频率为０．１Ｈｚ的交流信号，如图２．１２所示。
３２

兰州理Ｔ人学博Ｉｊ学ｆｐ沦文
》◆厶一｛
采用ｃｏｉｆ３小波将信号进行８尺度的小波分解，如图２．１３所示。从图中可以看出，信 号中的直流分量和基线漂移成分主要存在于第８尺度的逼近信号中，因此，在小波变换 重构的过程中，将该尺度下的低频逼近信号滤除，然后重构信号，即可去除直流及缓变 趋势分量。如图２．１４所示。根据公式（２．５１）计算滤波前后的信噪比分别为２１．５２３４ｄＢ和 ４３．５３６７ｄＢ。可见，小波分解重构对基线漂移的抑制很有效。
对于一取自Ｍ１Ｔ．ＢＩＨＡｒｒｈｙｔｈｍｉａＤａｔａｂａｓｅ的实际心电信号（记录３２７．ｄａｔ），并截取１０ 秒数据，采用∞够小波进行８尺度的小波分解，将低频逼近信号强制置零，滤除基线漂 移效果如图２．１５所示。从图２．１５（ｂ）可见，重构后的信号与原信号相比，在ＱＲＳ上基本 不失真，但在Ｔ波结束位置有明显失真，将８尺度下的逼近信号加入重构过程，从图２．１５ （ｃ）可见，滤波结果重新含有基线干扰，但图形基本不失真，说明小波滤波方法在滤 除滤除基线干扰时易造成Ｔ波及ＳＴ段的失真，这主要是因为Ｔ波及ＳＴ段处频率成分比较复 杂，部分与基线频率相重叠。
２）去除工频干扰的实验 在ＥＣＧＳＹＮ动态心电模型产生原始标准心电信号中加入工频干扰信号，其幅度为 ０．１２ｍＶ，频率为５０Ｈｚ，如图２．１６所示。 采用ｃｏｉｆｓ小波对加噪后的信号进行８尺度的小波分解，分解信号如图２．１７所示。由图 可以看出，高频干扰（如工频干扰）主要分布于尺度２１和尺度２２对应分解信号信号，将 这两个尺度的小波系数置零，再进行小波重建，得到小波重构的心电图，如图２．１８所示。 计算消噪前后信号的信噪比分别为５２．２０３４ｄＢ和７４．９５７４ｄＢ。可见，ＳＮＲ有明显的提 高。选取ＭＩＴ．ＢＩＨＡｒｒｈｙｔｈｍｉａＤａｔａｂａｓｅ中实际心电信号（编号为１０３．ｄａｔ），如图２．１９。利 用小波除基线漂移叠力ｌＪ５０Ｈｚ工频干扰，如图２．２０。利用ｃｏｉｌ３ｔＪ、波函数对信号进行８尺度 分解，去噪后的信号如图２．２１。 ３）滤除肌电干扰 利用ＥＣＧＳＹＮ动态心电模型产生标准心电信号，考虑加入高斯白噪声号。选用小波 函数ｃｏｉｙ３，进行４尺度分解，分别比较采用硬阈值和软阈值及不同阈值选取的小波阈值 去噪效果，并通过田哝加以衡量，其中采用Ｐｅｎａｌｉｚｅｄ阈值的软硬阈值情况下的去噪如图

心ｆＵ波形柃测’ｊ心率，芟异－件分析方；上｛ｉＪ『究
２．２２所示，不同阈值选取的ＳＮＲ计算结果如表２．１所示。
ｘ １０。３ ２ ；０ ．２ ０．０２ 刁ｔ＇ｑ ０ ．０．０２ ０．５ 铅０ ．０ 甚
图２．１３ ｃｏｉｔ３小波８尺度小波分解
图２．１４去除基线漂移的心电信号

兰州Ｔ理Ｔ人学博Ｉｊ学化论文
｝｜ 一一

一州ｌ ■ｌ，弋＿一件一 一件一 ｔ¨ ｎⅣ

Ｔ出１一

一ｌｆｑ｝一 一！．卜纠｝；酊

一一３

｜＿．划 一一～。㈡川删二二一一；｛－ｒ．。＿－ｌｆ，Ｉ．＿｛Ｔ『叫，１Ｉ—ｌ＿１ｆ］时

１ ｏ．８ ｏ．６ ０．４ ｏ．２
０ －－０．２ －０．４ 一ｏ．６ －０．８
·１ ｏ

５００

１ ｏｏｏ

１ ５００

２０００

２５００ Ｎ

３０００

３５００

４０００

４５００

５０００

ｃ１
图２．１５实际心电信号的基线漂移的滤除 ａ）原始信号ｂ）滤除基线漂移的信号ｃ）加入ｃ８的重构结果

图２．１６含有工频干扰的标准心电信号的心电图
３５

心ｌＩ！波７侈龄测‘ｊ心：｝，变异件分析方法研究
皿∞ ＝０
．嘣
Ｏ 利 ＇ 扣 ｎ
Ｎ
图２．１７混有工频干扰的心电信号小波分解
宅、■量Ｅｑｍ日田 图２．１８滤除工频干扰的心电图

兰州艘Ｔ人一擎ｆ｛孽ｔ。学ｆ？，沦支
弘跳川姒ｊ

图２．２０叠加工频干扰的心电图

图２．２１除去工频的心电图

由表可知，基于Ｓｔｅｉｎ无偏似然估计阈值、启发式阈值和极大极小阈值的去噪效果，

软阈值要好于硬阈值；对于固定阈值，硬阈值要好于软阈值。在软硬阈值情况下，

Ｐｅｎａｌｉｚｅｄ阈值的去噪效果是最好。硬阈值方法的特点是保留所有大于阈值的细节，故能

够有效地保留信号中的突变信息，但缺点是有可能把某些大于阈值的噪声也当作有用的

细节而保留下来，致使滤波得到的信号可能出现毛刺；软阈值方法的特点是对大于阈值

的细节作了一个整体性的收缩，故能够平滑掉许多噪声的毛刺，但也使得许多有用细节

被平滑，造成重构时信号的包含的突变信息损失，影响重构效果。

采用ｃｏｉ小波函数对

．

中实际心电信号（记录

ｄａｔ）ｌＯｓ
．

，如图２．２３所示。滤波结

进行．归小波阈值去噪Ｔ，ｈ分ｅ解Ｍ层ＩＴ数Ｂ为ＩＨ８Ａ层ｒｈ，ｙｔ截ｈｍ取ｉＤａｔ的ａｂ数ａｓ据ｅ１０６

３７

果如图２．２４所示。

心ＩＵ波形伶测。ｊ心半变异忡分析方法研究

１

ｏ．８

一

０．１６

ｌ

ｊ

０．４

量

４

ｏ‘２

０

一 一
以 心 Ｍ形 一

—ｏ．２

一

每占ｒ——了６ｉＦ一一‘茹

２０００ Ｎ

２５００

３０００

ＳＳ００

４０００

ｂ）

１

０．８

一

，

０．ｅ 一

一

奎

１

０．４ 一

一

｝

ｉ

ｏ。２ ｏ

３

Ｍ

Ｕ

心

Ｍ

心

Ｍ

Ｍ

Ｍ

心

Ｍ

Ｍ

～

Ｍ

几：

｝ —ｏ．：之

一

－－０．４ ０

５００

１０００

１５００

２０００ Ｎ

２５００

３０∞

３５００

４０∞

ｃ）

图２．２２ Ｐｅｎａｌｉｚｅｄ阈值的软硬阈值去噪

ａ）加入白噪声的原始信号ｂ）硬阈值去噪ｃ）软阈值去噪

表２．１不同阈值选取方法的ＳＮＲ

３８

兰州胖Ｔ人学博Ｉｊ学化论文

ｌ｝蚺 沁 ０儿 ，ｉ．—¨

Ｉ
ｕ

ｉ，¨
＼『ｎ々¨

…４０。００ —ｏ·５占—一 ５６ｉ———ｉ一６∞——ｉ氲元广——≥ｏｏｏ——ｊｉ面ｒ一’３６０ｉ——１名ｏＯ

Ｎ

图２．２３实际心电信号（１０６．ｄａｄ

图２．２４滤除了肌电干扰信号的心电图
２．４平稳小波和自适应滤波器相结合的心电滤波器
２．４．１平稳小波和正交小波的心电滤波比较 利用小波去噪时，在信号奇异点处常出现Ｇｉｂｂｓ现象。心电信号具有多奇异点特征，
在强噪声背景下，采用阈值量化的去噪方法消噪后在Ｑ、Ｓ波处常出现Ｇｉｂｂｓ振荡现象， 造成包含重要医学信息的ＳＴ段信号被抬高，破坏了心电信号的几何特征。为了改进去噪 效果，可通过平移含噪声信号来改变不连续点的位置，对平移后的信号进行阈值法去噪 处理，然后把去噪后的信号再进行相反的平移，便可以实现信号的消噪。离散平稳小波 变换具有平移不变性的特点，可以有效地去除信号重建后出现Ｇｉｂｂｓ震荡现象，较好地 保持心电信号的几何特征，表现了更好的视觉效果。
利用ＥＣＧＳＹＮ动态心电模型产生标准心电信号和迭加白噪声的心电信号如图２．２５所 示。小波基选用ｃ０／ｆ３，分别采用离散正交小波和离散平稳小波的阀值去噪方法消除心电 噪声，观察比较Ｇｉｂｂｓ振荡现象，软硬阈值函数的处理结果如图２．２６所示。其中图２．２６（ａ） 和图２．２６（ｂ）为采用硬阈值和软阈值处理的离散正交小波变换的消噪结果。图２．２６（ｃ）和图 ２．２６（ｄ）为采用硬阈值和软阈值处理的离散平稳小波的消噪结果。
从仿真实验结果可以看出，采用离散正交小波变换阀值去噪法对心电信号进行消噪 处理，硬阈值和软阈值方法都在Ｑ、Ｓ波处产生了较明显的Ｇｉｂｂｓ振荡现象，硬阈值更明
３９

心Ｉ【！波形伶测ｏｊ心：年变异。ｒｔ分析方；土研究
显，两者都造成Ｑ、ｓ波段，特别是Ｓ礅段信号失真，而采用离散平稳小波变换Ｑ波和Ｒ
波处没有出现Ｇｉｂｂｓ振荡现象，消噪后心电信号的Ｐ波、ＱＲＳ波、Ｔ波形的基本保持原有 几何特征。
宅
｛ｉ
趸 詈 舌 岔
一
ａ）
１．４ １．２
１
善ｏ·８ 尝０．６ 差０·４ 密０．２
０
ｂＪ
图２．２５标准心电信号和迭加白噪声的心电信号 ａ）模拟标准心电信号 ｂ）迭加白噪声的心电信号
２．４．２综合滤波器构建与仿真
心电信号的基线漂移主要由人体的呼吸运动或电极和皮肤的接触不良所致，严重的 基线漂移，往往使波形识别和参数测量成为不可能。采用小波阀值去噪时，基线漂移的 能量大小主要反映在小波变换的尺度８、９的小波系数上，一般方法是将这两个尺度上的 小波系数强制置零。但是心电信号的Ｐ波、Ｔ波及ＳＴ段的频带范围与基线频带有一定的 重叠，在消除基线漂移的同时，常常会引起Ｐ波、Ｔ波及ＳＴ段的严重失真。为了尽可能 的保持心电信号的Ｐ波、Ｔ波及ＳＴ段的波形形态，又能克服采用传统离散正交小波阀值 去噪时产生Ｇｉｂｂｓ振荡现象，提出将离散平稳小波变换和自适应滤波相结合，设计 一种能有效滤除各类心电噪声的综合滤波器。
自适应滤波器与平稳小波变换相结合的消噪算法基本思想是：首先运用ｃｏｉｌ３小波对 心电信号进行９尺度的离散平稳小波变换，由小波分解的频率分布范围可知，９尺度上逼 近信号的频率主要由基线频率和心电信号频率组成。令该信号为Ｊ（Ｄ，则有Ｊ（垆碱Ｄ＋’，（０

兰州Ｉ胖Ｔ人·毕博Ｉ学ｆ进论文

１４

１２

１
：
ｏ．８

ｏｅ ●

儿 儿 似 ０．４
扒 至薹呈鸯 ｏ ２ ： ｏ

八一八 八八！

ｏ．２

ｆ

０．４

ａ）

１．２

１

一

０８
：
ｏ．６

儿 儿 儿 儿 儿 ｏ．４
至薹呈９３｜ ｏ．２ ●
八 ０

Ｊ

１

ｏ．２

０．４

｛；ａｍ口Ｉｅ￥

ｏ

：

●

舢 肚 舢 似 ：

扒

八以

ｆ

＿

图

ｃ）

１４

１．２ ●

１
：
ｏ．８

０．６
～ Ｍ舢 从 似 ： ０４
著再基盖。。｜ ０ ２
■ ０
．ｏ．２

一ｏ．４

ｏ
￡；ａｍ口●ｅｏ

ｄ）

图２．２６离散正交小波和离散平稳小波消噪结果

（ａ）采用硬阈值处理的离散正交小波（ｂ）采用软阈值处理的离散正交小波

（ｃ）采用硬阈值处理的离散平稳小波 （ｄ）采用软阈值处理的离散平稳小波

心ＩＵ波形伶测’ｊ心牢变异‘件分析方法研究
其中，工为不含噪声的心电信号在第９尺度上的逼近信号，’，为基线漂移信号。 将Ｓ作为自适应滤波器的输入信号，进行自适应滤波。这样消除基线漂移的自适应
滤波器实际上是一种零频率陷波器，仅需要一个权值，参考信号设为常值ｌ，即，｜（ｆ）一 ［１，１，．．．，ｌ】。采样频率为５００Ｈｚ时，步进因子弘应小于０．００３，参数∥可采用动态调节以获得 期望的低频响应。在第９尺度上的逼近信号的自适应滤波的误差输出信号即为消除了基 线漂移的心电信号，将其作为第９尺度上的新逼近信息，应用平稳小波的重构方法，获 得消噪后的心电信号。算法的总体框图如图２．２７所示。
图２．２７基于平稳小波变换的自适应滤波器构成 为了说明基于平稳小波变换的自适应滤波方法能够较好的保持心电信号的Ｐ波、Ｔ 波及ＳＴ段波形，利用ＥＣＧＳＹＮ动态心电模型产生含有基线漂移的心电信号进行滤波实 验，其中，第９尺度上的逼近信号的自适应滤波算法分别采用固定步长因子∥的ＬＭＳ算法， 变步长因子∥的ＬＭＳ算法及ＲＬＳ算法，将综合滤波器的基线漂移消除的效果和平稳小波 变换进行比较。 设心电信号采样频率为５００Ｈｚ，仿真实验结果如图２．２８所示。其中图２．２８（ａ）含基线 漂移的原始心电信号，图２．２８（ｂ）平稳小波变换的基线漂移消除，图２．２８（ｃ）采用固定步长
因却的ＬＭＳ算法的综合滤波器的基线漂移消除，图２．２８（ｄ）采用变步长因子∥的ＬＭＳ算法
的综合滤波器的基线漂移消除，图（ｅ）采用ＲＬＳ算法的综合滤波器的基线漂移消除。 从仿真实验结果可以看出，采用离散平稳小波变换的基线漂移消除，易造成心电信
号的Ｐ波、Ｔ波及ＳＴ段的严重失真。而基于平稳小波变换的自适应滤波器的三种方法都很 好地保持了心电信号Ｐ波、Ｔ波及ＳＴ段的形态，有效的降低了波形的失真。对比三种自适 应滤波方法可知，变步长因子∥的ＬＭＳ算法和ＲＬＳ算法的滤波效果更好一些。
利用离散平稳小波变换较好地解决了传统离散正交小波变换易产生Ｇｉｂｂｓ振荡的失 真。消除基线漂移易造成Ｐ波、Ｔ波及ＳＴ段的形态改变，这对于临床医学诊断产生很大 影响。为解决这一棘手的问题，本文提出了自适应滤波和离散平稳小波变换相结合去噪 算法，利用该算法既能一次性滤除心电信号通常包含的主要噪声干扰，又较好地保持了 心电信号的低频低幅Ｐ波、Ｔ波及ＳＴ段波的形态，对于提高心电信号的临床诊断的可靠性 和进一步分析心电信号的其他特征信息时都有重要意义。需要指出的是该算法的复杂性 较大，适合于对心电信号采集后的离线分析，以提高分析性能。
４２

兰州Ｉ理Ｔ人学博Ｉｊ学化论文
ｂ）
ｃ）
ｅ）
图２．２８基于平稳小波变换的自适应滤波算法的基线漂移滤除 （ａ）含基线漂移的模拟心电信号（ｂ）平稳小波变换的基线漂移去除（ｃ）综合滤波器的基线漂移 去除（固定步长ＬＭＳ算法）（ｄ）综合滤波器的基线漂移去除（变步长ＬＭＳ算法）（ｅ）综合滤波器 的基线漂移去除（１也Ｓ算法）
４３

心ｌ【！波形伶测’ｊ心ｊ午娈异件分析方泫研究
２．５本章小结
滤除影响心电信号分析的噪声是心电信号预处理的主要任务。本章在分析了心电信 号的频谱分柿特点及各种干扰的主要表现形式基础上，讨论了滤除工频干扰、基线漂移 及肌电噪声的几种常用数字滤波方法。重点介绍了小波变换的基本理论及小波消噪的基 本原理，并对小波消噪进行了仿真实验。针对小波变换的阀值去噪易在Ｑ、Ｓ波处出现 Ｇｉｂｂｓ振荡现象及消除基漂时可能改变心电信号低频部分的形态改变问题，提出了将平 稳小波变换和自适应滤波方法相结合的一次性心电信号消噪方法，仿真实验表明该算法 在消除信号噪声的同时有效地克服Ｇｉｂｂｓ振荡现象，且保持了心电信号Ｐ波、Ｔ波及ＳＴ 段波形形态，有助于提高心电诊断及心电特征提取的准确性。

兰州理Ｔ人学ｆ【擘ｆ‘学化论文
第３章基于非线性能量算子的心电信号Ｒ波检测方法

３．１引言

心电波形的特征参数检测和波形识别是心电信号处理涉及的一个重要问题，它是实 现心电信号自动分析与诊断系统的关键。而ＱＲＳ波群的检测是ＥＣＧ信号分析诊断的前 提和基础，只有Ｒ波标定后，才可能计算心率，检测ＳＴ段参数及正确区分心律失常事 件。但由于心电波形变异较大，且容易受到各种噪声的干扰，如何正确识别ＱＲＳ波群 一直受到学者的广泛关注。目前，已提出了多种方法用于ＱＲＳ波群的识多Ｊｉｊ［４ｓ，ｓｓＪ，西安 交大的李翠微、郑崇勋等人的研究工作最具代表性，其算法的基本思想是以二次样条函 数和高斯函数的一次导数为母小波，利用Ｍａｌｌａｔ快速算法计算小波变换，通过在某一尺 度或某几个尺度内搜索小波变换模极大值．极小值对之间的过零点来标定Ｒ峰位置，算 法获得了较高的Ｒ波的检测率【５¨。非线性能量算子（Ｎｏｎｌｉｎｅａｒ Ｅｎｅｒｇｙ Ｏｐｅｒａｔｏｒ，ＮＥＯ） 是在研究非线性语音建模时引入的一个数学算子，其输出分量可以看作是信号经过高通 滤波后的瞬时能量成分，能够突出信号中的瞬时分量，是一种理想的波形峰值检测方法 ［１１１，１１２】。已有将非线性能量算子用于脑电波形和心电波形峰值检测研究的文献报道 ［ｉ１３，１１４Ｊ。在分析典型Ｒ波检测方法的基础上，提出将小波变换和非线性能量算子相结合 的Ｒ波检测算法，利用ＭＩＴ．ＢＩＨ心电数据库中的实际心电信号验证了算法的有效性。

３．２典型的Ｒ波检测方法

３．２．１差分阈值法Ｒ波检测

差分阈值法是一种实时ＱＲＳ波群检测的方法，该算法广泛应用于实时心电监护系

统。从ＥＣＧ信号的特征波形态可知，其ＱＲＳ特征波变化最剧烈，与其他特征波波形的斜 率相比，其对应的Ｒ波形的上升斜率或下降斜率变化最显著。差分阈值法正是利用这一

明显不同来定位ＱＲＳ复合波的位置，通过计算心电信号序列对时间的导数即斜率值可以 发现，在Ｒ波的上升沿和下降沿心电波形斜率变化最大，其一阶导数的过零点和二阶导

数极值点即为Ｒ波顶点所在的位置。因此，可通过对预处理后的ＥＣＧ信号应用一阶差分 或二阶差分，再结合窗口和幅度阈值即可确定Ｒ特征波的位置。

差分阈值法有多种具体的实现算法，为了突ｍＲ特征波上升速率的变化，文献［１０３】

利用心电信号的一阶差分和二阶差分的平方和来检测Ｒ波，通过输出脉冲的宽度，能较

精确地估计Ｒ波的宽度。

∥（，１）＝—ｘ（ｎ＋１）－—ｘ（ｎ－１） 中心差分公式是相对于误差平方的高阶无穷小，其一阶差分形式为：

（３．１）

４５

二阶差分形式为： ｘ一（，ｚ）：—２ｘ（ｎ＋１）＋ｘ（ｎ＋２）－—ｘ（ｎ－２）－２ｘ（ｎ－１）

（３．２） ８

式中，缸以）为预处理后的心电信号序列。

为突出突变点Ｉ！ｐＲ波峰的位置分别对两次差分的信号求平方和运算。 设所得的新的

数据序列为坝ｎ），则有

Ｘ（ｎ）＝［工’（聆）】２＋【ｊｃ”（，ｚ）】２

（３．３）

的三Ｆ］Ｉ＝［［亡［口ｉ］［［网 采用该方法对实际心电信号的处理结果如图３．１所示。

０

５０Ｄ

１０００

１５００

２０∞

２５００

３０００

３５００

０．５厂——————ｒ——————１．——————１———————ｒ——————＿ｒ———————广——————１＿１

协．。呈畦上±土±士±上±ｊｊｊ到

…０

５００

１０００

１５００

２００３

２５００

３０００

３５００

０．２

ｃ）宅０

ｅ）山口．０２

兰州理Ｔ人学博ｌ’学化论文

３．２．２小波变换法Ｒ波检测
采用差分阈值法进行Ｒ波检测，若有强肌电干扰、室性期前收缩或波形的形态变异 时，‘将造成不同的程度的误检和漏检。由小波变换理论可知，小波变换具有良好的时频 局域化分析能力和多分辨分析特性，其时频窗口宽度随着频率的增大而缩小，这恰好符 合高频信号分析的分辨率要求。因此，小波变换在信号奇异性检测方面有着广泛的应用。
信号在某处有奇异性是指信号在某处有间断或某高阶导数不连续。数学上通常用 Ｌｉｐｓｃｈｉｔｚ指数描述信号的奇异性。
设ｘ（ｔ）∈Ｌ２（Ｒ），信号ｘ（Ｏ在点ｔｏ的Ｌｉｐｓｃｈｉｔｚ指数ａ定义为

Ｉｘ（ｆ）一ｘ（ｆｏ）ｆ＝Ｋｐ—ｆｏＩ口，Ｖｔ∈Ａｔｏ

（３．４）

其中，Ｋ为常数。

显然，若信号“ｆ）在ｔｏ处是不可微的，则其Ｌｉｐｓｃｈｉｔｚ指数ａ必然小于ｌ，此时信号在ｔｏ

处将是奇异的。白噪声是一个几乎处处奇异的随机分布，故其具有负的Ｌｉｐｓｃｈｉｔｚ指数，

而一般信号的Ｌｉｐｓｃｈｉｔｚ指数通常为正值。 若小波缈（口，６）是实数小波且连续可微，具有ｎ阶消失矩（ｎ∈Ｚ＋），则对Ｖｔ∈Ａｔ。，

信号缸Ｄ在ｔｏ处Ｌｉｐｓｃｈｉｔｚ指数和信号的小波变换系数的关系满足：
ＩＷｘ（ａ，ｆ）Ｉ≤Ａａ口 其中，ｌ吸（口，ｆ）Ｉ称为小波变换的模。

（３．５）
．ａ

如果—ＯＷ—ｘ（优ｉａｏ一，ｔｏ）：０，那么，（ａｏ，ｔｏ）应为暇（口，力的局部极值点； Ｖｔ∈Ａｔ。时，若满
ｌＷｘ（ａｏ，ｆ）Ｉ＜ＩＷｘ（ａ。，ｔｏ）Ｉ，则（口０，ｔｏ）为Ｗｘ（ａ，力的模极大值点，Ｉ致（口ｏ，ｔｏ）Ｉ是相应的模极大值。
显然，对于信号ｘ（Ｏ，有如下结论： １）如果在ｔｏ处的Ｌｉｐｓｃｈｉｔｚ指数ａ＞Ｏ，则小波变换的模极大值随着尺度，的增大而增大。 ２）如果在ｔｏ处的Ｌｉｐｓｃｈｉｔｚ指数ａ＜Ｏ，则小波变换的模极大值随着尺度，的增大而减小。 ３）如果在ｔｏ处的Ｌｉｐｓｃｈｉｔｚ指数ａ＝Ｏ，则小波变换的模极大值不随尺度，的变化而变化。 根据这一结论，噪声的Ｌｉｐｓｃｈｉｔｚ指数为负，其小波变换模极大值的幅度随尺度增大 而减小，而信号的Ｌｉｐｓｃｈｉｔｚ指数为正，其小波变换模极大值的幅度则随尺度增大而增大， 由此可以区分噪声与信号，进而检测信号的奇异点。 ＱＲＳ波群、Ｐ波和Ｔ波等特征波是心电信号中典型的奇异部分，鉴于小波变换优良的 信号奇异点检测性能，基于小波变换的心电特征波检测方法一直受到学者极大关注。其 中Ｒ波检测算法是目前采用较多的方法。Ｒ波检测的实质是通过设置合适的阈值来判断 某尺度上的模极大值对，以模极大值对的起点和终点作为ＱＲＳ波的起点和终点，确定 ＱＲＳ波群的宽度，以模极大值对的过零点作为Ｒ波的峰值点。 采用紧支撑对称正交Ｈａａｒｄ、波对实际ＥＣＧ信号进行六个尺度的小波分解，如图３．２

４７

心ｆＵ波形伶测’ｊ心ｊ＃变异件分析方泫研究
所示。从图中可以看出，ＱＲＳ波群的能量主要分布在小波分解的２、３和４尺度的信号上， 而低频的Ｐ波、Ｔ波能量主要集中在４、５尺度的信号上。高频噪声主要出现在ｌ尺度的信 号上，基线漂移信号主要出现在６尺度的信号上。ＱＲＳ波群所产生的模极大值对在３尺 度上表现最明显，选择此尺度检测Ｒ波，有利于减小Ｐ波、Ｔ波以及噪声干扰的影响。Ｒ 波的位置可由此尺度的模极大值对的过零点的位置确定，由于Ｒ波峰点与该模极大值对 所对应的零交叉点有较稳定的时移，可引入时移补偿修正。

３｝Ａ一６八～．４．＾、ｌ＾一一Ｊ八～．１．，、．．』．。。４人～儿Ｊ／乙—一

－２｝

Ｊ

２旺一．５０Ｑ，一∞虹，一ｊ５００一一２０００一麴Ｑ．３００９一．３５００

ｏ卜卜’—０…—＋…—‘１Ｌ—一——－’．———一——二一卜…一——卜—¨ ０ ｋ——————Ｌ——————＋—————－————————————１Ｌ＿——————＾——————＾，————１Ｌ—————’ｌ—————“

－２Ｉ…ｔ——一－一——－一——－ 一

．Ｚ广０—一一 ２００

４００

６００

８００ １０００ １２００ １４００ １６００ １∞０

＞ Ｅ 、

．２

ｉ一——一』——————Ｌ—Ｌ——一』…．ｊ．—————Ｌ—Ｌ．１…一一１

口ｏ

３

兰

△

Ｅ

《

ｏ０

５０

１００

１５０

２００

２５０

３００

３５０

柏０

４５０

ｏ 山

童匾墨王三竖毫三型『Ｉ『Ｉ｜ｊ

童Ｉ∽卜１八肚‰．卜．八，ｊ 童区墨亚笙§寥巫巫

早—绎

筚

掣

一挈

！粤

！罕０

—。１．．０．．．．．．．．．．．．．．．．．．．．．．．．．．．．．．．．．．．１．』．０．．．．．．．．．．．．．。．．．。．．．．．．．．．．．．．．．．２．．．．０Ｉ．．．．．．．．．．．．．．．．．．．．．．．．．．．．．．．．．３．．．０．．，１．，．．。．．．．．．．．．．．．．．．．．．．．．．．．．．４．．．．０．．．．．』．．．．．．．．．．．．．．．．．．．．．．．．．．．∞．．．．．．．．．．．１．．．．．．．．．．．．．．．．．．．．．．．．．∞。一．Ｊ
Ｎ
图３．２小波六层分解及其各层系数分布

在小波分解的３尺度上进行Ｒ波检测的步骤如下：

Ｉ）根据Ｍａｌｌａｔ算法，利用Ｈａａｒ小波对采样的数字心电信号进行６尺度分解，小波系

数Ｅ，ｘ（ｔ）（『＝ｌ，２，．．．，６）：

２）在尺度，＝３上检测小波正负模极大对，当满足正模极大值大于正阈值，负模极大

值小于负阈值时，可确定为一有效模极值对，否则丢弃该模极值对；

３）在极大值和极小值之间的时间窗内定位过零点位置；

４）采用２Ｊ＿１＝３进行时移修正后，可得求得Ｒ波峰值点位置。

基于小波变换的Ｒ波检测算法存在的局限性是：（１）过零点位置易受干扰影响，定
位稳定性难以保证；（２）由于Ｉ激峰值定位是借助于一对相邻的模极值点（斜率极值点）

的位置及两者间的斜率间接确定，其计算过程较繁琐。为此，提出将小波变换和非线性

能量算子相结合方法实现心电信号的Ｒ波检测，利用Ｍａｒｒ小波分解较好地抑制心电信号

４８

兰州理Ｔ人学博ｌｊ学ｆｔ论文

各种噪声干扰，结合非线性能量算子运算以突出ＯＲＳ波的特征点，使得阀值检测便于实 施，再利用相关修正策略以提高Ｒ波检测率，经ＭＩＴ．ＢＩＨ心电数据库的验证获得了非常 好检测效果。

３．３基于非线性能量算子的心电信号Ｒ波检测方法

’

３．３．１ Ｒ波检测基本原理

３．３．１．１ Ｍａｒｒ小波变换

根据小波变换的奇异性检测原理，如果以某一低通平滑函数的一阶导数为小波变换 的基本小波，对信号缸ｆ）作小波变换，Ｎ４，波变换的零点是ｄｘ／ｄｔ＝Ｏ之点，即为颤力的极值 点；而以某一低通平滑函数的二阶导数为小波变换的基本小波，对信号《力作小波变换， 则小波变换的极值点是ｄｘ／ｄｔ＝Ｏ之处，即为ｘ（Ｏ的极值点。为此，本研究采用Ｍａｒｒ／］、波， 也称为墨西哥草帽小波，该小波是高斯函数的二阶导数，属于二次微分小波。利用Ｍａｎ＂ 小波对心电信号进行小波分解，Ｒ波峰值点恰好对应于小波变换的极值点，通过直接检 Ｎ４，波变换的极值点来标定Ｒ波的位置，克服了使用样条小波时需检测过零点的不便。
设高斯函数为伙Ｄ，则９（ｆ）＝丽１～ｚ冗ＣＴ ｅ一乏，Ｍａｒｒｄ、波的小波函数∥（ｆ）＝＿ｄ２驴０Ｑｌ（一ｔ），则信
号缸Ｏ的小波变换为：

Ｗｘ（ａ，ｔ）＝州口２粤ａｒｔ ● ｍ）＝口２芸ａｒ－ｔ（ｘ宰叫ｆ）

（３．６）

由卷积运算可知，ｘ＊Ｏａ∽可以看成是函姒力用高斯函数按尺度ａ进行光滑化的结果。

当尺度以很小时，用Ｏａ（ｘ）对ｘ（Ｏ进行光滑化时，ｘ（Ｏ的奇异部分的位置形态影响不大，而当 口稍大时，则光滑过程将缸Ｏ的一些细小奇异点消去，这些细小奇异点主要由噪声信号引 起，而剩下较大的奇异点为信号的真正奇异。因此，需要根据具体情况选择适当的尺度

参数ａ，以达到消去噪声信号干扰。 对正交小波变换常采用Ｍａｌｌａｔ的塔式算法来提高小波分解速度，塔式算法中尺度按２

的幂级数增长（ａｏ＝２，口＝２，），数据点数则每经一级分解作一次二抽取，使数据减半，从 而实现快速算法，而每次二抽取不便于对信号突变点的精确定位和准确分析。对非正交 小波基，则采用连续小波变换。连续小波变换的计算量较大、实时性较差。这里采用离

散小波变换的直接算法，实现对ＯＲＳ波群进行识别。

设二进离散小波基为ｙｍ（ｆ）＝２－Ｊ／２∥（２－ｊｔ－ｋ）ｊ『，ｋ∈Ｚ。若以砀表示巧，“力张成的函

数空间，即％＝ｓｐａｎ｛９ｔｔｍ ｋ∈Ｚ｝，则有ｕ％＝ｒ俾）和ｎ％＝０

Ｊ＝·－∞

，昌—∞

对于信号ｘ（Ｏ（ｘ（ｔ）ｅＬ２职））在所张成的空间嘭上的投影为：

４９

心ｌＵ波形柃测‘ｊ心卑变兄ｒ丰分析方法研究

％，＾＝（ｘ（ｆ），沙似（ｆ））＝Ｊｘ（ｆ）·２—７坨∥（２一’ｆ一七）出 （／∈ｚ） （３．７）
足
式中，∥是啪共轭，嵫脓板力啊尺度小波谱，／为尺度参数，豇为平移参数。
信号“ｆ）的重建为：

彳（ｆ）＝∑ｘｊ（ｔ）＝∑∑％。。Ｉｋｊ．ｋ（ｆ）

（３．８）

ｊ

ｊ

ｋ

其中，眈．。（ｆ）是∥卅（ｆ）的对偶小波，以Ｄ为信号顶力在尺度／上的分解分量。

３．３．１．２非线性能量算子

设颤力是连续时间信号，且ｔ＞０，若其频带满足： Ｓ。（缈）＝０， ｌ彩ｌ＞Ｂ

（３．９）

其中，Ｂ为常数。即信号顶Ｏ为频带受限过程，定义的非线性能量算子表示为： 矿［ｘ（ｆ）】＝［ｘ’（ｆ）］２－ｘ（ｔ）ｘ”（ｆ）
其中，ｘ’（ｆ）为缸Ｄ的一阶导数，ｘ”（ｆ）为缸力的二阶导数。

（３．１０）

若对顶力离散化处理后，则离散时间信号双，ｚ）的非线性能量算子表示为： 研ｚ（咒）］＝ｚ２（疗）一ｘ（ｎ＋１）ｘ（ｎ一１）
考虑信号

（３．１１）

则有

ｘ（，１）＝，．（疗）ｃｏｓ●ｏ（ｎ）

（３．１２）

ｑ，Ｅｘ（ｎ）】－【，．（咒）缈（九）】２ 式中，ＣＯ被定义为信号瞬时频率，即缈（ｆ）＝ｄ口ｏ／ｄｔ，，．为信号瞬时幅度。

（３．１ ３）

可见， （３．１３）式给出了信号ｘ（，ｚ）的一个能量测度方法，表示了信号瞬时幅度平方 和瞬时频率平方的乘积。可从统计学角度对非线性能量算子做出解释【Ｂ６１。

设信号缸力是信号石ｌ（力和ｘ２（ｔ）的线性组合，离散化后表示为： ｘ（ｎ）＝而（以）＋Ｘ２（厅）
由（３．１ １）式得：

（３．１４）

缈［ｘ（，１）】＝研ｘｌ（以）＋Ｘ２（，ｚ）】 ＝研ｘｌ（，ｚ）】＋伊【ｘ２（玎）】＋｛２ｘｌ（，１）ｘ２（疗）一ｘｌ（万一１）ｘ２（，ｌ＋１）一ｘＩ（刀＋１）ｘ２（以一１）ｊ

（３．１５）

如果信号ｘｌ（力和ｘ２（ｔ）相互独立，则有
Ｅ如吓ｘ（刀）］）＝Ｅ劬【ｘ。（，１）】｝＋Ｅ如哐石：（，１）】｝
其中，Ｅ｛．）表示求期望。

（３．１６）

信号缸Ｏ的自相关系数定义为 Ｒ，Ｏ＋ｆ，ｔ－ｒ）＝Ｅ｛ｚＯ＋ｒ）ｘ（ｔ—ｒ））‘
其傅里叶变换为

（３．１７）

５０

兰州胖丁人学Ｍ ｆ＋学化论文

阶，缈）＝万１￡疋（Ｈ三，卜互／－）Ｐ咖协

（３．１８）

式（３．１８）称为魏格纳分布。ｗ（ｔ，ｃｏ）可以作为信号谱变化的一种度量和平稳信号的 一种谱估计。
当ｗ（ｔ，ｃｏ）是∞的偶函数时，则有

尺，ｏ＋吾，ｆ一号）＝￡∥（ｆ，ｃｏ）ｃ。ｓ（ｃｏｒ矽缈

（３．１９）

由（３．１ １）式得
Ｅ舀虹ｚ（刀）】｝＝Ｅ｛ｘ２（，ｚ）｝一Ｅ扛（甩＋１）ｚ（玎一１））

＝Ｒｘ（胛，ｎ）一Ｒ，（，ｚ＋ｌ，ｎ一１）
＝Ｊ：。形（以，回）（卜ｃｏｓ ２ａ，Ｔ）ｄｃｏ

显然，式（３．２０）中（１－ｃｏｓ２ａ，Ｔ）项是有高通滤波作用，令形７（＂，∞）＝ｒＶ（ｎ，缈）（１一ｃｏｓ２ａ）Ｔ） 称其为职行，ｃｏ）的高通滤波结果，则有

Ｅ｛研工（以）】｝＝Ｋ，（以）ｆｓ Ｗ（ｎ，ｃｏ）ｄｏ

＝Ｋ。（咒）Ｒ，（，ｌ，ｎ）

（３．２１）

其中，以∽：阜皇竺 ￡ＢＷ（ｎ，缈）ｄ国

尺。∽）是信号不同时刻的高频段瞬时能量总和与信号瞬时总能量的比值，可作为高

频段能量的一个测度。对于直流信号，Ｋ，（，１）＝０；对于限带白噪声，Ｋ，（以）＝１，对于 带宽Ｂ＝州２Ｔ的正弦信号，Ｋ。（，１）＝２。因此，Ｋ，Ｏ）的范围为［ｏ，２】，疋∽，订）表示为不

同时刻信号的瞬时总能量。

利用（３．２１）式，由式（３．１６）可得：

Ｅ协ｘ（刀）】｝＝Ｋ而（，１）Ｒ而（，ｌ，疗）＋ｋ（以）Ｒｘ２（万，”）

（３．２２）

若信号ｘＩ（力和ｘ２（Ｏ分别表示基本信号和信号尖峰，当信号没有尖峰出现时， （３．２２）

式的第二项为０，当信号尖峰出现时，由于信号尖峰具有大瞬时能量和包含较多的瞬时

高频成分能量，故（３．２２）式的第二项占主导。因此， Ｅ｛研ｘ（ｆ）】）被认为是一个非负的

能量指标，可以作为表征信号尖峰出现的特征。

当信号尖峰具有非平稳的特征时，Ｅ｛．）算子不能通过时域平均获得。为提高ＮＥＯ处 理非平稳信号的能力，可采用平滑非线性能量算子（ＳＮＥＯ），即用非线性能量算子诃工（刀）】

和一时域窗函数作卷积运算，其表达式为： 纵［ｘ（疗）】＝研ｘ（刀）】·嵋（，１）

（３．２３）

式中，帆（，１）为窗函数，符号“水”表示卷积运算。

５ｌ

心ｆＵ波彤伶测一ｊ心半变异。什分析方法ｆｊ＿｝１究
适当选择窗函数的类型和宽度，以满足时间分辨率要求和有效地减小噪声干扰。应 用非线性能量算子（ＮＥＯ）作用于ＥＣＧ信号，不但Ｒ波峰可获得突出，而且由于Ｔ波、Ｐ 波的能量主要分布低频部分，经能量算子运算后获得了很好抑制，避免高大Ｔ波、大Ｐ 波对Ｒ检测的影响。利用离散ｍａｒｒｄ，波变换对一段心电信号进行４尺度分解，如图３－３所 示。
原鹪：口ｊ口［：＝［］［＝Ｅ五工工硼 ．２ Ｌ．．．．．．．．．．．．Ｊ．．．．．．．．．．．．Ｊ．—．．．．．—．．．．Ｊ．．．——．．．—————Ｌ．．．．．．．．．．．．Ｊ——．．．．．—————．Ｌ．．．．．．．．．———ＬＪ
图３．３心电信号的Ｍａｒｒ小波变换 从图中可以看出，Ｒ波峰对应的ｆｉｌｌ４个尺度上的小波变换值总体上是递增的，而高频 噪声表现为递减的或不规则的，Ｒ波的波峰位置对应于该尺度上小波变换的局部极大值。 在生理病理变异情况下，或许部分Ｒ峰在第２、３、４尺度上的幅值常常比较接近，但都 比第一尺度的值要大。在第３尺度上，高频噪声一般得到较好的抑制，取对３尺度小波分 解分量进行ＳＮＥＯ运算，如图３．４所示，可以看到，经能量算子运算后Ｔ波、Ｐ波获得了很 好抑制，而Ｒ波峰得到较大突出。
３．３．２ Ｒ波检测的仿真实验
取自ＭＩＴ／ＢＩＨ心电数据库的两组心电记录１０８和１０４，它们分别受到了低频和高频的 严重干扰，其Ｍａｒｒｄ、波分解的结果如图３．５和３．６所示，可以看出在３尺度分解信号上噪声
５２

得到了很好的控制。

兰州耻Ｔ人’≥博ｌ‘学位论文

．１。ｈ—Ｉ—ｒ！矿Ⅳ！、Ｉ、竺１１尘￡爿 ．．．．．．．．．．．．．．．．．．Ｉ．．．．．．．．．．．．．－Ｊ

图３．５低频干扰严重的ＥＣＧ信号的小波分解

三５ 匝匝里巫巫里一

户１ ０
．５ ５

ｊ：２ ０
．５ ５

户３ ０
．５ ５

户４ ０

－５ ０

５００

１０∞

１５００

２０００

２５００

３０００

３５００

图３．６高频干扰严重的ＥＣＧ信号的小波分解
为了精确地确定Ｒ波的波峰位置，选择尺度，＿３的Ｍａｒｒｄ，波分解信号，并将此信号作 为ＳＮＥＯ算法的输入信号，由于算法的输出信号突出了Ｒ波峰。因此，可以容易根据阈值 判断是否有Ｒ波出现，如果Ｒ波出现，则可对应模板窗口中寻找极值，此极值的位置即 为Ｒ波波峰的位置。具体算法描述如下：
１）读取ＥＣＧ数字信号《刀）； ２）选择Ｍａｒｒｄｘ波，利用离散二进小波变换的直接算法对ＥＣＧ信号进行４尺度小波分
解得各尺度分解信号以，１）ｊ＝ｌ，２，３，４；
３）选取尺度户３ｄ，波分解信号取作为ＳＮＥＯ运算得输出信锨疗）。

心ｌＵ波形怜测ｏｊ心串，楚异·ｎ分析方法研究

４）选取适当阀值后进行阀值检测。本研究选取连续３秒内的待分析信号ｙ（＂），则选耿

阀值为：

１

Ⅳ

Ｔｈ＝Ｃ二ｙ＇，（胛）

Ⅳ：＝’。。

（３．２４）

式中，Ⅳ为３秒内待分析信号ｙ（以）的采样数，Ｃ为常数比例因子，第一次可由实验确定。

当检测到大于砌的信号时，则使模板信号输出为１，否则输出为０。这样，可求得ＱＲＳ模

板信号ｙｌ（刀），记录每个模板区内），（，ｚ）的峰值时刻和峰值。 ５）模板信号修讵方法：若连续两个模板区间隙小于２５ｍｓ，则将两模板区合并；若连

续两个模板区内），（，ｚ）的峰值时刻间隔小于０．３￣ｏ．５倍ＲＲ平均间期，则对此连续两个模板进 行误差判断，峰值低的为误差，删除其对应的模板。重新记录模板区数量和模板区内），（拧） 的峰值时刻，即可获得修正后Ｒ峰点的位置及心拍个数。

６）Ｒ波峰点检测的补偿措施：由于心律失常的出现，使得ＱＲＳ波幅度、频率突然变

得很小，Ｒ波峰点，即“刀）所对应的极值点达不到阈值，导致漏检。解决这个问题方法是 对前面检测的Ｒ峰点再做进一步检验；计算连续十个ＲＲ间期的平均值为最近平均心动周 期Ｌ若本段内所检测到的Ｒ峰间隔大于１．６Ｔ，则说明存在漏检，降低阈值幅度为原阀值

一半重新在该两个Ｒ峰点进行搜索，采用这种补偿方法可以减少漏检的发生。

选取ＭＩＴ／ＢＩＨ心电数据库两段心电数据，一段是ｌ １４号从９分２６秒开始的一段心电数

据，另一段是２０３号从１５分００秒开始的一段心电数据。１１４号心电数据段的Ｒ波检测算法

各步骤的处理过程如图３．７所示，其相应的Ｒ波峰定位如图３．８所示。２０３号心电数据段的

Ｒ波检测算法各步骤的处理过程如图３．９所示，其相应的Ｒ波峰定位如图３．１０所示。

∞．｝巨三三三五三三三三三珂
２
＠
＠

＠

＠

∞
ｏ之叫仿ｏ，帖 ｏ，帖
Ｏ

∞０

１∞０

１９３０

２０∞

２５∞３０００

３５∞

图３．７心电数据的Ｒ波检测算法的处理（１１４．ｄａｔ） （ａ）原始心电信号颤以）Ｃｏ）尺度３的分解信号以以）／＝３ （ｃ）ＳＮＥＯ处理信号爿以）（ｄ）阀值检测 模板信号少１０）（ｅ）模板修正信号（ｆ）Ｒ波漏检补偿的模板信号

兰州理Ｔ人学博Ｉｊ学ｆ蠢论爻

＾

至

童

：

蕈

昌
；

；

．

．

．

号一

渤耋叵翌巫互璺里巫囹 图３．８心电数据的Ｒ波峰定位（１ １４．ｄａｔ） ，
∞ Ｊ吡
的． ∞ 叭吡吡

油 ｏ 卜｜Ｉ
Ⅲ 傍 ｏ 仲。伯∞ｏ；兮叫∞ｏ，坫ｏ，坫ｏ ０

０ ｌ ： ４ ｌ ：ｌ

： ０ ｌ Ｊ 《 ｌ ：０

．

５∞

１∞０

１５∞

２∞０

ｌｌ㈧ ｌ Ｍ

ｌ㈧

２５∞

３０００

ｌ利
３５００

图３．９心电数据的Ｒ波检测算法的处理（２０３．ｄａｔ） （ａ）原始心电信号缸行）（ｂ）尺度３的分解信号以刀）ｊ＝３（ｃ）ｓＮＥＯ处理信号畎刀）（ｄ）阀值检测模板 信ｑｙｌ（刀）（ｅ）模板修正信号（ｆ）Ｒ波漏检补偿的模板信号

图３．１０心电数据的Ｒ波峰定位（２０３．ｄａｔ） 采用可变阀值检测能检测到绝大多数的ＱＲＳ波群，但有时会受至ｔＪＱＲＳ波形态或高大 Ｐ波或Ｔ波的影响，将模板信号分裂为多个模板区，从而造成误检。采用模板修正策略将
５５

心ＩＵ波形价测‘ｊ心ｊ棼馁斤件分析方ｆｌａｉｌ究
模板缝隙在２５ｍｓｌ内的模板合并，如图３．７（ｅ）所示。将模板区间隔小于０．３～Ｏ．５倍ＲＲ平均 间期的模板区进行误差判断同样可以有效减少误检。图３．７中的第６、８个Ｒ波和图３．８中第 ５、１１个Ｒ波经ＳＮＥＯ运算后幅度过小而造成漏检，采用漏检补偿措施后重新找回，从而 减小了Ｒ波漏检率。
唾嘶叫『｜ｉ
８●州●＂ｌｉｍｅ（５） ｂ）
Ｓａｍｌ■ｅ １１ｍｅ（．’
ｃ）

ｅ）

Ｄ

图３．１ Ｉ噪声污染严重的心电信号Ｒ检测

ａ）低频干扰（１０５．ｄａｔ）ｂ）高频噪声（１０４．ｄａｔ）ｃ）电极滑动（１０１．ｄａｔ）ｄ）基线漂移（３２７．ｄａｔ） ｅ）基线漂移、高大Ｐ、Ｔ波（１０８．ｄａｔ）ｆ）心律失常、高大Ｔ波（２０３．ｄａｔ）

该算法对有严重的噪声和存在不同类型心律失常的心电信号检测的结果如图３．１ ｌ所 示。从图中可以看出：图ａ）、ｂ）分别为取自编号１０５、１０４，Ｃ，电数据文件，它们具有不

同类型噪声；图ｃ）为取自编号１０１号心电数据文件，其中第４个Ｒ波峰较为特殊，是Ｒ波

兰仆ｌ理Ｔ人掌博ｌ：’７－＂１ｐ论文
定位的难点，且存在运动伪迹；图ｄ）为取自３２７号心电数据文件，具有严重的基线漂移； 图ｅ）为取自１０８号心电数据文件，具有严重的基线漂移和高大Ｐ波、Ｔ波；图ｆ）为取自 ２０３号数据文件，具有严重心律失常。为进一步检验算法的有效性，对ＭＩＴ／ＢＩＨ心电数 据库的大部分心电数据进行Ｒ波检测，其统计结果如表３．１所示，有１５９个漏检、１３０个误 检，共计２８９个错检，算法检测率达到９９．７％，根据统计结果表明，论文提出的检测算 法具有较高的检测准确率和较强的鲁棒性，检测性能优于传统的检测算法。
从仿真结果可以看出，离散Ｍａｒｒｄ、波变换和平滑非线性能量算子运算相结合的心电 信号的Ｒ波检测方法的优点：
１）利用小波变换的多尺度分解，较好地消除了干扰对心电信号中Ｒ波识别影响。 ２）采用ＳＮＥＯ运算突出了Ｒ波群特征点，使得在严重噪声信号干扰下，也能实现对Ｒ波 的准确定位。 ３）与传统差分阈值的Ｒ波检测方法相比，Ｒ波的检测率准确率大大提高；与小波变换 的Ｒ波检测方法相比，阀值检测算法便于实施，算法运算量小，可用于实时检测。
３．４本章小结
本章分析了典型差分阈值法Ｒ波的检测算法，采用差分阈值法检测Ｒ波时，易受噪 声干扰的影响，判据较为简单，容易发生漏判和误判。分析了基于小波变换的Ｒ波检测 方法的原理及实现步骤，指出该方法存在的不足。提出了一种非线性能量算子和Ｍａｒｒｄｘ 波分解相结合的Ｒ波检测新算法，利用ＭａｒｒｔＪｘ波变换的３尺度信号的极值点标定Ｒ波的位 置。通过对３尺度小波分解分量的平滑非线性能量算子运算，突出了Ｒ波尖峰，同时抑制 高大Ｔ波、大Ｐ波对Ｒ检测的影响。算法具有Ｒ波定位准确，检测率高，运算量小及易于 实时检测的优点，通过ＭＩＴ．ＢＩＨ的心律失常数据库验证了算法的有效性。
５７

心Ｉ Ｌｌ波形柃测。ｊ心；年变异ｒ｝分析方法研究

文件
ｉ００ １０ｌ １０２ １０３ １０４ ｉ０５ １０６ １０７ １０８ １０９ ｌｌｌ １１２ １１３ １１４ １１５ １１６ １１７ １１８ １１９ １２１ １２２ １２３ １２４ ２００ ２０１ ２０２ ２０３ ２０５ ２０７ ２０８ ２０９ ２１０ ２１２ ２１３ ２１７ ２１９ ２２０ ２２１ 合计

表３．１ ＭＩＴ—ＢＩＨ数据库部分心电数据文件Ｒ波的检测统计

标准心搏数

漏检数

误检数

总错检数

错检率（％）

２２７３

０

０

０

０

１８６５

ｌ

ｌ

２

０．１ｌ

２１８７

０

０

２０８４

０

０

２２２９

２０

２

０

０

０

０

２２

０．１０

２５７２

１８

１４

３２

１．２４

２０２７

７

３

２１３７

３

３

１０

０．５０

６

０．２８

１７７４

１０

５

１５

０．８５

２５３２

０

０

０

０

２１２４

１５

２

１７

０．８０

２５３９

３

Ｉ

４

０．１６

１７９５

０

ｌ

ｌ

Ｏ．０６

１８７９

１４

Ｉ

１５

ｏ．８０

１９５３

０

０

０

０

２４１２

３

１２

１５

０．６２

１５３５

０

０

０

０

２２７５

３

２

１９８７

１

０

５

０．２３

ｌ

Ｏ．０５

１８６３

Ｉ

Ｉ

２

０．１１

２４７６

０

０

０

０

１５１８

０

ｌ

１６１９

０

ｌ

ｌ

Ｏ．０６

ｌ

Ｏ．０６

２６０１

Ｉ

２

３

０．１２

１９６３

３

２０

２３

１．２０

２１３６

５

８

１３

０．６０

２９８２

１８

１０

２８

０．９４

２６５６

ｌ

２

３

０．１ｌ

１８６２

８

４

１２

０．６４

２９５９

６

１２

１８

０．６１

３００４

７

２

９

０．３０

２６４７

８

ｌＯ

１８

０．６８

２７４８

２

０

２

０．０７

３２５１

０

２

２２０８

２

３

２

０．０６

５

Ｏ．２３

２１５４

０

Ｉ

１

０．０５

２０４８

０

ｌ

ｌ

０．０５

２１２７

０

３

３

０．１４

８５００１

１５９－

１３０

２８９

０．３０

５８

兰州胖Ｔ人学博ｆ学ｆ一沦艾

第４章心率变异性的Ｈ ｉ Ｉ ｂｅ ｒｔ谱分析

４．１引言

信号总体上分为确定性信号和随机信号。由于随机信号在自然界中普遍存在，对于

随机信号的分析与处理有更重要的实际意义。

在理论上，随机信号又可以分为平稳和非平稳两大类。根据传统定义，一个时间序

列坦力称为广义平稳的，应满足如下三个条催１ １５】：
，
Ｅ（Ｉｘ（ｔ）ｌ‘）＜ｏｏ
Ｅ（ｘ（ｆ））＝ｍ兰ｃｏｎｓｔ

’１

ｌ

孓

Ｉ

（４．１）

ｃ（ｘ（ｔ１），Ｘ（ｔ２））＝Ｃ（Ｘ（ｔｌ＋ｆ），Ｘ（ｔ２＋ｆ））＝ｃ（ｆＩ—ｆ２）Ｊ

其中，以·）为信号的数学期望，Ｃ（·）为协方差函数。
广义平稳也称为弱平稳，如果一个信号是严格平稳的，那么对所有的椰ｒ，应满足：

Ｆ（ｘ（ｔ１），ｘ（ｆ２），…，ｘ（ｔ。））＝Ｆ（ｘ（ｔｌ＋ｆ），ｘ（ｔ２＋Ｏ，－－－ｘ（ｔ。＋ｆ））

（４．２）

其中，尺·）为联合分布函数，式（４．２）意味着分布相对于时间移位是不变的。

一个严格平稳的随机信号必定是广义平稳的，但反之不成立。如果一个信号不是广

义平稳的，则它是非平稳信号。因此，非平稳信号是指统计特性随时间变化的随机信号。

最常见的非平稳信号是自相关函数或功率谱密度随时间变化的信号，非平稳信号自相关

函数和功率谱密度的定义为：

疋（ｆ，ｒ）＝Ｅ［ｘｏ＋｛）石＋ｏ一詈）］

二

ｚ

（４．３）

Ｓｘ（ｔ，ｃｏ）＝ＬＲ，（ｔ，ｆ№一彬ｄｒ

其中，袁示延迟，∞表示频率。

由于理论研究和分析工具的局限，人们常常将非平稳信号简化为平稳信号进行分

析，傅立叶变换是平稳信号分析的很有效的工具。

对于给定信号ｘ（力，若ｘ（Ｏ为能量有限信号，即

￡Ｍ１２ｄｔ＜∞

（４．４）

则可对其进行傅立叶变换，《ｆ）的傅立叶正、反变换为

ｘ（国）＝￡ｘ（ｔ）ｅ－Ｊ科ｄｔ

（４．５ａ）

ｘ（ｆ）＝荔１￡ｘ（国）Ｐ埘砌

（４－５ｂ）

可以看出，傅立叶变换是用平稳的正弦波作为基函数（扩ｆ）去变换信号缸ｆ），从而得

心ｌＵ波形价测‘ｊ心ｊ筝变异。ｒＦ分析方法研究
到其频谱斌∞）。信号的频谱易于揭示信号特征，许多在时域中无法看清的问题，通过变 换到信号频域却变得一目了然。因此，信号的频谱分析方法是傅立叶变换最重要的贡献。
在通常的信号分析中，平稳信号常用信号的二阶统计量来表征，对应于时域统计特 征表现为信号的相关函数，对应于频域则为信号的功率谱，信号的相关函数和功率谱构 成了傅立叶变换关系。信号的功率谱．蹦∞）和相关函数ＲＸｒ）的傅立叶映射关系表示如下：
Ｓｘ（ＣＯ）＝￡Ｒｘ（丁）Ｐ缈ｄｆ ∞ 小“枢∞
（４．６）
Ｂ（了）＝瓦１￡＆（厂）ｅｊｃｏｔ如 ∞ Ｋ冲啪ｏ 、●、，ｊ
傅立叶变换建立了信号从时间域到频率域的通道，频谱厨∞）显示了基于正弦波基函 数分解的信号珂力中各频率分量的相对强度信息，而无法显示这些频率分量如何随时间 演变的信息。即傅立叶变换是一种整体变换，对信号的表征要么完全在时域，要么完全 在频域，作为频域表示的频谱并不能反映某种频率分量出现在什么时候以及它的变化情 况，而这对于非平稳信号分析是十分重要的。
需要指出即使信号在有限的持续时间内是平稳的，但由于加窗处理而产生能量泄露 的缘故，傅立叶频谱的效果也不尽人意，所获得的频谱幅值、相位和频率都可能产生较 大的误差。而对于非平稳信号，傅立叶变换表征的只是信号与基函数扩‘之间相似性程度 的一个度量，而非信号的真实谱信息【１１６】。实际的生物医学信号大都是非平稳的随机信 号，傅立叶变换只能提供了频域的全局特性，而缺乏局部信息，对于这类信号的分析是 远远不够的，或者说是不适合的，更何况其通常所反映的并不一定是信号的真实谱信息。 时频分析方法可以直接在时频平面上表征信号，能反映信号的时频局部特征，弥补了傅 里叶变换的在分析非平稳信号上的不足。
本章讨论了基于ＨＨＴ的Ｈｉｌｂｅｒｔ时频谱的分析方法，为揭示ＨＲＶ信号蕴含的生理病理 信息，定义和提取了ＨＲＶ信号的Ｈｉｌｂｅｒｔ时频特征，应用于不同生理病理的区分获得了很 好的效果。
４．２时频分析方法的回顾
信号分析的根本目的就是通过某种变换处理使待分析信号的特征信息尽可能地突 显以便信号特征提取。目前，对于非线性、非平稳信号的特征提取已成为现代信号处理 重点关注的问题。信号的时频域特征可以更准确、更全面地反映非线性、非平稳信号的 特性，而时频分析是获取时变非平稳信号时频特征的主要方法。按照时频分析的本质特 征，可将众多的时频分布归纳为线性时频分布、Ｃｏｈｅｎ类双线性时频分布、仿射类双线 性时频分布、重排类双线性时频分布及自适应核函数类时频分布【１１纠１８】。
４．２．１线性时频分布
６０

兰州Ｉ剧Ｔ人学博ｌｊ学ｆｔ论文

４．２．１．１｛ｌａｂｏｒ展开 １９４６年Ｇａｂｏｒ提出可以用二维的时一频平面上离散栅格处的点来表示一个一维的
信号。给定信号顶ｆ）∈￡２（尺），其Ｇａｂｏｒ展丌定义为

ｘ（ｆ）＝∑∑Ｃｍ．ｈ肌疗（ｆ）

（４．７）

搠＝－．００月＝—∞

其中，ｃ删为Ｇａｂｏｒ展开系数，而五肌。（力为Ｇａｂｏｒ基函数

‰（ｆ）＝ｈｍ？／（ｔ－ｍＴ）ｅ７２疗‘棚＂ｍ，ｎ＝０，±１，４－２，…

（４．８）

其中，丁为时间间隔，Ｑ为频率间隔。

Ｇａｂｏｒ展开系数Ｇ。由Ｇａｂｏｒ变换表示为：

％＝［：．ｘ（ｆ）ｇ’（卜ｒｏＴ）ｅ－伽（ｍＶ

（４．９）

其中，踟ｎ（力是Ｇａｂｏｒ基函数Ｊｉｌ删（力的对偶函数。 Ｇａｂｏｒ变换奠定了时频联合域内进行信号分析的理论基础，是时频分析的思想起源。
稳定的Ｇａｂｏｒ展开要求临界采样或过采样，即Ｇａｂｏｒ展开应满足约束条件殛毽２兀。Ｇａｂｏｒ 基函数ＪＩＭ（力是一种时间平移加调频因子的函数，所为时移因子，刀为调频因子，？这样， 时频分析中的时频平面（奶对应在Ｇａｂｏｒ展开中则为平面（聊，甩），从而揭示出Ｇａｂｏｒ展开 与时频分析的内在联系。Ｇａｂｏｒ基函数使用高斯窗函数，其时频分辨率完全由高斯窗函 数决定，能较好地刻画信号中的瞬态结构。

４．２．１．２短时傅立叶变换

１９４６年，Ｇａｂｏｒ提出了窗口傅里叶变换的概念，用一个在时间上可滑动的时窗来进 行傅里叶变换，实现了在时间域和频率域都具有较好局部性的分析，称为短时傅里叶变 换（Ｓｈｏｒｔ Ｔｉｍｅ Ｆｏｕｒｉｅｒ Ｔｒａｎｓｆｏｒｍ，ＳＴＦＴ）。
给定一信号ｘ（ｔ）ＥＬ２职），其ＳＴＦＴ变换和反变换为

ＳＴＦＴ，（ｔ，ｆ）＝ｆｘ（Ｏｇ（ｒ＿ｔ）ｅ－Ｊ２矿ｄｆ

（４．１ ０）

ｘｘｏＯ））：＝Ｉ厂ｆｌｏ

（（ｆｆ，，ｆ）ｇ

Ｊ２ａｆｒｄｔａ

（４４．．ＩＩ Ｉ ）

），ｆ）ｇ（ｒ Ｉ－ｔ）ｅ砑 Ｓ＂ｄｔｄｆ ＴＦＴ

显然，这一变换将信号顶力映射到时频二维平面（ｆ力，窗函数反力的时移和频移，使 得窗函数变成既是时间的函数又是频率的函数，信号与对应于某一时移和频移的窗函数 作内积，则能反映出信号在该时刻的局部频谱特征，整个变换结果则可揭示信号频谱的 演化特性。
．Ｓ弘疋的窗函数烈力的选取是十分关键，决定了船Ｆ瓦的时频分辨率。高斯函数的
傅立叶变换仍是高斯函数，保证了时域和频域的能量都相对较为集中，因此，最优的时 间局部化窗函数是高斯函数，即

６ｌ

曩曼曼皇曼曼皇曼曼曼曼曼曼曼曼曼曼量鼍量鼍曼曼鼍詈毫心鼍ｌ晕Ｕ皇波曼形！Ｉ柃测’ｊ心＿ ｊｏ年曼曼变曼斤皇十曼鼍牛曼分曼析皇曼方舅法曼研！鼍究曼皇曼曼皇舅舅曼曼曼皇皇曼皇曼曼曼皇曼曼曼曼曼曼曼

ｇ（ｆ）：士ｅｗｔ－ 盯＞ｏ ～氕６
当给定窗函数甙力和其傅罩叶变换Ｇ∞，则带宽Ⅳ为
『【卅Ｇ（刊】２ ａｆ
（△厂）２
ｆｌＧ（：）１２矽

（４．１２） （４．１３）

其中，分母是信号烈Ｏ的能量。 同理有

（Ａｔ）２：１Ｊ＇［ｔｒｇ（百ｔ）］］２ ｄｔ

（４．１４）

恬（ｆ）ｒｄｔ

其中，分母是信号甙力的能量。
则有够Ａｔ分别为．Ｓ豫瓦的频率分辨率和时间分辨率。由于受Ｈｅｉｓｅｎｂｅｒｇ不确定
性原理的制约，时间分辨率缸和频率分辨率△厂不可能同时任意小，一旦＆和△厂确定，
则整个时频平面上的时频分辨率将保持不变。可见，．Ｓ矾是一种时窗大小及形状都固
定不变的时频局域化分析方法。 需要指出的是保证ＳＴＦＴｘ方法有效性的假设条件是信号在窗函数的持续时间内应是
平稳的，这一条件通常无法满足或只是近似满足。因此，Ｓ阿疋可能给出错误的信息， 即使信号在窗函数的持续时间内是平稳的，同傅里叶变换一样，．Ｓ乃珥也不能很好地反
映信号的局部频谱信息。
４．２．１．３小波变换
小波分析的思想就是既要看到森林（表示信号的概貌），又要看到树木（表示信号 的细节）。在２．３节我们已经给出了小波变换的定义，小波变换实质上是一种时间．尺度 分析，它的时频窗口面积固定但其形状可改变，其中平移因子ｂ确定了窗口的时间位置， 而尺度因子ａ既影响窗口频率位置，也影响窗口的形状。对信号ｘ（０在尺度上变化，若 ａ＞ｌ，则信号波形收缩，反之，若ａ＜ｌ，则信号波形伸展。也就是说，小波变换是用大 尺度观察信号的总体，用小尺度观察信号的细节。与短时傅氏变换相比，小波变换具有 自动调节对信号分析的时宽．带宽的能力，是一种时窗和频窗都可改变的时频局部化分 析方法。
目前，小波分析的应用文献浩繁，似乎小波变换无所不能，但在处理工程实际信号 时人们也发现它的不足之处【¨９】：（１）小波变换的基本小波函数是有限长度，会引起能 量泄漏问题，使得信号中产生虚假谐波，也会改变信号的时频能量分布，从而导致错误 的时频分析结果；（２）小波分析是非自适应的，小波函数一旦选定，对于所有数据的分 析都必须使用，分析效果不能保证是最佳的。可以说小波函数的选择几乎是影响小波变

６２

兰州Ｉ理Ｔ人学｝ｆＩ｝卜≯化论文

换应用成败的决定性因素：（３）小波函数的长度远小于数据长度，会造成边界处信号产 生畸变。

４．２．２ Ｃｏｈｅｎ类双线性时频分布
Ｃｏｈｅｎ类双线性时频分布的思想是设计一个联合时间频率函数，能够同时以时间和 频率为变量来描述信号的能量密度或信号强度。Ｃｏｈｅｎ类双线性时频分布的基础是 Ｗｉｇｎｅｒ－－Ｖｉｌｌｅ分布（ＷＶＤ）。
信号珂Ｄ的ＷＶＤ可以表示为

ＷＶＤ，（ｔ，厂）＝￡ｘ（ｆ＋ｆ／２）ｘ＋（卜ｆ／２）ｅ印矿ｄｆ

（４．１５）

由于定义式中不含任何窗函数，于是避免了线性时频表示中时间分辨率和频率分辨

率的互相牵制，它的时频．带宽乘积达到了Ｈｅｉｅｓｎｂｅｒｇ不确定原理的下界，使得ＷＶＤ分 布具有很高的时频分辨率，或者说具有很高的时频聚集性。另外，ＷＶＤ分布也具有对

称性、时移不变性以及满足边缘条件等特点。

ＷＶＤ分布不是线性的，即两信号之和的Ｗｉｇｎｅｒ－Ｖｉｌｌｅ分布并非每一个信号的

Ｗｉｇｎｅｒ－Ｖｉｌｌｅ分布之和，其中多出一个附加项。
若缸力＝ｘＩ（Ｄ＋规（力 则有
ＷＶＤｘ（ｔ，ｆ）＝形哦．（，，ｆ）＋ＷＶＤｘ２（ｆ，门＋２Ｒｅ｛聊ｑ，：（ｆ，厂））

（４．１６）

其中，ＷＶＤｘ，屹ｏ，门＝￡而ｏ＋ｆ／２）ｘ２＋ｏ—ｆ／２）ｅ－：＇Ｃ，ｄｆ

式（４．１６）中，第三项称为交叉项或干扰项。交叉项是实的，混杂于自项成份之间， 且其幅度是自项成份的两倍；交叉项是振荡型的，每两个信号分量就会产生一个交叉项。 对于单分量的线性调频信号，ＷＶＤ分布具有理想的时频聚集性，然而对于多分量信号 会产生由交叉项引起的虚假信号。交叉项的存在，严重干扰着对ＷＶＤ分布的解释，对 于复杂信号，ＷＶＤ分布甚至会变得毫无意义。
为了有效地抑制交叉干扰项，学者们提出了许多新型的时频分布。１９６６年，Ｃｏｈｅｎ 提出对Ｗｉｇｎｅｒ－Ｖｉｌｌｅ分布进行时频平滑的时频分布方法，抑制了部分交叉项，但也不同程 度地降低了信号的时频分辨率。该方法也使得众多的时频分布可用统一的形式表示，习 惯上称为Ｃｏｈｅｎ类时频分布。
Ｃｏｈｅｎ类时频分布的一般表达式为

ＴＦＤ，，（ｔ，厂）＝￡￡舭Ｏ）ＷＶＤ，（卜ｆ，ｆ－Ｏ）ｄｒｄＯ

（４．１７）

其中，９化Ｄ称为核函数。当驴心Ｄ＝ｌ时即为ＷＶＤ分布。 式（４．１７）的意义在于核函数不同将产生不同的时频分布，可将构造时频分布的问
题简化为核函数的设计问题；通过对核函数的限制，可以获得具有某种性质的时频分布；

６３

心ＩＵ波形馀删’ｊ心ｊ爷变异性分析方法ｆｉＪ『究

可以通过核函数的分析获得新的时频分布的特性。

４．２．３其他类时频分布

为了从时间和尺度的角度来分析信号，提出了仿射类的时频分布，该类分布是通过 时移和伸缩变换实现的，可表示为：

ＴＳＲ，（ｆ，口）。ｆ。工。。痧（等，口Ｏ）ＷＶＤ，（ｆ，Ｏ）ｄｒｄＯ

（４．１８）

仿射类的分布是具有时间和伸缩不变性的时频分布类，这一类分布的基础仍然是 Ｗｉｇｎｅｒ－Ｖｉｌｌｅ分布。仿射类双线性时频分布也可通过时间．尺度平滑处理来抑制交叉项。
除此以外，为进一步提高Ｃｏｈｅｎ类和仿射类双线性分布的性能，Ｋｏｄｅｒａ等人提出对 时频平面进行重排的思想，即所谓的重排类双线性时频分布【１ ２０】。所谓重排方法就是将 时频面以（ｆ力点为中心的邻域内的信号能量的平均值ＴＦＤ。（幼搬移到这个区域的重心 处，以此处代表信号的局部能量分布。由于Ｃｏｈｅｎ类、仿射类及重排类的双线性时频分 布均与一固定的核函数相对应，则会产生时频分布对某一信号的交叉项抑制效果较好， 而对另一信号可能较差的问题。说明这三类时频分布均缺乏对信号的适应性，Ｂａｒａｎｉｕｋ 提出了自适应最优核函数类时频分布【１２１１。它是通过优化求解获得最优核函数，且通过 核函数的体积参数控制时频聚集性和交叉项成分的抑制之间的平衡，使得两方面都有比 较满意的效果。

４．３希尔伯特一黄变换（ＨＨＴ）理论及谱分析方法

线性时频分布、Ｃｏｈｅｎ类及改进的双线性时频分布都是以ＦＦＴ为最终的理论依据， 分析结果必然地会受到ＦＦＴ分析非平稳信号缺陷的影响。１９９８年美国学者诺尔顿·黄（Ｎ． Ｅ．Ｈｕａｎｇ）等人提出的ＨＨＴ突破了傅立叶变换理论的限制，建立了一种以瞬时频率概念 为基础的较系统和完整的信号分析方法，可以精确地反映非平稳信号的频率随时间的变 化规律，易克服虚假频率和虚假分量等问题的出现，对于非平稳信号的分析非常有效。

４．３．１瞬时频率的定义与估计

对于频率瞬变的非平稳信号而言，传统频率对信号特征的描述不再有效。定义的新

物理量——瞬时频率（Ｉｎｓｔａｎｔａｎｅｏｕｓ Ｆｒｅｑｕｅｎｃｙ，ＩＦ）在描绘非平稳信号的特征时具有独

特的瞬时有效性，并能够确定信号的谱峰的位置，瞬时频率的概念和估计己成功应用于

许多实际信号处理中【１２２１。

人们提出了不同定义的瞬时频率的定义方法，但都存在各自的局限性，１９４８年Ｇａｂｏｒ

和Ｖｉｌｌｅ对先前的研究工作进行统一和完善，提出实信号的瞬时频率就是信号所对应的

解析信号的相位关于时间导数，称为瞬时频率的传统定义——－Ｈｉｌｂｅｎ变换法（解析信号

法），是目前在学术界最为常用且得到普遍认可瞬时频率定义【屹３１。

…

量曼曼！曼舅舅皇曼曼曼曼量曼曼曼曼皇曼曼曼！曼！曼曼！曼曼曼兰曼州曼曼理曼Ｔ曼人曼学曼博曼ｆ曼。曼’曼量≯曼仃！曼沦曼爻皇曼曼曼曼曼曼曼量曼曼曼曼曼曼曼曼曼皇曼！曼曼曼曼曼曼蔓Ｉ！

设信号缸力为时域内的连续实信号，一般可以表示为： ｘ（ｔ）＝ａ（ｔ）ｃｏｓｔｐ（ｔ）
其中，ａ（Ｄ为信号的幅度信息，ｐ（ｔ）表示信号的相位信息。 则“ｆ）的Ｈｉｌｂｅｒｔ变换定义为：
ｘ‘（ｆ）＝ＨＩｘ（ｆ）】－！［：翌ｄｆ：口（ｆ）ｓｉｎ缈（ｆ）

（４．１９）
（９．２０）

显然，信号颤力和ｚ＋（力互为复共轭。对于上述实信号，根据Ｇａｂｏｒ定义的解析信号，

则有

ｚ（ｔ）＝ｘ（ｔ）＋ｊｘ‘（ｆ）＝ｘ（ｔ）＋ｊＨ［ｘ（ｔ）］

（４．２１）

对（４．２１）式取傅里叶变换得

ｚ（ｃｏ）＝ｘ（ｃｏ）＋∥’＠）

＝Ｘ（缈）＋ｊ［－ｊｓｇｎ（ｏ））Ｘ（ｃｏ）】
＝Ｘ（国）［１＋ｓ鲥国）】

：ｊ２ｘ（缈） 国＞ｏ

‘

【０

０．９＜０

（４．２２）

可见，解析信号的频谱在负频率部分为零，而正频率部分是实信号的两倍。Ｇａｂｏｒ

定义的解析信号不仅压缩了信号傅立叶变换的负频率域，还定义了实信号的相位函数，

且相位函数是唯一的。将实信号的解析信号表示为：

ｚ（ｔ），１－－ａ（ｔ）ｅ’妒‘‘’

（４．２３）

贿，口（归＋历丽俪，舻ａｒｃｔａｎ（筹）

≯．

Ｖｉｌｌｅ矛ｌＪ用Ｇａｂｏｒ的解析信号概念，提出实信号的瞬时频率就是该信号所对应的解析 信号的相位关于时间的导数。即有

删＝警叫∽

（４“）

或

肿）＝去掣叫∽

（４．２５）

显然，定义的瞬时频率表示了信号相位变化的快慢，其物理意义十分明显。对瞬时 频率的定义可作如下解释，由频率均值可得：

‰＝吉￡国Ｉｘ（∞）１２ｄ国＝１。￡。ｃｏＸ（彩）ｘ’（国）ｄ缈

（４．２６）

令日（国）：硝（缈），则有，ＪＩｌ（ｆ）：一＿ｊ『鱼掣 ｄｔ
则上式可写作

。
－Ｉ：，ｆｌｚ波形伶测’ｊ心牢变异－阼分析方法研究

缈。＝ｉ１￡日（功）ｘ＋（ｏ＇）ｄｒａ

（４．２７）

根据Ｐａｒｓｅｖａｌ定理，则有

‰＝ｉ１￡［－Ｊ警妣）出

＝ｉ１（一／）ｆ：。叭ｆ）ｅ川＋扣（ｆ）咖）ｅ川］口（ｔ）ｅ－Ｙ９｛Ｏｄｔ

＝！Ｅ ｐ（州ｆ）］２ｄｔ一／ｉ１ Ｄ伽ｏ）ｄｔ
因为频率均值ＣＯｍ始终为实数，所以（４．２８）式的虚部应为零，即

（４．２８）

彩。＝ｉ１￡∥（ｆ）口２０）ｄｒ＝ｉ１￡缈’（ｆ）ｌｘ（ｆ）１２ｄｔ

（４．２９）

从时间角度看，ｌｘ（ｔ）１２为信号在各时间点上的的能量分布，则频率均值亦可认为是所 有时刻上瞬时频率全局均值，即有

‰＝去￡Ｏ）ｉ∽㈨１２ｄｔ

（４．３０）

比较（４．２９）和（４．３０）式，则有 哆（ｆ）＝矽’（ｆ）
可见，瞬时频率即为信号相位的导数。

（４．３１）

解析信号ｚ（力的瞬时频率也可由维格纳时频分布一阶矩定义，即

∞

国：（ｆｌ ）＝ｃｏ专Ｗ（ｔ－，—缈）一ｄ国＝ｑ（ｆ）

（４．３２）

ｌ Ｗ（ｔ，ｃｏ）ｄａ｝

ｉＩＬａ０

其中，职毛∞）为维格纳时频分布（ＷＶＤ）变换。

式（４．３２）说明维格纳分布定义的时频频率ｔＯｚ（ｔ）和ｌＨｉｌｂｅｒｔ变换法定义的瞬时频率∞ｆ（力 是相同的，其证明过程可参考文献［１２４］。
瞬时频率的估方法计主要包括相位差分法、相位建模法、时频分布法、过零点法及
基于线性预测滤波器的谱峰检测法掣１ ２４１。利用相位差分法估计瞬时频率时，可根据瞬
时频率解析定义，将连续时间微分变换为离散时间差分，根据差分方法选择的不同，则

分为以下三种估计算法。 １）前向差分瞬时频率估计

乃（刀）２玄［矿（刀＋１）一伊（，１）】

（４·３３）

２）后向差分瞬时频率估计

兰州理Ｔ人学博ｌｊ学位论文

以（力）＝圭［妒（甩）－ｔ，ａ（ｎ－１）】

（４．３４）

’
３）中心差分瞬时频率估计

以（刀）＝圭【伊（刀＋１）－呼ｏ（ｎ－１）】

（４．３５）

在三种瞬时频率估计方法中，中心差分法估计结果最好，其对于常用的线性调频信 号可得无偏估计，且与许多时频分布的一阶矩对应。采用直接差分法的瞬时频率估计有 一共同的缺点就是对噪声比较敏感，估计误差的方差较大。改善的方法是采用加权的相 位差法，即

炯＝荔１缶Ｎ－Ｉ¨妒（以＋１）一伊（托）】

（４．３６）

％＝器”（掣）２】 其中，Ⅳ为离散数据的点数，％为时变的加权系数，定义为

（４．３７）

瞬时频率估计也可由信号ｚ（Ｏ的离散时间与离散频率ＷＶＤ分布的一阶矩估计，即为 时频分布法，有

西：（刀）＝去州∑呒（，ｚ，ｋ）ｅｓ４，ａ／ｘ】

（４．３８）

ＷＶＤ分布法所得的瞬时频率估计和中心差分法的瞬时频率估计是相对应。

４．３．２经验模态分解

４．３．２．１解析信号法计算瞬时频率的局限性

解析信号具有非常好的物理解释，Ｈｉｌｂｅｒｔ变换也提供了一种合理的计算瞬时频率的

方法。然而，对于某些信号，使用Ｈｉｌｂｅｒｔ变换法求解瞬时频率产生了令人困惑的结果，

如信号频谱是有限个离散线状谱，而瞬时频率却可能是连续的；瞬时频率可能不存在于

信号频谱之中；对于频带有限信号，其瞬时频率可能出现在频带外；解析信号本身不存

在负频率上的谱，但其瞬时频率却可能是负的。

考虑信号ｚ（ｔ）＝Ａｌ ＣＯＳ ０９ｌｔ＋Ａ２ ＣＯＳ缈２ｔ，其中，ＡＩ，彳２为常数，ＯＯｌ＞０，００２＞０。可

表示为

ｚ（ｔ）＝Ａｌｅ／ｑ‘＋Ａ２ｅ归２‘＝Ａｅ ｙｍｔ

（４．３９）

信号ｘ（Ｏ的频谱由两个在∞ｌ和０）２的Ｊ函数组成，即

Ｚ（缈）＝Ａ１万（缈－－（．０１）＋Ａ２８（ｃｏ－－（－０２）

（４．４０）

因为∞ｌ＞０，０９２＞０，所以信号ｚ（力是解析的，将其写为ｚ（ｔ）＝Ａ（ｔ）ｅ７尹‘ｎ，其中

伊（ｆ）：ａｒｃｔ觚＿Ａｌ—ｓｉ—ｎｃ—ｏｔｔ—＋＿Ａ２—ｓｉ—ｎＣ０２ｔ．

（４．４１）

４ ｃｏｓＯ）ｄ＋Ａ，ＣＯＳ缈，ｔ

６７

心ｆＵ波彤伶删’ｊ心；竿馁并ｒＦ分析万让研’Ｚ

Ａ２（ｆ）＝Ａ？＋彳；＋２ＡｌＡ２ ｃｏｓ（０）２－－０）１）ｆ

（４．４２）

对相位妒（力取导数，得ｘ（力的瞬时频率为
删砒一１（”啪鼍１叩刚篝 （４．４３）

由（４．４３）式可知，瞬时频率不仅∞ｌ、∞２有关，而且与彳Ｉ、彳２有关。因此，对于不 同的０９和彳的值可能造成瞬时频率出现了负值或且超出了频带外的情况。
从数学角度看，对于多分量信号，Ｈｉｌｂｅｒｔ变换构造的解析信号的相位导数与时频分 布的条件均值相等，即可将瞬时频率解释为每一时刻信号的平均频率。但是通常情况下 信号的瞬时频率和信号每时刻的平均频率具有不同的值，它们表示了信号频率的两个不 同特性，仅在信号各分量的幅值相等时，两者是相等【１２５】。
设信号瞬时频率∞ｆ（力的频带限定于０）１和∞２。由（４．４２）式和（４．４３）式可知，则有

（４．４４）

司等价于（４．４５）式给出的两式成立。
』彳卜彳ｌ彳２ Ｃ０ｓ（（国２一国１）ｆ）≥ｏ
Ｉ彳；＋彳ｌＡ２ ｃｏｓ（（０）２－－０）１）ｆ）≥０
当么ＩＡ２＞０时，有

（４．４５）

砉≥一州（（－０２－－０）１ｍ

和

鲁≥一ｃｏｓ（（０）２－－０），）ｆ）

（４．４６）

同时成立。 当彳ｌＡ２＜Ｏ时，有

砉≤一ｓ（（０）２－－０），功

和

鲁９ｃｏｓ（（０）２－－０）１ｍ

（４．４７）

同时成立。
显然， （４．４６）式和（４．４７）式成立的唯一条件黝ｌ利２。而对于两分量幅度不等的
情况，∞ｆ（Ｄ为时变且常超出频带范围，在这种情况下，就无法将瞬时频率解释为信号的 平均频率。
以上分析表明，解析信号法计算瞬时频率只适用于单一分量信号，多分量信号获得 有意义瞬时频率必须满足一定的条件，然而并没有明确的定义来确定一个信号是否是单

兰州理丁人。￥二博ｆｊ。亨邛！论艾

一分量信号，通常以用“窄带”信号加以限定，当一个信号越接近于“窄带’’信号，解 析信号法的瞬时频率计算的物理意义就越明确。但关于带宽定义均是在全局意义上给出 的，过于严格且缺乏准确性。通过带宽限制，由解析信号法计算有明确物理意义的瞬时 频率还没有被严格地建立【“９１。为了得到频率时变的非平稳信号有意义的瞬时频率，应 将信号全局性的限制条件改为局部限制条件。
对于复杂信号本身无法保证得到有意义的瞬时频率，是否可以考虑通过信号分解方 法获得了满足瞬时频率传统定义的分量信号。１９９８年Ｈｕａｎｇ等人创造性地提出了经验模 态分解（Ｅｍｐｉｒｉｃａｌ Ｍｏｄｅ Ｄｅｃｏｍｐｏｓｉｔｉｏｎ，ＥＭＤ）的方法，该方法是以具有时变幅度与时 变频率信号的瞬时频率为理论基础的【１２６，１２７］。ＥＭＤ方法可用于非线性与非平稳信号分析 与处理，受到人们越来越多的重视。

４．３．２．２固有模式函数
Ｈｕａｎｇ等人将满足如下两个条件的函数称为固有模态函数（Ｉｎｔｒｉｎｓｉｃ Ｍｏｄｅ Ｆｕｎｃｔｉｏｎ， ＩＭＦ），即：
１）在整个数据序列中，信号的极值点与过零点的个数必须相同或至多差一个； ２）在任意时间点上，信号的局部极值点构成的包络均值为零或近似为零。 ＩＭＦ函数的第一个条件近似于传统平稳高斯过程的窄带的要求；第二个条件是其创 新之处，将传统的全局性限定变换为局部性限定，去除了波形不对称引起的瞬时频率波 动。对于满足这二个条件的模态分量，其连续二个过零点之间只存在一个极值点，也就 是仅包括一个基本模态的振荡，无复杂的马鞍波存在。在理想情况下应取信号局部均值 为零，但对于非平稳信号“局部均值＂难于定义，故常以包络均值代替。信号的非线性 畸变可能会引入一定偏差，但其影响和信号非平稳性相比较十分有限。因此，对于非平 稳、非线性信号所得的瞬时频率是符合信号原始物理意义。 ＩＭＦ分量表示了嵌入在数据中的振荡模态，对于其并没有限定为窄带信号，它可以 是有一定带宽的非平稳信号。一个典型的ＩＭＦ分量信号如图４．１所示。 通过Ｈｉｌｂｅｒｔ变换任意一个ＩＭＦ分量信号都能表示为解析信号ｚ（０，５纠ｇｚ（ｔ）进行傅里叶变 换，则有

Ｆ（缈）＝ｆ：ａ（ｔ）ｅｊ州ｆ）Ｐ删ｄｔ＝ｆ：口（ｆ）ｅ肭）训出

（４．４８）

由平稳相位法可知，对频谱尺∞）贡献最大的频率应满足如下的条件：

要（伊（ｆ）一ｃｏｔ）：ｏ ｊ缈：掣

口ｆ

“‘

（４．４９）

在（４．４９）式中，频率是通过局部正弦函数匹配的平稳相位条件得到的。因此，信

号频率不再使用整个振荡周期定义，而通过连续信号点的变化在信号每一点上定义的频

率值，从这个意义来看，即使信号为单调信号也可看作是一个振荡信号的一部分，从而

定义其瞬时频率值。

心Ｉｌ！波形柃测’ｊ心牢，玺异忡分析方法研究

图４．１典型的ＩＭＦ分量１青号
ＥＭＤ分解目的是为了消除局部的叠加波和局部的不对称性，以获得有意义的瞬时频 率；ＥＭＤ分解所得到的每一个ＩＭＦ分量应尽可能为单分量信号，这样其瞬时频率可随处 定义。
４．３．２．３ ＥＭＤ分解原理及算法实现

实际中大多数信号并不满足固有模态分量二个限定条件要求，为此Ｈｕａｎｇ等人提出 了如下假设：任何信号均可以由一些不同的固有模态分量组成的；每个ＩＭＦ可以是线性 的，也可以是非线性的；任意两个ＩＭＦ之间是相互独立的。在此假设的基础上，任何一

个复杂信号经ＥＭＤ分解后可表示为不同的ＩＭＦ之和。

设原信号为顶力，用，，ｚ七表示对信号工（力求ｋ次均值，而信号ｘ（ｔ）－与ｍｘ（ｔ）的差被定义为ＩＭＦ

分量，用ｃｌ表示。

Ｃｌ＝工（ｆ）一ｒｅｘ（ｔ）

（４．５０）

用颤Ｄ．Ｃｌ作为待处理信号再进行分解，依此类推至第ｎ次，则有 ｃ。＝ｍ”１石（ｆ）一ｍ“（ｒ）
满足一定条件后，分解过程停止，则有

（４．５１）

ｘ（ｆ）＝∑ｃｆ＋研”ｘ（ｆ）＝∑［聊Ｈｘ（ｔ）－ｍ‘工（ｆ）】＋聊“ｘ（ｆ）

扭ｌ

１＝１

设ＥＭＤ分解得到的各ＩＭＦ分量的解析信号为ｚｋ（ｔ）（ｋ＝－Ｉ，２…，，ｚ），则有

Ｚｋ（ｆ）＝ａｋ（ｆ弦’吼‘‘’（ｋ＝－Ｉ，２…，以）

原信号缸力的解析信号可以表示为

（４．５２） （４．５３）

ｚ（ｆ）＝∑口ｔ（ｆ）Ｐ７张‘ｏ
ｋ＝ｌ
求出各ＩＭＦ分量的瞬时频率ｏＪｋ（ｔ）。则原信号缸力可表示为
ｘ（ｆ）＝Ｒｅ【窆口。（ｆ）ｅ如∽出】
ｋ＝１
分析（４．５５）式可知，ＥＭＤ分解有以下的优点：

（４．５４） （４．５５）

曼量曼曼曼曼曼曼曼曼鼍曼曼曼曼璺寰曼曼曼曼曼曼曼鼍皇量曼曼黑兰曼州曼曼ｊ！！曼ｌ！曼Ｔ曼人曼学曼博皇！Ｉ曼。曼学曼曼使璺论曼文曼曼量曼曼舅曼曼曼曼曼曼皇皇曼曼曼曼曼曼曼曼曼曼曼曼曼皇！曼笪 一

１）由各ＩＭＦ分量的瞬时频率∞“力（ｋ＝ｌ，２…，以）可以充分反映－Ｊ＇ｘ（ｔ）的瞬时频率特征。

２）原信号ｘ（力傅罩叶分解表示为ｘ（ｆ）＝Ｒｅ［∑口。ｅ’ｑ‘】，式中的纵和∞七（肛１，２…，刀）均为
ｋ＝ｌ

常数。而基于ＥＭＤ分解得到是可变幅度和可变频率的信号描述，打破了傅里叶变换的固

定幅度和固定频率的限制。

３）ＥＭＤ分解的基函数（固有模态分量）是依赖于信号本身，不同的信号分解的基

函数是不同的，具有自适应的特性，可以得到更好的信号分解效果。

ＥＭＤ分解过程实际上是一个固有模态分量的筛选过程，其算法具体实现步骤如下：

１）确定信号缸力的所有局部极值点，然后用三次样条曲线拟合，将所有极大值点和

所有极小值点分别连接起来，构成缸ｆ）的上、下包络线。上、下包络线应包括所有的数

据点，记上、下包络线的平均值为ｍｌ（力。

２）被分解信号ｘ（Ｏ与均值ｍｌ（ｔ）的差记为＾ｌ（力，即 ｈｌ（ｆ）＝ｘ（ｔ）一ｍｌ（ｆ）

（４．５６）

在理想情况下，＾ｌ（Ｏ应该是一个ＩＭＦ分量。对非线性、非平稳数据而言，包络均值

可能不同于真实的局部均值，依然存在一些非对称波。因此，＾ｌ（力不满足基本模态分量

的限定条件，将ｈＩ∽作为待处理数据，重复上述过程，直至筛选出一个基本模式分量。

设重复筛选ｋ次后，得到Ｊｌｌｌ“力为 ｈｌｋ（ｆ）＝ｈｌ（ｋ－１）（ｆ）一ｍｌｔ（ｆ）

（４．５７）

使ｈｌＲｔ）满足ＩＭＦ的条件，记 Ｃｌ（ｆ）＝ｈｌ女（ｆ）

（４．５８）

则ｃｌ（力为信号ｘ（力的第一个ＩＭＦ。在实际的筛选过程中，很难保证信号的局部均值绝

对为零。如果完全按照二个限定条件判断分离出的分量是否为ＩＭＦ分量，很可能造成重

复筛选次数过多，导致ＩＭＦ分量变为纯粹频率调制信号，而丢失有意义的振幅波动，使

幅度变为恒定。为了保证ＩＭＦ分量能反映物理实际过程的幅度与频率调制有意义，应确

ｃ訾， 定一个筛选过程的停止标准。一般可由二个连续的筛选结果的标准差定义，即

品：委Ｔ

（４．５９）

通常岛的值取为０．２￣ｏ．３。ｅｌ（力包含原始信号中最短的周期分量，即信号尺度最小的

部分。

３）计算原始信号缸ｆ）和第一个固有模态分量Ｃｌ（力之间的差，称残差或趋势项，记为

ｒｌ（ｔ），则

‘（ｆ）＝ｘ（ｔ）一ｃｌ（ｆ）

（４．６０）

４）把ｒｌ（ｆ）作为一个新的“原始＂数据重复上述步骤，提取满足ＩＭＦ条件的颤ｆ）的第

二个，第三个，直至第ｎ个ＩＭＦ，记为ｃ，Ｏ（卢ｌ，２，…，刀）。最后原信号缸ｆ）被分解为ｎ个ＩＭＦ

７ｌ

皇曼曼曼曼曼詈曼曼曼曼曼曼曼曼皇曼Ｉ—

ｉ．

一一 心ｌＵ波形伶测‘ｊ心率变异忡分析方ｉ土研究 ＿．

Ｉ皇皇曼曼皇量曼曼曼曼曼量曼皇曼曼曼量曼曼！曼曼

分量之和，再加上残差ｈ（力，即有

ｘ（ｆ）＝∑ｃｊ（ｆ）＋％（ｆ）
１＝１

（４．６１）

随分解尺度越来越大，残差ｒｎ（ｔ）变为一个相对缓变的信号，可以是一个单调函数或 常数。

４．３．２．４ ＥＭＤ分解的性能

１．线性性质 ＥＭＤ分解具有线性性质，即有

ａｘ（ｔ）＋ｂｙ（ｔ）＝∑（口ｃｆ（，）＋幻；ｏ））＋（口‘（ｆ）＋６巧（ｆ））
ｉ＝１

（４．６２）

２．完备性和正交性

分解的完备性是指分解的各个分量相加恢复原始信号的性质。由（４．６１）式和分解

算法本身可知，ＥＭＤ分解的所有ＩＭＦ分量和趋势项相加后可以完全恢复原信号，即信号

是可完全重构的，其误差小至计算机的舍入误差。因此，从理论和数值分析上都能说明

ＥＭＤ分解完备性【１２６１。

分解的正交性是指分解的各个分量之间相互正交的性质。Ｈｕａｎｇ等人认ＥＭＤ分解
的正交性在实际意义上是满足的，但在理论上还缺乏严格帆ｉＥＨＹｌｔｌ２６１。从分解过程来看，

每个基本模式分量都是原始信号与局部包络均值的差值，因此，分解得到的ＩＭＦ分量和

均值曲线是局部正交的，即有

（ｘＯ）一ｚ（ｆ））·工Ｏ）＝０

（４．６３）

但是（４．６３）式不是严格成立，因为这里均值曲线是由包络均值近似的，和真实均

值相比具有一定的偏差。从局部来看，ＥＭＤ分解的任何两个分量都是满足正交的，但

从全局来看，某些数据分解的相邻分量可能在不同的时间上具有相近的频率成分。因

此，ＥＭＤ分解的正交性是局部意义上的正交，其正交性能越好，各分量之间的能量泄

漏就越少。事实上，严格的正交性不是必要的，它依赖于信号长度和分解方法。在ＥＭＤ

分解中，每个ＩＭＦ分量的频率一般是非平稳的，如果对它们作傅里叶变换，将会有共同

的谐波分量，因而不能保证严格的正交性。

３．自适应性

ＥＭＤ的分解是以ＩＭＦ分量本身作为基函数，其依赖于信号本身，不同的信号分解的

基函数不同，因此具有自适应的特性，可以认为ＥＭＤ分解采用的是一种自适应的广义基

函数。虽然不能给出基函数的明确表达式，但通过自适应的广义基函数可获得了非常好

的信号分解效果。

、

４．时间尺度滤波特性

兰州飕Ｔ人学博Ｉｊ学化论文

通常信号滤波是采用一定结构和带宽的滤波器在频域上实现的。但对非线性、非平 稳信号，其频域包含了许多谐波成分，使得滤波后的信号失真严重。ＥＭＤ是基于信号局 部特征时间尺度的分解，分解的每一个ＩＭＦ表征了信号在某一特征时间尺度上的振动模 式和频率变动范围，而且具有明显的物理意义，因此，借助ＩＭＦ可以构造一种新的时间 尺度滤波滤波方式【１２７１。
对于一个包含有，ｚ个ＩＭＦ分量和一个残差信号ｈ（ｆ）的信号，其低通滤波可表示为：

ｘ胛（ｆ）＝∑ｃ心）＋＿（ｆ）
，

１＜ｚ≤咒

（４．６４）

高通滤波可表示为：

带通滤波可表示为：

ｋ
ｘ胛（ｆ）＝∑ｃ，（ｆ）
ｈ

ｌ＜ＪＩｌ＜七＜ｒ／

（４．６５）

七
ｘ胛（ｆ）＝∑ｃｆ（ｆ）
ｂ

１≤６＜ｋ≤，ｌ

（４．６６）

时间尺度滤波方式的优点是滤波结果能充分保留信号本身所固有的非线性和非平稳

特征，具有很强的自适应性。

４．３．２．５ ＥＭＤ分解端点效应

对于有限长的数据序列分析，通常存在边界的处理问题。在ＥＭＤ分解中，由于信号 两端边界的不确定性，其均值只能近似估计，边界处的均值精度，对信号分解的结果有 较大的影响，即所谓的ＥＭＤ分解的端点效应‘７５１。端点效应产生的原因是由于在端点处 三次样条函数拟合点的不确定，使得分解过程中上下包络的样条拟合函数在数据序列的 两个端点处产生大的摆动，甚至随分解过程的进行向数据序列的中心部位传播，从而造 成模态分解的失效。另外，在ＩＭＦ分量进行Ｈｉｌｂｅｒｔ变换时也会产生的严重的端点效应， 这是由于数字方法实现傅立叶变换而形成的频谱泄漏原因【１２８Ｊ。对于长数据序列的分解， 可在进行Ｈｉｌｂｅｒｔ变换前，抛弃一部分两端点的数据点，来减弱或消除端点效应。对于短 数据序列的分解，这种方法是不可行的。一般必须对数据序列延拓后进行ＥＭＤ分解，分 解后丢弃延拓部分，以减弱端点效应影响。端点效应是影响ＥＭＤ分解方法精度的主要因 素，关于端点效应的消除已提出了一些方法，主要包括特征波延拓法、包络延拓法、多 项式拟合法、自适应滤波法、端点波形匹配预测法等，不同的端点处理方法有各自优势 和不足【１２９】。各种端点处理方法虽然在实际使用中取得了可以接受的效果，但并没有从 根本上解决端点效应。
４．３．３ Ｈ．Ｉ ｂｅｒｔ时频谱分析
４．３．３．１ ＨｉＩ ｂｅｒｔ时频谱

心ｌＵ波形伶测’ｊ心：筝变异ｒｌ：分析方法研究

经过ＥＭＤ分解可以得到信号ｘ（Ｏ的有限个固有模念分量（ＩＭＦ），对每一个ＩＭＦ分量 ｃ，（ｆ）作Ｈｉｌｂｅｒｔ变换，即有

砷心）】－去ｅ盟ｔ－ｖ ｄｆ

（４．６７）

ｃｉ（ｔ）币ｎＨ［ｃｉ（ｔ）］为共轭复数对，则构造解析信号勿（力为 ｚ形）＝Ｃｉ（ｆ）＋Ｈ［ｃｆ（ｆ）】一ａｉ（ｆ）ＰＭ‘。’
式中，幅度ａ，（力和妒，（力分别为

（４．６８）

口∥）＝√ｃ；（ｆ）＋Ｈ ２［ｃ以）】

（４．６９）

删＝ａｒｃｔａｎ（Ｈｑ［ｃ【ｉＣ尹ｊＩＩ（，ｔ）］

（４．７０）

求出分量瞬时频率∞“力为

咄）＝百ｄｅｐｉ（ｔ）。ｒ厶＝去掣

（４．７１）

由此分量信号ｃ，（力可表示为

ｃ∥）＝Ｒｅ乜（ｔ）ｅｊＭ。’出）

（４．７２）

其中，Ｒｅ表示取实部。

原信号顶力可以表示为

ｘ（ｆ）：Ｒｅ｛窆ａｃ，（ｆ）ｇ，％ｆ（ｆ’）：Ｒｅ匹ｎ口ｑ ｏ）ｅｊＭ伽）

（４．７３）

其中，以为ＩＭＦ分量个数，Ｒｅ表示取实部。
残差信号＾（力一般是一个能量很小且具有不确定性得趋势量，为了更好的观察包含 有用的低频信息分量，在Ｈｉｌｂｅｒｔ变换时通常都不考虑残差信号。
哇ｔＨｉｌｂｅｒｔ变换得到的幅度和频率是时间的函数，将信号幅度在三维空间中表示成时
间和频率的函数硼力，即为信号的Ｈｉｌｂｅｒｔ时频谱。

Ｈ（ｆ，ｆ）＝Ｒｅ｛羔ａｃｔ（ｔ）ｅｘｐ［ｊ２刀仉班】）

（４．７４）

础力描述了信号幅值随时间和频率的变化规律。Ｈｉｌｂｅｒｔ谱实质是一个加权的联合时

间．频率．幅度分布，而每一个时间．频率单元上的权值则是局部幅度值。 Ｈｉｌｂｅｒｔ时频谱是信号的一种线性时频表示。因此，可以得到每个ＩＭＦ分量的时频谱

或几个分量重构的时频谱，即

Ｈｃｆ（／，ｆ）＝Ｒｅ［～（ｔ）ｅｘｐ（ｊ２ｚ Ｊ厶（ｆ）出）】

（４．７５）

７４

兰＂ｆ理Ｔ人学博ｆｊ学化论文

日ｃ『．－ｑ（厂，ｆ）＝Ｒｅ｛圭口ｑ ｅｘｐ（ｊ２万阮（ｆ）出））

（４．７６）

在三维平面｛删力）中，信号幅度可以表示为一个三维立体图及时频面的等高线。

４．３．３．２ Ｈ ｉ Ｉ ｂｅｒｔ时频谱的边际谱

信号在时频域内的能量描述为

ＥＥ，：２上ｆ。Ｉ。土Ｃ。Ｐｘ（ｆ，（ｆ，

（·

式中，烈ｆ力为信号的联合时间频率密度，ｐｘ（ｔ力是信号的二次函数。
能量分布应满足如下边缘性质，即

ｅｐ，（ｆ，ｆ）ｄｔ＝１ｘ（刊２

（４．７８）

．ｈｌ
（４．８１ｆ）ｄｔ
（４．８０）Ｐ
（４．７７）ｆ）ｄｔｄｆ

ｅｐ，（ｆ，ｆ）ｄｆ＝ｌｘ（ｔ）１２

（４．７９）

Ｃｏｈｅｎ类时频分布是满足（４．７７）、（４．７８）、（４．７９）式的一种常用的描述信号的
能量密度分布的时频分布，时频分布的边缘分布能够提供关于信号的重要信息，也是人
们感兴趣的内容，其定义为
时间边缘：
ｆ

，，（“ｆ））＝：一ｒ一ｐ（ｔ，，厂厂））一ｄｆ
。ｌｌＬ－００

（４． ８０）

频率边缘：

ｐ．，ｏ（）ｆ：）ｒ＝ｐ…（ｔ，

（．８１））

显然，时间边缘分布与信号的瞬时功率相对应，频率边缘分布与能量谱密度相对应， 即

∽ № 乃 、， ＝

２
ｆ‘

ｒ●、，Ｌ 彤 ∽ 所

＝．

厂 ＪＷｑ、，

（４．８２）

Ｈｉｌｂｅｒｔ时频谱是以瞬时频率为基础的瞬时幅值谱，不是一种能量密度分布，不满足 的边缘条件。但可借用边缘分布的概念，将三维表示降维在两维中描述时频信息，仍是 一种非常有效的时频表示方法。因此，可以得到整体的时频谱边缘表示，也可以得到单 一分量或某几个分量重构的时频谱边缘表示。
１．…Ｉｂｅｒｔ频率边际谱 若将特定频率的幅值（能量）分布在整个时间全部加起来，即对时间积分，则可得

７５

心ｆＵ波彤榆测０心牢变异忡分析方ｉ上研究

信号幅值（能量）密度频谱，定义为Ｈｉｌｂｅｒｔ频率边际谱，即
ｈ（ｆ）＝ＩＨ（ｆ，ｔ）ｄｔ
≠
将式（４．７４）代入式（４．８３）得

（４．８３）

ＪＩｌ（／）＝，Ｈ（ｆ，ｔ）ｄｔ＝，（Ｒｅ窆ａｉ（ｆ）ｅ伽胁出）ｄｒ

ｒ

ｒ

９１

（４．８４）

：窆ｆＲｅ（口∥）ｇ伽Ｍ西）ａｔ：窆＾Ⅳ）

ｉ＝ｌ ｒ

扭ｌ

其中，ＪＩｌｆ∽表示信号缸ｆ）的第ｉ个ＩＭＦ分量的边际谱。

可见，Ｈｉｌｂｅｒｔ频率边际谱也满足线性条件。Ｈｕａｎｇ等人指出边际谱中的频率（瞬时 频率）与傅立叶分析中的频率意义完全不同的，在傅立叶谱中，某一频率处幅值（能量）

的存在表示在整个时间轴上存在这一频率的正弦或余弦波。而在边际谱中，某一频率处

幅值（能量）的存在表示在整个时间轴上有这一频率的振动波存在可能性。而文献［１３０】 认为由于瞬时频率是一个局部瞬时概念，可以随时出现，也可以随时消亡，当边际谱中

存在的可能性。若对任意固定频躲时间积分，实际上将频猢力的所有时刻尉应幅 有某一频率的幅值（能量）出现时，则必然有这一频率的振荡波的存在，而不应是一种

值以（力相加，表示了信号在该频率处的总幅值（总能量），也即为边际谱线的高度。因 此，Ｈｉｌｂｅｒｔ频率边际谱反映的是信号瞬时频率的总幅值（总能量）大小。

若将幅度的平方对时间积分，还可得到Ｈｉｌｂｅｎ能量谱，即有

ｅｓ（厂）＝１日２（ｆ，ｔ）ｄｔ
子

（４．８５）

Ｈｉｌｂｅｒｔ能量谱提供了对于每个频率的能量度量，表达了每个频率在整个时间长度内 的能量累积。
２．ＨＩＩｂｅｒｔ时间边际谱 若将Ｈｉｌｂｅｒｔ时频谱对应到时间轴的边缘，可以得至ｌＪＨｉｌｂｅｒｔ时频谱的时间边缘分布， 定义为Ｈｉｌｂｅｒｔ时间边际谱，即

Ｊ（ｆ）＝ＩＨ（ｆ，Ｏａｆ
歹

（４．８６）

从（４．８６）式可以看出，Ｈｉｌｂｅｒｔ时间边际谱实质上是不同时刻对应频率的幅度累积。

Ｈｉｌｂｅｒｔ时间边际谱也满足线性条件，即

耶）＝∑，，（ｆ）

（４．８７）

在实际的非平稳随机信号的分析中，往往希望知道信号在某些频带内能量随时间的 变化情况，但传统时频分析要受到Ｈｅｉｓｅｎｂｅ喀测不准原理制约，不能在时间和频率同 时达到很高的分辨精度，也就不能确定时频空间中某一点的瞬时能量密度。ＨＨＴ不受

７６

兰州理Ｔ人学博Ｉ‘学位论文

Ｈｅｉｓｅｎｂｅｒｇｆｌ０不准原理制约，可以在时间和频率同时达到很高的精度。文献［１３１】 定义了时．能密度函数以反映了信号所在尺度区间（频带）的能量随定位参数（时间）

的分布。基于此概念，在某频率区间，将Ｈｉｌｂｅｒｔ时频谱的幅值平方对频率积分，称为信

号的频带能量谱，它可以表示信号的各个频带能量随时问的变化，即有

以
，。（ｆ）＝Ｉ：２Ｈ２（厂，ｔ）ｄｆ ■Ｉ

（４．８８）

式中，石啦是频带范围，式（４．８８）反映了不同时刻对应频带的能量累加。若在频带撕幔
再对时间积分，则可得到该频带范围内总能量值，即有

ＥＡ，疋＝ＩＩ，（ｔ）ｄｔ

。

。。Ｔ。

（４．８９）

由式（４．８９）可以获得在全频率范围内的不同频带的能量值，从而得到在整个频率

范围内按频带划分的能量变化的棒形图。

４．３．３．３ Ｈ．Ｉｂｅｒｔ时频谱的性能分析

１．时频聚集性 时频聚集性是反映时频分布性能的重要依据。传统的时频分析方法都是以傅立叶分 析为基础，对信号的全局进行变换，对于非平稳信号难以从根本上获得其瞬态特征。 Ｈｉｌｂｅｒｔ时频分析摒弃了从信号全局出发的思想，着眼于信号局部时频特性的分析ｅ．根据 固有模态函数的定义和条件可知，每个ＩＭＦ分量在任意一个时刻仅包含一个频率成分， 而且是有意义的。因此，对各ＩＭＦ分量经Ｈｉｌｂｅｒｔ变换得到的解析信号，在每一时刻都可 以将其表示成具有一定物理意义的瞬时幅值与瞬时频率的形式。这样，无论采用模态能 量分布还是点能量分布，ＨＨＴ时频谱均具有很好的时频聚集性。 Ｈｉｌｂｅｒｔ时频谱是由ＥＭＤ分解的各个ＩＭＦ分量单独进行Ｈｉｌｂｅｒｔ变换，再将结果线性叠 加后信号的一种时频表示，０１］Ｈｉｌｂｅｒｔ时频谱是一种满足叠加原理的线性时频表示。因此 它具有强的抑制交叉项的能力。而双线性时频分布（女ｎＷＶＤ分布）与线性时频分布完全不 同，双线性变换破坏了线性叠加原理，必然产生一定的交叉干扰项，使得多分量信号的 时频分布变得复杂，而一些抑制交叉干扰项的方法，大都是以降低分辨率为代价，且也 无法从根本上消除交叉干扰项。 考虑一个二次调频信号如图４．２（ａ）所示，其采样频率居＝４０００Ｈｚ，图（ｂ）为短时 傅里叶变换的时频谱，图（ｃ）为连续Ｍｏｒｌｅｔｄｘ波变换时频谱，图（ｄ）为ＷＶＤ的时频分 布，图（ｅ）为Ｈｉｌｂｅｒｔ时频谱，其中横坐标对应信号采样点数（时间），纵坐标对应归一 化信号频率。 短时傅里叶变换其在时频平面上是按确定的格状划分，受测不准原则的制约，很难 找到一个合适的短时窗函数，使信号在其时间宽度内获得最佳的分析效果。在图（ｂ） 中频率表现在一个很宽的带状区域，变化规律也不能清晰地反映出来，其时频聚集性很

心Ｉ ｂ波形检测‘ｊ心率变异性分析方法研究

㈣㈧＿ｌ：ｊ＋？』｜Ｉ。ｆ｜。０。Ｉ？。．ｆ√ｌＩ劁 ｏ。㈠－。 “。；＿＿；『：－

．。ｊ；ｉ＿．ｊ’：ｌ ｉ㈣搬嘲㈣㈥
ｉ㈨畔嘲猁蚓㈣《

ｉｊｌｉ｜㈤矧㈠Ｉｊ㈡Ｉ。０．。。川ｌ｜！】渊删湖删…删蝼

ｋ。。嘲。／？

１００

２００

３００柏Ｏ

５００

ｅｏｏ

？ｏｏ

Ｔｈ●ＳＩｍｐｌｅ

ｂ）

２００

３００

４００

５００

６００

７００

８００

ｍ●ＳａｍＤｈ

ｍ

图４．２二次调频１言号的时频分布 ａ）二次调频信号 ｂ）短时傅里叶变换的时频谱ｃ）连续Ｍｏｒｌｅｔｔｂ波变换时频谱
ｄ）：为Ｗｉｇｎｅｒ－Ｖｉｌｌｅ的时频分布 ｅ）Ｈｉｌｂｅｒｔ时频幅值谱 很差。按尺度对信号进行分解的小波变换，由于受到小波基函数的影响，所产生虚假谐 波分量引起信号能量泄漏，从而影响小波谱的时频聚集性。在图（ｂ）中频率也表现在 一个较宽的带状区域，而在低频段，聚集性非常差。ＷＶＤ分布对于线性调频信号分析 没有出现交叉项，但对于二次调频信号分析，ＷＶＤ分布反映其频率变化规律时有严重 的交叉项干扰，无法有效揭示信号的频率变化规律。在图（ｃ）中时频图十分清晰地反 映了频率变化规律，时频聚集性也非常好，但存在明显的交叉干扰项，这些伪信息直接 影响了观察结果。图（ｅ）的Ｈｉｌｂｅｒｔ时频谱大部分能量都集中在一定的时间和频率范围内， 清晰地刻画了信号的时频能量分布情况，反映了信号瞬时频率的二次函数变化规律。
因此，信号的Ｈｉｌｂｅｒｔ时频谱克服传统时频谱的不足，具有时频聚集性好，无交叉干 扰项的特点，是一种十分理想的表现信号局部特性及变化规律的时频分析方法。
２．Ｈ ｉ ｌ ｂｅｒｔ时频谱多分辨率特性

兰州理Ｔ人学博ｆｊ学位论文

时频分布可同时描述信号在不同时间和频率的能量密度或强度。因此，时频分布的 时间和频率分辨能力的高低是反映时频分布性能的主要指标。
理想的时频表示方法希望在时间和频率上都具有无限分辨率，即从信号的时频表示 中能确切知道信号能量在点以∞）的分布，然而受Ｈｅｉｓｅｎｂｅｒｇ测不准原理的制约，满足这 一要求是不可能的。
测不准原理：给定信号缸力，若ｌｉｍ４ｔｘ（ｔ）＝０，则

△，Ａｍ≥｛

（４．９０）

式中，４，为时窗半径，彳∞为频窗半径，当且仅当ｘ（ｆ）为高斯信号时等号成立。

显然，对给定的信号，其时宽与带宽的乘积为一常数，当信号的时宽减小时，其带

宽将相应增大，当时宽减到无穷小时，带宽将变成无穷大，反之亦然。若要准确求得信

号在＠∞）处的能量密度，必须测量信号在心∞）点一无限小的二维邻域内的能量，即要 求信号的时宽与带宽同时趋于无限小，这显然是不可能的。因此，信号的时频表示，只

能不同程度地近似表示信号在以∞）处的能量密度，即只同时具有有限的时间分辨率和频 率分辨率。

由著名的奈奎斯特采样理论可知，对一个一维无穷长带限的信号ｘ（Ｏ，如果频谱在

［．０３ｍ，ＣＯ州］外为零，则信号ｘ（ｔ）口－Ｉ用等间隔出的抽样值唯一表示的条件为

Ａｔ≤＾ ·ｆ ÷（缈、ｔ。Ｈ ＝２矾ｏ ）

）

（４．９１ｍ

二Ｊ ｍ

即要求最低采样频瓤伍＝ｌ／Ａｔ，Ａｔ采样周期）不小于砺。

对于离散信号进行离散傅立叶变换，可以得到信号的离散傅立叶频谱，则信号频谱

的频率分辨率为

Ａｆ：１：上：五

（４．９２）

２’ ＮＡｔ Ｎ

式中，瞒信号的长度，Ⅳ为信号的采样点数，则酬ｆ。

显然，采样点数随采样频率增加而增加。因此，增大采样频率不能有效地提高频率

分辨率。要提高频率分辨率可增加信号长度，即在采样信号数据后补零。 由离散傅立叶变换可得到的最高信号分析频率为采样频率的一半，即

ＪＬ“…姒 ＝二１ ＝且， ２Ａｔ ２

（…４．９３） 。

因此，提高采样频率，可以提高傅立叶分析的最高信号分析频率。Ｈｉｌｂｅｒｔ时频谱中
信号的瞬时频率是其解析信号相位函数的导数，其最高瞬时频率缸是采样后信号中自
身固有的最高频率。因此，Ｈｉｌｂｅｒｔ时频谱图中表示出的最高频率总是自适应地与信号自

身固有的最高频率相一致，它与傅立叶变换最高分析频；童ｉｇ－ｆ／２不同。因此，Ｈｉｌｂｅｒｔ谱的最

，ｔｂ『Ｕ波形伶测’ｊ心串变畀忡分析方法研究

高频率分辨率只与采样信号中自身含有的最高频率和信号的采样数Ⅳ有关，即

ｆ－争

一（４．９４）

一般地厶采∥２，故Ｈｉｌｂｅｒｔ谱的频率分辨率比傅立叶分析的高两倍多。

小波变换的时频分辨率特性受到测不准原理的制约，其时宽一带宽积为一常数。因

此，小波变换的时频分辨率的特点为：当尺度因子ａ减小时，对信号“幻的时域观察范

围变窄（时窗变窄），时间分辨率增大，而频率观察的范围变宽（频窗变宽），频率分

辨率减小，且观察的中心频率向高频处移动；反之，当尺度因子ａ增大时，对信号ｘ（力

的时域观察范围变宽（时窗变宽），时间分辨率减小，而频域的观察范围变窄（频窗变

窄），频率分辨率增大，且分析的中心频率向低频处移动。

我们知道，小波分解在不同尺度（分辨率）下可将信号分解为低频部分（概貌信号）

和高频部分（细节信号），而细节信号刻画Ｙｄ，波分解在两个不同尺度２，与矿１之间的差

别，即为两个不同分辨率之下的差别，在小波分解的这种嵌套分解结构中信号的表征为

小波变换的时频多分辨特征，它是小波分析理论的重要概念。

实际上，根据ＥＭＤ分解原理，将信号双力的ＥＭＤ分解表示为【１３２】

ｍ”１ｘ（ｔ）＝ｍ”ｘ（ｔ）＋ｃ。

（４．９５）

其中，岛表示第玎个固有模态函数，ｍｎｘ（ｔ）表示第ｎ次对信号顶力求均值曲线。

可以看出，信号的每次ＥＭＤ分解都增加了一个细节信号（固有模态函数靠）和一个

频率低于细节信号的低频分量（第ｎ次均值曲线ｍｎｘ（Ｏ），分解过程实际上就是不断提取

信号的高频分量的过程。当信号分解过程完成后，得至：ｌＪｎ个固有模态分量函数的最高频

率是按从大Ｎｄ，ＣｔＶ列，ＯＰｃｌ所含频率最高，岛所含频率最低。
设‰是分量ｃ，中的最高频率，则有

Ｚ一＞正ｆ＋Ｉ）一 ｉ＝１，２，…，万一ｌ 这样，分量ｃ，的Ｈｉｌｂｅｒｔ时频谱图频率分辨率为

（４．９６）

６ｆ，＝等

（４．９７）

式中，Ⅳ为信号采样点数。
在采样点数一定时，时频图的频率分辨率则由分量最大瞬时频率扁椭定，且有

ａｆ，＞ａｆ，＋Ｉ

（４．９８）

可见，每个固有模态分量的Ｈｉｌｂｅｒｔ时频谱图频率分辨率不相同，小时间尺度分量（高

频分量）的频率分辨率低，而大时间尺度分量（低频分量）的频率分辨率高。由于ＥＭＤ

分解中分量的数据点数不随分解的进行而减少，使得各分量的时间分辨率保持不变，即

时频谱图的时间分辨率为么ｆ。这即为Ｈｉｌｂｅｒｔ时频谱的多分辨率特性。

由于ＥＭＤ分解是根据具体信号的局部时变特征进行自适应分解，分解的分量个数无

法预知，每一个固有模态分量的频带范围、最高频率也是在分解结束后获得，说明Ｈｉｌｂｅｒｔ

兰州理Ｔ人学博ｌｊ学ｆ一沦丈
时频谱多分辨分析特性是自适应的。 比较Ｈｉｌｂｅｒｔ谱的多分辨特征和小波谱多分辨特征可知，小波谱的多分辨分析受测不
准原理的制约，提高频率分辨率的同时降低了时间分辨率。Ｈｉｌｂｅｒｔ谱的多分辨分析不 受测不准原理制约，其时间分辨率保持不变，提高采样频率，可提高时间分辨率；而 频率分辨率呈现多分辨率特性，增加采样点数，可提高频率的分辨率。由于ＥＭＤ的各分 量的时间尺度是从信号中自适应提取的，可以是任意值，Ｈｉｌｂｅｒｔ谱具有自适应特性；小 波分解的时间尺度和范围是预先选取的，不具有自适应特性。因此，Ｈｉｌｂｅｒｔ时频谱的多 分辨分析特性优于小波谱。
３．Ｈ．Ｉ ｂｅｒｔ时频分析对采样频率要求 采样频率对基于信号本身性质的ＥＭＤ分解有一定的影响。将连续信号变成数字信 号，采样频率正必须满足采样定理。ＥＭＤ分解时需要求取信号的局部均值包络，局部极 值的大小和时间位置是局部均值计算的关键，因此，ＥＭＤ分解的离散信号在满足采样定 理要求的前提下，可能还需要满足一定的附加条件【ｌ ３３】。 采用单一的正弦信号为研究对象，分析采样频率对ＥＭＤ分解影响。设信号
ｘ（ｔ）＝ｓｉｎ（２ｎｆｉ）其中，频率ｆ＝３０Ｈｚ，采样时间长度为ｌｓ。在不同的采样频瓤的信号Ｈｉｌｂｅｒｔ
时频谱如图４．３所示，其中，图（ａ）～（ｄ）的采样频率石分别为７０Ｈｚ、１６０Ｈｚ、２４０Ｈｚ、６００ Ｈｚ， 在图（ａ）～（ｂ）中除了信号本身的３０ Ｈｚ成分外，还存在低频虚假成分的能量，且随采样频 率的逐渐降低，信号的低频虚假成分能量增多。而图（ｃ卜（ｄ）中仅在端点处受至ＪＪＥＭＤ分解 的端点效应影响外，其能量集中分布在３０Ｈｚ附近。说明信号采样频率足够高时，信号被 ＥＭＤ正确分解，没有产生虚假低频分量。信号采样频率逐渐降低时，ＥＭＤ分解将产生 虚假低频分量，表现在Ｈｉｌｂｅｒｔ谱中为频率波动和虚假频率。这主要是因为ＥＭＤ分解是依 据离散信号的极值点所确定的特征尺度进行分解，若对信号极值点采样的不准确可能对 分解产生重要影响。因此，对于单一频率的信号采样，其采样频率的应选择为信号频率 的偶数倍，且尽可能采用较高的采样频率，以减ｄｘＥＭＤ分解产生的误差。对于其他情况 时，可以采用过采样方法，以来降低ＥＭＤ方法的分解误差。
采样频率对于瞬时频率的准确计算也有一定的影响。信号的瞬时频率可由中心差分 计算，其精度与步长有关。通过增大采样频率，可以减小步长，从而提高了瞬时频率的 计算精度。
因此，合理选择采样频率既减小了ＥＭＤ分解误差，又可提高瞬时频率的计算精度， 这两个方面对于Ｈｉｌｂｅｒｔ时频谱刻画信号特征非常重要。在工程实际应用中，在采样频 率在满足ｆ，＝４ｎｆｍ前提条件下，可尽量增大采样频率。
４．４心率变异信号的Ｈ ｉＩ ｂｅｒｔ谱分析
４．４．１ Ｈ．Ｉ ｂｅｒｔ时频特征
８ｌ

∞ 巧 町 薹 ∞ １日 ∞
ＨＺ＿，ａｃ∞３９Ｌ
仔 坩 ； ０
劬
∞
柏
∞
Ｈｚ～誊∞｜ｋ
∞
坩
Ｏ
图４．３不同采样频率下的Ｈｉｌｂｅｒｔ时频谱 ａ）ｆｓ＝７０Ｈｚ ｂ）ｆｓ＝１ ６０Ｈｚ ｅ）ｆｓ＝２４０Ｈｚ ｄ）ｆｓ＝６００ Ｈｚ ＨＲＶ信号的频谱提供了其能量随频率变化分布的基本信息，通过研究与特定频率有 关的功率变化，可以揭示隐藏在ＨＲＶ信号内的特殊节律及其生理意义。其短时程频域频 率特征指标包括ＨＦ（Ｏ．１５＂－＇０．４Ｈｚ）；ＬＦ（０．０３＂－＇０．１５Ｈｚ）；ＶＬＦ（＜Ｏ．０３Ｈｚ）；ＴＰ（Ｏ～ ０．４Ｈｚ）及ＬＦ／ＨＦ。这些指标一定程度上反映了自主神经系统的调节功能，但其频谱分析 是基于傅立叶变换理论，在反映具有非平稳特性的ＨＲＶ信号并不完全。 ＨＨＴ具有很好的时频分析性能，在生物医学信号的分析中得到了较多应用【１３４邯６１。 由ＨＨＴ得到的Ｈｉｌｂｅｒｔ时频谱可以准确刻画了非平稳时变信号的瞬态变化的特征，清晰的 表现信号的正常与异常状态的差异。应用于ＨＲＶ信号分析，能清晰的显示不同时刻、不 同频率范围ＨＲＶ信号的能量分布状况。 在ＨＲＶ信号的频谱分析中给出了具有特定生理意义的频带能量划分，按照这一频带
划分，在Ｈｉｌｂｅｒｔ时频谱中计算ＨＲＶ信号的相应频带的谱能量值，并绘制Ｈ１ｗ信号的 Ｈｉｌｂｅｒｔｆｌ皂量棒形图。提取信号频带总能量和各生理频段的能量作为ＨＲＶ信号的时频特 征，并定义和频域指标生理意义类似的其他时频特征指标。
依据（４．８９）式计算对应生理频段的能量值，则可在Ｈｉｌｂｅｒｔ时频谱上定义ＨＲＶ信号 的时频特征，即
高频能量（晶ｐ：

量曼１皇曼曼曼鼍曼曼曼曼曼曼曼曼曼暑曼詈曼曼曼曼曼曼曼！曼！皇兰皇州曼曼理曼Ｔ曼人曼学曼曼博曼ｆ曼：曼学曼曼ｆ一曼！沦曼曼丈曼鼍曼舅曼曼皇曼曼曼曼曼皇曼曼曼曼曼曼曼曼曼曼曼曼曼曼曼曼

低频能量（勖）：
甚低频能量（蹦：
总能量（％）：

ＥｔｆＩ ｅ，（ｔ）ｄｔ
Ｅｖｌｆ＝ｌｅｖ（ｔ）ｄｔ ％＝工ｅｔ（ｔ）ｄｔ

（４．９９） （４．１００） （４．１０１） （４．１０２）

其中，吃（ｆ）＝￡日２ｕ，Ｄ矿，ｑ（ｆ）＝ｆ００Ｊ３５日２（＾力矽，

巳（ｆ）＝ｒｍ３日２（厂，Ｄ咿，ｅａｔ）＝ｒ‘４序扩，ｆ）∥
’
对各频段能量进行归一化处理，可得锄助功率百分比为：

‰％＝Ｅ矿／Ｅｑ，×１００％

（４．１０３）

Ｅ呖％＝Ｅｖ陋Ｉｐ×１００％

（４．１０４）

在传统频谱分析中，ＬＦ／ＨＦ是评价心脏迷走．交感神经均衡性的指标，文献［１３７］研究
表明ＬＦ～ＬＦ能获得ＬＩ＇，ＬＦ／ＨＦ更好的敏感性和准确性，故定义勖慨，和励佤稚为类似的
时频特征指标。 将定义的时频特征用于Ｍｒｒ．ＢＩＨ标准心电数据库中健康年轻人、健康老年人和充血
性心力衰竭（Ｃｏｎｇｅｓｔｉｖｅ Ｈｅａｒｔ Ｆａｉｌｕｒｅ，ＣＨＦ）病人的ＨＲＶ信号的分析，以验证特征的敏感 性和其生理含义。
４．４．２实验数据及预处理
实验对象分为实验对象（１）和实验对象（２）。实验对象（１）的ＨＲＶ信号取自 Ｔｈｅ ＭＩＴ．ＢＩＨ Ｆａｎｔａｓｉａ数据库，包括４０个健康样本，其中２０位年轻人（２１－３４岁，女１０ 人，男１０人）和２０位老年人（６８～８５岁，女１０人，男１０人）。所有样本在进行ＥＣＧ信号 采集时保持仰卧休息状态，并观看Ｆａｎｔａｓｉａ影片帮助保持清醒，ＥＣＧ信号采样频率为 ２５０ Ｈｚ，采集时间为１２０ ｍｉｎ。实验对象（２）包括两个样本组，两样本组健康人的ＨＲＶ 信号取自Ｔｈｅ ＭＩＴ－ＢＩＨ Ｎｏｒｍａｌ Ｓｉｎｕｓ Ｒｈｙｔｈｍ ＲＲ Ｉｎｔｅｒｖａｌ Ｄａｔａｂａｓｅ，样本组Ｉ在数据库中 任意选取２９人，其中男１４人，５９—７５岁，女１５人，６２～７３岁，样本组ＩＩ在数据库中任

心ＩＵ波形伶测ｏｊ心半娈坤‘ｎ分村Ｔ方法硼ｌ彳Ｅ
意选取１５人，其中男６人，６４，－７４岁，女９人，６２～６７岁，ＥＣＧ信号采样频率为１２８Ｈｚ， 采集时间为２４ｈ；患有严重的慢性充血性心力衰竭疾病的ＣＨＦ病人分别取自Ｔｈｅ ＭＩＴ－ＢＩＨ Ｃｏｎｇｅｓｔｉｖｅ Ｈｅａｒｔ Ｆａｉｌｕｒｅ Ｄａｔａｂａｓｅ和Ｔｈｅ ＢＩＤＭＣ Ｃｏｎｇｅｓｔｉｖｅ Ｈｅａｒｔ Ｆａｉｌｕｒｅ Ｄａｔａｂａｓｅ数据库，样本组Ｉ选取数据库全部２９个样本数据，其中男７人，女２人，２０ 人性别没有给出，年龄３４￣７９岁，ＮＹＨＡ：Ｉ～ＩＩＩ级。样本组ＩＩ选取数据库全部１５个样 本数据，其中男１１人，２２～７１岁，女４人，５４～６３岁，ＮＹＨＡ：ＩＩ—ＩＩＩ级，ＥＣＧ信号采 样频率为２５０Ｈｚ，采集时间为２０ｈ。样本数据采用文献［１３８］方法进行信号滤波，目的是 去除伪差和异位心搏，由于ＨＲＶ信号在时域中是不等间隔的，采用三次样条插值后， 以２Ｈｚ对序列重采样。考虑ＨＲＶ信号作短时程分析，截取实验对象（１）连续三段长度 为５ｍｉｎ的等间隔时间序列数据，实验对象（２）一段长度为５ｍｉｎ的等间隔时间序列数 据绘制Ｈｉｌｂｅｒｔ棒形图，并计算相应的时频特征。 ４．４．３实验分析结果 ４．４．３．１年轻人、老年人的ＨＲＶ信号分析
在样本数据中，某健康男性年轻人（年龄３１岁）和老年人（ｉｆ－龄８ｌ岁）的ＨＲＶ 信号如图４．４所示（３段×５ｍｉｎ／段＝１５ｍｉｍ）。
各生理频段的Ｈｉｌｂｅｒｔ能量棒形图如图４．５所示。图４．５（ｂ）中狄色表示老年人，白色 表示年轻人，柱状图表示连续３段能量均值，误差棒表示能量标准差，两个局部放大图
分别表示低频能量研口高频能量历，ｏ
图４．４年轻人和老年人ＨＲＶ信号 ａ）老年人 ｂ）年轻人

兰州理Ｔ人学博Ｉ：学位论义

心ｌＵ波形伶测’ｊ心ｊ簪变异‘陀分析方法研究

－＇矿 ３５｛

ｏ
＝暑
１一
２
＞一＜
侣

３｝
Ｔ

， 【．．．．．．．．．．．．．一——～——一一

ａ）

糊 伽

姗

蛳

绷 撕 ■；｝ｉｑ

善

硼

伽

啪

ｏ

ｈ）
图４．５样本数据的总能量、各生理频段能量及时频特征的分布
ａ）老年人和年轻人的总能量％ｂ）老年人和年轻人的甚低频能量点谚ｃ）老年人和年轻人的低频能量勖 ｄ）老年人和年轻人的高频能量点谚ｅ）时频特征点：旷偈矿ｆ）时频特征岛经谚ｇ）时频特征‰％１１）时频特
征‰％

ａ．ｚ．州艘Ｔ人学博Ｉｊ学ｆｔ论爻
号分析不但可行，而且清楚的表明了随着年龄增大自主神经功能及其对心血管系统活动 的调节作用逐渐减弱的这一规律。
表４．１实验对象（１）的样本数据统计分析结果
注：Ｆ、Ｐ’，方差分析的差异性检验参数，双边ｔ检验的显著性概率，
４．４．３．２ ＣＨＦ病人、健康人的ＨＲＶ信号分析 两样本组的ＣＨＦ病人、健康人的ＨＲＶ序列的总能量及各生理频带的Ｈｉｌｂｅｒｔｆｌ邑量棒形
图如图４．７所示，图４．７ａ）为实验对象（２）的样本组Ｉ，图４．７ ｂ）为样本组ＩＩ，局部放大 图分别为低频能量励和高频能量历厂。其中，白色为健康人，灰色为ＣＨＦ病人，柱状图表 示数据样本的能量均值，误差棒表示标准差。
对比样本组Ｉ和样本组ＩＩ的ＣＨＦ病人和健康人的数据可以发现，ＣＨＦ病人的各能量
值均低于健康人，尤其如、风出面下降明显，ＣＨＦ病人的历，有略微降低的情况，但无 统计差别。各时频特征的统计分析如表４．２所示，其中％、Ｅ出Ｅ肭双边ｔ检验的显著性
概率小于０．００１，提示ＣＨＦ病人、健康人的时频能量特征之间存在显著差别，％可反映 ＨＲＶ信号的总体变异，既减小，表明心力衰竭患者的ＨＲＶ信号的总体心率变异性降低，
自主神经对心脏的调节能力减弱，局，是交感神经和迷走神经双重活性的反映，也与压力 感受器有关，对于心衰病人其值显著降低，其可能的生理机制原因在于：１）心衰时交 感神经张力持续过度增高使窦房结功能达到饱和，导致其对神经输入的反应降低；２） 压力感受器功能受损，正常的迷走神经优势降低，而使交感神经兴奋性过度增强，导致 ＨＲＶ降低；３）心动过速和室壁张力过高引起的心内膜缺血导致ｐ．受体密度下调，使心 肌细胞对儿茶酚胺不敏感。交感神经的失活可使室性心律失常（尤其是室颤）的发生率明 显增加，因此，局，值降低意义重大，Ｍ．Ｇａｌｉｎｉｅｒ等人的研究指出慢性心力衰竭病人的ＨＲＶ 信号低频功率的降低增加了的猝死危险性，低频功率的降低对于ＣＨＦ病人有独立的预测
价值【２３】。注意到样本组ＩＩ的ＣＨＦ病人的ＮＹＨＡ大多为Ⅲ级，实验结果表明其局脾低的尤
其显著，说明随心功能降低，低频功率降低的就更显著，自主神经调节功能受损越严重。
岛代表了迷走神经活性，其值变化不明显，这与一些研究报道不尽一致【２¨，这可能与所

心ｌ乜波形榆测１ｊ心率变异性分析方法研究
观察患者的病情分布存在差异有关。文献［２２］研究表明ＣＨＦ患者ＨＲＶ的时域指标ＳＤＮＮ、 ＳＤＡＮＮ（与频域的低频能量指标对应，代表交感神经的活性较健康人有明显的降低， 而时域指标ＲＭＳＳＤ、ＰＮＮ５（与频域的高频能量指标对应，反映迷走神经张力的变化不 太明显。文献［１４１］基于ＡＲ模型的ＨＲＶ信号频谱分析表明ＣＨＦ患者交感神经受损超过迷 走神经，其高频能量、高频峰值变化不太明显。对于Ｂ，，的明显降低的生理机理，有待深
入研究。蚴水表了交感神经的调控性能，ＣＨＦ病人的骗止匕健康人的小，表明ＣＨＦ 病人的交感神经活性受损，而驰ｆ，给出最佳区分性能。表４．２给出的归一化时频能量特
征，‰％有好的区分性能，而而疡％无统计差别。

％Ｅ沁
息

４００
３００
”Ｅ２００ ｕＪ
１００
０■—＿
Ｅｇ（０．０３－０ １５Ｈｚ）

ａ）

ｂ）

图４．７总能量及各生理频段的Ｈｉｌｂｃｒｔ能量棒形图

ａ）样本组Ｉ

ｂ）样本组ＩＩ

表４．２实验对象（２）的样本数据统计分析结果

通过对取自不同数据库的ＣＨＦ病人的数据样本的实验统计分析表明ＣＨＦ病人的 ＨＲＶ明显降低，说明其自主神经对心脏的调节能力明显减弱，且随着心功能减退逐渐降

兰州理Ｔ人学博卜学化论文
低。可见，基于Ｈｉｌｂｅｒｔ谱的时频特征能敏感、准确地表征临床病症的变化，对于疾病治 疗和病情评估有重要意义。
４．４．３．３心率对时频特征的影响
心率（ＨＲ）是单位时间内心脏搏动的次数。正常窦性心率范围为６０～１００ｂｐｍ。由于 ＨＲ受体内诸多因素影响，使正常人的心率并非恒定，而是有一定的起伏，这些因素的 影响最终通过交感神经和副交感神经的调制作用表现出来，迷走神经兴奋可使心率减 慢，而交感神经兴奋使之加快。高频段能量是迷走神经活性的标志，而低频段能量与交 感神经活动的关系并不像高频段能量和迷走神经活动那样明确，通常认为低频段能量受 交感神经和迷走神经共同支配【１４２１。
实验数据样本取自１１１ｅ ＭＩＴ－ＢＩＨ Ｎｏｒｍａｌ Ｓｉｎｕｓ Ｒｈｙｔｈｍ ＲＲ Ｉｎｔｅｒｖａｌ Ｄａｔａｂａｓｅ的健康人 数据库，包括男２６人，年龄：２８～７６岁，女２４人，年龄：５８～７３岁，截取５ｍｉｎ分钟ＲＲ间
期数据，计算平均心率，并提取时频特征卧Ｅｈｆ，讨论心率变化对环而，的影响，结果
如图４．８所示。从图中可以看出，健康人的Ｅｈｐ岛髓ＨＲ的增加有明显的减小趋势。将Ｅｈｆ， 励髓心率的变化进行线性回归分析，模型采用Ｅ＝ａｘＨＲ＋ｂ，分析结果分别为：口＾尸．０．１８４４， 巩严２２．０８６８，ａｔ／＝．５．５５７４，ｂ！ｒ＝６４３．６６９４，如图４．８中直线段所示，ＨＲ和西提负相关的， 相关系数为．０．５４，支持了随着心率增加迷走神经兴奋减弱的观点。一般认为交感神经活 动增强，心率表现为增加，￥［ＪＨＲ和励应有正相关性，但回归分析的结果显示ＨＲ和励仍 具有负相关性，只是负相关性有所减弱，相关系数为．０．４６。说明低频段能量并不能完全 反映交感神经活动，其所包含的迷走神经活动成分可能对结果产生了很大影响。文献 【１４３］将１８名健康年轻人分为安静组和运动组进行短时程（１０ｍｉｎ）ＨＲＶ信号的频域分析， 结果表明低频能量和高频能量和心率变化具有负相关的特性。文献［１４４】对２７２２名健康人 群进行长时程（２ｈ）ＨＲＶ信号的频域分析显示高低频段能量和心率变化也具有负相关的 特性，这些研究结果与本文一致。因此，心率变化是ＨＲＶ分析应考虑的重要因素。

心牢（ｂｐｍ）
ａ）

心率（ｂｐｍ）
Ｄ

图４．８健康人的时频特征Ｅｈｆ，点谚随心率变化的线性拟合结果

ａ）时频特征％，的线性拟合 ｂ）时频特征Ｅ棚线性拟合

心ｌ【！波形伶测’ｊ心串变畀忤分卞Ｊｒ方法１ｉＪ『究

４．４．４分析结论

由ＨＨＴ获得ＨＲＶ信号的Ｈｉｌｂｅｒｔ时频谱，提取ＨＲＶ信号的各生理频段能量和总能量为

时频特征。以健康年轻人、老年人和ＣＨＦ病人为研究对象，统计分析表明健康老年人和

年轻人的ＨＲＶ的总体变异性没有明显差异，但老年人在高频和低频段上的能量明显小于

年轻人，提示老年人心脏的交感神经和迷走神经调节存在一定失衡现象，其他时频特征
也表现了良好的区分性能，尤其厮偈，艏标更为敏感。研究结果说明随年龄的增大心脏

自主神经的调节功能逐渐减弱，说明年龄是ＨＲＶ分析应考虑的重要因素。ＣＨＦ病人的时

频特征明显低于健康人，说明ＣＨＦ病人的心脏自主神经系统受到了损伤，对心脏的调节

能力明显减弱，统计分析也显示了随心衰程度加重，自主神经系统的损伤明显增大。由

于低频能量降低更明显，提示ＣＨＦ病人交感神经的损伤较大。通过讨论心率的变化和高

频和低频能量特征的相关性，表明了低频能量是受交感神经和迷走神经共同支配，也说

明在ＨＲＶ分析时应同时考虑心率变化的因素。

’·

总之，基于Ｈｉｌｂｅｒｔ谱的ＨＲＶ信号时频分析方法获得了很好的分析效果，提取时频特

征特异性好、生理病理意义明显，为临床ＨＲＶ分析提供了一种有效的新方法。

４．５短时心率信号的Ｈ ｉ Ｉｂｅｒｔ边际谱分析

４．５．１过速性室性心律失常的预测问题
心脏猝死（Ｓｕｄｄｅｎ Ｃａｒｄｉａｃ Ｄｅａｔｈ，ＳＣＤ）是心律失常最严重的症状和表现，也是导致 死亡最常见的心脏疾病。研究表明恶性室性心律失常，包括心室纤颤（Ｖｅｎｔｒｉｃｕｌａｒ Ｆｉｂｒｉｌｌａｔｉｏｎ，ＶＦ）或是持续性室性心动过速（Ｖｅｎｔｒｉｃｕｌａｒ Ｔａｃｈｙｃａｒｄｉａ，ＶＴ）是导致ＳＣＤ的主 要原因。在患者体内置入埋藏式心脏复律除颤器（Ｉｍｐｌａｎｔａｂｌｅ Ｃａｒｄｉｏｖｅｒｔｅｒ Ｄｅｆｉｂｒｉｌｌａｔｏｒｓ， ＩＣＤ）是目前治疗恶性室性心律失常，预防ＳＣＤ发生较有效的方法【１４５１。由于ＳＣＤ的发生 时间不确定，症状持续时间短暂，使得对其进行风险预测显得尤为重要。目前，ＳＣＤ的 风险评估指标主要有左室射血分数（ＬＶＥＦ）、ＱＲＳ间期、ＱＴ间期、Ｔ波改变、心室晚电 位、心率变异性等【ｍ】，其中，ＬＶＥＦ能较好反映心脏功能的情况而成为预测ＳＣＤ的敏感 指标，在室性心律失常治疗和心脏性猝死预防中通常认可将ＬＶＥＦ＜４０％作为ＳＣＤ一级预 防中ＩＣＤ植入的标准，但是，这些风险预测方法目前在临床上尚未得到完全证实【１４７１。因
此，对于心血管疾病患者，特别是对于普通人群的恶性室性心律失常（Ｖｒ胛）发生预
测及ＳＣＤ的风险评估仍面临挑战。 ＨＲＶ信号分析用于过速性室性心律失常的预测分析却有不一致的结果。有研究文献
表明在ＶＴＭ发生之前ＨＲＶ频域指标有重要的改变，心率（ＨＲ）有增加【１４ｓ，１４９］。Ｖｙｂｆｉａｌ
等人研究了２４例发生ＶＦ事件的Ｈｏｌｔｅｒ记录发现在ＶＦ发作之前（５ｍｉｎ）ＨＲＶ指标及ＨＲ没 有重要改变【”ｏ】；Ｂｕｒｒｉ利用传统短时傅里叶变换和小波变换的时频分析方法分析了４１例 植入ＩＣＤ的有心肌梗塞病史患者在恶性室性心律失常发生之前（５１ｍｉｎ）ＨＲＶ信号，结

