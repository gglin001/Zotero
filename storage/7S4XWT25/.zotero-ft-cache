电子技术研发 Electronics R & D
10.3969/j.issn.1000-0755.2017.03.002
基于深度学习的脉搏波连续血压测量
李万万 周子力 李明晨 （曲阜师范大学物理工程学院，山东省曲阜市，273165） 摘 要：传统脉搏波特征参数测量通常采用回归分析，建立血压模型，其特征参数不固定，影响了某些 因子的不可测性，因此该方法在某些情况下受到限制，影响了测量血压值的准确性。而本研究所采用的基 于深度学习的血压测量方法是通过构建多隐层的模型和大量训练数据，来学习更有用的特征，从而提升预 测血压值的准确性。 关键字：脉搏波；连续血压；回归分析；深度学习
Pulse-wave Continuous Blood Pressure Measurement Based on Deep Learning
Li wanwan Zhou zili Li mingchen （Qufu Normal University, Qufu, Shandong Province 273165） Abstract: Traditional blood pressure measurement methods usually used regression analysis to establish the model of blood pressure. Because of the characteristic parameters are not fixed, which affects the undetectability of some factors, and also affects the accuracy of measuring blood pressure values. The deep learning adopted in this study is to build a multi-hidden layer model and massive training data, to learn more useful features, so as to ultimately improve the accuracy of blood pressure prediction. Key words：pulse wave; continuous blood pressure; regression analysis; deep learning

0 引言 脉搏是心脏和血管状态等的重要信息的外在反 映，人体任何一个系统的状态变化都会影响到脉搏 系统。心血管疾病初期，患者并无任何症状，但心 血管血流参数已经发生变化，并首先反映在脉搏曲 线的波形变化上[1]。实验发现能够表征心血管系统 机能的血流参数与脉搏曲线中提取的特征血压测量 方法分为直接测量法和间接测量法两种。直接测量 法测量的血压是最准确的，但其技术要求较高，且 是有创的，所以仅适用于临床上危重患者及大手术 的血压测量。间接测量法又称无创测量，在临床上 得到了广泛应用，参数具有极大的相关性，人体脉 搏曲线中蕴含着各种与心血管系统密切相关的生理 信息[2]。 无创测量法又可细分为间歇式测量法和连续式 测量法[3]。间歇式测量法测得的是某一特定时刻的 血压值，不能满足临床的需要。连续式测量法能够 检测每搏血压值，为临床诊断与治疗提供了更加充 分的依据，特别是在临床监护以及特殊情况下需要 观察血压连续变化时具有传统方法无法比拟的优势。 因此，本文针对脉搏波特征参数和血压之间的关 系，首先用一种混合的算法识别特征点，进而提取特征 参数，并在传统的血压测量理论基础之上提出一套基于 深度学习框架的血压连续测量方法，构建血压模型。

1 脉搏波简介 脉搏波中包含着非常丰富的与心血管系统相关 的生理信息[4]。因此，脉搏波的波形特征及其变化 规律可以作为评价人体的动脉血压等心血管系统的 重要依据。一般情况下，脉搏波主要包括6个特征点 [5]（如图1所示），分别为 A、B、C、D、E和F，它们 都反映着血管的不同状态。其中，A点指的是主动 脉瓣打开时的点，B点指的是幅值取最大值的点，C 点指的是主动脉扩张时压力开始下降的点，D 点指 的是左心室开始舒张的点，E 点指的是重搏波的起 始点，F点是重搏波达到最大压力时的点。 基于脉搏波的6个特征点，通过进一步的计算可 以得到一系列的时域特征参数。然后提取时域和频域 特征参数，并以此为自变量，以测得的收缩压和舒张 压为因变量，进行回归分析，即可得到血压模型。
图1 脉搏波特征点

6

万方数据

电子技术研发 Electronics R & D

2 脉搏波特征点和特征参数提取

脉搏波特征主要包括特征点和特征参数。特征

点是在波形上可以直接观察到的有重要意义的点，

而特征参数是在检测出波形特征点的基础上提取出

来的有实际意义的参数。因此要提取特征参数，就要

先对脉搏波进行分析，准确地检测出脉搏波的特征点。

脉搏波在一个完整的周期内有6个特征点，由

于ABE三个点比较明显，我们先利用阈值差分法成

功的提取初始点A，波峰点B和重搏波波峰点E，差

分法是一种快速算法，满足远程心电监护系统终端

对实时性的要求。其基本原理是：由于波峰、波谷

是心电信号波形变化最剧烈的地方，含有较高的能

量，其对应波形的斜率其他波形相比显著不同，通

过对滤波后的信号应用差分法并与由经验获得的阈

值相结合，确定出脉搏波大致起始点，再利用窗口

和幅度阈值来确定脉搏波的特征点。差分公式为：

（1）

然后对其进行小波变换，波变换检测脉搏波特

征点的主要思路是：对脉搏波进行小波分解，然后

在分解后的不同细节层上寻找该层系数的模极大极小

值点或者是极值对之间的过零点。再把这些点对应回

原始信号波形，就能找出所需的特征点。此处选择

的小波为墨西哥草帽小波Mexh，因为墨西哥(Mexh)

小波函数为高斯函数的二阶导数，

，

波峰点B后第一个过零点就是重搏前波波谷C点。第二

个过零点就是重搏前波波峰D点，最后利用微分法，

波谷点D之后的第一个过零点就是重搏波波峰E点，

这样，就成功的检测到了脉搏波的6个特征点,如图2

所示。可以看到，运用此方法提取特征点很准确。

图 2 检测出的各特征点
我们将选取14个时域特征参数，特征量K值、 主波上升斜率v、主波高度H、降中峡高度f、重搏 波高度g、降中峡相对高度f/H、重搏波相对高度分 g/H、收缩期相对时间t12、舒张期相对时间t1s、收

缩期和舒张期时间比t2s、收缩期相对面积s1s、舒张 期相对面积s2s、收缩期和舒张期面积比s12、每搏 心输出量z。
对于高度类的参数，可以通过求波形上两点之 间纵坐标的差值来计算。如求主波高度H时，可以 用波谷点A和波峰点B的纵坐标差值得到。对于时间 类参数则可以通过波形上两点之间横坐标的差值来 计算。而面积类参数相当于波形上一段曲线对时间 积分，对于离散的数据即为两点之间求和。特征量 K相当于脉搏波压力脉动分量的平均值在最大值中 所占的百分比，而脉搏波的纵坐标是由脉搏波传感 器测到的指端的幅度值，所以可以用波形上纵坐标 的值计算出K值。

3 血压测量深度学习模型

3.1 深度学习简介

深度学习作为时下热门的机器学习算法，能够

在全局环境下得到较优的解，已经在各领域中获得

了大量的应用。手工设计出有效的特征是一个相当

漫长的过程，而深度学习可以针对新的应用从训练

数据中很快学习到新的有效的特征表示，于是，本文

采用深度学习中多元线性回归方法训练特征参数，

构建血压模型。

3.2 深度学习构建血压模型建立

模型建立步骤为：

（1）输入数据，提取出的特征参数和用电子血

压计测量出的收缩压y1、舒张压y2；

（2）选择机器学习算法，选择深度学习中的线

性回归算法来构建血压模型；

（3）得到估计函数h（x），即为函数血压与脉搏

波特征参数之间的关系方程；

（4）估计血压，测量新的一组特征参数，带入

估计函数h（x），与电子血压计测出来的真实血压对比；

本文中的估计函数为：
h（x）= h（θ x）= θ1x1 + θ2x2 + K + θmxm（2）
其中，x表示提取出的特征参数，θ为系数也就

是权限，就是这个特征的份量。

令θ0=0，则上述公式可写成 n

∑ （ h x）= θixi=θ TX

（3）

i=0

目标就是求出这些θ值，但是要考虑给出的θ到

底好不好，于是采用下面的式子：

∑ J（θ）=

1 2

m
（h（θ x（i））- y（i））2
i=1

（4）

7

万方数据

电子技术研发 Electronics R & D

这个函数一般称为损失函数或者错误函数，主

要描述估计函数h（x）到底好不好。x为训练数据的个

数，即上面提取出的特征参数，m为特征参数个数

14，y为用电子血压计测出的真实血压值，

Jθ 越小，h（x）越准确，最好的情况就是　Jθ　 =0， 如何解，下面给出梯度下降法，先给出θ的一个初始

值，然后改变θ的值，使J(θ)沿梯度下降方向进行减

小，这一部分跟单变量线性回归类似，不同的是这

边变成了两个变量。

批量梯度下降算法迭代规则是：

∑ 　

θ j=θj-α

1 m

m
（h（θ x（i）- y（i））x（j i）

（5）

i=1

i是训练数据，j是维度，α为学习率，范围为

0.001 ≤ α ≤ 10。每训练一个数据就对θ进行更新。当

（J θ j+1　）　-　J（　　θ　j）　　≤　0　时，结束。

经过多次实验分析，当学习率为1的时候，预测

结果最佳，于是设定α=1，变量是提取出的特征参数，

预测结果为收缩压和舒张压，迭代次数设置为100，

在python中运行结果为：

图3 在python中运行结果

4 血压估算

为了清楚表明本文提出算法模型的优点，本文

采用两种方法对数据处理再加以比较，第一种就是

用深度学习的算法构建血压模型，第二种是传统的

算法线性回归构建血压模型。

第一种算法上一章节已经介绍，第二种算法为：

在测出一个人不同时刻的血压和脉搏波后，以提取

出的脉搏波的特征参数作为自变量，以收缩压和舒

张压作为因变量，利用PASW Statistics软件对其进

行相关性分析和逐步回归分析。找到与血压显著相

关的特征参数，建立血压模型如下：

SBP=135.206s1s+17.554k+27.044 （2）

DBP=76.233s1s+27.623

（3）

得到血压的回归方程后，就可以通过这两个方

程计算血压值。首先要采集当前时刻的一组脉搏波

，提取出每个脉搏波的特征点和血压方程中的特征

参数，再将这些特征参数代入到血压模型中。为了 比较通过回归方程计算的血压和深度学习计算的血 压同电子血压计测量的血压值之间的误差，我们釆 集五组脉搏波信号，同时记录下每组脉搏波对应的 实际测得的血压值。如表1，表2所示：
表1 逐步回归分析估算血压和真实血压对比

表2 深度学习估算血压和真实血压对比

5 结论
本文在传统理论的基础上，提出运用深度学习 的方法构建血压模型，最终成功的测量出血压值。 通过误差分析，两种方法得到的血压值的误差保持 在3mmhg以内[6]，说明这两种血压测量方法具有较 好的准确性，也说明了通过脉搏波特征参数测量血 压这种方法是可行的。进一步可以看到，通过深度 学习估算的血压误差都在2mmhg以内，且精确度显 然更高。本文也存在一些不足，不同数据规模下识 别率是否高效这个问题没有解决，因此设定参数范 围是进一步需要解决的问题。

参考文献

[1] 颜国栋,基于脉搏波的无创方法研究，2013，

　　　　天津理工大学.

[2] 张宇博,舒红平,岳希,指端脉搏曲线特征参数提取

　　　　方法研究,软件导刊,1672-7800（2015）004-0032-03.

[3] 刘沛,庞宇,吴宝明,王普领,马勋，脉搏波形态特征

　　　　与血压相关性的研究,生命科学仪器,2015第13卷

/2月刊.

[4] 陆小左,浅谈中医脉诊认识方式的历史沿革,河南

　　　　中医，1003-5028（2015﹚.

[5] Grdes,L.A.Voelz,M.H.,BABBS.C.F,and TACKER.

W.A. Pulse transit time as an Indicator of arerial

Indicator of arerial pressure[J]. Psychophysiology:

18:21-24

(下接5页)

8

万方数据

电子技术研发 Electronics R & D

根据实际测试体验，影响效率的主要因素有3个：
开关管的开关损耗、电感 L1和续流二极管VD1。开关 管的开关损耗与开关频率有关，电感　L　1 的损耗与磁
芯的磁通密度及线径有关，续流二极管VD1的损耗
与导通降压关。增大 L1 的电感量，可以减小输出电
压的纹波，在一定限度内提高变换器的效率，但电
感量太大，直流电阻及损耗也变大，效率反而降低
（笔者手摸电感有明显热感）。
安森美公司推荐电路（见图8），在输出5V&1A 时效率为82%。由图8可见，开关管为TIP115，脉宽 调制管为MPSA20，续流二极管为1N5823，电感为 150μH@2.0A，额定输出为5V@1.0A。

（上接8页）
[6] 杨建,脉搏波信号采集与分析方法的研究,电脑与 信息技术,电脑与信息技术，1005-1228（2014） 03-0053-03.
作者简介 作者：李万万(1990-) 院校：曲阜师范大学物理工程学院 手机：15965105933 E-mail：739864449@qq.com 通信地址：山东省曲阜市静轩西路57号曲阜师 范大学物理工程学院116 邮编：273165

(上接22页)

图8 安森美公司推荐电路
采用图4所示电路是基于能输出大功率的Buck 变换器效率很难做得很高，比如L4960的效率只有 73%；效率高比较高的JRC2360输出功率做不大。 输出功率大、效率又高的价格就昂贵。本文用分立 元件构成的Buck变换器具有输出功率大效率高的特 点，元器件易于购买，价格便宜，非常经济实惠。
参考文献： [1] Switching Power Supply Design（Second Edition） 　　　　（美）普莱斯曼Abraham I.Pressman（著）何志强(译） [2]　　　安森美公司TL431技术资料

[10] 李江全，刘恩博，胡蓉等. LabVIEW虚拟仪器 　　　　　数据采集与串口通信测控应用实战[M]. 　　　　　北京：人民邮电出版社，2010. [11] 深圳市宇泰科技有限公司[EB/OL]. [2016-3-26].
http://www.szutek.com/syjjkzhy/show/36.html
作者简介 姓名： 朱子鹏 单位/院校：太原理工大学 物理与光电工程学院 职位/学位： 副教授 博士 电子信箱： zhuzipeng@tyut.edu.cn

作者简介 雷三元（1965.），男，硕士研究生，高级讲师， 主要研究方向：家用电子技术。

5 万方数据

