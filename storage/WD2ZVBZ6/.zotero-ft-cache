电子科技大学
UNIVERSITY OF ELECTRONIC SCIENCE AND TECHNOLOGY OF CHINA
专业学位硕士学位论文
MASTER THESIS FOR PROFESSIONAL DEGREE

论文题目 心电波形多参数特征提取方法及其应用系统开发

专业学位类别

学

号

作者 姓 名

指导 教 师

工程硕士 201422040512
谢春柳 赖大坤 副教授

万方数据

分类号 UDC 注 1

密级

学位论文
心电波形多参数特征提取方法及其应用系统开发
（题名和副题名）

谢春柳
（作者姓名）

指导教师

赖大坤 电子科技大学

副教授 成都

申请学位级别 硕士
工程领域名称

（姓名、职称、单位名称）
专业学位类别 工 程 硕 士 电子与通信工程

提交论文日期 2017.4 论文答辩日期 2017.5

学位授予单位和日期

电子科技大学

2017 年 6 月

答辩委员会主席

评阅人

注 1：注明《国际十进分类法 UDC》的类号。

万方数据

MULTI - PARAMETER FEATURES EXTRACTION OF ECG WAVEFORM AND ITS
APPLICATION SYSTEM DEVELOPMENT

A Master Thesis Submitted to University of Electronic Science and Technology of China

Discipline: Author:
Supervisor: School:

Master of Engineering Chunliu Xie
Associate Professor Dakun Lai School of Physical Electronics

万方数据

独创性声明

本人声明所呈交的学位论文是本人在导师指导下进行的研究工作 及取得的研究成果。据我所知，除了文中特别加以标注和致谢的地方 外，论文中不包含其他人已经发表或撰写过的研究成果，也不包含为 获得电子科技大学或其它教育机构的学位或证书而使用过的材料。与 我一同工作的同志对本研究所做的任何贡献均已在论文中作了明确的 说明并表示谢意。

作者签名：

日期： 年 月 日

论文使用授权

本学位论文作者完全了解电子科技大学有关保留、使用学位论文 的规定，有权保留并向国家有关部门或机构送交论文的复印件和磁盘， 允许论文被查阅和借阅。本人授权电子科技大学可以将学位论文的全 部或部分内容编入有关数据库进行检索，可以采用影印、缩印或扫描 等复制手段保存、汇编学位论文。
（保密的学位论文在解密后应遵守此规定）

作者签名：

导师签名： 日期：

年月日

万方数据

摘要
摘要
调查显示，全球每年因心血管疾病死亡人数占死亡总人数的三分之一，居各 种疾病之首。研究表明，心电图（Electrocardiogram, ECG）某些波形特征参数变 化（如 24 小时心电图分析的心率变异性、T 波电交替等）与心脏猝死的发生具有 较高的相关性，对心脏病人实施长时间、连续实时的心电监护，及早捕捉心律失 常的先兆，提醒医护人员或者病人家属给与及时的救助，可避免其中 70%~80%患 者的死亡。
针对目前医用心电监护系统的不足，本论文的目标是提出并研制一套功能全 面、低功耗、智能移动式多参数遥测监护系统，以实现对患者的心电、呼吸、血 氧饱和度、姿态和位置信息进行实时采集并通过 WiFi 网络发送到医院监护中心。 当患者出现异常情况时及时发出报警，通过患者的位置信息提醒医护人员进行救 治，最大程度上防止患者发生猝死。本研究主要开展以下三个方面的工作：
首先，从生理学角度阐述了心电信号的产生机理，给出了典型心电信号各个 特征波形、特征间期的生理意义及正常值范围，并介绍了心电信号采集的导联类 型。针对心电采集过程中遇到的干扰因素，提出了中值滤波和带通滤波消除运动 伪迹噪声的方法。
其次，在国内外已有心电自动分析算法的研究成果的基础上，对其核心的 QRS 波特征提取，提出了一种基于差分阈值理论动态自适应阈值 QRS 波检测方法，该 算法复杂度低，适合在穿戴式设备上实时处理心电信号。同时，通过国际通用的 MIT-BIH 心律失常数据库测试和评估，结果显示该算法对 QRS 波检测的灵敏度和 准确率相应达到 99.57%及 99.80%。
最后，本文设计和研制了一套移动式生理多参数遥测监护系统原型，包括移 动监护终端和中央监护系统。其中，所研制移动监护终端的硬件模块包括：生理 参数采集模块、通讯及定位模块、跌倒检测模块、电源管理模块、嵌入式主控模 块以及人际交互模块。在完成终端硬件设计的基础上，本文给出了移动监护终端 软件设计以及与医院监护中心的通讯协议。
通过对系统组网测试，结果表明本论文研制的多参数遥测监护系统可以在不 限制患者正常生活情况下，能够对其多生理参数进行长时间监测、实时诊断和异 常报警，达到了预期设计要求，在临床上具有广泛的应用前景。
关键词：信号预处理，QRS 检测，跌倒检测，WiFi 定位，多参数监护
I
万方数据

ABSTRACT
ABSTRACT
According to the survey, the number of deaths due to cardiovascular diseases accounts for 1/3 of the total number of deaths every year in the world, ranking the first of various diseases. The results show that some changes in the waveform parameters of Electrocardiogram (such as Heart Rate Variability, T-Wave Alternans, etc.) have a high correlation with the occurrence of sudden cardiac death, and the long-term, continuous real-time ECG monitoring of cardiac patients is a harbinger of arrhythmia or the patient's family to give timely relief, which can avoid the death of patients with 70%~80%.
Aiming at the deficiency of current medical ECG monitoring system, the goal of this thesis is to develop a multi-parameter telemetry monitoring system which is functional, low-power, portable and intelligent. The system proposed in the thesis realizes the real-time collection, processing of ECG, respiration, blood oxygen saturation, attitude and position information. Particularly, the monitor designed is able to exchange data with the hospital monitoring center through the WiFi network. When the patient physiological parameters abnormal or fall when the alarm issued by the patient's location information to remind the medical staff for timely treatment, to prevent the occurrence of sudden death in patients. The research are carried out mainly on the following three aspects:
Firstly, it describes the basic principle in generation of ECG wave from the perspective of physiology, normal and abnormal parameters of ECG components and the ECG lead systems. Aiming at the interference factors encountered in the process of ECG acquisition, a method of median filtering and bandpass filtering to eliminate motion artifacts.
Secondly, based on the existing research results of ECG automatic analysis algorithm at domestic and foreign, In this thesis, a novel algorithm of QRS complex detection based on adaptive threshold is proposed, which is based on the theory of differential threshold algorithm. The algorithm has low complexity and is suitable for real-time processing on microprocessor. With the evaluation test MIT-BIH Arrhythmia Database proved, its sensitivity and accuracy for QRS detection reach 99.57% and 99.80%.
II
万方数据

ABSTRACT
Thirdly, the mobile physiological multi-parameter telemetry monitoring system is built successfully, and the design of the hardware circuit of the mobile monitoring terminal is completed by sub-modularization. The monitoring terminal comprises a physiological parameter acquisition module including ECG, respiration, blood oxygen saturation, communication and positioning module, fall detection module, power management module, embedded master module and interpersonal interaction module. Based on the hardware design platform, the software design flow of mobile monitoring terminal and the communication protocol with the hospital monitoring center are given.
According to the testing results, the multi-parameter telemetry monitoring system developed in this paper can monitor the multi-physiological parameters, real-time diagnosis and abnormal alarm without limiting the normal life of the patients and achieve the expected design requirements, Which will have wide application in clinical. Keywords: signal preprocessing, QRS detection, fall detection, WiFi positioning,
multi-parameter monitor
III 万方数据

目录
目录
第一章 绪 论 ..................................................................................................................1 1.1 课题研究背景与意义 .........................................................................................1 1.2 国内外研究现状及趋势 .....................................................................................2 1.2.1 心电监护技术的发展 .................................................................................2 1.2.2 心电自动分析技术的发展 .........................................................................3 1.3 本文主要研究内容及创新点 .............................................................................6 1.4 全文章节安排 .....................................................................................................6
第二章 心电信号分析基础及心电标准数据库 ............................................................8 2.1 引言 .....................................................................................................................8 2.2 心电信号的概述 .................................................................................................8 2.2.1 心电信号产生机理 .....................................................................................8 2.2.2 正常心电信号各波形、间期及其生理意义 ...........................................10 2.3 心电信号的采集方法 .......................................................................................12 2.3.1 心电导联的分类 .......................................................................................12 2.3.2 心电监护导联 ...........................................................................................14 2.4 心电标准数据库 ...............................................................................................14 2.4.1 MIT-BIH 心律失常数据库........................................................................14 2.4.2 MIT-BIH 噪声测试数据库........................................................................15 2.5 本章小结 ...........................................................................................................16
第三章 心电信号预处理与特征提取算法的研究 ......................................................17 3.1 引言 ...................................................................................................................17 3.2 心电信号预处理 ...............................................................................................17 3.2.1 心电信号噪声分析 ...................................................................................18 3.2.2 心电信号滤波的实现 ...............................................................................19 3.3 心电信号的特征提取 .......................................................................................21 3.3.1 心电波形差分阈值检测算法原理 ...........................................................21 3.3.2 R 波峰值检测 ............................................................................................22 3.4 QRS 波检测算法评估与仿真分析 ...................................................................26 3.4.1 算法的检测结果与性能评估 ...................................................................26 3.4.2 实验数据分析 ...........................................................................................28
IV
万方数据

目录
3.5 本章小结 ...........................................................................................................30 第四章 多参数遥测监护系统的设计与实现 ..............................................................31
4.1 系统总体设计 ...................................................................................................31 4.2 移动监护终端硬件设计 ...................................................................................32
4.2.1 心电采集电路设计 ...................................................................................33 4.2.2 呼吸信号检测电路设计 ...........................................................................34 4.2.3 血氧饱和度检测电路设计 .......................................................................35 4.2.4 无线通讯/定位模块及人机交互模块......................................................36 4.2.5 跌倒检测模块 ...........................................................................................36 4.2.6 电源管理模块 ...........................................................................................37 4.2.7 嵌入式主控模块 .......................................................................................38 4.3 移动监护终端软件设计 ...................................................................................39 4.3.1 系统流程设计 ...........................................................................................39 4.3.2 通讯协议 ...................................................................................................39 4.4 医院监护中心软件设计 ...................................................................................42 4.5 本章小节 ...........................................................................................................42 第五章 多参数遥测监护系统的测试与分析 ..............................................................43 5.1 移动监护终端实物 ...........................................................................................43 5.2 功耗测试 ...........................................................................................................43 5.3 系统功能测试 ...................................................................................................46 5.3.1 WiFi 通讯模块测试 ...................................................................................46 5.3.2 生理参数模块测试 ...................................................................................48 5.3.3 定位功能测试 ...........................................................................................48 5.3.4 告警功能测试 ...........................................................................................49 5.4 本章小结 ...........................................................................................................50 第六章 总结与展望 ......................................................................................................51 6.1 全文总结 ...........................................................................................................51 6.2 后续工作展望 ...................................................................................................51 致 谢 ............................................................................................................................53 参考文献 ........................................................................................................................54 攻读硕士学位期间取得的成果 ....................................................................................59
V
万方数据

第一章 绪论
第一章 绪 论
1.1 课题研究背景与意义
近年来，心血管疾病已成为一类严重危害人类健康的重大疾病，根据世界卫 生组织 2015 公布的数字显示，全球每年大约有 5700 万人死亡，心血管疾病以超 过 30%的比例排在各种死因的第一位每年死亡人数大概 1770 万，其中 670 万死于 脑卒中，740 万死于心脏病，且发病死亡者大约四分之三发生在收入水平相对较低 的国家[1]。根据我国卫生部门《中国心血管病报告 2015 年》的最新权威显示，我 国目前约有 2.9 亿心脑血管疾病患者，每年因心血管疾病死亡的人数大约为 370 万 （相当于每 10 秒钟就有 1 人因心血管疾病而死亡），心血管疾病占居民疾病死亡 构成：在城市为 42.51%，在农村为 44.60%，全国每 5 个死亡人数中，就有 2 个死 于心脑血管疾病，居各种疾病之首[3]。由此可以看出，针对心血管疾病开展相对应 的防治工作是当前阶段需要解决的重要问题之一。
心脏猝死（sudden cardiac death，SCD）系指由于各种心脏原因所致的，出现 急性症状后 1 小时内发生的突然死亡[4]。根据美国健康中心的流行病学研究结果所 示，美国每年因心脏猝死的患者总数大约 46 万，心脏疾病死亡超过 50%者为心脏 猝死[5]。随着我国经济的发展和人民生活水平的快速提高，我国每年因 SCD 死亡 的病人更是高达 54.4 万[6]。88%的 SCD 归因于心律失常，其中室性心动过速 （ventricular tachyarrhythmias-VT，简称室速）占 75%，特发性心室颤动（ventricular fibrillation-VF，简称室颤）占 8%，缓慢性心律失常（bradyarrhythmias）占 17%[7-8]。 研究发现，心电图（Electrocardiogram，ECG）某些波形特征参数的变化（如 24 小时心电图分析的心率变异性、T 波交替、QT 间期离散度等等）与心脏猝死的发 生具有较高的相关性。医学工作者通过对心电信号的特征参数和规律的研究判断， 已经能够较为准确的对部分恶性心律失常做出早期预测和及时诊断[9-11]。因此，对 于具有潜在性心律失常的病人实施长时间、连续的实时心电监护，及早捕捉心律 失常的先兆，并提醒医护人员或者病人家属给与救助，可避免其中 70%~80%患者 的死亡。
近年来，伴随着计算机技术及微电子技术的飞速发展，医用监护设备已广泛 应用于临床，成为现代医疗中不可或缺的一种设备。这类设备以 ECG 作为最主要 的监测参数，因此也常称为心电监护。由于心脏病的突发性和随机性特点，临床 中常规心电图检查历时几十秒到两三分钟，仅能记录有限个心动周期，所获得的 信息有限。而正常人一天二十四小时心动周期数量多达十万次左右，在短暂的时 间内，难以发现心电图的动态变化，记录心律失常的概率非常低。临床研究表明，
1
万方数据

电子科技大学硕士学位论文
短暂数分钟的常规心电检查只能检出十分之一病人的心律失常，而 24 小时则可达 到 85%～90%。因此，通过对患者长时间、连续地心电监护，对心电波形特征参数 进行实时提取分析，及时捕捉心律的各种异常变化，有助于早期发现和及时诊断 这类疾病，从而有效地降低死亡率。
而传统的长时间床边监护极大地限制了病人的活动范围，降低了病人的生活 质量，对于非重症患者或处于恢复期的患者，由于活动范围的限制，给患者带来 很多不便。因此研制出一套移动式多参数遥测监护设备在保证患者一定的生活质 量的同时，做到对其潜在心脏病进行实时的心电特征参数提取、分析对异常心电 及时告警、减轻医护人员的工作量、提高护理工作效率，具有重要的临床和使用 价值。本论文研究就是在这样的思路下开展的。
1.2 国内外研究现状及趋势 1.2.1 心电监护技术的发展
1903 年、荷兰医生、生理学家 W.Einthoven 基于光学放大原理发明了第一台 石英丝弦线型心电图仪，并以此首次描记了人体的心电活动，从而开创了现代心 电图学[12]，并与 1908 年确立了心电图的应用标准[13]。心电图的记录方式经历了弦 线电流式、电子管放大式、热笔描绘式、墨水喷射式以及数字化等几个发展阶段。 遥测心电监护仪是指利用远距离通信技术、计算机及遥感技术，对病人实施远距 离的心电监护，可以在较大范围内同时对多个监测者进行连续监测的装置，通过 监测患者的心电等生理参数，以了解检测心脏异常活动，帮助医生及时了解病情 并提供救助。远程心电监护主要经历了 Holter 系统、心电 BP 机系统、心电实时监 护系统等发展阶段：
（1）Holter 系统：1957 年，美国物理学家 NormanJ.Holter 发明了可连续长时 间（24～72 小时）记录患者正常生活状态下心脏电活动情况的便携式采集装置， 并于 1961 年应用于临床。这种检测心电图的方法称为动态心电图（Dynamic Electrocardiogram ，DCG）。Holter 系统只能对心电数据进行记录，无法对心电信 号进行实时分析，并且不具备远程传输能力，因此当 ECG 信号记录完成后，需要 病人将采集存储的心电数据带到医院，医生通过专门的设备对数据进行回放、显 示和分析，最终给出诊断结果[14]。
（2）心电 BP 机系统：该系统于 20 世纪 80 年代研制出来。心电 BP 机监护 终端由一个类似 BP 机大小组成，负责对心电信号的采集和传输，由患者随身携带。 当患者感觉不舒服或者心电异常时，按下相应的按键后可采集数秒到几分钟不等 的心电图，监护终端可以将采集到的心电信号通过电话线传输到医院监护中心。
2
万方数据

第一章 绪论
心电 BP 机系统只能对患者感觉到心脏不适时的心脏电活动进行报警，容易造成漏 报，初步实现了远程监测的功能。
（3）心电实时监护系统：心电实时监护系统根据其传输方式可分为有线心电 遥测系统以及无线心电遥测系统。有线心电遥测系统通过电话线等有线网络将实 时采集到的心电数据传输到医院监护中心，和心电 BP 系统相比，在监护时间和实 时性上有所提高，但因需要线缆连接通信而限制了病人的活动范围。无线心电遥 测系统将实时采集的心电信息通过无线的方式实时发送到医院监护中心。随着无 线通信技术的发展特别是 4G 和 WiFi 技术的日趋成熟和推广应用为无线遥测监护 系统提供了高速、稳定的无线传输途径。
1.2.2 心电自动分析技术的发展
传统的心脏病诊断流程，首先医生根据病人做的心电图检查做出初步的诊断， 再参考患者的其它辅助信息结合医务人员的临床经验最终给出诊断结论。但随着 远程心电监护的推广和普及，心电图信号数据量越来越庞大，单靠人工分析不但 效率低而且人工劳动量大，且无法满足实时性的需要。此外，经验丰富的心电图 医生相对于大量心血管患者仍然是非常稀缺的，因此为了提高效率，有必要研究 一种基于计算机系统的心电自动诊断分析方法对大量的心电图信息进行自动筛 选，选取异常判定难度较大的心电波形给医生进一步分析。而这一点对于解决我 国医疗资源稀缺并提高服务质量尤为重要。
目前各国心电自动分析研究小组已为心电自动分析做出了巨大努力，已有大 量的研究成果。从研究内容上看心电信号自动分析可分为三个部分：心电信号预 处理、心电波形特征提取、心脏疾病诊断。
（1）心电信号预处理发展现状 由于心电信号幅度微弱、频率低，检测过程中极易受到周围环境中各种噪声 的干扰。尤其在对患者进行长时间动态心电监护过程中，被检者可以自由活动于 各种复杂的环境中，采集的心电信号常常淹没在干扰信号中，而如何有效去除这 些干扰就是心电信号预处理研究的内容。心电信号预处理即心电信号的滤波处理， 包括硬件滤波和软件滤波，其中软件滤波即数字滤波是心电信号滤波最主要的方 法。对于心电信号的滤波，通常从滤除工频干扰、基线漂移以及肌电噪声三个方 面考虑。 工频干扰的去除。最早采用方法是平滑滤波，该算法设计简单、计算速度快、 滤波效果较好并且适合实时处理，缺点在于通频带较窄，有较严重的削峰现象， 信号衰减较大。Wariar[15]等人提出的整系数带阻滤波器，具有运算速度快、实时性
3
万方数据

电子科技大学硕士学位论文
较好、设计简单，对工频及其倍频信号抑制效果较好，但缺点就是滤波阶数较高 需要大量的内存迭代空间并且当工频干扰有波动时，滤波效果会明显下降。 Thakor[16]等人利用自适应滤波算法来去除工频干扰，自适应滤波能够根据工频信 号的幅度和频率的变化自动调节滤波参数以此去除工频干扰，取得比较理想的效 果。缺点是需要采集工频信号作为滤波参考信号，计算量较大，滤波开始需要一 段训练时间，因此实时性相对较差。
基线漂移的滤除。通常最简单的方法是采用中值滤波法，该算法简单，处理 速度快适合实时处理，对信号边缘具有很有的保持特性，对较大的基线漂移也有 很好的抑制作用，并且对于和基线漂移频带较为相近的 ST 段也有一定的保护；中 值滤波算法的关键在于选择合适的滤波窗口长度，由于中值滤波是非线性滤波， 不能用传统滤波器方法分析，需要多次实验来确定滤波窗口值。在要求不是很高 的情况下通常采用高通滤波器方法来去除基线漂移，在移动式心电监护中通常采 用零极点对消的设计方法设计整系数高通滤波器[17]。Blanco[18]等人利用经验模态 分解（empirical mode decomposition，EMD）来去除基线漂移。李小燕[19]等人提出 基于小波变换的自适应滤波方法在去除基线漂移的同时又很好的保留了 ST 段的信 息，但小波变换理论复杂算法复杂度高，不适合实时处理。
肌电干扰。心电信号中的肌电干扰相对心电信号及其他噪声属于高频噪声。 因此去除肌电干扰通常有效的方法是对心电信号进行低通滤波器处理。实际应用 中，通常采用零极点对消的设计方法设计整系数的低通滤波器较为普遍。
（2）心电波形特征提取发展现状 心电信号具有准周期性，每个心电周期一般由 P 波、QRS 波群、T 波、ST 段 等特征参数组成，正常的心电信号各个特征参数幅值和时间间隔都在一定的范围 内，当心电图出现异常状况时，通过提取其中的特征波形参数可对疾病进行分析 与诊断，因此心电波形特征参数提取是心电自动分析的前提和基础，其准确性和 可靠性决定着最终诊断的效果。QRS 波幅度和频率与其它特征参数及其噪声有着 明显的区别，是心动周期中特征最为显著的部分，因此 QRS 波的检测是心电波形 特征提取的基础，当 QRS 波位置确定之后，以其为参考根据 QRS 波群的相对位置 关系在一定的时间窗内进行搜索，可实现对其它心电特征参数的提取。常见的 QRS 波检测方法有阈值法、小波变换法、神经网络法、数学形态学法、以及它们互相 结合的检测方法等。 阈值法是一种实时的检测方法，因 QRS 波幅度和斜率都较大，算法首先增强 QRS 波成分并抑制其他波形成分，然后通过设定斜率、面积、幅度中的一个或者 多个阈值，采用逐点比较方法对其定位。对于正常的 QRS 波，该方法准确度较高，
4
万方数据

第一章 绪论
但在 T 波高大、噪声干扰较大、心律失常时易出错。因此性能较好的算法中基本 都使用自适应阈值、或者引入临床经验参数（例如跳过 QRS 波的不应期）以及回 溯机制去改善检测性能。这方面 Tompkin 等人[51]提出基于差分算法的阈值检测方 法有一定的代表性，Friesen 等人[20]对九种典型的这类方法进行了比较，实验证明 了基于滤波的一阶差分方法效果较好。C.Li 等人[21]等首次利用小波变换进行 QRS 波的检测，使用样条小波将 ECG 信号分解到多个尺度，然后利用各小波尺度上的 模极大值、Lipschaitz 指数实现 R 波的定位，对 MIT-BIH 数据库 46 条记录进行了 测试，算法准确度达到了 99.85%。Slimane 等[22]结合经验模态分解法和阈值法来 检测 QRS 波。Trahanias 等人[23]提出一种基于数学形态学方法来检测 QRS 波，算 法灵敏度和准确度分别达到了 99.38%和 99.48%。
总体来说，心电波形特征提取检测中对 QRS 波检测算法研究成果较多，方法 也较为完善，其准确率也较高，并且有多个开放的心电数据库标定了 R 波的位置， 为 QRS 波检测算法提供了便利。和 QRS 波相比，P 波和 T 波幅度小、特征不明显， 检测算法较少，准确率也有待进一步的提高，此外也没有标定好的 P、T 波数据库 供其参考使用，是心电特征提取的难点。
（3）心律失常自动诊断发展现状 通过对心电信号预处理、特征参数提取，用计算机来实现心电信号的分类进 而对心律失常等心脏疾病的诊断是心电信号自动分析最重要的目标。提高心律失 常自动分类诊断的准确率是目前心电信号自动分析的弱项，也是难点。目前对心 电信号自动分类识别方法主要有两类第一类是基于波形形态结构的分类方法，第 二类是基于波形特征的分类方法[24]。 波形形态结构的分类主要基于心电特征参数提取的基础上，如 RR 间期、ST 段、R 波幅度、QRS 宽度等，然后根据临床上疾病分类规则等先验知识对信号分 类，具有一定的合理性，并且符合医生的诊断习惯，因此也较为常用。Tsipouras 等人[25]仅利用 RR 间期可将心拍分为窦性心拍、二个连发室早、室性二联律、室 性三联律、室性心动过速及 II 度传导阻滞 7 类，且准确度较高。Chazal 等[26]根据 心电图中十二个特征参数进行线性分类，将心拍分成 5 个类别，并取得了较理想 的效果。基于波形形态的分类方法对特征参数精确识别要求较高，因此需要较高 质量的心电波形，由于基于波形形态的心电特征参数较少，因此分类的类型有限。 基于波形特征的分类方法是目前应用最为普遍的一种分类方法，其分类原理 是基于异常心电信号在特征空间上与正常心电信号的不同表现来对心电信号进行 分类。其实现方法主要有神经网络、支持向量机、逻辑判别树法、粒子群优化法、 K 近邻以及多种方法结合等。Martis 等人[27]使用主成分分析、独立成分分析、线
5
万方数据

电子科技大学硕士学位论文
性判别分析对心电信号特征提取，并分别使用神经网络、支持向量机对心拍进行 分类。Melgani 等[28]提出了一种支持向量机的基于粒子群优化的新型分类算法，能 够对 5 种异常波形进行分类，效果较为理想。
1.3 本文主要研究内容及创新点
本论文的最终目标是移动式生理多参数遥测监护系统的研制以及在此基础上 的心电波形多参数特征提取算法的研究，以实现对患者的远程实时监护，病发早 期预警和诊断，提高患者生活质量的目的。该系统由移动监护终端和医院监护中 心系统两部分组成。移动监护终端主要包括多生理参数采集模块（包括心电、呼 吸、血氧饱和度并可扩展到其他生理参数）、无线通信模块、电源管理模块、嵌入 式主控模块、人机交互模块等功能模块，各模块在主控模块的统一控制下协调工 作。本文的主要工作及创新点如下：
1、对医院以及社区遥测监护仪的功能和性能需求进行了分析和调研，提出了 系统的总体设计框架。
2、搭建了移动式多参数遥测监护系统的平台。在硬件设计方面，采用低功耗 的电路设计和工作模式以及模块化的思想，使以电池供电的移动监护终端能可靠 地长时间工作。在数据传输方面，定制了通讯编码协议，提高高速通信的可靠性 和数据安全性。
3、提出了基于三轴加速度传感器以及 WiFi 技术的跌倒检测和病人定位的方 案，在监护患者生理参数的同时，能实时遥测病人的位置以及跌倒状态，当患者 出现异常情况时，提醒医护人员进行及时的救助。
4、在心电自动分析方面，基于差分阈值算法理论，提出了一种新的差分函数 动态自适应阈值的 QRS 波特征参数检测方法，对于心电信号预处理，采用中值滤 波加带通滤波抑制心电信号中遇到的运动伪迹以及噪声干扰。
1.4 全文章节安排
基于上述分析，围绕本课题的研究内容，本文各章节安排如下： 第一章首先引入了本课题的研究背景及意义，然后综述了与课题相关的心电 监护技术国内外研究进展及趋势并对心电监护技术中核心的心电自动分析算法做 了详细的概述；最后给出了本论中主要的研究内容与创新点。 第二章从生理学角度阐述了心电信号的产生机理并给出了典型心电信号各个 特征波形、特征间期的生理意义及正常值范围，介绍了心电信号采集的导联类型， 最后给出了本论文用到的标准心电数据库。
6
万方数据

第一章 绪论
第三章主要研究心电信号预处理和特征参数提取算法。首先概述了动态心电 采集过程中主要的噪声干扰种类，并从频域上分析了心电信号各波组成分和主要 噪声的频谱范围，在此基础上给出了本文的预处理算法及仿真结果；其次，提出 了一种基于差分阈值算法理论的动态自适应阈值 QRS 波特征参数提取方法，并在 MIT-BIH 心律失常数据库中对算法进行了测试和评估，最后结合实验测试数据对 算法主要优点和不足进行了综合分析。
第四章主要围绕移动式多参数遥测监护系统实现来展开的，首先对院内多参 数遥测监护仪的功能需求以及性能要求进行分析，给出了系统的总体架构设计， 之后采用分模块的思想对移动监护终端各个模块硬件电路进行了设计，最后给出 了移动监护终端软件设计流程以及与医院监护中心的通讯协议。
第五章系统测试与结果分析。完成了系统的组网调试，对移动监护终端各个 模块功能、功耗进行了测试，给出了移动监护终端实物图。
第六章总结与展望。对整个多参数遥测监护系统进行了总结，分析了其中的 不足并给出了可能的解决方案，对进一步的研究做了展望。
7 万方数据

电子科技大学硕士学位论文
第二章 心电信号分析基础及心电标准数据库
2.1 引言
心电图是使用放置于肢体或躯体的一定部位上的引导电极记录心脏在每一心 动周期电活动变化过程中电流差异在体表的记录图形，是心脏细胞除极和复极过 程在时间和空间有序的电活动的综合表现，对心脏疾病的诊断和心脏功能的评估 具有重要的价值。心电图是当前分析与鉴别各种心律失常最为有效的方法，在指 导心脏手术进行及指示必要的药物处理上也有参考价值，具有无创、简单易用、 低成本的特点而被医生在临床上广泛使用。
2.2 心电信号的概述 2.2.1 心电信号产生机理
人体心脏由大约 200 亿个细胞组成，心肌细胞占其中的绝大部分。心肌细胞 主要为五类细胞：心房肌细胞、心室肌细胞、浦肯野纤维细胞、过渡细胞以及起 搏细胞；前二者细胞是维持心脏正常的收缩以驱动血液流动故又称为收缩心肌或 工作细胞，后三者细胞能自动产生和传导电激动形成心脏传导系，其主要的电生 理特性包括自律性、兴奋性和传导性，构成心脏的传导系统，故又称为自律细胞。 心电信号是由心肌细胞的静息电位向动作电位转变的过程中产生的。

万方数据

图2-1 心肌细胞的穿膜动作电位[29]
8

第二章 心电信号分析基础与心电标准数据库
如图 2-1 所示, 心肌细胞的静息电位（Resting Potential，RP）指心肌细胞在未 受刺激的情况下存在于细胞膜内外两侧的电位差，通常处于细胞膜内的电位为负， 膜外电位为正的极化状态，人与哺乳动物的心室肌细胞的静息电位大约为-90mV。 因为这一电位存在于未受刺激细胞的膜内外两侧，故称为跨膜静息电位或膜电位， 亦简称静息电位[29]。静息状态下，当细胞膜由于内部原因或受到外加刺激作用后， 使得各种离子通道的开关状态发生变化，大量带正电荷的电子进入细胞导致膜内 电位升高，形成除极[30]。除极电位继续升高到一定值后，即阈值电位，跨膜电位 将突然升高到-20～+30mV，这个快速除极就是形成细胞动作电位的 0 相。一般情 况下，除极期的时间很短，为 1～2ms。除极 0 相之后紧随着的是三个复极相，首 先是快速复极相，即动作定位 1 相，这在浦肯野纤维中比较明显，随后进入到平 台期，即动作电位 2 相，然后到动作电位 3 相，这时细胞内电压迅速下降，最后 又回到静息电位，即动作电位的 4 相。心肌细胞从 0 相除极开始到 4 相复极终止 所出现的一系列电位改变形成动作电位（Action Potential，AP）,其时程一般在 200～ 300ms。

万方数据

图2-2 心脏各个传导组织细胞的动作电位图[31]
9

电子科技大学硕士学位论文
心肌细胞在没有外来刺激的条件下，由其本身的内在变化自动地产生节律性 的动作电位的能力称为自动节律性，简称自律性。心内特殊传导系统中的细胞均 具有自律性。其中窦房结细胞的自律性最高（100 次/min），房室交界次之（50 次 /min），浦肯野纤维最低（25 次/min）。正常情况下，窦房结控制着整个心脏兴奋和 收缩，故称为心脏正常的起搏点，如图 2-2 所示，由于心脏周围组织具有导电性， 窦房结自发产生的兴奋依次传导激动心房肌、房室交界、希氏束、心室内传导组 织，再通过心脏周围组织和体液导体扩步至整个人体，使身体每个部位在每个心 动周期中都发生规律性的电位变化，用引导电极置于肢体或躯体的一定部位记录 出来电活动变化曲线称为心电图。
2.2.2 正常心电信号各波形、间期及其生理意义
在心脏的每一个电活动周期，可以在心电图纸上记录下一组变化的波形。一 组典型的心电图（如图 2-3 所示）常包括 4 个波（P、QRS、T 和 U 波）、两段（P-R、 S-T）和两个间期（P-R、Q-T）等。总体来讲，心电图是心脏细胞除极和复极过程 在时间和空间有序的电活动的综合表现。正常的心电波形因年龄和体型的变化各 异。典型的体表心电波形如图 2-3 所示，其特征波段和和特征间期意义及正常值如 下：

万方数据

图2-3 正常人的心电模式图
10

第二章 心电信号分析基础与心电标准数据库
（1）特征波形的意义及正常值如下[32]： P 波（P Wave）是在心动周期中最早出现的一个幅度较小的波，反映左右两心 房的除极过程。其中右房除极早于左房，一般以 P 波的早期相代表右房除极，以 P 波的后部分代表左房的除极，而将 P 波中间部分表示两个心房和房间隔的除极。P 波的波宽代表心房除极的时间，正常的范围是 0.08～0.11s，P 波的幅度极少超过 0.25mV。 QRS 波群（QRS Complex）：也可简称 QRS 波，是左、右两心室的除极而产 生的。典型的 QRS 波由紧密相连的三个波组成，第一个向下的波形为“Q”波， 出现在 Q 波之后第二个狭小而高大向上的波为“R”波，最后一个波是“S”波方 向向下。QRS 波形状和幅度在不同的导联上变化也比较大。QRS 波宽度反映心室 除极的时间，正常值为 0.06～0.10s，绝大部分成年人的 QRS 波时间为 0.08s。 T 波（T Wave）：出现在 ST 段后的一个幅度较低而占时间较长的波，T 波形 态不对称，前半支较平后半支较陡，表示心室肌复极的电势产生的。正常情况下， Ｔ波的方向一般和 QRS 主波的方向保持一致， 幅度应大于同导联 R 波的十分之 一，在 II 导联中 T 波的幅度是最大的，历时大约为 0.05～0.25s。 U 波（U Wave）：继 T 波后 20~30ms 出现的一个宽而低的波，可能代表了浦 肯野纤维复极情况，但具体机制目前仍然不是十分清楚，正常 U 波的幅度是 T 波 的 5%～25%，正常范围为 0.05～0.2mV，且在 V2 和 V3 导联中最高。U 波在心率 较慢的情况下，通常较为明显。 （2）特征波段和间期意义及正常范围如下[32]： P-R 间期（P-R Interval，或称 PQ 间期）：PR 间期的测量是从 P 波起点至 QRS 波起点，代表心房除极开始至心室除极开始的时间。在正常的房室传导时，它包 括从心房开始激动至激动经房室结、希氏束、束支和浦肯野纤维下传心室，至心 室开始激动的时间，故也称为房室传导时间。在成年人，PR 间期的正常范围是 0.12～0.20s。若 PR 间期延长超过 200ms，则有可能是房室传导出现阻滞，此外 PR 间期与年龄和心率也有关系。 P-R 段（P-R Segment）：位于 P 波终点至 QRS 波起点间的时间，代表激动通 过房室结、希氏束、束支和浦肯野纤维的时间。由于这些传导组织产生的电位很 小，故 PR 段通常表现为一水平线，与基线在同一水平，其中包含心房复极波（Ta 波）的成分。Ta 波的方向与 P 波方向相反。 QT 间期（QT Interval）：QRS 波的起点至 T 波终点的时间，代表心室电收缩 期时间。QT 间期正常范围在 0.30～0.46s 之间，与心率成反比，并有随年龄的增 长而延长的趋势。为校正心率的影响，临床中通常用矫正值 QTc 代替 QT 做为诊
11
万方数据

电子科技大学硕士学位论文
断参数，许多研究都将 QTc>0.44s 视为异常。 QTc 延长易产生折返，形成恶性室 性心律失常[33]。
J 点（J Point）：QRS 波的终端或 ST 段的起点称为 J 点，代表心室肌已除极完 毕。正常情况下 J 点位于或接近等电位线，但在多数正常人也会出现Ｊ点上移并伴 有 ST 段的抬高。
ST 段（ST Segment）：指 J 点至 T 波起点之间的间期。它反映了心室除极终点 至复极开始的无极化变化的状态，或是心室除极完成和复极开始相互重叠的状态。 正常时 ST 段应与基线平齐，ST 段可有抬高，但不应超过 0.25mV，下降时应小于 0.05mV，时长一般在 0.05s～0.15s 之间。ST 段的异常变化可能与心肌梗塞、心房、 心室肥大等疾病有关。
2.3 心电信号的采集方法 2.3.1 心电导联的分类
传播至体表的电位需要被置于体表的电极感知，经放大等处理后由特定的显 示装置显示出来，才能产生出完整的心电图。在描记心电图时，引导电极安放的 位置和连接方式称为心电图导联（Lead）。目前临床心电监护中应用的导联系统有 标准 12 导联、Mason-Likar12 导联、心电监护 3/5 电极导联以及 EASI 导联系统。
Einthoven 于 1903 年提出标准 I、II、III 肢体导联；1930 年 Wilson 提出 V1～ V6 单极胸导联；20 世纪 40 年代 Goldberger 倡导采用 3 个“单极”肢导联，即 aVR、 aVL、aVF 单极加压肢体导联；1938 年美国心脏学会推荐临床采用统一的 12 导联 系统，从而使心电图记录技术得以标准化，这就是目前国际上临床习用的标准 12 导联。临床标准的 12 导联心电图采用 10 个置于体表部位的电极，其中 4 个位于 四肢，另 6 个置于胸前特定的位置。10 个电极中有 9 个电极按一定方式的连接可 构成 12 个标准导联，从而可产生出标准 12 导联心电图即 I、II、III、aVR、aVL、 aVF、V1、V2、V3、V4、V5、V6。位于右下肢的电极，只是作为接地电极。标 准 12 导联能够全面地反映心脏的活动信息、可用来诊断多种心血管疾病。为了给 患者提供长时间持续的 12 导联监护，1966 年 Mason 和 Likar 提出改良 12 导联系 统[34]，即 Mason-Likar 导联系统，其胸部电极的安放位置和标准十二导联一致，肢 体部位的电极移至胸部是为了减少上、下肢活动造成的噪声干扰。临床常用的 Holter 监护就是采用的就是 Mason-Likar 导联系统，其电极放置方式如图 2-4 所示。
与标准 12 导联系统相比，Mason-Likar 导联系统所记录的各导联波形基本吻 合。但在肢体导联中 QRS 波群在幅度和电轴中有轻微的改变[35]，同时也有 ST 段 的变化[36]。
12
万方数据

第二章 心电信号分析基础与心电标准数据库

图2-4 Mason-Likar 12导联系统[35]

图 2-5 修正的 3 电极双极导联[35]

图 2-6 通用的 5 电极导联系统[35]

13 万方数据

电子科技大学硕士学位论文
2.3.2 心电监护导联
心电监护导联种类繁多，目前临床使用的主要是 3 电极双极导联和 5 电极导 联。在所有心脏监护导联中，最简单常用的是 3 电极双极导联，常用来监护 I、II、 III 导心电或者修正的双极胸导联 MCL1（如图 2-5 所示）。3 电极双极导联简单方 便通常用在便携式除颤监护器中，用于监测心率，检测心室纤维性颤动以及在心 电除颤中检测 R 波进行同步直流电击心电复律等。因修正的 V1 胸导联与标准的 V1 导联在 QRS 形态上存在差异因此无法诊断宽 QRS 波心动过速[35]。
临床另外一种常用的心电监护导联是使用 5 个电极记录 6 个肢体导联加上一 个单极胸前导联。如图 2-6 所示，胸前电极 C 放置在标准胸导联 V1～V6 中的 V1 处。与 3 电极双极导联相比，5 个电极可记录真实的单极胸导联，并可用来诊断更 多的心脏疾病，例如 V1 可用来诊断左右束支传导阻滞、心室起搏节律以及宽 QRS 心动过速等。但是因其只能记录一个胸导联，不能用来诊断急性心肌缺血[36-38]。
2.4 心电标准数据库
自从心电自动分析成为热点后，世界各国小组开始研究心律失常检测算法， 由于不同研究小组的心电数据库不统一，算法性能的评估很大程度上制约了算法 的发展。标准心电数据库是指数据库内的心电信号标识和分类是由临床证据证实 的或是经过权威的专家小组确认（主要指心律失常数据库）的心电数据集。心电 标准数据库对于心电算法的测试以及仪器性能的评估有着非常重要的作用。国际 上目前公认的可作为标准权威的心电数据库主要有三个：美国心脏学会公布的 AHA 数据库（American Heart Association Database）、美国麻省理工学院和 Beth Israel 医院合作建立的 MIT-BIH 数据库（MIT-BIH DataBase）、以及欧洲的 CSE 数 据库（Common Standards for quantitative Electrocardiography Database）。近年来， MIT-BIH 数 据 库 所 有 者 将 更 多 的 数 据 免 费 放 在 互 联 网 上 （https://www.physionet.org/cgi-bin/atm/ATM），使其成为应用最为广泛的数据库， 为广大从事心电科研工作者提供了有力的工具。通过比较分析，本论文中的实验 数据均来自 MIT-BIH 数据库中的心律失常数据库（MIT-BIH Arrhythmia Database） 以及噪声测试数据库（MIT-BIH Noise Stress Test Database）。
2.4.1 MIT-BIH 心律失常数据库
MIT-BIH 数据库来自 Beth Israel 医院心律失常实验室在 1975 到 1979 年采集的 4000 多例长时间 Holter 记录的数据。其中大约 60%的数据来自住院患者，其他来 自于门诊病人。数据库一共 48 条记录，每条记录时长大约 30 分钟，采样频率为
14
万方数据

第二章 心电信号分析基础与心电标准数据库
360Hz，模数转换（ADC）分辨率为 11 位（每一采样值的范围在 0～2047），幅度 范围大约在-5～5mV 之间（采样值 1024 对应的幅度是 0mV）。数据库中每条记录 由两个心电导联信号组成，第一个导联采用修正的肢体 II 导联（MLII），第二个导 联通常是 V1 导联（少量是 V2 或 V5，有一个记录是 V4 导联）。数据库中的 48 条 记录最终来自 47 个不同的患者（记录 201 和记录 202 来自同一个患者），其中男 性 25 名（年龄在 32～89 岁），女性 22 名（年龄在 23～89 岁）。数据库中前 23 数 据（记录号 100～124）是从 4000 多例数据中随机选取具有代表意义的各种变化的 波形和伪迹，另外的 25 条数据是特意选取一些并不常见但临床上又非常重要的心 律失常数据[39]。
数据库中每条数据记录由三个文件组成：头文件（header）扩展名为 hea、数 据文件扩展名为 dat 以及注释文件（annotation）扩展名为 atr。头文件中详细记录 了相关的数据文件的 ADC 采样频率、持续时间、存储格式、ADC 分辨率、ADC 零值、信号初始校验值等其他属性，头文件的存储格式为 ACSII 码；注释文件记 录的是心电专家给出的心拍诊断结果以及节律和信号质量等，注释文件存储格式 为二进制存储，根据注释文件的第一个字节可将注释文件标识信息分为 MIT 格式 和 AHA 格式。数据文件是以自定义的二进制格式存储的原始数据，尽管 ADC 精 度为 11 位，但为了计算机存储方便 MIT-BIH 心律失常数据库中每一个采样点值以 12 位进行保存，整个数据文件用三个字节表示两个采样点这样循环存储整条记录， 数据存储格式其对应的头文件中有具体的说明[40]。
MIT-BIH 心律失常数据库中 48 记录大约包含了 10900 个心拍，其中有 6 个记 录中的 33 个心拍，心电专家没有给出分类。可能因为心电记录的技术缺陷或是因 为没有足够多的判定信息。有 7 段长度大约为 10 秒的信号因为噪声或信号丢失而 无法识别其中的 QRS 波。此外在记录 102 和 104 中，由于患者做外科手术，用 V5 代替修正的肢体 II 导联[42]。
2.4.2 MIT-BIH 噪声测试数据库
为了尽可能真实的反映心电信号采集中的噪声，MIT-BIH 小组在 MIT-BIH 心律失 常数据库基础上增加了噪声测试数据库，简称 NSTDB。NST 数据库中总共包含了 15 条数据，时长为 30 分钟。其中 12 条记录来自 MIT-BIH 心律失常数据库中记录 号为 118 和 119 的干净片段加入不同增益的噪声信号而得到的，具有不同信噪比的 运动干扰伪迹。另外 3 条记录则是往 118 和 119 中加入的实际心电信号采集过程中 典型的噪声记录，分别是记录号为 bw 的基线漂移噪声、记录号为 ma 的肌电干扰 噪声以及记录号为 em 的电极运动干扰噪声。
15
万方数据

电子科技大学硕士学位论文

表 2-1 MIT-BIH 噪声测试数据库记录号及其信噪比

Tape （No.） 118e24 118e18 118e12 118e06 118e00 118e-6

SNR （dB）
24 18 12 6 0 -6

Tape （No.） 119e24 119e18 119e12 119e06 119e00 119e-6

SNR （dB）
24 18 12 6 0 -6

对于 NST 数据库中的噪声加入过程如下，开始的 5 分钟为纯净信号，之后每 隔两分钟叠加与 118 或 119 同时刻持续时间为 2 分钟的运动干扰噪声 em。噪声叠 加到干净的心电记录片段可根据信噪比（Signal-to-noise Ratio, SNR）公式（如公 式 2-1 所示）计算。

SNR=10

log10

(

S N

)

(2-1)

其中，S 为纯净的心电信号能量，N 为噪声的能量。合成后的 12 条带有噪声的心 电记录片段如表 2-1 所示[43]。

2.5 本章小结
首先从电生理学角度阐述了心电信号的产生机理并给出了典型心电信号各个 特征波段、间期的生理意义及正常值范围，然后介绍了心电信号采集的导联类型。 最后将论文中所涉及到的心电数据库进行简单的说明，为后续的心电信号预处理 以及特征识别算法研究提供基础。

16 万方数据

第三章 心电信号预处理与特征提取算法的研究
第三章 心电信号预处理与特征提取算法的研究
3.1 引言
心电自动分析是指在已检测到的心电信号基础之上，使用计算机系统自动提 取其中与心脏功能和疾病相关的特征参数和波形信息，通过分析处理进而对心脏 的健康状况进行预测和评估，在临床中具有十分重要的意义。而心电波形的特征 参数提取特别是 QRS 波的提取是实现心电信号自动分析与诊断的关键。由于心电 信号微弱很容易受到干扰，因此对心电信号中各种伪迹的有效去除将直接影响着 心电分析和智能诊断的科学性和准确性。虽然目前心电自动分析方法已有大量的 研究成果，但还是存在一定的缺陷。
3.2 心电信号预处理
心电预处理的主要目的是抑制心电信号中的各种干扰噪声，特别是去除基线 漂移和高频噪声。普通的医院心电检查时，病人在床上保持不动，等基线稳定后 再进行测量。但在移动心电监护系统中，心电采集常常受到患者的运动而出现严 重的基线漂移，并且在信号传输的过程也会受到各种干扰，因此对于动态的这种 心电信号遇到的各种干扰进行去除是非常必要的。
心电信号进行预处理之前，心电信号以及噪声的频谱分析对后面的信号处理 以及心电特征参数提取有着重要的依据和意义。实际心电信号功率谱分布如图 3-1 所示。目前对心电信号及各组分的频率分布已有大量的研究报道，由于测量方法、 频率有效标准、测量仪器、信号提取方式等原因，各研究小组结果各异。例如文 献[44]统计结果表明：心电波形的频谱范围在 0.05～100Hz 之间，总体频带范围在 0～ 40Hz（±7Hz），P 波的频带主要为 0～18Hz（±3Hz），波峰能量集中在 5～12Hz； QRS 波的频谱带宽为 5～37Hz（±5Hz），波峰能量集中在 6～18Hz 附近，T 波的 频带范围为 5～12Hz（±2Hz），绝大部分能量集中在 0～8Hz 区间。而文献[45]报道， 心电信号带宽范围在 0～58Hz（±19Hz），P 波带宽为 0～8Hz（±3Hz），QRS 波 频谱范围为 0～55Hz（±19Hz），T 波频谱范围为 0～11Hz（±2Hz）。Thakor[46]等 人研究报道，QRS 波的频率带宽为 5～40Hz，中心频率在 17Hz，P 波和 T 波频率 带宽为 0.7～10Hz。虽然各个小组报道结果不同，但整体范围相差不大。
17
万方数据

电子科技大学硕士学位论文
图 3-1 心电信号的频谱特性[46]
3.2.1 心电信号噪声分析
由于心电信号具有幅度微弱（毫伏级）、频率低、高阻抗性等特点，因此在信 号采集时尤其是在动态心电监护过程中由于受到电磁环境、采集仪器、人体运动 等多方面的影响，所采集到的心电信号容易受到各类噪声的干扰。其中主要的噪 声分为以下三类：
1. 工频干扰 工频干扰是由电力系统以及心电采集仪器与人体的分布电容等因素引起的， 属于低频干扰，其频率成分包括工频及其谐波，我国的工频是 50Hz，在美国等西 方国家是 60Hz。心电图上表现为有规律的正弦波，工频干扰幅值可达到心电信号 峰峰值的三分之一。 2. 肌电干扰 肌电干扰通常是由于被检者所处的环境温度较低、人体活动、肌肉紧张等原 因导致肌肉收缩时在皮肤表面产生的电势变化引起的。其幅值在-90～30mV 之间, 频率分布范围很广在 5～2000Hz 之间，频谱特性接近白噪声，持续时间约为 50ms。 心电图中表现为一系列不规则的细小芒刺，较被容易误诊为心房颤动波[47]。 3. 基线漂移 基线漂移通常由人体呼吸、肢体活动、硬件放大器温漂以及电极移动时与皮 肤的阻抗变化等因素造成的。基线漂移频率较低，频率范围为 0.05～1.5Hz，属于 低频干扰。基线漂移是影响心电信号形态分析以及基于阈值检测的特征参数提取 的重要因素。特别对 ST 段的影响，由于心电信号中 ST 段频率（0.7～2.0Hz）与
18
万方数据

第三章 心电信号预处理与特征提取算法的研究
基线漂移的频谱非常接近[48]，因此在去除基线漂移的同时应尽量避免对 ST 段的形 态造成严重的失真。此外严重的基线漂移还会造成在 QRS 波的检测过程的误检， 所以对基线漂移的抑制是心电自动分析过程中一个重要又困难的问题。
3.2.2 心电信号滤波的实现
图 3-2 中值滤波对基线漂移的抑制效果图。（a）去除基线漂移前的信号；（b）中值 滤波去除基线漂移后的信号；（c）利用中值滤波提取出的基线漂移信号
19 万方数据

电子科技大学硕士学位论文
图 3-3 中值滤波和带通滤波对噪声抑制效果。（a）滤波前的心电波形；（b）中值滤波 后输出的波形；（c）中值滤波和带通滤波后输出的波形
在动态心电信号记录过程中常常夹杂着各种各样的噪声，采集的心电信号常 常淹没在各种干扰噪声中，因此噪声的存在会降低信号分析的精度和准确度，因 此必须先对采集的信号进行去噪。通常的方法是先采用硬件电路滤波，再用数字 滤波器进一步提高信噪比。数字滤波器的设计滤波精度高、算法设计灵活，国内 外许多学者在此进行了专题研究，取得了较好的效果。经过对比分析本论文采用 中值滤波加带通滤波处理方法。
中值滤波法校正的基本原理是首先确定好中值滤波窗口长度，得到原始序列 每一点设置在该点预先设置的窗口长度领域内的中值，最后将原始信号与得到的
20 万方数据

第三章 心电信号预处理与特征提取算法的研究
中值相减抵消基线漂移，得到滤波后的结果。数学描述为：原始序列 x={x(1), x(2), x(3), … x(n), …, x(N)}, 预先设置好中值滤波的窗口长度假设为 2M+1，窗口长度一 般设置为奇数，中值滤波输出后的序列为 y(n)=median{x(n-L), x(n-L-1) …, x(n), …, x(n+M-1), x(n+M)}, 其中 median{}是对序列取中值的操作。中值滤波具有良好的 边缘保持性以及消除脉冲噪声能够很好的抑制较大的基线漂移，并且算法简单、 处理速度快，很适合做实时处理。算法最核心的是选择合适的滤波窗口长度，若 窗口太小，拟合出来的基线反而会带来额外的高频分量，若窗口过宽，增加系统 运算量，并且会影响算法的实时性。一般窗口长度设置采样频率的 80～90%比较 合适[49]，本论文中采用 MIT-BIH 数据库对算法进行测试，MIT-BIH 数据库采样率 为 360Hz，因此窗口长度选为 301。为了验证中值滤波效果，取 MIT-BIH 心律失 常数据库中受基线漂移等干扰较为严重的 103 号长度为 10s 的数据进行测试。如图 3-2 所示为使用中值滤波算法后的实验结果。
可以观察到中值滤波能够很好的抑制心电信号中较大的基线漂移噪声，对 ST 段也有一定的保护，并且没有产生波形失真。经过中值滤波后的信号仍然残留着 高频噪声，最后我们设计一个二阶带通频率为 0.05~100Hz 的巴特沃兹滤波器，利 用 MATLAB 来获得滤波器的系数。将图 3-2 中值滤波输出的信号进一步经过带通 滤波处理的信号效果图如图 3-3 所示。
3.3 心电信号的特征提取 3.3.1 心电波形差分阈值检测算法原理
心电图是当前分析与鉴别各种心律失常最为有效的方法，因此心电信号的自 动分析对心脏疾病的诊断具有十分重要的意义。波形检测和特征提取是心电自动 分析系统的前提和基础，心电图的诊断就是依靠心电波形的多个参数并根据临床 知识进行诊断分析，其检测准确性和可靠性直接影响着诊断的效果。而波形检测 和特征提取首先是针对 QRS 波，主要原因是 QRS 波幅值和频率与其他特征参数有 着明显的差异，在 QRS 波检测的基础上再对其他特征参数进行检测提取，包括 P 波、T 波、ST 段、U 波等。目前国内外许多研究小组对 QRS 波群的检测方法已经 做了大量的研究，QRS 波检测方法主要有：差分阈值法、模板匹配法、小波变换 法、数学形态法、神经网络和非线性滤波法等。除差分阈值法外其他方法虽然能 够达到很高的检测率，但是由于算法复杂度高、计算时间长不能很好应用在实时 处理的微处理器中，特别是一些便携式的心电监护设备。
差分阈值法是 QRS 波实时检测算法中最经典、最常用的一种算法，其基本思 想是：QRS 波是心电信号中特征最显著的部分，尤其是 R 波有高幅值、高斜率的
21
万方数据

电子科技大学硕士学位论文
图 3-4 经典差分阈值检测算法流程图
特点。基于以上特征，算法流程首先对检测到的 ECG 信号进行预处理，预处理之 后对信号进行差分运算，目的是增强 QRS 波能量，去除噪声伪迹，突出 R 波幅度、 斜率信息；最后将差分预处理后得到的信号与预先设置阈值进行对比，当等于或 者大于该阈值即认为检测到了一个 QRS 波。其中阈值包括信号的幅度、差分以及 面积阈值中的一种或多种。在初期的算法中，阈值是预先设置的一个固定值，但 是由于个体化差异以及心律失常时信号的变异等原因大多研究者采用自适应阈 值。
Balda 等人[50]最早提出用差分法来检测 QRS 波。1985 年 Pan J 和 Tompkin W J[51] 提出的基于差分阈值 QRS 波实时检测算法（以下简称 PT 算法）目前仍在医疗设 备中广泛应用。PT 算法流程如图 3-4 所示，其具体实现步骤是：将采集到的心电 信号通过一个下限截止频率为 5Hz 上限截止频率为 11Hz 的带通滤波器去除心电噪 声伪迹，同时也衰减了 P、T 波带来的干扰。通过差分和平方运算之后再通过 150ms 的移动窗口积分，为了显著突出 QRS 波群的位置，最后使用阈值法去检测 QRS 波。为了最大程度上减少高大的 T 波带来的误判，当检测到一个 QRS 波后跳过一 段时间为 200ms“不应期”（refractory period），同时更新阈值，此外为了减少由 于低幅值的 QRS 波所造成的漏检情况，当 RR 间期大于预设阈值后，则认为漏检 了一个 QRS 波，此时需要降低阈值重新检测一次。
3.3.2 R 波峰值检测
本文对 PT 算法做如下两点改进：首先采用一种新的差分函数使 QRS 波能量最 大化，同时抑制 P 波、T 波干扰，舍弃 PT 算法中的平方运算，因为平方运算对低 幅值的 QRS 有衰减；第二增加 R 波幅值检测代替 PT 算法中的滑动窗口积分，减 少算法的复杂度。算法流程主要包括四个步骤：信号预处理、差分运算、阈值检 测，峰值校验。信号预处理详见本章上一节中的中值滤波和带通滤波。
22
万方数据

第三章 心电信号预处理与特征提取算法的研究

图 3-5 差分方程幅频及相频特性曲线

3.3.2.1 差分运算

差分阈值法有多种实现形式，主要有一阶差分或者二阶差分，其中常用的差 分运算有以下几种形式[52]：如式 3-1 所示。其主要的原理是 R 波有高幅值、高斜 率特点，通过差分处理后、突出 R 波的幅度和斜率信息，使 P 波和 T 波得到衰减。

y(n)=x(n+1)-x(n)

 y(n)  2 x(n 2)  x(n1)  x(n1)  2 x(n 2)

 

y(n)



x(n

2)



2x(n)



x(n1)

 y(n)  x(n)  x(n1)

(3-1)

本文所采用 MIT-BIH 心律数据库采样频率为 360Hz，文献[53]表明，QRS 波的 时间一般在 60～100ms 之间，通过对心电波形的观察和分析，Q 波和 R 波之间的 斜率是最大的，平均间隔大约为 20ms，也就是说 QR 波之间的间隔大约在 7 个点 左右（0.02*360=7.2）。为了突显 QR 波的斜率，相应的差分步长取 7，最终的差分 函数如式 3-2 所示。

y(n)  x(n)  x(n 7)

(3-2)

对式 3-2 等号两边做 Z 变换，结果如式 3-3 所示，其造成的时间延迟为 3 个采 样点，差分方程对应的的幅频及相频特性曲线如图 3-5 所示，其 3db 对应的下限截 止频率为 6Hz，上限截止频率为 46Hz，通带内有 6db 增益。

H(Z)  1 Z7

(3-3)

结合上一节心电信号各波段的频谱范围，P 波、T 波绝大部分频谱在差分的阻 带范围内，QRS 波绝大部分频谱在差分函数的通带内并且有 6db 的增益。取 MIT-BIH 数据库中记录号为 119 中的 5s 心电信号做差分运算后的波形如图 3-6 所

23

万方数据

电子科技大学硕士学位论文

图 3-6 差分运算波形图。(a)滤波后的心电信号波形；(b)差分运算后的心电信号波形

示，从图中可看到信号经过差分运算后，基本已经去除低频的 T 波和 P 波，同时 突出了 R 波的斜率和幅度。

3.3.2.2 阈值检测

阈值检测是 R 波定位的关键步骤，将差分预处理的信号与阈值比较，当差分 值大于某一阈值后即认为检测到一个 R 波，在 R 波检测过程中，因检测对象的不 同和各种心律失常信号的差异使得差分后的 R 波斜率会有很大的差异，因此对于 阈值的设置和更新显得尤为重要。本文在 R 波检测过程中，采用差分阈值和幅度 阈值根据信号的变化及时更新阈值来适应不同的 R 波检测。具体实现过程如下：
1. 初始化阈值设计 取前 10 秒滤波后的信号以及差分信号，分成 5 段每段时间 2 秒，然后求每一 段 信 号 内 的 幅 度 最 大 值 和 差 分 最 大 值 依 次 保 存 在 AmpMaxValueArray 和 DiffMaxValueArray 中。初始化幅度阈值和差分阈值计算公式分别如式 3-4、式 3-5 所示，其中 α 和 β 值范围为 0～1。通过实验数据测试 α 和 β 最优的值为 0.5 和 0.68。

 AmpThrehold





 

1 5

5 n 1

AmpMaxValueArray[n]

(3-4)

24

万方数据

第三章 心电信号预处理与特征提取算法的研究

 DiffThrehold





 

1 5

5 n 1

DiffMaxValue

Array[n]

(3-5)

2. 阈值比较 记预处理后的信号为 x(n), x(n)差分后的信号记为 xDiff(n)，将 xDiff 逐点与差 分阈值比较，当 xDiff(n) ≥ DiffThreshold，则认为可能检测到一个 QRS 波，并记录 此时的位置并设为 P1；以 P1 为起点时间窗口为 20ms 的邻域内在 xDiff(n)中查找 差分最大值记为 DiffTempMax，记满足条件的位置为 P2，最后在 x(n)信号 P2 点为 中 心 20ms 邻 域 内 查 找 幅 度 最 大 值 记 为 AmpTempMax ， 并 判 断 是 否 满 足 AmpTempMax≥AmpThreshold，如果满足，则表示正确检测到了一个 QRS 波。 3. 自适应阈值更新 将最新得到幅度最大值 AmpTempMax 和差分最大值 DiffTempMax 以栈的形 式分别存储到 AmpMaxValueArray 和 DiffMaxValueArray 中，随着信号的变化自动 更新幅度阈值和差分阈值。

3.3.2.3 峰值校验
心电信号在检测过程中受到诸多因素的影响，尽管之前的预处理已经去除了 绝大部分的噪声和干扰，但是由于心律失常、噪声干扰、电极接触不好等原因使 QRS 波幅度和斜率突然变得很小，QRS 波峰值或斜率值达不到阈值而造成漏检或 者多检。本文为了解决这个问题，算法采用多种策略来避免 QRS 波的漏检和多检， 提高算法的检测准确率。
1、按照上一节介绍的自适应阈值更新。 2、不应期。根据第二章中心电信号产生的电生理基础可知，心肌细胞在复极 时膜电位要逐渐恢复到一定值后才能对下一个刺激有反应，即 QRS 产生之后一段 时间内不会产生另一个 QRS 波，这个阶段成为不应期。因此在检测到一个 QRS 波后，通常可以跳过一段数据，这样既可以避免将高大的 T 波被误检成 R 波，同 时也可以大量节省运算时间。这对于心电实时处理和心电监护过程中有着重要的 意义，PT 算法中将不应期时间设置成 200ms，本文中也采用这一值。 3、漏检补偿。根据临床知识，正常的人心率一般在 60～100 之间，运动员心 率稍低，但一般不低于 40。RR 间期正常范围一般在 0.4～1.2s 之间，因此每检测 到一个 QRS 波后，可以利用 RR 间期的范围来判断是否漏检了一个 R 波，这样可 以避免低幅度的 R 波以及心律失常导致的 R 波斜率和幅度造成的漏检。本文采用 最近 6 个 RR 间期的平均值记为 RR ，当前检测到的 R 波间期大于 1.66* RR 时，则 认为漏检了一个 R 波，此时应降低阈值并从上一个 R 波开始重新检测。

25

万方数据

电子科技大学硕士学位论文

3.4 QRS 波检测算法评估与仿真分析

3.4.1 算法的检测结果与性能评估

算法采用 MIT-BIH 心律失常数据库中的 48 条数据作为算法测试数据库，除了 记录号 114 使用的是第二导联外，其他 47 条数据均使用其中的第一导联即修正的 肢体 II 导联（102 和 104 患者在做外科手术两个导联数据都是胸导联）作为算法测 试数据。将本算法在 MATLAB 平台上得到的 QRS 波检出点的位置与 MIT-BIH 数 据库中注释文件标识的时刻对比，来判别 QRS 波的检测位置是否正确。如表 3-1 所示为 MIT-BIH 数据库的检测结果，从实验结果可以看到本论文提出的算法具有 较高准确度（99.80%）和灵敏度（99.57%）。
本文采用临床上常用的算法评估指标灵敏度（Sensitivity，SE）和阳性准确度 （Positive predictivity，P+）等指标来评估算法的性能。其灵敏度和准确率计算方 式分别如式 3-6、3-7 所示。

SE  TP TP  FN

(3-6)

P  TP TP  FP

(3-7)

其中真阳性（True Positive，TP）代表正确检测到了一个 QRS 波，即数据库 中注释文件标记的 R 波的个数，假阳性（False Positive，FP）表示错误检测到了一 个 QRS 波，假阴性（False Negative, FN）表示漏检了一个 QRS 波。灵敏度反映了 QRS 波被正确检测出来的比例。
如表 3-2 所示给出的是本论文中的算法与 PT 算法和小波变换[55]法对比结果， 表 3-2 算法用到的数据库均采用的是 MIT-BIH 心律失常库中的 48 条数据。从表中 可以看出，本论文中的算法性能较 PT 算法有所提高，但比小波变换算法性能要差。 因为小波算法从频域上分析 ECG 特性，其稳定性相对较好，但实时性能较差。

Tape （No.）
100 101 102 103 104 105 106

表 3-1 MIT-BIH 数据库检测结果

Total （No.Beats）
2273 1865 2187 2084 2230 2572 2027

TP （Beats）
2273 1865 2187 2084 2230 2570 2023

FP （Beats）
0 2 0 0 15 95 0

FN （Beats）
0 0 0 0 0 2 4

P+ （%） 100.00 99.89 100.00 100.00 99.33 96.44 100.00

SE （%） 100.00 100.00 100.00 100.00 100.00 99.92 99.80

26

万方数据

107 108 109 111 112 113 114 115 116 117 118 119 121 122 123 124 200 201 202 203 205 207 208 209 210 212 213 214 215 217 219 220 221 222 223 228 230 231 232 233 234 总计

第三章 心电信号预处理与特征提取算法的研究

2137

2137

1

1763

1760

11

2532

2532

0

2124

2122

2

2539

2531

0

1795

1797

2

1879

1879

0

1953

1953

0

2412

2411

0

1534

1533

0

2278

2278

0

1987

1987

49

1863

1861

0

2476

2476

0

1518

1515

0

1619

1619

0

2601

2598

2

1963

1845

0

2136

2125

0

2982

2951

29

2656

2652

0

2332

1858

5

2956

2942

0

3005

3005

0

2650

2594

0

2748

2748

0

3251

3251

0

2262

2258

2

3363

3362

0

2205

2203

0

2154

2145

0

2048

2048

0

2427

2370

0

2484

2648

0

2605

2600

1

2053

2049

8

2256

2256

0

1571

1569

0

1780

1773

0

3079

3076

0

2753

2753

0

109497

109122

224

0

99.95

103

99.38

0

100.00

2

99.91

0

100.00

0

99.89

0

100.00

0

100.00

1

100.00

0

100.00

0

100.00

0

97.59

2

100.00

0

100.00

3

100.00

0

100.00

3

99.92

118

100.00

11

100.00

31

99.03

4

100.00

4

99.73

12

100.00

0

100.00

56

100.00

0

100.00

0

100.00

2

99.91

1

100.00

2

100.00

9

100.00

0

100.00

57

100.00

16

100.00

6

99.96

12

99.61

0

100.00

1

100.00

7

100.00

3

100.00

0

100.00

472

99.80

100.00 94.47 100.00 99.91 100.00 100.00 100.00 100.00 99.96 100.00 100.00 100.00 99.89 100.00 99.80 100.00 99.88 93.99 99.49 98.96 99.85 99.79 99.59 100.00 97.89 100.00 100.00 99.91 99.97 99.91 99.58 100.00 97.65 99.40 99.77 99.42 100.00 99.94 99.61 99.90 100.00 99.57

27 万方数据

电子科技大学硕士学位论文

表 3-2 不同算法检测结果对比

算法类别

灵敏度(100%) 准确度(100%)

本论文算法

99.80

99.33

Pan-Tompkin 差分阈值法

99.75

99.54

小波变换法[21]

99.27

99.83

3.4.2 实验数据分析
如图 3-7 所示给出了典型的几种心电波形的检测结果，图中“*”表示算法正确 识别到的 R 波位置。图 3-7(a)是记录号为 100 波形未受到过多噪声干扰比较标准的 图形；图 3-7(b)显示的是记录号 107 中 ECG 信号有高大的 T 波，但由于算法采用 的差分函数对 T 波有衰减，并且在检测到 R 波后跳过 200ms 不应期，因此很好的 避免了对 T 波的误捡；图 3-7(c)，显示的是记录号 103 收到基线漂移后的波形，由 于加了中值滤波很好的去除了基线漂移的影响，并未对算法的识别造成影响，图 中算法标记的 R 波位置和原始波形实际的 R 波位置有偏差，其原因是原始信号预 处理后对相位有延迟；图 3-7(d)，说明漏检补偿对于低幅值的 QRS 修正比较有效。
如图 3-8 所示给出了本文算法中主要错误来源的典型的三种的波形。图 3-8(a) 是记录号 105 受严重的噪声干扰波形片段，给 QRS 检测带来困难，类似的还有 108、 203；图 3-8(b)来自记录号 201 中的记录片段，正常的 RR 间期中夹杂中幅值较小 的室性早搏波形，尽管算法中加了漏检补偿，但由于 RR 间期不满足大于 1.66* RR ， 因此造成了漏检；图 3-8(c)显示的是记录号 205 中低幅值的 QRS 漏检的情况，也 是算法中主要的错误来源，尽管漏检补偿中 RR 间期满足要求，但是当阈值降低了 也会带来新的噪声干扰，因此这需要折衷考虑，找到最优化的阈值系数。

28 万方数据

第三章 心电信号预处理与特征提取算法的研究
图 3-7 含有基线漂移和 T、QRS 波异常的心电波形检测结果图
29 万方数据

电子科技大学硕士学位论文
图 3-8 含有严重伪差和异常的心电波形检测结果图
3.5 本章小结
本章主要研究了心电信号的预处理技术以及心电特征提取部分中的 QRS 波检 测算法。首先给出了心电信号中主要的噪声来源以及心电信号各波段的频谱范围， 之后利用中值滤波和带通滤波实现了对基线漂移、肌电干扰等噪声的有效抑制。 对于 QRS 波的检测部分，本文在基于已有的差分阈值算法的基础上，对其核心的 差分函数和检测规则做了改进，并在 MIT-BIH 数据库中对算法进行了测试和评估， 并对测试结果进行了对比和分析，同时对算法检测过程中错误的来源进行了分析。
30 万方数据

第四章 多参数遥测监护系统的设计与实现
第四章 多参数遥测监护系统的设计与实现
4.1 系统总体设计
为了给心脏病患者和重症患者提供有效监护、诊断各种异常病症，先后出现 了床边监护技术和心电遥测监护技术。床边监护仪可以实时监护患者的心电、呼 吸、血氧、血压、体温等生理参数，可以对异常参数进行实时报警和简单的数据 回放，但由于床边监护仪体积较大，监护时患者必须在病床上。心电遥测监护技 术主要由患者随身携带的移动监护终端、医院中心监护系统和院内的局域网等组 成。移动监护终端采集患者的心电信息通过院内的局域网上传至监护中心，医生 可实时地查看患者的心电信息。虽然患者不受监护仪的限制，可以在病区内自由 活动，但监护参数单一，一般只有心电图并且导联较少。此外由于心脏疾病的突 发性以及随机性，在对心脏病人的诊断和监护时，患者需要长时间处于医院内监 护，使得病人无法正常的生活。

万方数据

图 4-1 本课题中提出的多参数遥测监护系统拓扑结构图
31

电子科技大学硕士学位论文
本论文基于医护人员及其患者的临床需求克服现有技术的不足，提出一种具 有区域定位和快速预警响应功能的多参数遥测监护系统，系统包括生理多参数移 动监护终端和医院中心监护系统。系统拓扑结构如图 4-1 所示[59], 移动监护仪由患 者随身携带，用于采集患者的心电、呼吸、血氧、姿态以及位置等信息，通过 WiFi 网络实时上传至医院监护中心。医院中心监护系统能够对多名患者进行实时的监 护，并对异常情况（例如：电极脱落、电池电量低、心率异常、超出监护区域等） 自动发出报警，提醒医护人员对患者进行及时的救治。
4.2 移动监护终端硬件设计
移动监护终端硬件设计框图如图 4-2 所示，系统采用模块化思想进行设计，即 首先定义好各个模块的功能以及输入输出之间层次结构，然后再分别实现各种模 块的功能。移动监护终端硬件主要由以下基本模块构成：嵌入式主控模块、生理 参数采集模块、无线通信/定位模块、跌倒检测模块和人机交互模块。心电、血氧 分成独立的模块进行设计，各个模块都有相应的单片机进行控制，避免生理参数 采样之间的干扰。分模块设计可以降低设计的难度，并且可以方便硬件的调试和 维护，并可根据需求对系统进行剪裁。

万方数据

图 4-2 本课题提出的移动监护终端硬件设计框图
32

第四章 多参数遥测监护系统的设计与实现
4.2.1 心电采集电路设计
心电信号具有幅度微弱（毫伏级）、低频（0.05～100Hz）、易受干扰的特点， 因此对于心电采集电路需要满足以下几点要求：（1）高输入阻抗；（2）高共模抑 制比；（3）高信噪比。因此传统心电采集电路设计较为复杂：一般由前置放大电 路、滤波电路、后置放大、导联脱落检测电路等组成。以上设计虽然可以得到高 质量的心电信号，但由于电路通过分立器件组成设计难度大、开发成本高、功耗 较大、不适合在移动监护领域的应用。
本文中移动监护终端心电信号采集电路主要采用 TI 公司推出的集成 ECG 模 拟采集前端芯片 ADS1292 来实现心电信号的采集。ADS1292 主要特点如下：双通 道 24 位模数转换器；7 种可选采样频率最高至 8kSPS；模拟输入数字输出通过片 上 SPI 与外部设备进行串行数据交互，高共模抑制比最高可达 105db。
本系统中采用第二章提到心电监护导联，支持 3/5 个电极，由心电导联运算关 系可知，最多可得到 7 个通道的心电波形即 6 个肢体导联和 1 个胸导联（I、II、III、 aVR、aVL、aVF、V）。本系统包含 5 导联 7 通道心电、因此需要两片 ADS1292 才能达到要求。心电采集电路原理图如图 4-3 所示。

万方数据

图 4-3 心电采集电路原理图
33

电子科技大学硕士学位论文
4.2.2 呼吸信号检测电路设计
人体通过呼吸从外界环境摄取氧气并排除机体产生的二氧化碳，从而维持机 体正常的新陈代谢。呼吸是人体重要的生理过程，一旦呼吸停止，生命也将终止， 对呼吸的监护检测在临床上具有重要的意义。一般对呼吸监护是监护呼吸的频率。 临床上呼吸的检测方法主要有以下几种方法：通过压力传感器检测胸腔的体位变 化来检测呼吸波[56]、温度传感器器法借助放置在鼻孔处的热敏电阻把呼吸作用引 起的温度变化来检测呼吸[57]、体积描记法通过放置在人体的双频带环把呼吸运动 引起的带环电磁场的变化转化为呼吸波来监测呼吸[58]、呼吸阻抗法。呼吸阻抗法 的主要原理：人体的胸部可等效成一段容积导体，随着人体呼吸造成气体的进出 引起胸腔交替变形，机体组织的电阻抗也会发生随之交替的变化，将一个恒定的 高频激励电信号直接加载到病人的胸壁上，通过一对电极测得电压的变化来检测 人体的呼吸波形。呼吸阻抗法技术成熟、实现简单是目前监护设备中最常用的一 种方法，本文也选用呼吸阻抗法来提取呼吸信号。
呼吸阻抗法有两电极法和四电极法。两电极法中激励电极和测量电极共用， 四电极法中，激励电极和测量电极完全分开。考虑到四电极个数多使用不方便， 临床上普遍使用两个电极，通常与心电图导联电极 LL 和 RA 复用。本系统中还预 留了 RA 和 LA 电极通道。

万方数据

图 4-4 呼吸信号检测电路原理图
34

第四章 多参数遥测监护系统的设计与实现
呼吸信号检测电路原理图如图 4-4 所示，具体实现方法为通过心电采集模块中 单片机 STM32F103 集成的计时器 Timer 产生频率为 62.5KHz 的高频激励信号，使 呼吸信号调制在其上，经放大、滤波、解调后可得到呼吸波形，最后送至心电采 集模块中的 ADS1292 对其采样输出。
4.2.3 血氧饱和度检测电路设计
血液中的有效氧分子，通过与还原血红蛋白（Hb）结合后形成氧合血红蛋白 （HbO2）。血氧饱和度（SPO2）指的是血液中氧合血红蛋白占可结合的还原血红 蛋白和氧合血红蛋白之和的百分比，反映了人体血液携带氧气的指标。其主要测 量原理是根据不同的血红蛋白对不同光谱的吸收强度的差异。本论文中采用指夹 式血氧探头来采集血氧，其主要由放光器件和光电检测器件组成，发光器件分别 发出波长为 660nm 的红光和波长为 940nm 的红外光，HbO2 和 Hb 对 660nm 的红 光吸收差别很大，而对 940nm 的红外光相差不大，光电检测器件将接收到经过手 指后的透射光转换成电信号，再对此电信号进行运算即可得到血氧饱和度。
血氧饱和度检测电路原理图如图 4-5 所示，血氧饱和度检测模块主要包括血氧 探头 LED 驱动电路、信号调理电路以及微控制电路。由微处理器产生分时复用的 时序信号驱动发光器件顺序发出红光和外红光，信号调理电路将光电检测器件得 到的电信号进行放大、分离，在微处理器中进行模数转换。

万方数据

图 4-5 血氧饱和度检测电路原理图
35

电子科技大学硕士学位论文
4.2.4 无线通讯/定位模块及人机交互模块
无线通讯模块采用济南有人科技有限公司的 USR-C322 低功耗 WiFi 模块。该 模块是基于 TI 公司的 CC3200 芯片方案，内置 ARM Cortex-M4 内核，运行频率达 80MHz，支持 Wi-Fi@2.4GHz 802.11b/g/n 无线标准、AP/STA 工作模式和 TCP/IP 协议，AT+指令对设备进行配置，模块与嵌入式主控模块通过串口进行连接[60]。
本系统的定位原理主要基于 WiFi 定位技术。其定位原理如下：无线访问接入 点（Access Point, AP）（一般家庭或办公室使用的无线路由器就是一个 AP）都有 一个全球唯一的物理地址（Medium Access Control, MAC），并且是固定不变的， 患者随身佩戴的移动监护仪在上电后无线通讯模块即可连接到预先布置好的局域 网中离用户位置最近并且信号强度最大的 AP，通过查询 AP 的 MAC 地址所对应 的监护区域地址即可知道用户的位置。
人机交互模块主要包括按键、指示灯以及蜂鸣器。当移动监护仪发生网络断 开、电池电量过低、导联电极脱落、心率异常等状况时，通过指示灯颜色以及蜂 鸣器的声音来提醒医护人员及其家属，患者也可通过按键与医护人员进行交互。
4.2.5 跌倒检测模块
老年人和心脏疾病患者由于身体比较虚弱，自理能力和自我保护能力比较差， 常常会发生意外跌倒，若跌倒后不能得到及时的救助，可能会导致非常严重的后 果。本系统监护主要应用于医院及其社区，养老院和家庭的自由活动患者，对于 这类患者跌倒检测非常有意义。当被检测到患者跌倒后能够及时地通知相关人员 进行救助，将会大大地减轻由于跌倒而造成的危害。
目前，对于跌倒检测的方法主要有三种[61]：基于视频图像的跌倒检测、基于 音频和振动的跌倒技术、基于穿戴式传感器的跌倒技术。基于视频图像的跌倒检 测技术通过摄像头实时采集人体运动资料来检测跌倒信息，其缺点是使用范围有 限并且不能保证用户的个人隐私。基于音频和振动的跌倒检测需要在患者活动的 地点安装声学及振动传感器，成本很高并且使用范围有限。
基于穿戴式传感器的跌倒检测技术的传感器类型可分为压力传感器检测和加 速度传感器检测。压力传感器检测方法是通过将压力传感器放置在足底和其它传 感器一起来检测人体跌倒是否发生跌倒。加速度传感器法通过实时检测人体的加 速度参数来判断人体是否发生跌倒，当人站立或者行走时其 Z 轴方向的加速度为 g，X 轴和 Y 轴的加速度约为零；当发生跌倒时，人体躯干 X、Y、Z 三个轴方向 的加速度会发生变化，通过对人体跌倒状态进行建模提取跌倒过程中加速度的特
36
万方数据

第四章 多参数遥测监护系统的设计与实现
图 4-6 跌倒检测电路原理图
征值，通过与设定的阈值进行比较来判断是否发生跌倒[62]。 本系统中选择 Analog Devices 公司推出的三轴加速度传感器 ADXL335 用于人
体跌倒检测。利用 ADXL335 设计的人体跌倒检测电路图如图 4-6 所示，ADXL335 在采集人体的加速度之后，分析并转换成模拟电压进行输出，其中加速度为 0g 时 输出电压为 VCC/2±10%V(VCC 为 ADXL 工作电压)，工作电流为 400uA，灵敏度 为 300±10%mV/g。
4.2.6 电源管理模块
本系统电源管理模块主要有四部分组成：电池电量检测电路、稳压电路、电 池充电电路、以及电池切换电路。为了让系统能够进行长期的工作，连续监护时 长大于 48 小时、系统选用锂电池和 3 节 AA 镍氢电池给移动监护终端供电。
电池电量检测电路测量的主要依据是电池电量和电压的放电曲线，通过实时 测量电池两端的电压来检测电池的电量[63]。电池电量检测电路如图 4-8 所示，因 锂电池最高电压为 4.2V，嵌入式主控模块 STM32 的 ADC 最高采集电压为 3.3V， 所以电路中用 2 个 102K 的电阻分压之后再连接到 ADC 输入口。电池切换电路根 据电池电量检测电路捡到的结果自动切换到当前电池电量高的电池给系统供电。
充电及电池选择电路如图 4-7 所示，电池充电电路选用 TP4054 给锂电池充电， TP4054 充电电压固定为 4.2V，可编程充电电流高达 800mA，充电满时自动终止充 电，待机模式下电流为 45uA。CN3085 可以对单节至四节镍氢电池进行充电管理 充电输出电压 Vbat=1.205*(1+R5/R6)。
稳压电路如图 4-9 所示，稳压电路采用 micrel 公司的 MIC5301，MIC5301 是 一款低压差线性稳压芯片（LDO）其主要特性如下：输入电压范围 2.3V～5.5V， 可以保证 150mA 电流压降只有 40mV，电压精度±2%。
37
万方数据

电子科技大学硕士学位论文

图 4-7 充电及电池切换电路原理图

图 4-8 电池电量检测原理图

图 4-9 稳压电路原理图

4.2.7 嵌入式主控模块
嵌入式主控模块与各模块连接电路如图 4-10 所示，嵌入式主控模块控制器芯 片采用 STM32F103C8T6。该芯片具有 20KB SRAM、64KBFLASH、5 个串口 （UART）、3 个独立的 12 位 ADC、3 个 SPI 及 112 个通用 IO 口。嵌入式主控 STM32 的 UART1、UART3 用作通信端口和生理参数采集模块中的血氧饱和度 CPU、心 电呼吸 CPU 进行通信传输用户指令和数据包接收。主控 STM32 将接收到的血氧 饱和度、心电呼吸数据进行打包压缩通过 UART2 传输给通讯模块[64]。

38

万方数据

第四章 多参数遥测监护系统的设计与实现
图 4-10 嵌入式主控模块电路原理图
4.3 移动监护终端软件设计 4.3.1 系统流程设计
移动监护终端软件及算法开发环境是 Keil uVision4，开发语言是 C 语言。总 体流程图如图 4-11 所示，监护终端开机上电启动后，首先完成各模块硬件初始化 工作，并进行自检（包括 SPI、UART、WiFi 模块、心电呼吸、血氧饱和度模块、 以及外围端口配置）。初始化自检通过心电呼吸模块以及血氧饱和度模块采集数 据，然后根据数据包协议将数据通过串口发送到主控 CPU，主控 CPU 将电池电量、 电极连接状态、患者体态信息、与生理参数数据打包组装通过 WiFi 发送到医院监 护中心，监护中心收到数据包后发送接收成功标志。
4.3.2 通讯协议
移动监护终端通过 WiFi 将数据发送到医院中心监护系统。由于无线通讯与有 线通讯相比有更大的延时和数据丢包率，因此对于数据包协议中各个字段的尺寸、 结构设计、数据包的划分设计、容量及发送频率等，对程序代码性能及通讯性能 具有一定的影响，为了方便软件实现并优化性能，在对数据协议设计时主要遵循 以下几个规范：
1、最小化数据结构尺寸：将可以合并的数据按位合并，以缩短数据包尺寸， 提高通信性能。
2、最小化执行损耗：在兼顾规范 1 的同时，尽量避免将数据分拆为不同的数 据字节，避免发送方和解析方不得不进行数据分拆和组合。
39
万方数据

电子科技大学硕士学位论文
图 4-11 移动监护终端总体流程图
3、最小化通信频率：在满足实时性、网络传输规范和系统资源限制的情况下， 尽量减少数据发送的次数，比如可以累积波形数据，到 500ms 或者 1s 再作为一个 波形数据包进行发送，避免一个波点就发送 1 次之类的情况。
移动监护终端和医院监护中心传输的数据包类型有四种：监护数据、波形数 据、遥测数据、指令数据。具体的数据帧封装格式如图 4-12 所示，其中医院中心 监护站监听的 TCP 端口号为 8800。
40 万方数据

第四章 多参数遥测监护系统的设计与实现
图 4-12 WiFi 数据帧封装图
WiFi 数据帧封装结构简要说明： 1、通信双方在协议解析时，必须确保合格的帧头（Head）和帧尾（End）、数 据包类型（PkgType）及其匹配的数据内容长度（Len）定义，若此四项彼此不完 全匹配，则说明不是合法数据帧。 2、通过数据包类型（PkgType）来标识数据帧中的数据类型： 0x01：监护数据；数据长度为 23Bytes，包括心率值、脉搏值、RR 间期等心 电特征参数，以及预留一些心律失常类型，数据流量一秒 1 个。 0x02：波形数据；数据长度为 96Bytes，数据包内容依次是导联 I（25Bytes） 导联 II（25Bytes）、导联 V（25Bytes）、SPO2（10Bytes）、RESP（10Bytes），一个 标志字节（用于表示 R 波标志、以及脉搏标志），数据流量一秒 5 个。 0x60：遥测数据；数据长度为 8Bytes，包括跌倒状态、电池电量、6 个字节的 MAC 地址，数据流量一秒 1 个。 0x10：医院中央站设置指令；数据长度为 5Bytes，包括切换 ECG 增益、ECG 滤波方式、呼吸增益、ECG 导联，用于与移动监护终端交互。 0x20：通讯心跳包；数据长度为 1Bytes，用于医院中心监护系统判断通信的
41 万方数据

电子科技大学硕士学位论文
稳定性，当移动监护终端接收到一个心跳包时通过相应的指示灯提示与中央站通 信正常情况。
尽管 TCP 协议支持长时间激活通信链路，但仍然存在通信链路中断而发送方 未获得通知的情况，此情况可能导致发送方出现数据积压并最终导致耗尽资源而 崩溃。本系统增加带外链路检测协议，以便确定通信双方链路是否仍保持畅通。 协议规范如下，移动监护终端每隔 10 分钟发送一个带外字节“C”，等待医院监护 中央站返回响应“R”，若在 10 秒钟内没有响应，则将该 TCP 链路视为中断。移动 监护终端可主动关闭链路，并根据需要进行后续处理，如重新发起 TCP 呼叫等。
4.4 医院监护中心软件设计
本系统中另外一个重要组成部分就是医院监护中心系统。该系统的开发和设 计并不是由本人完成，但是为了介绍系统的完整性以及配合后续移动监护终端的 测试，在此主要介绍该系统的基本功能，对具体设计细节不进行阐述。监护中心 系统可实现同时对病区内 64 位患者进行连续心电、呼吸、血氧饱和度检测，在出 现危机症状或意外跌倒时，将自动发出告警并定位患者所在的区域位置。监护中 心软件只对移动监护终端发送的数据进行实时显示和存储，生理参数特征识别算 法在各自的主控芯片里进行。监护中心软件功能见下章的测试图。
4.5 本章小节
本章首先从临床背景需求出发进行分析，提出了系统在功能和性能上的需求， 对移动式生理多参数遥测系统进行了总体设计，然后给出了移动监护终端硬件设 计框图以及各个模块的设计原理和电路实现，最后给出了移动监护终端的软件流 程设计以及与中央站的通讯协议。
42
万方数据

第五章 多参数遥测监护系统的测试与分析
第五章 多参数遥测监护系统的测试与分析
5.1 移动监护终端实物
如图 5-1 所示展示了本课题研制的移动监护终端装置实物图，包括心电导联线 和电极、指夹式血氧饱和度探头。为了方便携带，本系统采用通用的工模作为移 动监护终端的外壳，外壳尺寸 25*70*135（高*宽*长 mm）。移动监护终端内部结 构图如图 5-2 所示。
5.2 功耗测试
为了测量移动监护终端的功耗情况，在供电电源的一端串联一个阻值为 1.2 欧 姆的电阻，通过示波器测量电阻两端的电压，进而得出相应模块的工作电流。按 照之前的统计资料，最大耗电模块集中在通信模块、心电呼吸采集模块、以及血 氧饱和度模块，因此我们首先测量在心电呼吸模块工作下系统的工作电流，进而 加上血氧饱和度模块系统总体的工作电流。

万方数据

图 5-1 本课题研制的移动监护终端实物图
43

电子科技大学硕士学位论文

图 5-2 本课题研制的移动监护终端内部结构图。 （a）正面图；（b）背面图

电流工作情况如图 5-3 所示，如图 5-3（a）所示，测得心电呼吸模块（不包括 通讯和血氧模块）电流 85mA；WiFi 通讯模块未发送数据时，每隔 100ms 出现一 个脉宽 4ms 幅值为 60mV 的脉冲表示与中央站正常连接，每隔 4 秒钟 WiFi 模块发 送一次数据帧平均电压为 56mV，脉宽为 340ms，因此可得到 WiFi 通讯模块的平 均工作电流为 9.2mA；从图 5-3 中（a）和（b）图可得到血氧模块的工作平均电流 为 40mA；所有模块全部工作时平均电流为 135mA，待机电流 5mA。各个模块工 作电流数据如表 5-1 所示，以锂电池容量为 6000mAH、镍氢电池为 3000mAH 和 充放电效率为 75%计算，充满电可使心电模块连续工作大约为 72 个小时，全参数 工作 48 小时。

工作模块 心电呼吸模块
WiFi 通信模块 血氧饱和度模块
总体 待机电流

表 5-1 工作电流测试 工作电压典型值/V 3.3 3.3 3.3 3.3

平均电流消耗/mA 85
9.2
40 135 5

44

万方数据

第五章 多参数遥测监护系统的测试与分析
（a）
（b） 图 5-3 移动监护终端工作时电流波形。（a）未接血氧模块时电流波形；（b）所有模
块工作时系统的电流波形
45 万方数据

电子科技大学硕士学位论文
5.3 系统功能测试
移动监护终端按照功能可分为：通讯及定位模块、生理参数采集模块、跌倒 检测模块、声光报警模块。下面根据系统的设计对各个模块的功能进行测试。
5.3.1 WiFi 通讯模块测试
移动监护终端 WiFi 模块有二个工作模式：AP 模式和 STA 模式。AP 模式即无 线接入点，当 WiFi 模块配置在此模式时，可通过电脑或者手机的浏览器网页快速 配置移动监护终端的 WiFi 模块参数；STA 模式即无线站点，该模式下根据其应用 场景的不同，有 4 个子模式：TCP 服务器、TCP 客户端、UDP 服务器、UDP 客户 端。本系统中移动监护终端配置为 TCP 客户端模式，在该模式下移动监护终端可 以向指定的 IP 地址和端口发送数据。如图 5-4 所示为电脑连接到移动监护终端后 通过网页配置移动监护终端实际工作模式参数信息，其中服务器地址是医院监护 中心电脑的 IP 地址，监听端口号为 8800。配置好移动监护终端通讯参数后，通过 TCP 测试工具查看服务器端接收到来自移动监护终端 WiFi 传输的数据，其数据信 息如图 5-5 所示。
图 5-4 移动监护终端 WiFi 模块配置。（a）WiFi 工作模式配置；（b）串口参数设置
46 万方数据

第五章 多参数遥测监护系统的测试与分析 图 5-5 TCP 测试工具接收到的数据

万方数据

图 5-6 生理参数真人现场测试图
47

电子科技大学硕士学位论文
5.3.2 生理参数模块测试
移动监护终端可以监护 7 通道心电波形、心率、血氧饱和度波形、脉搏值、 血氧饱和度值、呼吸波形和呼吸率。如图 5-6 所示为生理参数真人现场测试图，图 5-6 右边是医院监护中心软件显示的波形。
5.3.3 定位功能测试
无线局域网络布局如图 5-7 所示，定位实验测试地点为电子科技大学物电楼 5 楼区域，首先在 4 个实验室以及洗手间布置了 5 个无线 AP 路由器，其中本人所在 的实验室 506 中的 AP1 为图 5-7 中的主路由器，其他四个位置为中继（repeater） 路由器 AP2～AP5。5 个移动监护终端作为数据采集点，测试中由模拟病人随身携 带在图 5-7 中 WiFi 覆盖的区域内自由活动。医院中心监护中央站显示的定位结果 如图 5-8 和 5-9 所示。
通过对比模拟病人实际移动过程中的位置和医院监护中心软件实时显示的位 置（图 5-8、5-9）可得到以下结论：移动终端中 WiFi 模块每 4 秒通过 AT 指令获 取其附近信号最强的 AP 的 MAC 和其他数据一起打包发送给医院监护中心软件， 监护中心软件对其中的数据包进行解析提取其中的位置信息，因此监护中心软件 实时显示的位置有 4 秒的延迟；此外实际 AP 信号的辐射区域近似一个球形，当移 动监护终端在两个 AP 中间强度相等的位置医院监护中心软件上显示的位置会变 化。

万方数据

图 5-7 无线局域网络布局测试示意图
48

第五章 多参数遥测监护系统的测试与分析
图 5-8 医院监护中心软件的定位结果
图 5-9 医院监护中心软件的定位结果
5.3.4 告警功能测试
目前医院监护中心支持移动监护终端告警的几种情况为：电池电量低、导联 脱落、患者主动按键呼叫、病人跌倒、HR（心率）过高、HR 过低。医院监护中 心告警图如图 5-10 所示，其中各种心率的心电波形采用铭昇公司的 SKX-2000D 心 电信号模拟器来产生，心率的检测通过第三章的 QRS 检测算法来实现。
49 万方数据

电子科技大学硕士学位论文
图 5-10 医院监护中心告警图
5.4 本章小结
本章主要对多参数遥测监护系统的测试过程进行了详细的阐述，包括功耗测 试、以及系统的各个功能测试，测试结果均满足预期的功能和设计目标。
50 万方数据

第六章 总结与展望
第六章 总结与展望
6.1 全文总结
本文提出的课题为心电波形多参数特征提取方法及其应用系统开发。基于该 课题，主要完成了以下的工作：
1、对比心电信号中各类噪声常用的去噪方法后，针对移动式心电监护设备， 本文提出的中值滤波、带通滤波器能很好的抑制心电信号采集中遇到的基线漂移、 肌电干扰等噪声。
2、针对心电信号中 QRS 波群的特征提取，本文从经典的差分阈值法入手， 对其核心的差分函数和检测规则做了改进，并在 MIT-BIH 数据库中对算法进行了 测试和评估，灵敏度和准确度分别达到了 99.57%和 99.80%，较以往算法有所提高。
3、开发了一套移动式生理多参数遥测监护系统。对移动监护终端中各个模块 的硬件电路、硬件开发部分及软件实现做了详细的介绍和设计。
4、完成了移动监护终端软件设计以及心电特征提取算法的移植。能够实现 7 通道心电、呼吸、血氧数据的采集，并能够将数据通过 WiFi 通讯模块实时地发送 到医院监护中心，并当患者出现危机状况时（例如心动过速、心动过缓）自动发 出告警。通过医院中心监护系统可以对患者的位置进行实时定位、并能对患者的 生理参数进行存储和历史回顾。
开发一套完整的生理参数监护系统并非一件容易的事情，前期需要做大量的 临床调研以及用户的需求分析，确定好设计方案。在系统开发阶段涉及到对各个 模块电路进行精心设计和软件程序的编写，期间需要查阅大量的技术文档以及学 习相关的理论知识，对系统进行不断的调试和优化，总结经验和教训。最终在老 师和实验室各位同学的指导和协助下，才得以完成。
6.2 后续工作展望
本课题所研制的移动式生理多参数监护遥测监护系统，虽然完成了预期的功 能，但仍旧有很多不足值得深化改进，主要表现在以下方面：
1、大量的临床试验。医疗设备要应用于市场，需要经过大量的临床试验和专 业的医疗检测机构的认证以及专业的模具封装。因时间和条件的限制，本文仅对 多参数遥测监护系统做了初期功能测试，后续还需要做大量的临床测试和检验并 进行不断优化和改进。
51
万方数据

电子科技大学硕士学位论文
2、增强心电监护中自动分析算法。可在已有的系统基础上，进一步开发更小 型化、更低功耗、具有多种高级功能的移动监护终端以及与目前的数据挖掘、云 计算技术相结合的 ECG 自动分析算法，进一步提高系统的智能化水平，使系统从 监护级向诊断级设备发展。
3、定位算法的优化。目前系统中定位原理是根据终端连接已知位置的 AP 来 确定患者的位置，在多个 AP 信号强度相差不大的时候无法给出准确的位置，可通 过增加目前有文献报告的基于三角形和位置指纹识别算法的 WiFi 定位方法来提高 定位的精度。
4、增加 4G 通讯模块。目前终端和中央站采用 WiFi 进行通信，因此患者只能 在有 WiFi 覆盖的地方才能使用监护系统，下一步可以增加 4G 通讯的终端，为患 者提供随时随地的监护。
52 万方数据

致谢
致谢
时光飞逝，一转眼，三年的研究生生活就要结束了，回顾这三年的点点滴滴， 我的学习生活过的充实而快乐。虽然在开展研究工作的时候会遇到瓶颈，但是在 解决问题的思考过程中深深的体会到了宁静耐心求索的那份乐趣。回首这几年的 求学历程，对那些引导我、帮助我、激励我的人，我心中充满了感激。学识渊博 的导师、严谨求学的同门、乐于助人的室友，都是我研究生期间最美好的回忆。 每当遇到项目上、生活上的困难时，正是由于这些人的帮助和鼓励，才使得我攻 克了一个个的难题，让这三年过得没有遗憾。
借此机会，我想特别对我的导师赖大坤副教授提出感谢。从研一刚开始进入 教研室，导师就以其严谨的治学态度深深的感染着我，尽管刚开始接触心电这个 领域的时候，很多的专业知识都从未涉及过，但是导师的鼓励和帮助使得我从未 退缩，从最初的开题报告撰写时候的疑惑不安，到后面心电数据处理、论文撰写 时的运用自如，直到最终定稿编制时的成竹在胸，这些都离不开赖老师的细心指 导，赖老师在每个过程中总能给出专业的实质性建议。
同时，对于我研究生期间在心电领域的快速成长，我要特别对我教研室的师 兄张飞、徐琦提出感谢。在科研过程中遇到不顺利的时候，他们都会与我交流， 让我可以快速抓住相关的专业知识，避免走过多的弯路。还要感谢同门毛亮、张 欢欢，以及教研室的师弟师妹们，在项目上给了我很多宝贵的建议，在生活上给 了我莫大的帮助。感谢我的朋友，在我科研烦心的时候，一直陪伴鼓励着我，这 里就不再一一提名。
最后，我要感谢我的家人，他们无微不至的关怀和理解永远是我背后最强大 的后盾！我将在今后的生活工作中加倍努力，取得更多的成果来回报他们、回报 社会。
53
万方数据

电子科技大学硕士学位论文
参考文献
[1] World Health Organization. Cardiovascular diseases Fact Sheet no 317. WHO[EB/OL]. http://www.who.int/mediacentre/factsheets/fs317/en/, May, 2017
[2] M. Nichols, N. Townsend, P. Scarborough, et al. Cardiovascular disease in Europe: epidemiological update.[J]. European Heart Journal, 2016, 36(42):2696
[3] 陈伟伟. 中国心血管病报告 2015[J]. 中华医学信息导报, 2016 (12): 11-11 [4] M. O. Al Chekakie. Traditional Heart Failure Medications and Sudden Cardiac Death
Prevention A Review[J]. Journal of cardiovascular pharmacology and therapeutics, 2013, 18(5): 412-426 [5] Z. J. Zheng, J. B. Croft, W. H. Giles, et al. Sudden cardiac death in the United States, 1989 to 1998[J]. Circulation, 2001, 104(18): 2158-2163 [6] 田凤祥, 潘惟丽, 陈凯, 等. 心源性猝死心电预测和综合防治研究进展[J]. 现代生物医学 进展, 2013 (20): 3993-3996 [7] 方丕华, 李晓枫. 心电图对心脏性猝死的预警价值[J]. 中华实用诊断与治疗杂志, 2010, 24(6): 525-528 [8] A. B. de Luna, P. Coumel, J. F. Leclercq. Ambulatory sudden cardiac death: mechanisms of production of fatal arrhythmia on the basis of data from 157 cases[J]. American heart journal, 1989, 117(1): 151-159 [9] B. D. Nearing, R. L. Verrier. Modified moving average analysis of T-wave alternans to predict ventricular fibrillation with high accuracy[J]. Journal of Applied Physiology, 2002, 92(2): 541-549 [10] A. L. Aro, H. V. Huikuri, J. T. Tikkanen, et al. QRS-T angle as a predictor of sudden cardiac death in a middle-aged general population[J]. Europace, 2012, 14(6): 872-876 [11] M T. La Rovere, G D. Pinna, R. Maestri, et al. Short-term heart rate variability strongly predicts sudden cardiac death in chronic heart failure patients[J]. circulation, 2003, 107(4): 565-570. [12] 邓亲恺. 论医学模式的变革与医学仪器未来走势[J]. 中国医学物理学杂志, 2003, 1 [13] 王保华. 心电技术面向未来——纪念心电图机发明 100 周年[J]. 中国医疗器械杂志, 2003, 27(6): 390-391 [14] N. J. Wimmer, B. M. Scirica, P. H. Stone. The clinical significance of continuous ECG (ambulatory ECG or Holter) monitoring of the ST-segment to evaluate ischemia: a review[J]. Progress in cardiovascular diseases, 2013, 56(2): 195-202
54
万方数据

参考文献
[15] R. Warlar, C. Eswaran. Integer coefficient bandpass filter for the simultaneous removal of baseline wander, 50 and 100 Hz interference from the ECG[J]. Medical and Biological Engineering and Computing, 1991, 29(3): 333-336
[16] N. V. Thakor, Y. S. Zhu. Applications of adaptive filtering to ECG analysis: noise cancellation and arrhythmia detection[J]. IEEE transactions on biomedical engineering, 1991, 38(8): 785-794
[17] 汪家旺, 吴玲燕, 杨涛, 等. 几种去心电基线漂移算法的实现和比较[J]. 中国医疗器械信 息, 2008, 14(6): 30-33
[18] M. Blanco-Velasco, B. Weng, K. E. Barner. ECG signal denoising and baseline wander correction based on the empirical mode decomposition[J]. Computers in biology and medicine, 2008, 38(1): 1-13
[19] 李小燕, 王涛. 基于小波变换的自适应滤波器消除 ECG 中基线漂移[J]. 中国科学技术大 学学报, 2000, 30(4): 450-454
[20] G. M. Friesen, T. C. Jannett, Jadallah M A, et al. A comparison of the noise sensitivity of nine QRS detection algorithms[J]. IEEE Transactions on biomedical engineering, 1990, 37(1): 85-98
[21] C. Li, C. Zheng, C. Tai. Detection of ECG characteristic points using wavelet transforms[J]. IEEE Transactions on biomedical Engineering, 1995, 42(1): 21-28
[22] Z. E. H. Slimane, Naït-Ali A. QRS complex detection using Empirical Mode Decomposition[J]. Digital Signal Processing, 2010, 20(4): 1221-1228
[23] P. E. Trahanias. An approach to QRS complex detection using mathematical morphology[J]. IEEE Transactions on Biomedical Engineering, 1993, 40(2): 201-205
[24] 王如想. 心律失常自动识别算法的研究[D]. 山东大学, 2013, 5-7 [25] M. G. Tsipouras, D. I. Fotiadis, D. Sideris. An arrhythmia classification system based on the
RR-interval signal[J]. Artificial intelligence in medicine, 2005, 33(3): 237-250 [26] P. De Chazal, M. O'Dwyer, R. B. Reilly. Automatic classification of heartbeats using ECG
morphology and heartbeat interval features[J]. IEEE Transactions on Biomedical Engineering, 2004, 51(7): 1196-1206 [27] R. J. Martis, U. R. Acharya, L. C. Min. ECG beat classification using PCA, LDA, ICA and discrete wavelet transform[J]. Biomedical Signal Processing and Control, 2013, 8(5): 437-448 [28] F. Melgani, Y. Bazi. Classification of electrocardiogram signals with support vector machines and particle swarm optimization[J]. IEEE transactions on information technology in biomedicine, 2008, 12(5): 667-677 [29] 余承高. 心脏电生理学基础与临床[M]. 武汉:华中科技大学出版社, 2008. 144-189
55
万方数据

电子科技大学硕士学位论文
[30] B. Hille. Ionic channels of excitable membranes, 3rd ed[M]. Sunderland MA.: Sinauer Associates, Inc., 2001: 102-108
[31] J. Malmivuo, R. Plonsey. Bioelectromagnetism: principles and applications of bioelectric and biomagnetic fields[M]. Oxford: Oxford University Press, 1995. 185:192
[32] 苏静怡. 心脏从基础到临床[M]. 北京:北京医科大学, 1999. 198-221 [33] O. Costantini, C. Drabek, D. S. Rosenbaum. Can sudden cardiac death be predicted from the T
wave of the ECG? A critical examination of T wave alternans and QT interval dispersion[J]. Pacing and Clinical Electrophysiology, 2000, 23(9): 1407-1416 [34] R. E. Mason, I. Likar. A new system of multiple-lead exercise electrocardiography[J]. American heart journal, 1966, 71(2): 196-205 [35] B. J. Drew, R. M. Califf, M. Funk, et al. Practice standards for electrocardiographic monitoring in hospital settings[J]. Circulation, 2004, 110(17): 2721-2746 [36] M. W. Krucoff, K. A. Loeffler, W. K. Haisty, et al. Simultaneous ST-segment measurements using standard and monitoring-compatible torso limb lead placements at rest and during coronary occlusion[J]. The American journal of cardiology, 1994, 74(10): 997-1001 [37] H. S. Bush, J. J. Ferguson, P. Angelini, et al. Twelve-lead electrocardiographic evaluation of ischemia during percutaneous transluminal coronary angioplasty and its correlation with acute reocclusion[J]. American heart journal, 1991, 121(6): 1591-1599 [38] B. J. Drew, L. A. Tisdale. ST segment monitoring for coronary artery reocclusion following thrombolytic therapy and coronary angioplasty: identification of optimal bedside monitoring leads[J]. American Journal of Critical Care, 1993, 2(4): 280-292 [39] G. B. Moody, R. G. Mark. The impact of the MIT-BIH arrhythmia database[J]. IEEE Engineering in Medicine and Biology Magazine, 2001, 20(3): 45-50 [40] 宋喜国, 邓亲恺. MIT-BIH 心率失常数据库的识读及应用[J]. 中国医学物理学杂志, 2004, 21(4): 230-232 [41] 涂岳文. Holter 系统中运动伪差自动识别的关键技术及算法研究[D]. 杭州: 浙江大学, 2013, 25:31 [42] 郑捷文. 可穿戴实时诊断, 报警, 移动健康监护系统[D]. 北京: 中国人民解放军军事医学 科学院, 2008, 10:33 [43] G. B. Moody, W. Muldrow, R. G. Mark. A noise stress test for arrhythmia detectors[J]. Computers in cardiology, 1984, 11(3): 381-384 [44] 曹细武, 邓亲恺. 心电图各波的频率分析[J]. 中国医学物理学杂志, 2001, 18(1): 46-48
56
万方数据

参考文献
[45] 何伟, 陈良迟. 心电信号及各组分的频率分布和有效带宽研究[J]. 生物医学工程学杂志, 1996, 13(4): 336-340
[46] N. V. Thakor, J. G. Webster, W. J. Tompkins. Estimation of QRS complex power spectra for design of a QRS filter[J]. IEEE Transactions on biomedical engineering, 1984 (11): 702-706
[47] 翁羽洁, 丁勇, 孙立艳, 等. 一种基于提升小波和中值滤波的心电去噪方法[J]. 北京生物 醫學工程, 2010, 29(5): 465-469
[48] 朱伟芳, 齐春. 一种实用的去基线漂移滤波算法[J]. 苏州大学学报: 工科版, 2006, 26(1): 62-64
[49] 蔡坤, 陆尧胜. 基于中值滤波的心电基线校正方法的研究[J]. 中国医疗设备, 2004 (2): 5-7 [50] R. A. Balda, G. Diller, E. Deardorff, et al. The HP ECG analysis program[J]. Trends in
computer-processed electrocardiograms, 1977: 197-205 [51] J. Pan, W. J. Tompkins. A real-time QRS detection algorithm[J]. IEEE transactions on
biomedical engineering, 1985 (3): 230-236 [52] B. U. Kohler, C. Hennig, R. Orglmeister. The principles of software QRS detection[J]. IEEE
Engineering in Medicine and Biology Magazine, 2002, 21(1): 42-57 [53] S. Pal, M. Mitra. Detection of ECG characteristic points using multiresolution wavelet analysis
based selective coefficient method[J]. Measurement, 2010, 43(2): 255-261 [54] W. J. Youden. Index for rating diagnostic tests[J]. Cancer, 1950, 3(1): 32-35 [55] 李翠微, 郑崇勋. ECG 信号的小波变换检测方法[J]. 中国生物医学工程学报, 1995, 14(1):
59-66 [56] J. Alihanka, K. Vaahtoranta, I. Saarikivi. A new method for long-term monitoring of the
ballistocardiogram, heart rate, and respiration[J]. American Journal of Physiology-Regulatory, Integrative and Comparative Physiology, 1981, 240(5): R384-R392 [57] 何庆华, 吴宝明. 热敏法呼吸频率监测电路设计[J]. 医疗卫生装备, 1999, 20(5): 13-14 [58] K. P. Cohen, D. Panescu, J. H. Booske, et al. Design of an inductive plethysmograph for ventilation measurement[J]. Physiological measurement, 1994, 15(2): 217
[59] 赖大坤，谢春柳，徐琦. 一种多参数自动预警和快速定位响应的遥测监护方法及系统[P].
中国，发明专利，201510609571.X，2015 年 9 月 22 日 [60] http://www.usr.cn/Product/122.html, Feb 10, 2015 [61] M. Mubashir, L. Shao, L. Seed. A survey on fall detection: Principles and approaches[J].
Neurocomputing, 2013, 100: 144-152
[62] 秦瑀阳. 老年人跌倒检测报警装置的研究与设计[D]. 大连: 大连海事大学, 2013, 19-26
57
万方数据

电子科技大学硕士学位论文 [63] F. Hoffart. Proper care extends Li-ion battery life[J]. Power Electronics Technology, 2008,
34(4): 24 [64] Y. Wei, X. Yiping. LCD display system design based on MCU STM32F103C8T6[J].
Microcomputer & Its Applications, 2014, 33(20): 29-31.
58 万方数据

攻读硕士学位期间取得的成果
攻读硕士学位期间取得的成果
[1] 赖大坤，谢春柳，徐琦. 一种多参数自动预警和快速定位响应的遥测监护方法及系统[P].
中国，发明专利，201510609571.X，2015 年 9 月 22 日 [2] Huanhuan Zhang, Dakun Lai, Chunliu Xie, et al. Directed-transfer-function based analysis for
epileptic prediction[C]//Image and Signal Processing, BioMedical Engineering and Informatics (CISP-BMEI), International Congress on. IEEE, 2016: 1487-1491 [3] Liang Mao, Dakun Lai*, Qi Xu, and Chunliu Xie. Photoacoustic Imaging: A Potential New Tool for Diagnosing Vasculogenic Erectile Dysfunction[C]. 9th International Congress on Image and Signal Processing, BioMedical Engineering and Informatics (CISP-BMEI), 2016, 1365 – 1369
59 万方数据

