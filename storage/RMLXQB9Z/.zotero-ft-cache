Signal Processing Methods for
Heart Rate Variability
Gari D. Clifford St. Cross College Supervised by Prof. L. Tarassenko Michaelmas Term, 2002
This thesis is submitted to the Department of Engineering Science, University of Oxford, in fulﬁlment of the requirements for the degree of
Doctor of Philosophy. This thesis is entirely my own work, and except where otherwise stated, describes my own research.

Signal Processing Methods For Heart Rate Variability Analysis
Gari D. Clifford St Cross College Doctor of Philosophy
Michaelmas term 2002

Heart rate variability (HRV), the changes in the beat-to-beat heart rate calculated from the electrocar-

diogram (ECG), is a key indicator of an individual’s cardiovascular condition. Assessment of HRV has

been shown to aid clinical diagnosis and intervention strategies. However, the variety of HRV estima-

tion methods and contradictory reports in this ﬁeld indicate that there is a need for a more rigorous

investigation of these methods as aids to clinical evaluation. This thesis investigates the development of

appropriate HRV signal processing techniques in the context of pilot studies in two ﬁelds of potential

application, sleep and head-up tilting (HUT).

A novel method for characterising normality in the ECG using both timing information and morpho-

logical characteristics is presented. A neural network, used to learn the beat-to-beat variations in ECG

waveform morphology, is shown to provide a highly sensitive technique for identifying normal beats.

Fast Fourier Transform (FFT) based frequency-domain HRV techniques, which require re-sampling

of the inherently unevenly sampled heart beat time-series (RR tachogram) to produce an evenly sampled

time series, are then explored using a new method for producing an artiﬁcial RR tachogram. Re-sampling

is shown to produce a signiﬁcant error in the estimation of an (entirely speciﬁed) artiﬁcial RR tachogram.

The Lomb periodogram, a method which requires no re-sampling and is applicable to the unevenly

sampled superior

tnoatthuereFoFfTthfoerseigvnalaulaitsinignvHesRtVigamteeda.suErexdpebryimtheentsÀÄ

demonstrate that -ratio, a ratio of

the the

Lomb low to

periodogram is high frequency

power in the RR tachogram within a speciﬁed band (0.04–0.4Hz). The effect of adding artiﬁcial ectopic

beats in the RR tachogram is then considered and it is shown that ectopic beats signiﬁcantly alter the

spectrum and therefore must be removed or replaced. Replacing ectopic beats by phantom beats is

rcleaovtmieolpsuaornefddeerctottohtpheyes.ecTacshoeendoLifotiemocntbosppaiecnr-diroediasoltgaerdaromRbRuissitnsmhteoerwvthanol dtroemfpororovmvailedfaeosraurtsihnieggnFitFﬁhTceaanÀÄntldy-LrbaoetimtotebrinmestehttiehmopadrtseesfoeofnrctvheaeroyÀÄfin(ga-
possibly unknown number of) ectopic beats or artefacts.

The Lomb periodogram and FFT-based techniques are applied to a database of sleep apn ic and

normal effects

subjects. on HRV

A of

new method of assessing HRV during sleep changes due to changing mental activity.

is proposed Estimation

to of

mÀÄin-irmatiisoe

the confounding using the Lomb

technique is shown to separate these two patient groups more effectively than with FFT-based techniques.

Results are also presented for the application of these methods to controlled (HUT) studies on subjects

with syncope, an autonomic nervous system problem, which indicate that the techniques developed in

this thesis may provide a method for differentiating between sub-classes of syncope.

2

Acknowledgements
Firstly I would like to thank the SPANN research group; Lionel Tarassenko for support, guidance, freedom and a wonderful working environment, Neil for unending tolerance, support and suggestions, Patrick for diversionary research and a wealth of mathematics, Mayela for saving my plants from neglect and a thousand helpful computing hints, Dileepan, Tim, Simukai Paul and Stephen for many insightful discussions, Rich and Sunay for the jokes and evening ‘research’, Laura for advice and banter, Al ‘n’ Al for sustenance, Nick for taking the coffee club on and all the others for helping me along. I’d also like to thank Professors Noble and Murray for their helpful comments.
Roy Jackson, Adam Fullerton, and Alex Niarac saved me from my hardware nightmares, for that I am in their debt.
On the clinical side I’d like to thank Janet for support and emails, James Price for an invaluable medical perspective and all the clinical team at the JRH and RI.
On the funding side of things I’d like to thank Oxford Instruments (in particular James Pardey for lifts, cold mornings, papers, databases, and relieving me of my car stereo) as well as Oxford BioSignals Ltd. and all the crew there for tools, data, and the funding to make it all possible.
Not only is it an honour to work in such a wonderful place, it’s a privilege to live here too. So many people have enriched my life here I am surely blessed to have met you all. Please forgive me if I’ve forgotten to thank you... the list is too long!
Finally, and most of all I’d like to thank my family for being so supportive and patient, David and Jo for long nights of wit and music (without whom I would have surely become a mad hermit) and most of all to Rachel, for supporting me in the ﬁnal push and making everything worth it.
Thankyou!
3

Contents

1 Introduction

1

1.1 Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1

1.2 Identifying the problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2

1.3 Physiology of the human heart . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2

1.3.1 ECG waveform generation and recording . . . . . . . . . . . . . . . . . . . . . 4

1.3.2 Lead conﬁgurations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5

1.3.3 Heart disease . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7

1.4 Abnormalities in the ECG - ectopic beats . . . . . . . . . . . . . . . . . . . . . . . . . 7

1.5 The physiology of beat-to-beat heart rate control and HRV . . . . . . . . . . . . . . . . 8

1.5.1 The autonomic nervous system and the sympathovagal balance . . . . . . . . . . 9

1.5.2 Reﬂexes controlling heart rate and its variability . . . . . . . . . . . . . . . . . 13

1.5.3 Factors inﬂuencing heart rate and its variability . . . . . . . . . . . . . . . . . . 14

1.5.4 HR and HRV correlation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

1.6 Quantifying HRV . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

1.6.1 HRV metrics from the RR tachogram . . . . . . . . . . . . . . . . . . . . . . . 19

1.6.2 Selected time domain measures of HRV . . . . . . . . . . . . . . . . . . . . . . 20

1.6.3 Scale-independent measures of HRV . . . . . . . . . . . . . . . . . . . . . . . . 21

1.6.4 Components in the frequency domain . . . . . . . . . . . . . . . . . . . . . . . 24

1.7 The cardiovascular respiratory system - parameters and models . . . . . . . . . . . . . . 29

1.7.1 Baroreﬂex sensitivity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

1.7.2 The connection between HR, HRV, BP and respiration - a possible mechanism . 30

1.7.3 The DeBoer model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

1.7.4 Data-driven models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34

1.8 The clinical utility of Heart Rate Variability . . . . . . . . . . . . . . . . . . . . . . . . 34

1.8.1 ATRAMI trials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

1.8.2 Standardisation and clinical community recommendations . . . . . . . . . . . . 35

1.8.3 Standard terminology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

1.8.4 Measurement standards . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

1.8.5 Physiological and pathophysiological correlates . . . . . . . . . . . . . . . . . . 38

1.8.6 Commercial manufacturers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39

1.8.7 Appropriate clinical applications . . . . . . . . . . . . . . . . . . . . . . . . . . 39

1.8.8 Future research areas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41

1.9 The problem of HRV measurement and repeatability . . . . . . . . . . . . . . . . . . . 42

1.10 Overview of thesis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43

2 QRS detection

46

2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46

2.2 QRS detection algorithms - overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47

2.2.1 Available data — the MIT-BIH database . . . . . . . . . . . . . . . . . . . . . . 49

i

2.3 The Hamilton and Tompkins QRS detector . . . . . . . . . . . . . . . . . . . . . . . . . 52 2.3.1 Detection of QRS complexes: Implementation of the Hamilton and Tompkins method. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54 2.3.2 Comparison of performance on MIT normal data . . . . . . . . . . . . . . . . . 59 2.3.3 Discussion of results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
2.4 Conclusion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

3 Abnormal Beat Detection in the ECG

66

3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66

3.2 Pre-processing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

3.2.1 Ectopic rejection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

3.2.2 Artefact rejection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68

3.2.3 Robust methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

3.3 Using morphological information to identify normal QRS complexes . . . . . . . . . . . 70

3.3.1 Template matching for the detection of ectopic beats . . . . . . . . . . . . . . . 70

3.3.2 Neural Network for ECG analysis . . . . . . . . . . . . . . . . . . . . . . . . . 75

3.3.3 The multi-layered perceptron . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76

3.3.4 Auto-associative networks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78

3.3.5 Structure of auto-associative network for QRS reproduction. . . . . . . . . . . . 79

3.3.6 Principal Component Analysis for architecture deﬁnition . . . . . . . . . . . . . 82

3.3.7 Training the auto-associative network . . . . . . . . . . . . . . . . . . . . . . . 82

3.3.8 QRS classiﬁcation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86

3.3.9 Pruning the training set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90

3.3.10 Size of training set and training time. . . . . . . . . . . . . . . . . . . . . . . . 90

3.3.11 VEB detection performance. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91

3.3.12 Initialisation with PCA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93

3.3.13 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96

3.4 Using timing information to identify artefact and abnormal beats . . . . . . . . . . . . . 97

3.4.1 Distribution of artefacts and ectopic beats . . . . . . . . . . . . . . . . . . . . . 98

3.4.2 Data fusion algorithms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

3.4.3 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101

4 HRV experiments using spectral techniques

102

4.1 Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102

4.1.1 The RR tachogram - an unevenly sampled time series . . . . . . . . . . . . . . . 102

4.1.2 FFT methods compared to AR methods . . . . . . . . . . . . . . . . . . . . . . 103

4.1.3 Re-sampling to enable spectral estimation . . . . . . . . . . . . . . . . . . . . . 104

4.1.4 PSD estimation without re-sampling - the Lomb periodogram . . . . . . . . . . 105

4.2 From FFTs to the Lomb method - PSD estimation . . . . . . . . . . . . . . . . . . . . . 105

4.2.1 The Discrete Fourier Transform . . . . . . . . . . . . . . . . . . . . . . . . . . 106

4.2.2 Generalising the DFT - PSD estimation via the Lomb periodogram . . . . . . . . 107

4.3 Practical considerations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111

4.3.1 Window size . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111

4.3.2 Sampling frequency . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112

4.3.3 Pre-processing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112

4.3.4 Performance metrics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112

4.4 Generating artiﬁcial data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113

4.4.1 A simple model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113

4.4.2 Spectral estimation of artiﬁcial RR time series . . . . . . . . . . . . . . . . . . . 116

ii

4.4.3 Frequency variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117 4.4.4 Frequency resolution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119 4.5 Comparison of spectral estimation methods using artiﬁcial data . . . . . . . . . . . . . . 120 4.5.1 Comparison of even and uneven sampling for a single sinusoid . . . . . . . . . . 121 4.5.2 Comparison of even and uneven sampling for LF and HF components . . . . . . 124 4.5.3 Comparison of even and uneven sampling with frequency variation . . . . . . . 128 4.6 Performance of algorithms on artiﬁcial data when coping with ectopy . . . . . . . . . . 130 4.6.1 Previous Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131 4.6.2 Artiﬁcial ectopy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132 4.6.3 Beat replacement and removal: a comparison . . . . . . . . . . . . . . . . . . . 134 4.6.4 Metric performance when removing or replacing ectopic beats . . . . . . . . . . 134 4.6.5 Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135 4.7 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136

5 HRV analysis during sleep

138

5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138

5.2 Physiological control and variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139

5.2.1 The autonomic nervous system . . . . . . . . . . . . . . . . . . . . . . . . . . . 139

5.2.2 Circadian rhythms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140

5.3 Changes in HRV with activity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142

5.4 HRV and sleep . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143

5.4.1 The physiology and classiﬁcation of sleep . . . . . . . . . . . . . . . . . . . . . 143

5.4.2 HRV changes with sleep state . . . . . . . . . . . . . . . . . . . . . . . . . . . 145

5.4.3 Sleep disruption; pain, drugs and noise . . . . . . . . . . . . . . . . . . . . . . 147

5.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147

5.6 Methods for analysing HRV during sleep . . . . . . . . . . . . . . . . . . . . . . . . . . 148

5.6.1 The MIT polysomnographic database . . . . . . . . . . . . . . . . . . . . . . . 148

5.6.2 Preprocessing and artefact rejection . . . . . . . . . . . . . . . . . . . . . . . . 149

5.7 Mathematical analysis of HRV during sleep . . . . . . . . . . . . . . . . . . . . . . . . 151

5.7.1 Mathematical analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151

5.7.2 Results on normal subjects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153

5.7.3 Results on sleep apn ic subjects . . . . . . . . . . . . . . . . . . . . . . . . . . 157

5.7.4 Comparison of PSD estimations methods for separating patients groups using

REM and SWS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 162

5.8 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163

6 HRV: Applicability in controlled studies - Head-up tilts

166

6.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166

6.2 Syncope: Classiﬁcation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167

6.2.1 Neurally mediated syncope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 168

6.2.2 Orthostatic Hypotension . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170

6.2.3 Cardiac arrhythmia/structural heart disease . . . . . . . . . . . . . . . . . . . . 170

6.2.4 Cerebrovascular (steal syndromes) . . . . . . . . . . . . . . . . . . . . . . . . . 171

6.2.5 Controversial classiﬁcations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171

6.3 Syncope: Tests and Diagnosis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171

6.3.1 Head Upright Tilt Table Testing . . . . . . . . . . . . . . . . . . . . . . . . . . 171

6.4 HRV in the context of HUT and syncope . . . . . . . . . . . . . . . . . . . . . . . . . . 172

6.5 HUT data analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174

6.5.1 Methodology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174

iii

6.5.2 Clinical protocol . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174 6.5.3 Description of patients . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175 6.5.4 Signal Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 182 6.6 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 184

7 Summary, conclusions and future work

185

7.1 Summary and key conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185

7.2 Future work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187

7.2.1 Signal processing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187

7.2.2 Clinical studies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 188

A The MIT-BIH database

190

A.1 Appendix: The Annotation Deﬁnitions . . . . . . . . . . . . . . . . . . . . . . . . . . . 190

B Mathematical derivations

192

B.1 Appendix: Derivation of error back-propagation . . . . . . . . . . . . . . . . . . . . . . 192

B.2 Appendix: Karhunen-Loe´ve Transformation . . . . . . . . . . . . . . . . . . . . . . . . 194

C Normal Values of Standard Measures of HRV

196

D Cubic Spline Interpolation

197

E A Simple Illustration of the Lomb Periodogram

199

iv

List of Figures

1.1 Source nodes of electrical stimulation within the heart. . . . . . . . . . . . . . . . . . . 3

1.2 One second of a typical ECG waveform for one heart beat. The vertical axis represents
¦ the mV ﬂuctuations scaled to 1 over the whole record. The horizontal (time) axis shows

the sample number (with a sampling rate of 256 Hz, there are 256 samples in one second). 4

1.3 Electrical vectors for the standard ECG lead conﬁgurations. . . . . . . . . . . . . . . . . 5

¿ 1.4
1.5

10 of the standard electrode positions for 12-lead ECG recording. A Ventricular Ectopic Beat in the middle of a set of normal beats (

Ö.

........... beat from the left)

6

ÀÊ for subject 109 of the MIT-BIH database. . . . . . . . . . . . . . . . . . . . . . . . . . 8
1.6 Instantaneous or beat-to-beat heart rate, ,(lower trace) and RR interval (middle trace)

for a 1 minute segment of ECG (upper trace). . . . . . . . . . . . . . . . . . . . . . . . 9

1.7 Organisation of the autonomic nervous system. The sympathetic system (left) is stimu-

lated by stressful situations, increases HR, cardiac output, blood ﬂow to the muscles and

inhibits digestive activity. Stimulation of the parasympathetic branch of the ANS (right)

leads to increased digestive activity, and depresses BP, HR, cardiac output. Taken from

[70]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
¡ ÀÊ 1.8 Chronotropic RR interval (- -) and (-º-) responses to graded efferent vagal stimu-

lation (from Malik [105]). Note that the increase in RR interval is proportional to the

increase in vagal stimulatory frequency. . . . . . . . . . . . . . . . . . . . . . . . . . . 12
ÀÊ 1.9 Two minutes of ECG, , RR interval and respiration (from upper to lower trace re-

spectively) from a healthy subject exhibiting RSA. Compressions and rarefactions can

clearly be seen in the occurrence of the R-peaks (tall spikes in the ECG). This is re-
¾ ¿ ﬂected in the cyclical changes in the HR and RR interval ( Ò and Ö traces). Note that

the lower trace represents volume changes in the chest; as the subject inhales the trace
¾ rises and the HR ( Ò trace) rises, and when the subject exhales the lower trace falls and

the HR drops. From 120 to 180 seconds the subject is breathing at almost 4 respirations

per minute (rpm). From 180 to 220 seconds the subject was instructed to breathe at about

7 rpm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

1.10 BP and HR proﬁle in a normal subject over a 24-hour period. On the horizontal axis, a

time of 16 means 4pm and a time of 28 means 4am. Taken from [186]. . . . . . . . . . . 18

1.11 Typical FFT of RR intervals over 24hrs. (Taken from [184]). Note that the Meyer waves

are masked by the power spectral dominance of the VLF and ULF contributions . . . . . 25

v

¼ 1.12 AR spectral analysis (model order 12, 10 minute window) of an RR tachogram in a healthy subject at rest and during Ó head-up tilt. At rest, two major components of

similar power are detectable at low frequencies (LF) and high frequencies (HF). During

tilt, the LF component becomes dominant, but as total variance is reduced, the abso-

lute power of LF appears unchanged compared with that at rest. Normalisation leads

to predominant LF and smaller HF components, which express the alteration of spectral

components due to tilt. The pie charts show the relative contributions from each band

together with the absolute power of the two components represented by the area. Taken

from Malik et al., 1996 [184]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

¼ ¼ ¼ ½ 1.13 PSD (linear axes) of RR intervals for ﬁgure 1.6. Note the peaks at

Hz, Hz

¼ ¾ (probably due to BP ﬂuctuations) and one around Hz - a modulation of the RR

tachogram due to respiration. From observation of ﬁgure 1.6 it can be seen that the

subject was indeed breathing at about 16 breaths per minute, or 0.27 Hz. . . . . . . . . . 27

1.14 Schematic digram of the cardiovascular system according to DeBoer [64]. Dashed line

indicates slow sympathetic control. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

2.1 Five stage ﬁlter sequence of Pan and and Tompkin’s QRS detector. . . . . . . . . . . . . 54 2.2 5.5 seconds of MIT-BIH ECG data sampled at a frequency of 128Hz, at each stage of
data processing. The processing delays in each digital ﬁlter have been compensated for. . 55 2.3 Low pass ﬁlter frequency and phase response (dB/Hz and deg/Hz). . . . . . . . . . . . . 58 2.4 High pass ﬁlter frequency and phase response (dB/Hz and deg/Hz). . . . . . . . . . . . . 58 2.5 The time-averaged waveform for two consecutive QRS complexes. The upper threshold
is set at 90% of the peak amplitude of each packet. The point where this intersects the time-averaged waveform deﬁnes the region in the original data in which the algorithm scans back to locate a peak. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59 2.6 Incorrectly labelled ﬁle 114 by algorithm due to noise. . . . . . . . . . . . . . . . . . . 62 2.7 File 114 correctly labelled by clinicians. . . . . . . . . . . . . . . . . . . . . . . . . . . 62 2.8 Low amplitude QRS complexes (in lead II, the upper channel) missed in ﬁle 114. . . . . 63 2.9 Artefacts in ﬁle 203 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63 2.10 File 228 scored by the clinicians . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64 2.11 Missed QRS complexes in ﬁle 228 due to high energy VEBs. . . . . . . . . . . . . . . . 64

3.1 Flow of logic for beat classiﬁcation. If a beat, detected by a conventional QRS detector, has a template correlation value greater than Ñ Ò or an MLP reconstruction error greater
than ÊÅ Ë Ñ Ò, it is classiﬁed as abnormal. Otherwise the beat is labelled as a VEB. . . 72 3.2 From top down: Original ECG waveform, ÊÅ Ë and for a 12 second segment of
ﬁle 109 of the MIT-BIH database. Note the third QRS complex - a VEB - in the original
ECG has a small ÊÅ Ë . The dashed lines are the thresholds ÊÅ Ë Ñ Ò and Ñ Ò. . . 73
3.3 The basic neuron . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76 3.4 Schematic of a 5-3-2 multi-layer perceptron. Bias units and weights are omitted for clarity. 77
3.5 Layout of a -Â- auto-associative neural network. . . . . . . . . . . . . . . . . . . . 79
3.6 A typical ECG waveform sampled at 256Hz. . . . . . . . . . . . . . . . . . . . . . . . . 81 3.7 A typical ECG waveform down-sampled to 64Hz. . . . . . . . . . . . . . . . . . . . . . 81 3.8 Size-ranked set of eigenvectors for a training set. . . . . . . . . . . . . . . . . . . . . . 82 3.9 Mean Square Error during training at the end of each training epoch for ﬁle 109. The
horizontal axis is the number of epochs. . . . . . . . . . . . . . . . . . . . . . . . . . . 84 3.10 Ratio of the variance in the input patterns to that in the output patterns at each epoch for
MIT-BIH ﬁle 109. The horizontal axis is the number of iterations through the data set (epochs). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85

vi

3.11 The average QRS complex in ﬁle 109 over all of the training set. Note that this vector represents a one second time interval since the signal has been down-sampled to 64Hz. . 85
3.12 A normal QRS complex (above) in ﬁle 109 and its reconstruction (below). Note that the R-peak is not central when presented to the neural network. . . . . . . . . . . . . . . . . 87
3.13 A normal QRS complex (above) in ﬁle 109 and its reconstruction (below) when presented to the neural network centred on the R-peak. . . . . . . . . . . . . . . . . . . . . . . . . 88
Æ 3.14 Distribution of percentage change in RR interval for normal to normal intervals ( Ò on Æ the upper plot) and normal to abnormal intervals ( lower plot) for all 19 subjects in the
MIT-Physionet NSRDB. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98 3.15 Distribution of percentage change in RR interval for sinus to sinus intervals (upper plot),
sinus to non-sinus intervals (middle plot) and sinus to artefacts (lower plot) for all 19 subjects in the Physionet NSRDB. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
£ · ¿± 3.16 Percentage of N-N beat pairs remaining ( ), N-E ( ) and N-A ( ) removed for ¾ ± for all 19 subjects in the NSRDB . . . . . . . . . . . . . . . . . . . . . . . . 100

¯ 4.1 Section of (artiﬁcial) RR tachogram. The ‘idealised’ signal ( ) is a perfect sinusoid.

£ The physiologically realistic RR tachogram is indicated by a series of stars ( ). The cubic

· spline re-sampled signal is represented by

and the linearly re-sampled signal by

º . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104

4.2 Real RR intervals (º) with a (7Hz) cubic spline re-sampling overlaid. . . . . . . . . . . . 113

4.3 PSD of ﬁgure 4.2 - a real RR tachogram. . . . . . . . . . . . . . . . . . . . . . . . . . . 114

4.4 Artiﬁcial RR time series generated from equation 4.25 with a sampling rate of 1000

Hz (top ﬁgure, A). Figure B shows the physiologically plausible RR intervals extracted

from the time series in ﬁgure A. Figure C shows these RR intervals with ÀÞ linear

re-sampling. Figure D shows the RR intervals with ÀÞ cubic spline re-sampling. . . . . 115

4.5

Periodograms of equation
¼ ¾ , ¾ , ¼,

ÀÊ ¼ (4.25) ¾ ¿¼¼ Ð

for
Ø

even )

sampling computed

(Ó using:

A)

, ¾Ð
FFT with

¼ ¼ ½¼,¼¾¼ÀÞ,

B) FFT with

ÀÞ and C) Lomb periodogram with

ÀÞ. . . . . . . . . . . . . 116

4.6 Periodograms of physiologically realistic data derived from equation (4.25). a) Lomb

method of 300 individual beats in a 5 minute interval. b) 7 Hz linear re-sampling with

FFT. c) 7 Hz cubic spline re-sampling with FFT. . . . . . . . . . . . . . . . . . . . . . . 117

4.7 Sample-quantised frequency distribution with associated RR tachogram. . . . . . . . . . 118

4.8 PSD of RR tachogram with a Gaussian (

¿) spread of frequencies generated by

equations 4.26. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119

× Ò´¾ ´¼ ¾ µ µ 4.9 PSDs of evenly sampled (7Hz) artiﬁcial RR tachogram with a single component:

Ø,

derived from the Welch FFT (upper) and Lomb (lower) methods. . . . . . . . . . . . . . 122

× Ò´¾ ´¼ ¾ µ µ 4.10 PSDs of unevenly sampled artiﬁcial RR tachogram with a single component:

Ø,

derived from the FFT with linear re-sampling (upper), FFT with cubic spline re-sampling

(middle) and Lomb (lower) methods. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123

4.11 PSDs of evenly sampled artiﬁcial RR tachogram with a two sinusoidal components:
Ð × Ò´¾ ´¼ ¼ µØµ · × Ò´¾ ´¼ ¾ µ µØ , derived from Welch’s FFT (upper) and Lomb

method (lower). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124

4.12 PSDs of unevenly sampled artiﬁcial RR tachogram (with two sinusoidal components:
Ð × Ò´¾ ´¼ ¼ µØµ· × Ò´¾ ´¼ ¾ µ µØ ) derived from the FFT with linear re-sampling

(upper), FFT with cubic spline re-sampling (middle) and Lomb (lower) methods. . . . . 126

¿ 4.13 PSDs of a Gaussian ( ) frequency modulated evenly sampled artiﬁcial RR tachogram

× Ò´¾ µ · × Ò´¾ µ (with two sinusoidal components: Ð

ÐØ

Ø ) derived from the FFT

(upper) and Lomb (lower) methods. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127

vii

¿ 4.14 PSDs of a

frequency modulated unevenly sampled artiﬁcial RR tachogram (with

× Ò´¾ µ · × Ò´¾ µ two sinusoidal components: Ð

ÐØ

Ø ) derived from the FFT with

linear re-sampling (upper), FFT with cubic spline re-sampling (middle) and Lomb (lower)

methods. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129

4.15 Sinus beats occurring at times t¼, t½, t¿ and t , and an ectopic beat occurring at t¾. The

ectopic beat occurs earlier than would be expected for a sinus rhythm beat and shortens

tihehnqaetlurfoaﬁdlwrutsaotcyiaØn¿bsgs¾eotØhw½ci.igeah.etenf.drte.½Rq.uaRne.ndicn.tyt¿.ecrs.vooam.lthp.(aoR.tnReR.Øn·R.ts½Ø.·)a½t.anta.hdni.sdlep.Rno.gRintØ.ht·,e.¾nas.bpeh.tchao.enmt.soeem.cRo.bnRe.d¼Øa·.t(½Rc.aRa.nnØd·.be¾.R)p.R.la¼ØT.·coe¾.d,a.bvaoo.t itt.dh¼¾ . 130 4.16 RR intervals from data in ﬁgure 4.15. Sinus beats occurring at times t¼, t½, t¿ and t , and
an ectopic beat occurring at t¾. The ectopic beat occurs earlier than would be expected for a sinus rhythm beat and shortens the ﬁrst associated RR interval (RRØ·½) and lengthens
£ RtphhRea¼Øns·teo½cmo(inndbdei(caRat tRpeØdl·acb¾ey).daTartoedta¼¾v, o)hiaadnlfdinwRtraRoyd¼Ø·ubc¾eit(nwignedheincigahtt½edfarebnqyduaet¿nreccdyha+cno).gmeBspooRtnhRetnhØ·tes½seaatnntedhwisRinRptoØe·irnv¾ta,tloas
have the same value. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
· ¡ 4.17 Realistic RR tachogram ( ) evenly re-sampled with linear interpolation ( ). An

ectopic beat is chosen to occur at about 55 seconds. Application of equation 4.28 moves

the corresponding RR interval downwards and to the left. The following RR interval

occurs at the same time as before, but has a much larger magnitude since the previous

RR intervals occured prematurely and thus its location in time has moved. Note that the

line of magenta dots which forms a straight line through this segment (54 to 57 seconds)

corresponds to the 7Hz re-sampled (linearly interpolated) RR tachogram after these two

points are removed (see section 4.6.4). . . . . . . . . . . . . . . . . . . . . . . . . . . . 132

4.18 Re-sampled data (magenta dots) from original RR intervals (+) using the four methods

detailed in the text; (i) Ectopic RR interval removal followed by 7Hz linear resampling;

(ii) Ectopic beat replacement followed by 7Hz linear re-sampling; (iii) Ectopic RR inter-

val removal followed by 7Hz cubic spline re-sampling; (iv) Ectopic RR interval removal

£ 4.19

wÀÄ ith-rantoioreL-sFa/mHFpl-irnagti.o

..... estimates

.. for

..... methods

. i

. (

. ),

.......
ii (o), iii (º)

.............. and iv (+) when dealing

134

wÀÄith-radtiifofeorfin0g.6n4u. mEbacehrspoofinetcitsopainc

beats in a average of

ﬁve-minute RR tachogram with 1000 randomly seeded runs. . .

an ..

actual ...

.

135

5.1 The regions of the brain that control rapid eye movement (REM) sleep (dotted), nonREM sleep (striated), wakefulness (black) and the respiratory-cardiovascular system (nuclei in the hypothalamus). See sections 5.2.1 and 5.4.1 for details. Adapted from [165]. . 139
5.2 The propensity for a normal subject to fall asleep over the 24 hour clock (adapted from [165]). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140
5.3 A typical sleep-wake plot (taken from [165]) showing the stages of sleep for a healthy young adult (top). Note that stage 1 is labelled ‘drowsy’ and stages 3 and 4 have been merged and labelled SWS (slow wave sleep). Within about 45 minutes of the young adult falling asleep, a deep phase of sleep occurs. This is interrupted after about an hour by a less deep phase of sleep leading to REM sleep. As the night progresses, the periods of deep sleep become progressively shorter and more shallow, whereas REM sleep becomes more prominent. The lower graph demonstrates how elderly patients tend to suffer from a signiﬁcantly more fragmented sleep pattern than young healthy adults. . . . . . . . . . 144

viii

5.4 5wmavienuslteeePpS(DSWs oSf)R, Ranidntrearpviadlse,yaeccmoordvienmgetnotsslleeeepps(tRatEesM: )a.wÀÄake-r(aWtio),isstaaglseo2in(Sditc2a),tesdlofwo-r
each physiological state. Taken from Otzenberger et al. [213]. . . . . . . . . . . . . . . 146

5.5 Two different expert sleep scores are plotted in blue and magenta for patient 02-01 from

the OBS polysomnographic database. The horizontal time axis is in 30 second epochs.

1 represents wakefulness, 0 REM sleep and -1, -2, -3 and -4 indicate sleep states 1 to 4

respectively. Movement artefact is assigned a value of 2. Note the close correspondence
± between expert scores ( agreement.) . . . . . . . . . . . . . . . . . . . . . . . . . . 150 ÀÊ 5.6 6 minutes of data with a 5 minutes sliding window marked along the time axis. PSD

5.7 hcÀÄaelac-lurthalatyitoihounemsstaiamnreamtmeaslaed((eas-uocbn)jeeaacnctdhOsoBlfeSet-hp0e2ss-ec0ow2r)ei.nsdÀÄ(odw)-rsad,tuwiorihniisgcehs7to.i2vmeharltoaeupdrsubsyoinf2g7s0ltehseeeptchofronerdesam. en.toh.rom.das.;l . 152
(a) Lomb periodogram, (b) FFT after cubic spline interpolation and (c) FFT after linear

interpolation. Note the FFT methods produce estimates with a higher variance. The

lower graph (the corresponding hypnogram) is plotted for two expert scorers (one in

£ · 5.8 bEÀÄlauce-hraaptniadotioeennsteti’msinaavmteesaragfgeoenrtaÀnÄ)o.r-NmraoattileohtiehsaeglthihviygehnhdfuoemrgarRenEes Mo(Of saBlgeSreepPemo( ley)n,stoNmbRenEtwoMgereasnplehsecipcor(dearst)a.ab.nads. eS. 0W.2)S.. . 153

5.9

Eslxeepper(tºs)cfoorredeahcyhponfotghreamthr(eleowspeercttrraaclee)satinmdatÀÄion-rmateiotheosdtsim(saeteeste(xutppfoerr

details). plots) for

. a

... non-

.

156

apn ic and non-noisy section of data for patient 03 of the MIT polysomnographic database

using the three methods; Lomb periodogram (blue), FFT after cubic spline interpolation

5.10

(green) Expert

sacnodreFdFhTyapfnteorgrlianmea(rloinwteerrptoralacteio) nan(rdedÀÄ).

... -ratio

..... estimates

.... (upper

..... plots) for

. a

... non-

.

159

apn ic and non-noisy section of data for patient 04 of the MIT polysomnographic database

using the three methods; Lomb periodogram (blue), FFT after cubic spline interpolation

5.11

(green) Expert

sacnodreFdFhTyapfnteorgrlianmea(rloinwteerrptoralacteio) nan(rdedÀÄ).

... -ratio

..... estimates

.... (upper

..... plots) for

. a

... non-

.

159

apn ic and non-noisy section of data for patient 41 of the MIT polysomnographic database

using the three methods; Lomb periodogram (blue), FFT after cubic spline interpolation

5.12

(green) Expert

sacnodreFdFhTyapfnteorgrlianmea(rloinwteerrptoralacteio) nan(rdedÀÄ).

... -ratio

..... estimates

.... (upper

..... plots) for

. a

... non-

.

160

apn ic and non-noisy section of data for patient 48 of the MIT polysomnographic database

using the three methods; Lomb periodogram (blue), FFT after cubic spline interpolation

£ · 5.13

(pÀÄgartei-eernantt)i’osanaevdsetFirmaFgaTeteasÀÄftfeor-rrlaistnlieeoaeirpsiagnpitvenerpnoifcloasrtiuoRbnEje(Mcretsdsl)(e.MepI.T(.

.......... Polysomnographic ), NREM sleep (

...... database). ) and SWS

... Each sleep

.

160

¢ 5.14

(ÀÄº)

for each of the three spectral estimation -ratio estimates for normal subjects ( )

methods (see text for details). . . . . and patients suffering from sleep apn

.... a ([])

161

in REM sleep for each of the three spectral estimation methods being tested; the Lomb

periodogram, the terpolation (FFTÐ

FFT after Ò). Note

cubic spline interpolation (FFTÙ )
that better patient group separation

and FFT after is achieved by

liÀÄnea-rraitnio-

¢ 5.15

eÀÄsti-mraattieos eusstiinmgattehse

Lomb periodogram. for normal subjects (

...................... ) and patients suffering from sleep apn

.... a ([])

163

in NREM sleep for each of the three spectral estimation methods being tested; the Lomb

periodogram, the FFT after cubic spline interpolation (FFTÙ ) and FFT after linear in-

terpolation (FFTÐ Ò). Note that no spectral estimation method gives better separation

between patient groups in NREM sleep. . . . . . . . . . . . . . . . . . . . . . . . . . . 164

ix

¢ 5.16 ÀÄ -ratio estimates for normal subjects ( ) and patients suffering from sleep apn a ([

]) in deep sleep (SWS) for each of the three spectral estimation methods being tested;

the Lomb periodogram, the FFT after cubic spline interpolation (FFTÙ ) and FFT after

lÀÄine-arratiinoteersptiomlaattieosnu(sFinFgTtÐhÒe).LoNmobteptehraiot dboegttrearmp.ati.en.t

group ....

separation ......

is achieved by .........

165

6.1 Proposed mechanisms for various types of neurally mediated syncope. Taken from [28]. 168

6.2

RR and interval,

HÀÄR-Vratdiaotaovfeorr5sumbijneuctteAw1indduorwinsgwHithU2T4. 0Fsroecmontodpovtoerlbaopt,tosmtan; dbaeradt-dteov-biaetaiot nRoRf

the same windows. The time marker represents the front of the 5 minute window. Note

also that each plot appears in pairs, one with an optimal scaling to observe the changes,

and one with the same scaling as each of the other patient plots. The left vertical line
¼ represents the time of the initial tilt to Ó and the right line represents the return to the

supine position. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176

6.3

RR and interval,

HÀÄR-Vratdiaotaovfeorr5sumbijneuctteAw2indduorwinsgwHithU2T4. 0Fsroecmontodpovtoerlbaopt,tosmtan; dbaeradt-dteov-biaetaiot nRoRf

the same windows. The time marker represents the front of the 5 minute window. Note

also that each plot appears in pairs, one with an optimal scaling to observe the changes,

and one with the same scaling as each of the other patient plots. The left vertical line
¼ represents the time of the initial tilt to Ó and the right line represents the return to the

supine position. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 177

6.4

RR and interval,

HÀÄ R-Vratdiaotaovfeorr5sumbijneuctte

B1 during HUT. From top to bottom; beat-to-beat RR windows with 240 second overlap, standard deviation of

the same windows. The time marker represents the front of the 5 minute window. Note

also that each plot appears in pairs, one with an optimal scaling to observe the changes,

¼ and one with the same scaling as each of the other patient plots. The left vertical line
represents the time of the initial tilt to Ó and the right line represents the return to the

supine position. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178

6.5

RR and interval,

HÀÄ R-Vratdiaotaovfeorr5sumbijneuctte

B2 during HUT. From top to bottom; beat-to-beat RR windows with 240 second overlap, standard deviation of

the same windows. The time marker represents the front of the 5 minute window. Note

also that each plot appears in pairs, one with an optimal scaling to observe the changes,

and one with the same scaling as each of the other patient plots. The left vertical line
¼ represents the time of the initial tilt to Ó. Note that the recording was terminated before

the return to supine position. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179

6.6

RR and interval,

HÀÄ R-Vratdiaotaovfeorr5sumbijneuctte

C1 during HUT. From top to bottom; beat-to-beat RR windows with 240 second overlap, standard deviation of

the same windows. The time marker represents the front of the 5 minute window. Note

also that each plot appears in pairs, one with an optimal scaling to observe the changes,

and one with the same scaling as each of the other patient plots. The left vertical line
¼ represents the time of the initial tilt to Ó and the right line represents the return to the

supine position. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180

6.7

RR and interval,

HÀÄ R-Vratdiaotaovfeorr5sumbijneuctte

C2 during HUT. From top to bottom; beat-to-beat RR windows with 240 second overlap, standard deviation of

the same windows. The time marker represents the front of the 5 minute window. Note

also that each plot appears in pairs, one with an optimal scaling to observe the changes,

and one with the same scaling as each of the other patient plots. The left vertical line
¼ represents the time of the initial tilt to Ó. Note that the recording was terminated before

the return to supine position. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181

x

E.1 Comparison of calculating the periodogram from the DFT of evenly sampled data (left) and using the Lomb periodogram on unevenly sampled data (right). See text for explanation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 200
xi

List of Tables

2.1 Standard output of MIT ﬁles. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51 2.2 Filter properties used for coefﬁcient generation with MATLAB5. . . . . . . . . . . . . . 57 2.3 Standard output of MIT ﬁles. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

3.1 Performance of Hamilton and Tompkins/Correlation combination algorithm on patient 109 for classifying beat morphologies for different values of Ñ Ò . . . . . . . . . . . . 74
3.2 Performance of Hamilton and Tompkins/ÊÅ Ë combination algorithm on patient 109 for classifying beat morphologies for different values of ÊÅ Ë Ñ Ò . . . . . . . . . . . 74
3.3 Reciprocal Mean Square Error (ÊÅ Ë ) between (downsampled, energy normalised)
MLP input and output patterns (QRS complex candidates) for subject 109 of the MITBIT arrhythmia database. Column one presents values for each ectopic beat, column two for each normal beat following the corresponding ectopic beat in column one, and
column three details the ÊÅ Ë for the next but one normal beat, following the ectopic
beat in column one. See text for details. . . . . . . . . . . . . . . . . . . . . . . . . . . 89 3.4 Performance of Hamilton and Tompkins/auto-associative network combination algorithm
for different numbers of training patterns. . . . . . . . . . . . . . . . . . . . . . . . . . 91 3.5 Performance of Hamilton and Tompkins/auto-associative network combination algorithm
for different sizes of temporal window (in seconds) used to segment the P-QRS-T complexes during training. 1700 training patterns were used for each case. . . . . . . . . . . 93

4.1

Mean estimates of the ÀÄ -ratio and the variance

¾
Ä

over 1000 runs using the Lomb

À

method for differing mean heart rates. . . . . . . . . . . . . . . . . . . . . . . . . . . . 120

¡ 4.2 Total power (ÈÌ ), peak power (ÈÔ ), frequency of peak ( Ô ), 3dB bandwidth ( ¿ ),

4.3

¦¼ ¼½ fraction of power in a

ÀÞ

band

centred

on

the

peak

(

ÈÔ ÈÌ

)

and

¡ side-lobe (È×Ð) for ﬁgure 4.9; even sampling, single HF frequency.

and È×Ð represent the ‘gold standard’ (see text). . . . . . . . . . .

amplitude of
Note that .......

the ﬁrst

¿

,

ÈÔ ÈÌ

....

.

122

¡ Total power (ÈÌ ), peak power (ÈÔ ), frequency of peak ( Ô ), 3dB bandwidth ( ¿ ),

4.4

¦¼ ¼½ fraction of power in a
side-lobe (È×Ð) for ﬁgure

À
4.10;

Þ band centred on
uneven sampling,

the

peak

(

ÈÔ ÈÌ

)

and

amplitude

of

single HF frequency. . . . . .

the ..

ﬁrst ..

.

123

¡ Total power (ÈÌ ), peak power (ÈÔ ), frequency of peak ( Ô ), 3dB bandwidth, ( ¿ )

¦¼ ¼½ fraction of power in a
side-lobe (È×Ð) for ﬁgure

ÀÞ

band

centred

on

the

peak

(

ÈÔ ÈÌ

)

and

amplitude

of

4.11 (even sampling, LF and HF sinusoids). . . . . . .

the ..

ﬁrst ..

.

125

4.5 Standard frequency metrics from the results presented in ﬁgure 4.11 (even sampling, LF and HF sinusoids). Ð (exp) is the experimentally measured ratio of the two peak

amplitudes in the low and high frequency regions. . . . . . . . . . . . . . . . . . . . . . 125

¡ 4.6 Total power (ÈÌ ), peak power (ÈÔ ), frequency of peak ( Ô ), 3dB bandwidth ( ¿ ),

¦¼ ¼½ fraction of power in a
side-lobe (È×Ð) for ﬁgure

À
4.12.

Þ

band ...

centred ....

on ..

the ..

peak ...

(

ÈÔ ÈÌ

..

) .

and ..

amplitude of .......

the ..

ﬁrst ..

.

126

xii

4.7 Standard frequency metrics from the results presented in ﬁgure 4.12 (uneven sampling,

LF and HF sinusoids). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126

¡ 4.8 Total power (ÈÌ ), peak power (ÈÔ ), frequency of peak ( Ô ), 3dB bandwidth, ( ¿ )

¦¼ ¼½ and the fraction of power in a

ÀÞ

band

centred

on

the

peak

(

ÈÔ ÈÌ

)

for

ﬁgure

4.13.

.

128

4.9 Standard frequency metrics from the results presented in ﬁgure 4.13 (even sampling, LF

and HF sinusoids). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128

¡ 4.10 Total power (ÈÌ ), peak power (ÈÔ ), frequency of peak ( Ô ), 3dB bandwidth ( ¿ )

¦¼ ¼½ and fraction of power in a

ÀÞ

section

centred

on

the

peak

(

ÈÔ ÈÌ

).

.

.

.

.

.

.

.

.

.

.

128

4.11 Standard frequency metrics from the results presented in ﬁgure 4.14 (uneven sampling,

LF and HF sinusoids). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129

4.12 Standard frequency metrics for differing magnitudes of ectopy (­). . . . . . . . . . . . . 133

¼ 4.13 Standard frequency metrics for ­

and two ectopic beats. . . . . . . . . . . . . . . 133

¦ 5.1 Activity dependent changes of the ÀÄ -ratio for conscious normal patients (with 1

Ý 5.2

sÀÄtan-draatridosddevuiraintigonW).akTeafkuelnnefsrso,mNrReEsuMltsanodf

[31]. REM

... sleep.

... N/A

. =

.. not

..... available,

.... Norm

. =

.. nor-

.

142

mal, Post-MI = a few days after myocardial infarction, indicates a non-cardiac related

problem. Taken from [213, 184, 275, 166]. . . . . . . . . . . . . . . . . . . . . . . . . . 146 5.3 The labelling scheme for the polysomnographic database. Each sleep stage or apn a

annotation applies to a thirty-second segment. . . . . . . . . . . . . . . . . . . . . . . . 149

5.4 Patients and sections chosen from the MIT polysomnographic database with little or no

5.5

noise Mean

aÀÄnd-araptnio

ic episodes.
(Ü) and S.D.

. (

................................ ) for each of the three PSD estimation methods for normal

151

5.6

subjects in REM sleep, Results of signiﬁcance

NREM sleep of F-test, K-S

and test

SWS. . . . and unequal

... t-test

..... between

ÀÄ.

.......... -ratio variances,

155

distribution and means in REM and NREM sleep for normal subjects. Signiﬁcance is

£ denoted with an asterisk ( ) for È ½¼ , or as È ¼ ¼¼¼ , È ¼ ¼¼ , È ¼ ¼½,

¼ ¼ È

. Æ Ë denotes not signiﬁcant. Note that in general, only the Lomb method

ghiivgehspsriogbnaibﬁicliatnytltyhadt itfhfeereÀÄnt

variances in NREM values in REM sleep

and have

REM sleep. Although a different distribution

there is a to those in

5.7

NsigRnEiﬁMcasnletleypdfioffreereancthmspeeacntrÀÄal

estimation technique, only -ratios for all subjects. . .

the ..

Lomb ....

Results of signiﬁcance of F-test, K-S test and unequal t-test between

periodogram gives

ÀÄ.

......... -ratio variances,

.

155

distribution and means in SWS and REM sleep for normal subjects. Signiﬁcance is

£ denoted with an asterisk ( ) for È ½¼ , or as È ¼ ¼¼¼ , È ¼ ¼¼ , È ¼ ¼½,

¼ ¼ È

. Æ Ë denotes not signiﬁcant. Note that in general, all three spectral estimation

methods gives signiﬁcantly different variances, means and distributions between SWS

annodsiRgEniMﬁcasnletedpi.ffeArletnhcoeusghinththeevmareiaannceÀÄ

in SWS is signiﬁcantly -ratio values calculated

lower for by each

subject 02, of the three

PSD methods indicates that

tehxeisdtiss.trHibouwtieovneor,finÀÄ

the case of the Lomb periodogram only, the K-S test -ratio values is signiﬁcantly different between SWS

5.8

ManedaRn EÀÄM-srlaeteiop.(Ü.)

... and

......... variance for each

.. of

.. the

... three

... PSD

...... estimation

...... methods in

... REM

.

156

sleep, NREM sleep and SWS for sleep apn ic subjects. N/A indicates not applicable; in

the segment of data analysed the subject did not experience this category of sleep. . . . . 161

xiii

5.9 Results of signiﬁcance of F-test, K-S test and unequal t-test between ÀÄ -ratio variances,
distribution and means in NREM and REM sleep for sleep apn ic subjects who experi-

enced all three sleep categories (REM, NREM and SWS). Signiﬁcance is denoted with
an asterisk (£) for È ½¼ , or as È ¼ ¼¼ , È ¼ ¼½, È ¼ ¼ . ÆË denotes not

signiﬁcant. Note that in general, only the Lomb method gives more signiﬁcantly different

vÀÄariavnaclueessbientwReEeMn NsRleEepMhaanvde

REM sleep. Although a different distribution

there is a high probability that the to those in NREM sleep for each

sspigencitﬁraclaensttdimifafetiroenncteecehxniisqtsueb,eatwllePeSnDtheestmimeaantioÀÄn

methods lead to the conclusion that no -ratios calculated in NREM and REM

5.10

sleep. Results

........ of signiﬁcance

.. of

... F-test,

... K-S

.. test

.. and

..... unequal

... t-test

..... between

ÀÄ.

.......... -ratio variances,

162

distribution and means in SWS and REM sleep for sleep apn ic subjects who experi-

½¼ ¼ ¼¼ ¼ ¼½ ¼ ¼ enced all three sleep categories (REM, NREM and SWS). Signiﬁcance is denoted with

£ an asterisk ( ) for
exist signiﬁcantly

È
different

, or as È
variances,

,È
distributions

and

,È
means

of

the

ÀÄ.

Note that there -ratio between

£ 5.11

ASWveSraagnedÀÄRE-Mratisoleeepst.im. a.te.s

.. for

..... subjects

..................... tested in the OBS polysomnographic

..... normal

162

database 02 ( ), normals in the current literature ([213, 275]), the MIT polysomnographic

££ (sleep apn
the results

ic) are

database ( ) not available

and a from

post-MI population current literature.

ÀÄ(tak-reantiforsomqu[o2t5e2d])f.roNm/Athinisdisctautdeys

Þ are means over all subjects in the group using Lomb periodogram-derived estimates.

indicates that no variance calculations were given in the paper . . . . . . . . . . . . . . 164

A.1 Beat annotation codes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 190 A.2 Non-beat annotation codes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
¦ C.1 Nominal 24-hour HRV metric values for normal subjects (mean values one standard
deviation). Taken from [184]). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 196

xiv

Glossary of clinical terms
In the interest of clarity and since the nature of this thesis is cross-disciplinary yet highly speciﬁc, a glossary of clinical terms, technical abbreviations and explanations of contextual descriptors are provided.
¯ Adventiita – Membranous structure, usually morbid, covering but not belonging to an organ. ¯ Afferent Nerves – Carry impulses to the muscle/gland/organ. ¯ Angiotensin – A powerful vascoconstricting polypeptide which stimulates the production of al-
dosterone and vasopressin and results in an increase in blood pressure (more fully angiotensin II); angiotensin I, the inactive precursor of this, which is formed in the liver by the action of renin on a plasma protein (angiotensinogen), and is converted in the lungs to angiotensin II by a second enzyme.
¯ Aortic stenosis – progressive narrowing of the aortic valve resulting in the obstructed passage of
blood from the left ventricle into the aorta. Chronic stenosis can lead to left ventricular enlargement and congestive heart failure.
¯ Arrhythmia – Any variation from the normal (sinus) rhythm of the heart beat, including preamture
beats, heart block, atrial ﬁbrillation and atrial ﬂutter.
¯ Artefact (Sometimes Artifact) – a product or effect that is not present in the natural state (of an
organism, etc.) but occurs during or as a result of investigation or is brought about by some extraneous agency such as electrode movement.
¯ Atrial myxoma – a very rare primary cardiac tumour, composed of connective tissue, located in
the left or right atrium.
¯ Autonomic Nervous System (ANS) – The system of nerves of the glands and of the involuntary
muscle that regulates key functions including the activity of the cardiac muscle, smooth muscles (e.g., of the gut), and glands. In 1940 R. S. Woodworth deﬁned the autonomic nerves to be those
xv

that run to the heart, blood vessels, lungs, stomach, intestines, and other viscera. These nerves are composed of extra-slender nerve ﬁbres, which grow out from cells in the brain stem and cord. The ANS comprises the sympathetic nervous system (which accelerates the heart rate, constricts blood vessels, and raises blood pressure) plus the parasympathetic nervous system (which slows the heart rate, increases intestinal and gland activity, and relaxes sphincter muscles).
¯ Autonomic Neuropathy – A disease of the autonomic nervous system. ¯ Baroreﬂex – A reﬂex whereby the heart speeds up and beats more forcefully when BP falls. ¯ Blood Pressure (BP) – The pressure that must be applied to an artery in order to stop the pulse
in the vessel beyond the point of pressure. It is generally assumed to be equivalent to the systolic pressure to which the blood is subjected by the force of the heart and the elasticity of the vessels, but also depends upon thickness and hardness of vessel wall, and of volume of blood thrown out of the heart at each beat. BP is greatest at each heart beat (systolic blood pressure - SBP) and lowest between beats (diastolic blood pressure DBP). Mean arterial (blood) pressure (MAP) is taken to
be È · Ë È ¿ È. ¯ ¼ Bradychardia – A slowness of the beating of the heart (to less than bpm).
¯ Carotid Sinus Massage (CSM) – ﬁrmly massaging the right carotid artery for 5-10 seconds at at
the anterior margin of the sternocleo-mastiod muscle at the level of the cricoid cartilage.
¯ ¢ Cardiac Output – HR stroke volume. ¯ Cardiomyopathy – A weakness of the heart muscle, often leading to heart failure. Can be caused
by a number of underlying disorders including coronary artery disease, valvular heart disease, viral infection, diabetes, alcohol abuse, or connective tissue disorders. Sometimes no speciﬁc cause can be identiﬁed, in which case the cardiomyopathy is referred to as idiopathic.
¯ Cardiothoracic ratio – The ratio of the maximal transverse diameter of the cardiac silhouette to the
distance between the internal margins of the ribs at the level of the right hemidiaphragm.
¯ Cataplexy – A sudden loss of muscle tone that may be induced by severe mental shock or as an
additional feature of narcolepsy.
¯ Cerebral perfusion – Quantity of blood ﬂow to the cerebrum or the brain. ¯ Central Nervous System – Pertaining to the brain, cranial nerves and spinal cord. It does not
include muscles or peripheral nerves.
¯ Chronotropic – Affecting (increasing) the rate of contraction.
xvi

¯ Circadian – Designating physiological activity which occurs approximately every twenty-four
hours, or the rhythm of such activity.
¯ Coronary Artery Disease (CAD) – is a chronic disease in which there is a atherosclerosis (hard-
ening) of the arteries on the surface of the heart. It is also referred to as coronary heart disease
(CHD).
¯ Coronary Heart Disease (CHD) – See Coronary Artery Disease. ¯ Diastole – The time, in between ventricular contractions (systole), at which ventricular ﬁlling
occurs.
¯ Diastolic Blood Pressure – The pressure exerted on the walls of the arteries when the heart is in
the relaxation phase (diastole). Considered abnormally elevated if consistently over 90 mmHg.
¯ Efferent Nerve – Carry impulses away from the muscle/gland/organ ¯ Ejection Fraction - a measure of the function of the left ventricle, also called left ventricular ejec-
tion fraction (LVEF). The ejection fraction is the percentage of blood ejected from the left ventricle
with each heart beat. An LVEF of 50% indicates that the left ventricle ejects half its volume each
time it contracts. A normal ejection fraction is 50% or higher. A reduced ejection fraction can
indicate that cardiomyopathy is present.
¯ Embolism – The plugging of a small blood vessel by material which has been carried through
larger vessels by the blood stream.
¯ Endocrine System – The system of glands that release their secretions (hormones) directly into the
circulatory system.
¯ Entrainment – To adjust such that synchronisation occurs. ¯ Fibrillation – A small, local, involuntary contraction of muscle, invisible under the skin, resulting
from spontaneous activation of single muscle cells or muscle ﬁbres.
¯ Heart Beat – A full cycle depolarisation and repolarisation of the cardiac muscle. Each heart beat
is followed by a period of rest where ventricular ﬁlling occurs.
¯ Heart Rate (HR) – The number of heart beats per minute (bpm) ¯ Hemorrhage – An escape of blood from the blood-vessels; a ﬂux of blood, either external or
internal, due to rupture of a vessel; bleeding, esp. when profuse or dangerous.
¯ Humoral – Of or belonging to, consisting of, or containing, any of the humours or ﬂuids of the
body; Contained in or involving the blood or other body ﬂuid; involving or consisting of a chemical
agent, esp. one present in the blood (such as hormones or ions).
xvii

¯ Hypertension – Persistently high arterial blood pressure. Hypertension may have no known cause
(essential or idiopathic hypertension) or be associated with other primary diseases (secondary hypertension).
¯ Hypertrophic cardiomyopathy – enlargement of the ventricular septum can result in ventricular
outﬂow obstruction (subaortic stenosis) and eventual cardiomyopathy (disease of the cardiac muscle mass).
¯ Hypoglycaemia – An abnormally diminished concentration of glucose in the blood. This occurs
when a person with diabetes has injected too much insulin, eaten too little food, or has exercised without extra food. Taking small amounts of sugar, sweet juice, or food with sugar will usually help the person feel better within 10-15 minutes. Symptoms of hypoglycaemia include nausea, sweating, weakness, faintness, confusion hallucinations, headache, cold sweat, piloerection, hypothermia, irritability, bizarre behaviour and fainting. Prolonged hypoglycaemia can result in complete loss of consciousness, convulsions, coma and brain damage.
¯ Hypovolemia – Decreases in venous return of the blood to the heart. ¯ Innervate – To supply (some organ or part) with nerve-force, or with nerves. ¯ Inotropic – Affecting the strength of contraction. ¯ Intoxication – A disorder resulting from absorption of the waste products of metabolism, decom-
posed matter from the intestine, or the products of dead and infected tissue as in gangrene.
¯ Ipsilateral – Belonging to or occurring on the same side of the body; connecting two parts on the
same side.
¯ Left Ventricular Ejection Fraction (LVEF) – see Ejection Fraction ¯ Narcolepsy – A disorder of sleep associated with excessive daytime sleepiness, involuntary day-
time sleep episodes, disturbed nocturnal sleep and cataplexy.
¯ Neurohumoral – Nervous plus hormonal stimuli ¯ Norepinephrine – or noradrenaline; a precursor of adrenaline whose main function is to mediate
the impulses in the sympathetic nervous system. Increased levels are associated with stress and it is often referred to as the ’ﬁght or ﬂight hormone’.
¯ Noise – a collective term for: ﬂuctuations or disturbances which are not part of a wanted signal or
which interfere with its intelligibility or usefulness such as muscle activity (for ECG analysis) and ectopic beats (for HRV analysis).
xviii

¯ Orthostatic hypotension – A drop in blood pressure that is precipitated by changes in body position.
May be related to hydration status, drug side effect or be caused by a dysfunction in the autonomic
nervous systems ability to maintain blood pressure with positional changes (for example autonomic
neuropathy secondary to diabetes).
¯ Myelin – The medullary (inner) sheath of nerve-ﬁbres. ¯ Mycroneurography – A technique for measuring electrical signals from human peripheral nerves
using a microelectrode.
¯ Myocardial Infarction (MI) – A blockage in the normal electrical conduction paths of the heart
that cause the muscle contraction, often leading to permanent damage to the heart muscle.
¯ Parasympathetic system – Part of the autonomic nervous system which is connected with the brain
and spinal cord through certain nerve centres in the mid-brain, medulla, and lower end of the cord,
including the vagus (see below). Its action is usually antagonistic to that of the sympathetic system
in that it inhibits the action of the heart and stimulates the intestine.
¯ Paroxysm – The ﬁt, attack, or exacerbation, of a disease that occurs at intervals, or has decided
remissions or intermissions.
¯ Paroxysmal – Recurring in paroxysms, spasms or seizures. ¯ Peripheral Resistance – The resistance to blood ﬂow at the peripheral blood vessels. ¯ Psychogenic syncope – Fainting spells related to anxiety, panic or major depression. ¯ Renin – the enzyme (or catalyst) that produces angiotensin ¯ Reninangiotensin System – Part of the renal (kidney) regulatory sysytem; very important in BP
regulation.
¯ R-on-T ventricular (premature) beat – A potentially dangerous condition is induced when a prema-
ture ventricular contraction occurs during the T-wave of the preceding QRS-T complex. R-on-T
phenomenon can induce ventricular tachycardia or ventricular ﬁbrillation.
¯ Sinus pause – A spontaneous interruption in the regular sinus rhythm, the pause lasting for a period
that is not an exact multiple of the sinus cycle.
¯ Splanchnic – Situated in, connected with, the viscera or intestines. ¯ Steal syndrome – stenosis or obstruction of artery near its origin ¯ Stenosis – Narrowing or stricture of a duct or canal. ¯ Subclavian artery – Artery extending under the clavicle.
xix

¯ Sympathetic system – Part of the autonomic nervous system consisting of ganglia united by an
irregular network of nerve ﬁbres. The major part of the sympathetic system consists of two ganglionated cords that run through the neck, chest and abdomen, lying close in front of the spine. Its action is usually antagonistic to that of the parasympathetic system in that it stimulates the action of the heart and inhibits the intestine.
¯ Syncope – A temporary suspension of consciousness due to generalised cerebral ischaemia, a faint
or swoon.
¯ Systole – The time at which ventricular contraction occurs; a contraction of the heart that alternates
with the diastole occupying, respectively.
¯ Systolic Blood Pressure (SBP) – The pressure exerted on the walls of the arteries during the con-
traction phase of the heart. Considered abnormally elevated if consistently over 150 mmHg. Systolic blood pressure varies with age, sex, size and relative condition.
¯ Tachycardia – The excessive rapidity in the action of the heart, the term is usually applied to a
heart rate above 100 per minute and may be qualiﬁed as atrial, junctional (nodal) or ventricular and as paroxysmal.
¯ Tonically – Of resting tone (baseline)
¯ ½¼ Vagal Nerve (Vagus or Pneumogastric) – The Ø cranianl nerve and part of the parasympathetic
nervous system formed by numerous ﬁlaments from the respiratory tract.
¯ Vagus – See Vagal Nerve. ¯ Valsalva – an attempt is made to exhale air while the nostrils and mouth, or the glottis, are closed,
so as to increase pressure in the middle ear and the chest.
¯ Vasovagal syncope – A transient vascular and neurogenic reaction marked by pallor, nausea, sweat-
ing, bradycardia, and rapid fall in arterial blood pressure which, when below a critical level, results in loss of consciousness and characteristic electroencephalographic changes. It is most often evoked by emotional stress associated with fear or pain. It is also called vasovagal attack and gowers’ syndrome.
¯ Viscera – The soft contents of the principal cavities of the body; esp. the internal organs of the
trunk; the entrails or bowels together with the heart, liver, lungs, etc.
Taken from [61], [109] and [204].
xx

Abbreviations and units

ACE AEB AF AR BP bpm CA CAD CHF CNS CSM dB ECG EEG EF FDA FFT HCM HF HR
ÀÊÁ
HRV Hz

Angiotensin-Converting Enzyme Atrial Ectopic Beat Atrial Fibrillation Autoregressive Blood Pressure Beats per minute Cardiac Arrest Coronary Artery Disease Congestive Heart Failure Central Nervous System Carotid Sinus Massage Decibels Electrocardiogram Electroencephalogram Ejection Fraction Federal Drug Administration (USA) Fast Fourier Transform Hypertrophic Cardiomyopathy High Frequency Heart Rate
Instantaneous HR ( Ê¼Ê )
Heart Rate Variability Hertz
xxi

ICA IV LDL LF MI mm/Hg ms MVP NN NYHA PCA QRS RR rpm s SCD SD SVT VEB VF VLF VT ULF

Independent Component Analysis Intravenous - injected into the vein Low Density Lipoprotein (cholesterol) Low Frequency Myocardial Infarction Millimetres of Mercury (as a measure of pressure) Milliseconds mitral valve prolapse Normal-to-normal beats (excluding ectopics). New York Heart Association classiﬁcation Principal Component Analysis Central part of heart beat morphology Beat-to-beat (R-peak to R-peak). Respirations Per Minute Seconds Sudden Cardiac Death Standard Deviation Supraventricular Tachycardia Ventricular Ectopic Beat Ventricular Fibrillation Very Low Frequency Ventricular Tachycardia Ultra Low Frequency

xxii

Dedicated to the memory of Joe Ensor (1915-2001), farmer, grandfather, and friend ... and to the rest of my family.

Chapter 1
Introduction
1.1 Overview
Over the last 20 years there has been a widespread interest in the study of variations in the beat-to-beat timing of the heart, known as heart rate variability (HRV). In certain circumstances, the evaluation of HRV has been shown to provide an indication of cardiovascular health [181]. However, often contradictory results have left clinical researchers sceptical about the efﬁcacy of HRV assessment and there exists no clear consensus on how to estimate HRV in clinical practice.
This thesis explores techniques for signal processing of HRV from motivation to application, in an attempt to develop robust methods for HRV analysis. This study considers signal extraction, the errors introduced at each stage of the processing, the cardiovascular interpretation of the metrics being estimated and methods for minimising the number of free parameters in clinical situations.
This chapter introduces the main characteristics of the electrocardiogram (ECG), a record of the biopotentials associated with the contractions of the heart muscle. A description of some of the common types of signals that can be derived from the ECG is also presented, together with the motivation behind the analysis of these signals. A detailed description of how the different branches of the human central nervous system (CNS) and respiratory cardiovascular (RCV) system interact to produce beat-to-beat variability in the human heart rate is then given.
1

1.2 Identifying the problem
The heart is composed of muscle tissue that contracts and relaxes in a coordinated manner when an electrical stimulus is applied. The heart’s function is to pump blood around the body, through the arterial system to enable the transport of vital nutrients and oxygen. Like all other muscles, the heart receives its oxygen and nutrients from arteries, which are the coronary arteries in this case. A blockage of these vessels often leads to a heart attack (the cessation of the beating of the heart). In fact, coronary heart disease has been shown to be the leading cause of death in developed countries [192]. Myocardial Infarction1 (MI), heart failure, angina, and sudden death can all occur from the blockages which occur in the coronary arteries. Following an MI, the conventional treatment is to inject a ‘clot-busting’ decoagulation agent, in order to remove the blockage. However, often the heart has already suffered much damage and muscle-tissue loss, leading to an increased likelihood of re-infarction [181].
Since the cardiovascular system is controlled by the CNS, a deterioration in this control mechanism also leads to cardiac-related problems. The rest of this chapter details how the CNS controls cardiac activity and how this is measured to assess the functionality of this control.
1.3 Physiology of the human heart
The human heart is controlled by a series of electrical discharges from speciﬁc localised nodes within the myocardium (cardiac muscle). These discharges propagate through the cardiac muscle and stimulate contractions in a co-ordinated manner in order to pump deoxygenated blood via the lungs (for oxygenation) and back into the vascular system. The physical action of the heart is therefore induced by a local periodic electrical stimulation. As a result of the latter, a change in potential of the order of 1mV can be measured during the cardiac cycle between two surface electrodes attached to the patient’s upper torso (usually either side of the heart). This signal is known as the electrocardiogram (ECG).
In a normal heart, each beat begins with the stimulation of the sinoatrial (SA) node, high up in the right atrium (see ﬁgure 1.1) which causes depolarisation of the cardiac muscle in this locality. This stimulation is both regular and spontaneous and is the source of the primary pacemaker within the heart with an intrinsic frequency of 100 to 120 beats per minute (bpm). Note that the resulting heart rate is
1A blockage in the normal electrical conduction paths of the heart that cause the muscle contraction, often leading to permanent damage to the heart muscle.
2

Figure 1.1: Source nodes of electrical stimulation within the heart.
often lower than this because of the complex set of chemical exchanges that occur between the initial stimulation and the subsequent depolarisation of the surrounding cardiac tissue. The impulse spreads from the SA node to depolarize the atria (the upper two cavities). The electrical signal then reaches the atrioventricular (AV) node, located in the right atrium. Normally, an impulse can only reach the ventricles via the AV node since the rest of the myocardium is separated from the ventricles by a non-conducting ﬁbrous ring.
As the AV node is activated it momentarily delays conduction to the rest of the heart and so acts as a safety mechanism by preventing rapid atrial impulses from spreading to the ventricles at the same rate. If the AV node fails to receive impulses it will take over as the cardiac pacemaker (at a much lower frequency of 40 to 60 bpm). The SA node will inhibit this pacemaking whenever its impulses reach the AV node.
Once the impulse has passed the AV node, it enters the bundle of His. This conducting network spreads out into the inter-ventricular septum and divides into left and right bundle branches. As the impulse moves through this region and into the posterior and anterior fascicles it stimulates depolarisation of the ventricles. There is a ventricular pacemaker2 (with a beat frequency of 15 to 40 bpm) which takes over as the main pacemaker if the AV node fails.
After the depolarisation of the ventricles, a transient period follows where no further ionic current
2Strictly speaking it is not localised; all the cells have an innate rhythmicity.
3

mV

can be ﬂow through the myocardium. This is known as the refractory period and lasts at least 200ms. There is then a recharging (repolarisation) of the ventricular myocardium to its resting electrical potential and the heart is then ready to repeat the cycle.
SAMPLE NUMBER Figure 1.2: One second of a typical ECG waveform for one heart beat. The vertical axis represents the
¦ mV ﬂuctuations scaled to 1 over the whole record. The horizontal (time) axis shows the sample number
(with a sampling rate of 256 Hz, there are 256 samples in one second).
1.3.1 ECG waveform generation and recording
A typical ECG waveform comprises of an initial P-wave, followed by the main ‘QRS’ complex and then a trailing T-wave (see ﬁgure 1.2). These waves are deﬁned as follows:
¯ P-wave – The low voltage ﬂuctuation caused by the depolarisation of the atria prior to contraction.
The atria contain very little muscle and thus the voltage change is quite small.
¯ QRS complex – The largest-amplitude portion of the ECG caused by the ventricular depolarisa-
tion. The time during which ventricular contraction occurs is referred to as the systole. Although atrial repolarisation occurs simultaneously, it is not seen due to the low amplitude of the signal generated by this process.
¯ T-wave – Caused by ventricular repolarisation.
The time between ventricular contractions, during which ventricular ﬁlling occurs, is referred to as the diastole. Although the R-peak is often the largest amplitude component, the morphology of a healthy ECG can vary greatly from patient to patient with the P- or T-waves sometimes dominating or merging
4

with the QRS complex. Swapping the two electrodes over gives an inverted signal with the R-peak being

ÀÊ the lowest (or most negative) part of the signal. The time averaged heart rate ( ¼) is usually calculated

ÀÊ by counting the number of beats in a 60 second time period. The instantaneous heart rate,

, is Ê¼Ê

ÊÊ ÀÊ where is the time between successive R-peaks (an RR interval). ¼ can vary between 30 and 220

beats per minute (bpm) and although the instantaneous heart rate can be as high as 300 bpm, this is not

sustainable for more than a few beats without serious problems manifesting themselves.

Figure 1.3: Electrical vectors for the standard ECG lead conﬁgurations.
1.3.2 Lead conﬁgurations
The choice of location on the thorax for the electrodes used to record the ECG is dictated by the type of clinical information required. Since the voltage difference between a pair of electrodes (known as a lead) is only representative of the variations along one axis from the heart (see ﬁgure 1.3), there is no three-dimensional activity information in single lead measurements. However, there are standard lead conﬁgurations for aquiring 3-D information about the electrical activity of the heart [121]. Figure 1.4 shows many of the standard positions for 12-lead ECG recordings and ﬁgure 1.3 shows the standard vectors that are visualised by these leads. For example, lead II represents the electrical activity vector from the centre point (close to the heart) to the left leg. Lead V5 represents the vector from electrode
5

Figure 1.4: 10 of the standard electrode positions for 12-lead ECG recording.
position V5 (as in ﬁgure 1.4) to the heart. The potential must be measured with respect to some common ground and this is often taken to be the right leg.
When a serious heart problem is suspected, (such as following a suspected MI) a clinician will usually order a full (12-lead) ECG recording to be made. This gives a detailed picture of a patient’s cardiac activity, and any possible problems, such as QT-syndrome (signiﬁcant changes in the time between the Q and T points on each cycle) and ST-elevation (a signiﬁcant rise in the point of inﬂection between the S and T points) [86, 134, 179]. However, since visual inspection is often used to evaluate these features, and this can be done on only a few cycles of the ECG, the recording is short (typically 10 seconds long). Routine analysis of the ECG does not normally involve such a high number of vectors being recorded. Even in an intensive therapy unit (ITU), when data from many lead conﬁgurations is available, only one or two leads are routinely monitored. Typically, leads II and V5 are chosen since they offer the most useful information in the context of medical diagnosis [121]. Note that these two lead conﬁgurations are the two channels of ECG data in the standard MIT-BIH database (see chapter 2). The analysis in this thesis concerns data taken over the course of hours, where it is unusual to record ECG data from more than these two channels.
6

1.3.3 Heart disease
Heart disease patients can be broadly classed as either myopathics or ischemics. Myopathics usually experience a slow degeneration of the heart over years or months, manifesting as inﬂammation of the cardiac muscle. In contrast, myocardial ischemia (a lack of oxygen to cardiac muscles) is often caused by a rapid build up (over hours) of plaque or other blood ﬂow-impeding particles and leads to muscle damage. The latter will usually manifest itself as a morphological change on particular sections of the ECG [134, 179].
In both cases, the onset of potentially fatal arrhythmias often resulting in MI can be preceded by two main changes: a higher than normal incidence of ectopic beats, and a reduction in the short term variations of the instantaneous heart rate [181].
1.4 Abnormalities in the ECG - ectopic beats
Most human beings exhibit a normal cardiac (sinus) rhythm composed of very similar beats occurring at regular (but slightly varying) intervals. Beats which occur prematurely in the cycle, often with a different morphology, are known as ectopic beats3. Recent research has shown that an increased number of these beats can be indicative of poor recovery after a traumatic event or denote the onset of potentially fatal arrhythmias4 [113, 181, 184, 282]. Although the electrical impulses around the heart originate from the SA node (see ﬁgure 1.1) and propagate to the ventricles (see section 1.3), signal block can occur at many different regions along this route [121]. As previously mentioned, the heart has a number of subsidiary pacemakers located in the AV junction (or node) and the ventricular myocardium.
If the AV junction fails to receive impulses, as a result of sinoatrial (SA) arrest or block, it will take over as the cardiac pacemaker. If the AV junctional pacemaker fails or its impulses are blocked then a ventricular pacemaker will take over and the resulting QRS complexes will be broadened. These are known as escape rhythms and their morphologies vary signiﬁcantly from normal beats.
If the R-peak of the beat occurs earlier than expected then it is known as an ectopic beat, such as the third peak in ﬁgure 1.5. (Deﬁnitions vary, but a typical value is around 20% earlier than the previous beat [138].) Although non-sinus beats can arise from any region of the heart an ectopic beat is usually classiﬁed as atrial, AV junctional or ventricular. A ventricular ectopic beat (VEB) is characterised by a
3From the Greek meaning ‘out of place’; also known as extrasystoles or premature beats. 4Any variation from the normal (sinus) rhythm of the heart beat, including preamture beats, heart block, atrial ﬁbrillation and atrial ﬂutter.
7

mV

SAMPLE NUMBER
¿ Figure 1.5: A Ventricular Ectopic Beat in the middle of a set of normal beats ( Ö beat from the left) for
subject 109 of the MIT-BIH database.
broad QRS complex. Occasionally a VEB is followed by an inverted P-wave, but there may be a full compensatory pause before the next normal beat instead. VEBs can also occur at the same time as the Twave of the preceding beat (R on T ectopics) and may trigger ventricular arrhythmias. VEB identiﬁcation is an important step in detecting the onset of such fatal arrhythmias.
In the mid 1980’s the literature surrounding the utility of ectopic beats as an independent measure of increased risk of MI or sudden death was highly contradictory and no clear conclusion could be drawn at that time [96, 147, 177, 228] even during stress tests [217]. However, by the mid 1990’s a large body of research had accumulated to indicate that an increased frequency of ectopic beats (particularly ventricular) is an independent marker associated with a statistically signiﬁcant increase in risk of cardiovascular disease [12, 261, 280, 282].
1.5 The physiology of beat-to-beat heart rate control and HRV
ÀÊ A subject’s baseline heart rate (usually the beat-to-beat HR averaged over 60 seconds ¼) varies
on an intra-patient basis (depending upon activity) and on an inter-patient basis (depending on their
ÀÊ cardiovascular ﬁtness). However, the instantaneous RR interval or beat-to-beat heart rate ( ) also ÀÊ ÀÊ varies around the mean ( ¼). Figure 1.6 illustrates how typically varies for a normal subject at
rest over approximately 60 seconds. Note that the average heart rate is about 72 bpm, although there appears to be a trend from this mean to around 80 bpm and then down to about 70 bpm over this 60
8

second segment. This phenomenon of the heart rate rising and falling on different time scales is known as Heart Rate Variability (HRV). Although the irregularity of the beat-to-beat intervals of a human heart was ﬁrst noted in the early 1600’s [181], its physiological importance was not appreciated until 1965 when Hon and Lee [119] noted that fetal distress was preceded by changes in the pattern of beat-tobeat intervals before any signiﬁcant change in the baseline heart rate. Since then many different indices and techniques have been proposed and tested on a great variety patient groups with varying degrees of success [181]. Before an overview of the most promising HRV analysis techniques is presented, a detailed description of the regulators or HR and HRV is required.
ÀÊ Figure 1.6: Instantaneous or beat-to-beat heart rate, ,(lower trace) and RR interval (middle trace) for
a 1 minute segment of ECG (upper trace).
1.5.1 The autonomic nervous system and the sympathovagal balance
The brain, via the CNS, regulates two motor systems, the voluntary motor system (muscular control of the limbs, body and head) and the involuntary motor system or autonomic nervous system (ANS). The ANS regulates the internal organs, including the heart, digestive tract, lungs, bladder and blood vessels. (It should be noted, however, that it is possible to exert voluntary control over internal organs, e.g. by deliberately overbreathing.)
9

The ANS is divided into two opposing branches, the sympathetic and the parasympathetic nervous systems, which exert opposing effects on most organs. The parasympathetic nervous system can be thought of as the ‘rest and digest’ mechanism and causes HR and blood pressure (BP) to drop (as well as the pupils to constrict) and the digestive system activity to increase. The sympathetic nervous system is rapidly activated in physically or mentally stressful situations and is therefore sometimes referred to as the ‘ﬁght or ﬂight’ response. It causes increases in HR, cardiac output5, blood ﬂow to the muscles, pupil dilation and a decrease in digestive system activity. Animals lacking a healthy sympathetic nervous system ﬁnd it difﬁcult to deal with physical and mental stress. The complicated interaction between the sympathetic and parasympathetic branches of the ANS and the overall effect that they have on the autoregulation of the cardiovascular system and the autonomic tone, has become known as the sympathovagal balance.
In the sympathetic system (the left side of ﬁgure 1.7) the spinal cord neurons innervate an adjacent series of ganglia. Neurons from these ganglia innvervate the internal organs. In the parasympathetic system (right side of ﬁgure 1.7), motor neurons from the brain stem innervate ganglia found in the internal organs themselves which in turn innervate the organ in which they are found. The parasympathetic axons from the brain stem extend to the internal organs in various cranial nerves, particularly the vagal nerve (vagus). This nerve, which fans out over a signiﬁcant portion of the interior lung wall lining is the dominant path for parasympathetic stimulation. For this reason, parasympathetic action is often referred to as vagal nerve activity.
The sympathetic and parasympathetic nervous system ganglia are not simply relay stations and their internal synaptic interactions are not well understood. However, it is well established [70] that the neurons of the parasympathetic ganglia release acetylcholine at their terminals whereas norepinephrine (or noradrenalin) is released from the terminals of the sympathetic ganglia. Internal organ regulation is consequently achieved by administering chemical blockers of these agents and norepinephrine is therefore currently used as the clinical standard for measuring the level of sympathetic nerve trafﬁc to the human heart.
Note that the stimulatory frequencies of the branches of the nervous system are much higher than
ÀÊ the resultant frequency of the cardiac cycle ( ). The vagal and sympathetic stimulations do not have
a direct effect on the sinoatrial node but change the sensitivity of this region of the heart (in a competing fashion). When the varying levels of stimulation cross a certain threshold, the sinoatrial node
5The volume of blood ejected from the right ventricle (stroke volume) times HR.
10

Figure 1.7: Organisation of the autonomic nervous system. The sympathetic system (left) is stimulated by stressful situations, increases HR, cardiac output, blood ﬂow to the muscles and inhibits digestive activity. Stimulation of the parasympathetic branch of the ANS (right) leads to increased digestive activity, and depresses BP, HR, cardiac output. Taken from [70].
is activated. Heart cells have two types of neuromodulatory receptors, one for acetylcholine and one for norepinephrine corresponding to the parasympathetic and sympathetic nervous systems respectively. Their receptors in turn interact with inhibitory or excitatory proteins which through a series of chemical
exchanges, decrease or increase the calcium (Ca¾·) in the heart cell membrane and inhibits or stimulates
HR and the strength of contraction [170]. The heart’s intrinsic pacemaker (the sinoatrial node) causes a HR of around 100 to 120 bpm in the
absence of any neurohumoral (nervous and hormonal) inﬂuence. However, for a healthy heart with no conduction block, the variation of the heart rate is a manifestation of both the (antagonistic) effects of the parasympathetic and the sympathetic nerves through changes in acetylcholine and norepinephrine levels, and a resting healthy human is likely to have a heart rate of around 70 to 80 bpm. During rest both autonomic divisions (the sympathetic and parasympathetic) are thought to be tonically active (i.e. they
11

¡ ÀÊ Figure 1.8: Chronotropic RR interval (- -) and

(-º-) responses to graded efferent vagal stimula-

tion (from Malik [105]). Note that the increase in RR interval is proportional to the increase in vagal

stimulatory frequency.

have a minimum baseline activity) with the parasympathetic (vagal) effects achieving dominance [170]. Each set of motor neurons that form these two nerve divisions interact in a highly complex manner and the modulation of HR cannot simply be interpreted as a linear sum of two opposing effects: a tachycardic response (i.e. increase in HR) from the sympathetic branch of the ANS and a bradycardic response (a slowing of the HR) from the parasympathetic branch, since they act over different time scales. The parasympathetic response is almost immediate (with only a 400ms latency period) and short lasting, whereas following the onset of sympathetic stimulation there is a delay of up to 5 seconds followed by a steady increase in HR for the next 20 to 30 seconds [105]. Sympathetic activity augmentation is the body’s principal method for increasing the HR above the intrinsic level generated by the sinoatrial node to the maximum possible (from about 110 to 200 bpm).
Furthermore, while increased frequency of vagal nerve stimulation tends to slow the beat-to-beat

12

ÀÊ heart rate, , (see ﬁgure 1.8) and increased frequency of signalling in the sympathetic nerves tends to ÀÊ increase , at stimulatory frequencies close to that of the sinoatrial node, the cardiac pacemaker can ÀÊ synchronise with the vagal impulses and small increases in vagal frequency may actually cause the
to increase instead. i.e. an increase in the frequency of vagal stimulation can cause an almost immediate increase in heart rate, the opposite of the normal response.
1.5.2 Reﬂexes controlling heart rate and its variability
The vagal and sympathetic centres are simultaneously stimulated by many different receptors in the cardiovascular and central nervous systems. These receptors, in general, have either a tachycardic or bradycardic effect on the heart rate. The following summary of HR-modulating response mechanisms is taken from Hainsworth et al. [105]:
Bradycardic Reﬂexes
¯ Baroreceptors are situated in the adventitia6 of some arteries and cause increases in vagal and
decreases in sympathetic activity. Increases in blood pressure will stretch these vessels and cause a rapid increase in baroreceptor discharge frequency. However, this frequency then rapidly falls to a moderate (but still elevated) level. The receptors quickly reset to change their operating range if a change in pressure continues although chronic resetting can occur over a period of many months. These receptors modulate HR on a beat-to-beat basis through parasympathetic stimulation and over a much longer period through sympathetic nerve stimulation.
¯ Carotid chemoreceptors – Stimulation by noradrenalin leads to slowing HR and increases in the
rate and depth of respiration. The direct effect on HR changes may be masked by the effect of respiration (which also modiﬁes the HR - see below).
¯ Coronary chemoreﬂex – A slowing of the HR, mainly stimulated by increases in ventricular
pressure - thought to be present only in MI patients.
¯ Lung hyperinﬂation – Abnormally large increases in lung volume may stimulate certain pul-
monary nerves which innervate the bronchi and lungs and may be stimulated during hyperinﬂation of the lungs.
6Membranous structure covering the organ.
13

¯ Indirect RCV changes – Pulmonary congestion, embolisms or intra-venous (IV) injections of
CNS depressants will also cause a bradycardic response.
Tachycardic Reﬂexes
¯ Metabaroreceptors – Situated in the muscle and stimulated by metabolites produced during ex-
ercise. Unlike the baroreceptors they do not respond to stretching or pressure.
¯ Atrial receptors – Stimulated mainly by stretching from increases in atrial volume with a fre-
quency proportional to the atrial pressure.
¯ Aortic chemoreceptors – Stimulation leads to an increase in HR and in the rate and depth of
respiration.
¯ Muscle receptors – Effort in the muscle groups associated with the cardiovascular system will
innervate the heart through stimulation of receptors sited in particular muscles.
¯ Lung inﬂation (moderate pressures) – stimulates airway stretch receptors attached to the myeli-
nated nerves.
¯ Baroreﬂex – Receptors in the arterial and vascular systems sense changes in tension through being
stretched by the pressure changes. An decrease in tension (from a drop in BP for example) causes the heart to beat more often and more forcefully while a BP increase produces a bradycardic response.
1.5.3 Factors inﬂuencing heart rate and its variability
Apart from the autonomic regulation of the heart via the sympathetic and parasympathetic motor neurones, the average heart rate and the variation of the RR interval (and hence instantaneous heart rate,
ÀÊ ) are controlled by a variety of other factors.
Intra-patient factors The following is a list of known changes that can occur for most humans from either internal stimuli or exogenous interventions.
14

ÀÊ Figure 1.9: Two minutes of ECG, , RR interval and respiration (from upper to lower trace respec-
tively) from a healthy subject exhibiting RSA. Compressions and rarefactions can clearly be seen in the occurrence of the R-peaks (tall spikes in the ECG). This is reﬂected in the cyclical changes in the HR
¾ ¿ and RR interval ( Ò and Ö traces). Note that the lower trace represents volume changes in the chest; ¾ as the subject inhales the trace rises and the HR ( Ò trace) rises, and when the subject exhales the lower
trace falls and the HR drops. From 120 to 180 seconds the subject is breathing at almost 4 respirations per minute (rpm). From 180 to 220 seconds the subject was instructed to breathe at about 7 rpm
¯ Respiratory Sinus Arrhythmia (RSA) – this phenomenon, initially documented by Hales in 1733
ÀÊ [7], is the acceleration or on inspiration, and its deceleration on expiration. The magnitude of
the effect is highly variable (or non-existent in some older or inﬁrm subjects) and tends to be larger the slower and deeper the breathing is [181]. Figure 1.9 illustrates this phenomenon whereby the QRS complexes are bunched more closely when the respiration trace is moving upwards indicating inspiration. (Here the respiration signal is derived from impedance pneumography; a 22 kHz signal is passed between two ECG electrodes and as air moves in and out of the thorax, the capacitance and hence electrical impedance of the upper body (between these electrodes) changes. The sinusoidal-like variations in electrical impedance at this frequency are therefore representative of the inhalations and exhalations of the subject.) In this case the breathing is deliberately controlled, at about 4 respirations per minute (rpm) initially and then at 7 rpm. Note that the beat-to-beat heart
15

rate changes synchronously with the (noisy) respiration trace.
RSA is mainly mediated through changes in efferent vagal activity and its magnitude is claimed to provide an index of the level of vagal activity to the heart [161]. RSA is partly inﬂuenced by the physical action of the lungs and the cardiac ﬁlling volume from the variations in intrathoracic pressure. However, RSA can be observed in the absence of breathing and therefore the mechanism is partly due to a CNS effect [181]. Furthermore, changes in HR similar to those caused by RSA have also been observed in denervated hearts7 and this is thought to be related to increased stretching of the sinus node caused by inspiratory increases in venous return [255]. A more detailed explanation of this will be presented in section 1.7.2.
¯ ¢ Cardiac Output (stroke volume HR) changes – At rest, changes in HR between about 80 and
150 bpm have little effect on cardiac output because the increase in HR is compensated for by the decrease in stroke volume. Below about 50 bpm stroke volume tends to be ﬁxed and so output falls with HR.
¯ Valsalva Man uvre – A respiratory procedure which is thought to provide a rough guide to the
integrity of the autonomic neural pathways involved [181]. The subject takes a deep breath followed by a maximal expiratory effort against a closed glottis. This generates an intra-thoracic pressure of around 100 mmHg which is transmitted to the intra-thoracic and abdominal blood vessels. Initially, pulmonary arterial pressure increases but venous return from outside this region is impaired so the cardiac output falls and BP decreases. The resulting baroreceptor activity causes a rising HR and vascular resistance together with the restoration of mean arterial pressure. On removal of the obstruction, venous return is initially enhanced causing a marked overshoot of BP and baroreﬂex-mediated bradycardia. Patients suffering from autonomic neuropathy show a sustained fall in pressure during the procedure with little or no compensatory tachycardia or a following BP overshoot and bradycardia.
¯ Decreases in Venous Return – A decrease in the amount of blood returning to the heart can be
caused by h morrhage and postural stress (causing blood pooling). Cardiac ﬁlling pressures are consequently reduced (hypovolemia) and the intra-vascular volume moves towards the peripheral veins. This normally causes a HR increase in the short term.
7Those physically disconnected from the CNS by a medical procedure.
16

¯ The Baroreﬂex and the vasovagal reaction – The Baroreﬂex uses arterial and vascular mechanical
stretch receptors to adjust the HR if the BP changes. When venous return decreases, BP remains constant or slightly increases while vascular resistance and HR increase. However, despite these increases in vascular resistance and HR this is not enough to compensate for the falling BP from a decreased return in blood volume. Finally if the venous return is too low there may be an abrupt fall in BP and loss of consciousness accompanied by a decrease in vascular resistance and HR. This is known as the vasovagal reaction.
¯ Exercise – This immediately induces an increase in HR through a CNS mediated vagal withdrawal.
Metabaroreceptors within the muscle also become stimulated to increase HR further through increased sympathetic activity which vasoconstricts the non-exercising muscles and splanchnic (soft internal organ) circulation. Receptors involved in lung inﬂation and possibly baroreceptor inhibition also contribute to the process. Less ﬁt, aged or extremely youthful hearts have a lower HR maximum and a higher resting HR. Training increases the amount of cardiac muscle and stroke volume to produce a higher maximum and lower resting HR.
¯ Thermoregulation – Peripheral and core body temperature are controlled by both internal and
external factors. This may affect peripheral resistance, the resistance to blood ﬂow in the peripheral blood vessels.
¯ Embolisms – When a small blood vessel is obstructed by fragments of material carried by the
blood ﬂow the result is often a tachycardic response as well as the destruction of the organ (in whole or part) that is supplied by this vessel.
¯ Intra-venous (IV) injections – Stimulatory or inhibitory chemicals can be intra-venously injected
to increase or reduce HR.
¯ Circadian Rhythms – These are deﬁned to be variations in biological activity that appear to have
a natural cycle of between 23 and 27 hours, but are often locked into the 24-hour day-night cycle [165] (due to light exposure). The most prominent 24-hour physiological variation in humans is that of the fall in blood pressure and HR for a normal subject while asleep (see ﬁgure 1.10). The factors which affect this variation include the health of a patient’s ANS, circulating and local hormones, level of patient awareness and the strength of the heart itself [186]. A more in-depth description of these complicated changes will be presented in chapter 5.
17

Figure 1.10: BP and HR proﬁle in a normal subject over a 24-hour period. On the horizontal axis, a time of 16 means 4pm and a time of 28 means 4am. Taken from [186].
Inter-patient factors
Although it is possible to expect certain differences in baseline (resting) HR and HRV depending on the type of patient, there are multiple factors that contribute to these differences. It is therefore difﬁcult to categorise or assess patients without using demographic data. The major factors that lead to inter-patient differences in HR and HRV (independently of the intra-patient factors presented above) are:
¯ Genetics and family history – Although family history can be an important risk factor for cardio-
vascular disease [21], relatively little is known about the nature of speciﬁc genetic risk factors. Research into this area is beginning to grow and some researchers [146] are attempting to identify and characterize genes responsible for inherited disorders in the hope that this information will also provide some insight into common forms of cardiovascular disease.
¯ Sex – The depression of HRV with age tends to be more marked in males and post-menopausal
women, supporting the idea that oestrogen provides some form of protection against coronary heart disease [254]. Furthermore, Barrett-Conner et al. [21] found that a positive family history of heart attacks was only independently predictive of death in men and not (pre-menopausal) women.
¯ Age – HRV is lower in the old and very young although this may be masked by the subject’s sex
and overall level of ﬁtness [254].
18

¯ Medical condition and level of ﬁtness – High cholesterol levels tend to be associated with lower
HRV [254].
Furthermore, Blood Pressure Variation (BPV) which affects the overall HRV is known to depend on body mass index, mean BP and BRS, which are known to have a signiﬁcantly lower within patient population variance than inter-group variance [163].
1.5.4 HR and HRV correlation
Coumel et al. [59] stress that the strong correlation between HR and HRV should not be interpreted as the fact that HRV is simply a complex way to measure HR. Although they point out that HR is probably the best index of the sympathovagal balance, they emphasise that a loss of correlation between HRV and other physiological parameters should be looked for as a sign of deterioration in the patient’s state (such as the h modynamic state if the correlates are HR and HRV). Furthermore, since HRV tends to be a function of the baseline HR they suggest that it could be advantageous to normalise the HRV using the HR but do not suggest a scheme other than the fact that it should not be linear.
1.6 Quantifying HRV
Short term and long term variations in HR are known to have different physiological origins and the magnitude of these variations has been shown to be indicative of the autonomic state of a patient [181]. Over the last 20 years, much effort has been put into quantifying these variations with a view to making clinically useful assessments of patient welfare [184]. This section provides an overview of the metrics (and their relevance to autonomic function) which have been found to be the most useful.
1.6.1 HRV metrics from the RR tachogram
HRV metrics are calculated from an analysis of the RR tachogram; the time series of RR intervals. It is important to note that this is an unusual time series in that both axes are time intervals, one being related to the other. Furthermore, since the variability in HR occurs on a beat-to-beat basis, the time series is inherently unevenly spaced along the horizontal axis. Figure 1.6 illustrates this concept; each star indicates the location of a beat in time (along the horizontal axis). The horizontal distance between each point (time stamp) is different for each adjacent pair, with the difference recorded on the vertical
19

axis. The fact that the RR tachogram is inherently unevenly sampled leads to complications and errors in metrics that utilise interpolation, as will be demonstrated in chapter 4.
There are many ways of assessing HRV and a comprehensive list of metrics investigated since the 1960’s are detailed by Malik et al. [184]. They can be broken down into three basic categories:
¯ those that measure the statistical properties of the data (often referred to a geometrical indices as
they attempt to categorise the shape of a histogram of RR intervals),
¯ those that evaluate statistics in the time domain, ¯ and thirdly, frequency domain metrics.
Note that these are all linear techniques. Some nonlinear techniques have been proposed, but there is as yet no clear consensus on the applicability or accuracy of such techniques [184].
1.6.2 Selected time domain measures of HRV
Geometric indices HRV indices that are generally referred to as geometric (in contrast to time-series methods) attempt to quantify the shape of the histogram of the RR tachogram. According to Malik [182] there are three basic approaches:
1. some measurement of the geometrical form of the histogram is made (e.g. the baseline width or the height of the sample density) and the HRV measure is derived from this number or,
2. the geometrical pattern is approximated by a mathematically deﬁned shape and the HRV measures are derived from the shape parameters, or
3. the general pattern of the geometrical form is classiﬁed into one of several predeﬁned categories and the HRV metric is derived on a category speciﬁc basis.
The following list of indices is recommended by the Task Force of the European Society of Cardiology and the North American Society of Pacing Electrophysiology, [184], the accepted standard for HRV measurement practice:
20

¯ HRV triangular index (or HRV index) – Total number of all NN (normal-to-normal)8 divided by

the maximal height of the histogram of all NN intervals measured on a discrete scale with bins of

½
×

seconds,

where

× is the sample rate of the ECG recording.

¯ TINN – (ms) Triangular Interpolation of the histogram of the NN intervals. This is calculated by

approximating the NN interval distribution to an isoceles triangle and measuring the width of the

unequal side (the base).

¯ Differential index – (ms) Difference between the widths of the histogram of differences between

ÆÆ´Øµ℄ ½¼ adjacent NN intervals (hist Æ

) measured at selected heights (e.g., at the levels of ¿ and

½¼ samples).

¯ Logarithmic index – Coefﬁcient, of the negative exponential curve

, which is the best

approximation of the histogram of absolute differences between adjacent NN intervals where

ÆÆ´Øµ ℄ d= Æ

and is an arbitrary scaling factor. Estimation of is usually done by ﬁtting to

the log of the distribution. The higher the value of , the tighter the distribution and the lower the

overall variability.

These methods tend to be relatively insensitive to outliers and are therefore considered to be robust to artefacts and computational errors in the RR tachogram derivation. However, they are sampling frequency and recording length dependent. Furthermore, they do not deal well with multi-modal distributions (often caused by sudden shifts in the baseline HR), concentrating on the dominant peak in the histogram and underestimating the overall HRV. For this reason they tend to be used only on very stable patients with little change in baseline HR over well-deﬁned periods (usually 24 hrs).

1.6.3 Scale-independent measures of HRV
Various detrending techniques have been proposed to remove baseline shifts, but usually a scale must be chosen over which the detrending is performed and the HRV is over-estimated at this scale. Recently, scale-invariant techniques have also been proposed [15, 16, 17, 29, 268] to allow a measure of the fractal behaviour of the RR tachogram. These methods include:
¯ The Fano Factor [268]: the variance of the number of events in a speciﬁed counting time Ì divided
by the mean number of events in that counting time. It is a measure of correlation over different
8intervals formed from the RR tachogram by excluding non-sinus beats.
21

time scales Ì . This measure is sometimes called the index of dispersion of counts.

¯ ´ µ Wavelet variance estimation or Wavelet-Transform Standard Deviation [130] is given by Û Ú Ñ

Ï´ µ ℄ Ï´ µ Ñ

¾

½ ¾

where

Ñ is the wavelet transform calculated over a set of Ñ scales in integer

powers of 2 (in the case of the dyadic wavelet).

¯ The Allan factor [268]: the ratio of Allan variance to twice the mean for a given segment. The

´¡ÊÊµ Allan Variance, ¾ ½¾

¾ , is the expectation of the ﬁrst difference of an RR time

¡ÊÊ series ( ). Since the Allan factor functions as a derivative, this variance converges for most

of the commonly encountered kinds of noise, whereas the classical variance does not always con-

verge to a ﬁnite value and therefore the Allan factor has the additional effect of mitigating against

nonstationarities.

¯ Detrended Fluctuation Analysis (DFA) [15]: An integrated RR interval time series, is divided into
boxes of equal length, Ò. In each box of length Ò, a least squares line (or polynomial curve) is

ﬁt to the data. The local trend is then removed from the box (detrending). The root-mean-square
´ µ ´ µ ﬂuctuation of this integrated and detrended time series is denoted by Ò . Ò is calculated over

all applicable time scales (box sizes), between some reasonable minimum and maximum length.

´ µ ÐÓ ´ µ℄ ÐÓ ℄ Typically, Ò will increase with box size Ò. A linear relationship on a

Ò to Ò plot

indicates the presence of power law (fractal) scaling and under such conditions, the ﬂuctuations

can be characterized by a scaling exponent, the slope of this plot.

However, Teich et al. [268] demonstrated explicit links between these methods and power spectral density and it has been shown that all these measures could be expressed in terms of the power spectral density of the signal. In fact, in the case of stationary or quasi-stationary data, the above methods have been shown to give the same results as power spectral density methods. Furthermore, Heneghan et al. [112] have shown that there is a one-to-one correspondence between measures such as the DFA
slope ( ÐÓÐÓ ´ÒÒ℄µ℄) and the PSD measured over the same time scales. The analysis in this thesis is therefore
conﬁned to linear PSD estimation techniques and the results can be relevant to scale-invariant techniques.

22

Statistical indices Statistical HRV indices are calculated on a beat-to-beat basis and are based on Euclidean root-meansquare (rms) metrics. They are therefore, sensitive to outliers and more suited to hand-edited data (which is usually short term due to the labour-intensive nature of such work). Time series indices are generally broken down into two broad categories [154]:
1. Variables directly derived from the beat-to-beat intervals, such as the mean HR and the standard deviation (SD) for the entire record.
2. Variables based on the differences between adjacent cycles, such as the proportion of differences between adjacent cycles that exceed an arbitrary limit.
The following indices are recommended by the Task Force of the European Society of Cardiology and the North American Society of Pacing Electrophysiology, [184]:
¯ SDNN (ms) – Standard deviation of all NN intervals (also known as SDRR) usually over 24 hours. ¯ SDANN (ms) – Standard deviation of the averages of NN intervals in all 5-minute segments of the
entire (24-hour) recording.
¯ RMSSD (ms) – The square root of the mean of the sum of the squares of differences between
adjacent NN intervals.
¯ SDNN index (ms) – Mean of the standard deviations of all NN intervals for all 5-minute segments
of the entire (24-hour) recording.
¯ SDSD (ms) – Standard deviation of differences between adjacent NN intervals. ¯ NN50 (count) – Number of pairs of adjacent NN intervals differing by more than 50 ms in the
entire recording; three variants are possible - counting all such NN intervals pairs, counting only pairs in which the ﬁrst interval is longer, and counting only pairs in which the second interval is longer.
¯ ± ¼ pNN50 ( ) – Percentage of adjacent NN differing by more than ms over an entire 24-hour ECG
recording.
23

Many variations of these indices have been investigated with varying degrees of success. For instance, Grifﬁn and Moorman [98] recently showed that neonatal sepsis is associated with a reduced baseline HR variability coupled with short-lived decelerations of HR and consequently the mean and SD of such distributions are often similar to those calculated from the ECG of normal (healthy) neonates. However, Grifﬁn and Moorman found that the observed decelerations signiﬁcantly altered the third moment of the distribution of one hour RR interval segments. Therefore, measuring this skewness allowed the differentiation between septic neonates and normal neonates up to 24hrs before diagnosis of sepsis in the degenerating group. It should be noted however, that the robustness of higher order moments in the context of HRV has yet to be demonstrated.
1.6.4 Components in the frequency domain
Heart rate changes occur on a wide range of time scales; millisecond sympathetic changes stimulated by exercise cause an immediate increase in HR resulting in a lower long term baseline HR and increased HRV over a period of weeks and months. Similarly, a sudden increase in blood pressure (due to an embolism for example) will lead to a sudden semi-permanent increase in HR. However, over many months the baroreceptors will reset their operating range to cause a drop in baseline HR and BP. In order to better understand the contributing factors to HRV and the time scales over which they affect the heart it is useful to consider the RR time series (or tachogram) in the frequency domain.
Components in the long term
Power spectral analysis was ﬁrst introduced into HRV analysis in 1981 by Akselrod et al. [6]. Since then many authors have applied a variety of power spectral estimation techniques. In order to facilitate interstudy comparisons, the frequency spectrum of an RR interval tachogram has been split (by deﬁnition) into four frequency bands:
¯ ULF - Ultra Low Frequency – ¼ ¼¼¼½ÀÞ ÍÄ ¼ ¼¼¿ÀÞ ¯ ¼ VLF - Very Low Frequency – ¼¼¿ÀÞ ÎÄ ¼ ¼ ÀÞ ¯ ¼ LF - Low Frequency – ¼ ÀÞ Ä ¼ ½ ÀÞ ¯ ¼ HF - High Frequency – ½ ÀÞ À ¼ ÀÞ
24

Figure 1.11: Typical FFT of RR intervals over 24hrs. (Taken from [184]). Note that the Meyer waves are masked by the power spectral dominance of the VLF and ULF contributions
Figure 1.11 shows a typical 24-hour PSD with the above bands marked (using logarithmic scales on both axes). Over such a period, frequencies below 0.04 Hz (VLF and ULF) become dominant.
The motivation for splitting the spectrum into these frequency bands lies in the belief that the distinct biological regulatory mechanisms that contribute to HRV act at frequencies that are conﬁned (approxi-
¼ ¼ mately) within these bands. Fluctuations below Hz in the VLF and ULF bands are thought to be due
to long-term regulatory mechanisms such as the thermoregulatory system, the reninangiotensin system (related to blood pressure and other chemical regulatory factors) and other humoral factors [46]. In 1998 Taylor et al.[267] showed that the VLF ﬂuctuations appear to depend primarily on the parasympathetic outﬂow. In 1999 Serrador et al. [247] demonstrated that the ULF band appears to be dominated by contributions from physical activity and that HRV in this band tends to increase during exercise. They therefore assert that any study that assesses HRV using data (even partially) from this frequency band should always include an indication of physical activity patterns.
Components in the short term
It is generally accepted in the clinical community that the HF band is a measure of the parasympathetic outﬂow [46]. However, the physiological interpretation of the LF band is more controversial and although
25

Figure 1.12: AR spectral analysis (model order 12, 10 minute window) of an RR tachogram in a healthy
¼ subject at rest and during Ó head-up tilt. At rest, two major components of similar power are detectable
at low frequencies (LF) and high frequencies (HF). During tilt, the LF component becomes dominant, but as total variance is reduced, the absolute power of LF appears unchanged compared with that at rest. Normalisation leads to predominant LF and smaller HF components, which express the alteration of spectral components due to tilt. The pie charts show the relative contributions from each band together with the absolute power of the two components represented by the area. Taken from Malik et al., 1996 [184].
sympathetic and parasympathetic mechanisms can operate at these frequencies many authors ascribe ﬂuctuations in the LF band to sympathetic activation only [74].
Consider ﬁgure 1.12 where auto-regressive (AR) analysis has been used to generate the power spectral density (PSD) of a 10 minute RR tachogram. We are only interested in the region below 0.4 Hz since the respiratory modulation frequency is the highest component of the HRV signal and this is rarely above 20 rpm (about 0.33 Hz). Two distinctive peaks are usually observed in the PSD, the lower frequency (around 0.1 Hz) being referred to as Meyer waves9 and the higher frequency component (around 0.25 Hz) being attributed to respiration effects. Figure 1.13 is the PSD of the HR from ﬁgure 1.6 derived using Fourier techniques10. Note the spectral peaks at 0.27 Hz (due to RSA; which corresponds to the recorded rate of respiration of 16 breaths per minute) and at 0.1 Hz (the Meyer waves). There is also a
9Often attributed to blood pressure variations. 10Method to be described in detail in chapter 4.
26

Power (linear scale)

0.16 0.14 0.12
0.1 0.08 0.06 0.04 0.02

0.05

0.1

0.15

0.2

0.25

0.3

0.35

0.4

Frequency (Hz)

¼ ¼ ¼ ½ Figure 1.13: PSD (linear axes) of RR intervals for ﬁgure 1.6. Note the peaks at

Hz, Hz

¼ ¾ (probably due to BP ﬂuctuations) and one around Hz - a modulation of the RR tachogram due to

respiration. From observation of ﬁgure 1.6 it can be seen that the subject was indeed breathing at about

16 breaths per minute, or 0.27 Hz.

signiﬁcant VLF contribution below 0.04 Hz.
The ÀÄ -ratio and sympathovagal balance
Rhythms within the HF band, synchronous with the respiration rate, are due to the intra-thoracic pressure changes and mechanical variations caused by the action of breathing. The manifestation of the respiration rhythms on the RR tachogram is known as Respiratory Sinus Arrhythmia (RSA) as can clearly be seen in ﬁgure 1.12. This higher frequency peak (above 0.15 Hz) is mediated almost exclusively by ﬂuctuations of the vagal-cardiac nerve activity [74] and is generally accepted as a marker of parasympathetic activity [116]. The 0.1 Hz peak corresponding to the most dominant of the Meyer waves is mostly mediated by ﬂuctuations of sympathetic nerve activity. Although sympathetic and parasympathetic mechanisms are involved in the LF band, an increase in LF power has always been observed as a consequence of sympathetic activation such as rest-tilt man uvres, mental stress, h morrhage, and coronary occlusion [46]. An increase in LF power is therefore accepted as a marker of sympathetic activation by many authors [137].

27

Since physiological interventions produce reciprocal changes of sympathetic and vagal outﬂows11 it has been suggested [7, 74, 163] that the balance between these opposing neural regulatory mechanisms
can be quantiﬁed by the ratio of the power in the LF to the power in the HF band ( ÀÄ ) which is then taken
as a measure of the sympathovagal balance. Although this metric is generally thought to quantify the relative contributions of the two branches of the CNS, this idea remains a topic of much debate amongst clinicians. However, there is a consensus that this is a useful model for clinical applications [153].
For instance, clinical studies [252, 273] have presented evidence that the ÀÄ -ratio is the best indicator
of post-MI mortality up to one year from discharge, although Valkama et al. [273] show that only changes in the HF band are relevant for assessment of post-MI convalescence. However, there are two problems with the use of the sympathovagal balance for studying cardiac problem related patients. First, their norepinephrine levels may not change or they may decrease (rather than the usual increase for healthy subjects) when sitting upright, thus confusing any averages taken over an extended period. Second, these patients may have unusually high levels of muscle sympathetic nerve activity and norepinephrine levels
with low SD of RR intervals and a low ÀÄ -ratio [74]. The measure must therefore be considered on a
patient speciﬁc basis. In fact sympathovagal balance is only considered to be useful in patients with less advanced stages of heart failure, with little guidance as to which exact criteria identify such patients [74].
Eckberg points out that normalised 0.1 Hz RR interval spectral power changes bear no signiﬁcant relation to baseline levels or baroreﬂex-mediated changes to sympathetic nerve activity (as measured by changes in myocardial norepinephrine) [74]. Furthermore, although there is a quantitative relation between respiratory frequency RR interval (HF) spectral power and vagal-cardiac nerve activity, moderate changes of this activity away from the baseline do not alter this HF power. Conversely, large changes of HF RR interval spectral power provoked by respiratory changes may not reﬂect changes of vagal-cardiac activity. Therefore any analysis must take into account the respiratory changes that occur during the period under analysis.
It has therefore been suggested that power in the HF band is too problematical to measure in most circumstances and that frequency domain measures should concentrate on the lower end of the spectrum. Signorini et al. [250] claim that only the contributions below 0.1 Hz help deﬁne the differences between pathological and non-pathological conditions. These results have been corroborated by the work of Teich et al. [268] in a study to determine which HRV indices proved the most able to differentiate between pathological cases. They found that the indices which were best able to differentiate between
11Over a limited range of arterial pressure; however, some physiological interventions provoke parallel changes [74].
28

pathological and normal clinical states all relied on a variability calculation equivalent to computing the PSD in the LF range. However, it is clear that the power in the HF band does carry information about the beat-to-beat variability of the heart and its ability to function in a healthy manner. For example, La Rovere et al. [164] and McClements [187] have shown that the HF as well as the LF metrics may be useful in long term prediction post-MI. Furthermore, the wealth of clinical studies that have presented
evidence for the ÀÄ -ratio being an excellent indicator of recovery [184, 252] and even the HF band alone
[273], illustrates that it would be unwise to discount the HF metric completely at this stage. The majority of the literature in the ﬁeld of HRV analysis has demonstrated that frequency domain
metrics, rather than time series or geometric metrics, are the most useful indices for assessing patient welfare and differentiating between patient groups [184]. This thesis will therefore concentrate on frequency domain metrics. Furthermore, the origin of long term HRV metrics is unclear and estimates of them may be inﬂuenced by factors as diverse as local conditions (e.g. temperature) [181] and quality of sleep [57]. However, short term metrics have been shown to be capable of assessing neurological activity [181, 184] and therefore may have a clinical interpretation as well as be more amenable to controlled experimentation. The scope of this thesis is thus further narrowed to include studies on only the short term (LF and HF) HRV metrics.
1.7 The cardiovascular respiratory system - parameters and models
In order to gain an understanding of when an analysis of HRV may offer useful clinical information, it is necessary to analyse the interactions between the heart and the rest of the respiratory cardiovascular system.
1.7.1 Baroreﬂex sensitivity
The baroreﬂex causes the heart to speed up and beat more forcefully when the BP falls. Since vasoconstriction then alters the BP and rate of ﬂow, the speed of the baroreﬂex therefore determines the peripheral resistance. The empirical investigation of the sensitivity of the baroreceptor control of the heart rate gives rise to the concept of Baroreﬂex Sensitivity (BRS) which is usually calculated from a measurement of the instantaneous heart rate-arterial pressure response to an intra-venous injection of phenylephrine [161]. The baroreﬂex gain is therefore deﬁned to be the change in RR interval per change in systolic arterial pressure.
29

It has been shown [161] that BRS and HRV may be loosely correlated and that BRS may prove a better indicator for the onset of fatal arrhythmias. In a recent paper Kim et al. [153] used a method they called complex demodulation, separating the signal into a series of band-pass ﬁltered signals of varying length in order to maximise the resolution. They deﬁned BRS to be the instantaneous amplitude of complex-demodulated oscillations in the RR interval divided by the instantaneous amplitude of complexdemodulated oscillations in systolic blood pressure. They claim that this technique was equivalent to power spectral analysis of the RR tachogram.
La Rovere et al. [164] state the need for care in the use of BRS since it is not static after myocardial infarction and sometimes improves shortly after the event. Furthermore, they pointed out that it also varies with activity and emotional state, although not necessarily in the same manner as HRV varies with these states. Despite such complications they found that the values of BRS studied in the ﬁrst month after myocardial infarction remain predictive of outcome during the next one to two years.
1.7.2 The connection between HR, HRV, BP and respiration - a possible mechanism
There is no simple connection between HR, HRV and BP although some measures of HR and HRV are often (inversely) correlated. That is, stimuli that increase HR often depress the variability of the HR in the short term. Conversely, activities that cause a drop in the average HR can lead to an increase in short term HRV. Although the strength of this correlation can change over time and from individual to individual [212], it is useful to consider the cardiovascular system from a static perspective in order to gain an insight into the relationship between the cardiovascular parameters.
The cardiovascular system is a pressure controlled system and therefore factors that inﬂuence changes in BP will also cause ﬂuctuations in HR. In resting humans, beat-to-beat ﬂuctuations in BP and HR are mainly due to respiratory inﬂuences and to the slower Meyer waves [64]. Sleight and Casadei [255] emphasise that there is much evidence to support the idea that beat-to-beat HR variations are a manifestation of a CNS oscillator which becomes entrained to the respiratory rate as a result of afferent input from bronchopulmonary receptors.
It is generally agreed [255] however, that coupling of HR, respiration and the cardiac cycle (the ﬂow of blood around the body with its consequent pressures) can be broadly explained as follows: inspiration lowers intra-thoracic pressure and enhances ﬁlling of the right heart from extrathoracic veins. Right ventricular stroke volume therefore increases and a consequent rise in the effective pressure of the rest
30

of the (lesser) circulation is observed. The rise in effective pressure in the pulmonary veins leads to an increased ﬁlling of the left heart and hence to an increased left ventricular stroke volume.
The resistance and hydraulic capacitances of the lesser circulation create a lag between inspiration and right ventricular output increase and between the rise of effective pulmonary venous pressure and left ventricular ﬁlling. A consequence of this is that stroke volume modulation will decrease with increasing respiratory rate (for a given respiratory depth). Furthermore, the phase lag of the stroke volume change with respect to the corresponding respiratory oscillation will increase for higher rates. In reality, at moderately rapid respiratory rates, the BP and stroke volume fall throughout most of the inspiration. Therefore the fall in arterial pressure with inspiration is due to the preceding expiration. Furthermore, the strength of this relationship increases as the patient moves from a supine to upright position (see ﬁgure 1.12).
During expiration, the longer pulse (or RR) interval buffers any change in diastolic pressure caused by the resultant increase in stroke volume, so diastolic pressure changes may correlate poorly with reﬂex
ÀÊ changes. This supports the notion that respiration drives BP changes, which in turn drive the RR ( )
changes. Diastolic BP changes with respiration are quite small since the inspiratory tachycardia tends to reduce any inspiratory fall in diastolic pressure (as there is less time for the diastolic pressure to drop).
This observation was ﬁrst explained by DeBoer in 1987 [64] and although there have been other mathematical models proposed since then (such as the Baselli Model [24] and the Saul Model [238]), most experimental evidence is thought to support DeBoer’s model [255]. For a more detailed survey of the last 50 years of cardiovascular respiratory modelling the reader is referred to Batzel et al. [26].

1.7.3 The DeBoer model

DeBoer’s model [64] ﬁrst published in 1987, explains how the BP affects both RR interval length and

peripheral (capillary) resistance through baroreceptors and the CNS. Note that no slow regulatory mech-

¼ ¼ anisms (

Hz) are included in the model. Figure 1.14 shows how the cardiac output is determined

by the current value of respiration and the previous RR interval. The new BP value is set by this value of

cardiac output and the peripheral resistance. The new BP value then sets the new value for the RR inter-

val. Therefore the model assumes that respiration ﬁrst affects BP which in turn affects the RR interval.

The LF peak in HR at 0.1 Hz observed in steady-state conditions for humans is explained as a resonance

phenomenon due to the delay in the sympathetic control loop of the baroreﬂex: the reﬂex sympathetic

31

neural outﬂow cannot follow beat-to-beat changes in the BP as sensed by the baroreceptors.

The respiratory signal that drives the HF (RSA) variations in the model is assumed to be unaffected

by the other system parameters. DeBoer chose the respiratory signal to be a simple sinusoid, although

other authors [281] have used more complicated signals. DeBoer’s model was the ﬁrst to allow for the

discrete (beat-to-beat) nature of the heart beat. (All previous models had used continuous differential

equations to model the system). The model consists of a set of difference equations involving systolic

blood pressure (Ë Ô), diastolic pressure ( Ô), pulse pressure (È Ë Ô

Ô), peripheral resistance

(Ê), RR interval (Á) and an arterial time constant (Ì Ê ), with as the arterial compliance. The

equations are then based upon four distinct mechanisms:

afferent
Baroreceptor
Blood Pressure

Central Nervous System
sympathetic (slow)
Peripheral Resistance

vagal (fast)
Cardiac Pacemaker

R-R interval
X

Cardiac Output

Respiration
Figure 1.14: Schematic digram of the cardiovascular system according to DeBoer [64]. Dashed line indicates slow sympathetic control.

32

1. Control of the HR and peripheral resistance by the baroreﬂex - The current RR interval value is a
linear (weighted) combination of the last 7 systolic blood pressure values ( ¼ËÒÔ ËÒÔ ). The current systolic value ËÒÔ, represents the vagal effect weighted by coefﬁcient ¼ (fast with short delays), whereas ËÒÔ ¾ ËÒÔ represent sympathetic contributions (slower with longer delays).
¼ The previous systolic value, ËÒÔ ½, does not contribute ( ½ ) because its vagal effect has already
died out and the sympathetic effect is not yet effective.

2. Windkessel properties of the systemic arterial tree - This represents the sympathetic action of the

¢ baroreﬂex on the peripheral resistance. Basically the Windkessel equation ( ÒÔ ¿ ËÒÔ ½

´ µ ÜÔ

ÁÒ ½ ÌÒ ½

) describes the diastolic pressure decay, governed by the ratio of the previous RR in-

terval to the previous arterial time constant. The time constant of the decay ÌÒ and thus (assuming

a constant arterial compliance ) ÊÒ, the current value of the peripheral resistance depends on a

weighted sum of the last 6 values of Ë Ô.

3. Contractile properties of the myocardium - The inﬂuence of the length of the previous interval
· on the strength of the ventricular contraction is given by ÈÒ ­ÁÒ ½ ¾ where ­ and ¾ are
physiology-dependent constants. A longer pulse interval (ÁÒ ½ ÁÒ ¾) therefore tends to increase the next pulse pressure12, ÈÒ, a phenomenon motivated by the increased ﬁlling of the ventricles
after a long interval, leading to a more forceful contraction (Starling’s law) and by the restitution properties of the myocardium (which also leads to an increased strength of contraction after a longer interval).
4. Mechanical effects of respiration on BP - Respiration is simulated by a disturbing ÈÒ with a sinusoidal variation in Á. Without this addition, the equations themselves do not imply any ﬂuctuations
in BP or HR but lead to stable values for the different variables.
DeBoer uses linearisation around operating points13 (normal human values for Ë Ô Ô Á and Ì ) to
facilitate analysis of the model. He found that with the addition of a simulated respiratory signal there is a good correspondence between the power spectra of real and simulated data. He also pointed out the need
to perform cross-spectral analysis between the RR tachogram and the Ë Ô and respiration signals. Pitzalis
et al. [223] performed such an analysis supporting DeBoer’s model and showed that the respiratory
rate modulates the inter-relationship between the RR interval and Ë Ô variabilities: the higher the rate ¼ 12if ­
13A good approximation when the subject is at rest

33

of respiration, the smaller the gain and the smaller the phase difference between the two. They also provided evidence14 suggesting that the sympathetic drive is not involved in this process. Sleight et al. [255] also present much evidence to support the DeBoer model.
It is known that in some pathological cases (or in the elderly) the coupling between respiration and RR interval can be greatly diminished or completely absent. Some authors [212] have gone further to show that in such cases there may be a reversal of the direction of ﬂow of information, so that the RR interval affects (and leads) the respiration.
1.7.4 Data-driven models
In 1999 Cao and Mees [41] developed a data-driven model for analysing nonlinear interactions between HR, respiration and blood oxygen concentration in the cardiovascular system. They found that it is possible to construct a model which enables reasonably close prediction of the next time step in one signal from a combination of 11 or fewer previous values extracted from the other two signals only. This therefore provides further evidence that BP, respiration and the intrinsic HR are the three main interacting factors in the cardiorespiratory cycle since no other signal is required to provide accurate predictions. However, it should be noted that this analysis was performed on only one subject who was a sleep apn ic and for which the correlations between the signals would be abnormal (see chapter 5 for a more detailed description).
1.8 The clinical utility of Heart Rate Variability
HRV is probably a less straightforward measure of autonomic system activity than plasma catecholamine concentration, baroreﬂex sensitivity measured by response to phenylephrine response, or sympathetic activity as measured through microneurography15 . However, there exists a consensus [181] that HRV does give a useful quantiﬁcation of ANS activity.
Recently Nolan et al. [207] have pointed out that chronic heart failure (CHF) is associated with autonomic dysfunction, which can be quantiﬁed by measuring HRV. They showed that a reduction in HRV identiﬁes patients at high risk of death and that HRV is a better predictor of death due to progressive heart failure than other conventional clinical measurements, such as elevated BP, the cardiothoracic ratio16, left
14The same response is found after ¬-adrenoceptor blockade.
15A technique for measuring electrical signals from human peripheral nerves using a tungsten microelectrode 16The ratio of the maximal transverse diameter of the cardiac silhouette to the distance between the internal margins of the
34

ventricular end-diastolic diameter and the presence of non-sustained ventricular tachycardia. Their results show that high-risk subgroups can be identiﬁed by HRV and elected as candidates for additional therapy.
1.8.1 ATRAMI trials
In 1998 the ATRAMI (Autonomic Tone and Reﬂexes After Myocardial Infarction) trial [164] results were published. The trial was intended to assign dichotomy limits for positive/negative outcome post-MI and other cardiac dysfunction, establishing the sensitivity, speciﬁcity and predictive accuracy of abnormal HRV for the prediction of subsequent events. The ATRAMI study provides clinical evidence that after myocardial infarction the analysis of vagal reﬂexes (measured by the HF metric) has signiﬁcant prognostic value independently of left ventricular ejection fraction17 (LVEF) and of ventricular arrhythmias and that it signiﬁcantly adds to the prognostic value of heart-rate variability. This is consistent with earlier work of McClements et al. [187] and indicates that the HF as well as the LF metrics may be useful in risk-stratiﬁcation.
1.8.2 Standardisation and clinical community recommendations
In Malik’s 1995 book on HRV, Kennedy et al. [148] suggest that deﬁnite standards for the following characteristics are required:
1. Acceptable ECG recording noise (including baseline wander, electrical artefact etc)
2. Identiﬁcation of ectopic beats
3. Determination of stationarity and measurement artefact
4. Sampling rates
5. Recommended ﬁlter procedures to be used in spectral frequency identiﬁcation and analysis
6. Optimal short and long term segments of data for time and frequency analysis
7. Guidelines applicable to PSD estimation
8. Stratiﬁcation based on patient group types - age, ailment, gender
ribs at the level of the right hemidiaphragm. 17LVEF - the fraction of blood volume in the left ventricle, ejected from this chamber each beat
35

This led, in 1996, to the European Society of Cardiology and the North American Society of Pacing Electrophysiology forming a task force to produce a document entitled Heart Rate Variability: Standards of Measurement, Physiological Interpretation, and Clinical Use, [184]. They were charged with ﬁve main tasks;
1. to standardise nomenclature and develop deﬁnitions of terms,
2. to specify standard methods of measurement,
3. to deﬁne physiological and pathophysiological correlates,
4. to describe currently appropriate clinical applications and
5. to identify areas for future research.
This thesis endeavours to use their standard notation and follow the guidelines whenever possible. However, where there is room for improvement it has been made clear in the text and the opportunity has been taken.
They addressed ﬁve main issues in their report [184] and their recommendations are detailed in the following six subsections (1.8.3 to 1.8.8).
1.8.3 Standard terminology
When using time-domain indices, it was recommended that at least two of the following four measures are used18: SDNN and HRV triangular index for an estimate of overall (long term) HRV, SDANN for an estimate of the long-term components of HRV and RMSSD. The choice should be speciﬁc to the type of medical condition being considered and the type of data that it is possible to collect. Furthermore it is inappropriate to compare time domain measures, especially for long term recordings that are derived from ECGs of different time lengths.
For frequency domain measures the Task Force recommended that the number of samples used for the calculation, the size and type of spectral window used and the method of calculating the power in respect of the window is reported to allow inter-study comparisons. Furthermore, when using parametric methods, the type of model, the number of samples, the central frequency for each component and the model order should be quoted. Reporting statistics to test the reliability of the model (such as the
18as deﬁned above
36

prediction error whiteness test for goodness of the ﬁt and the optimal order test to check the suitability of the model order used) is also important.
1.8.4 Measurement standards
For long duration recordings (usually in the time domain) the Task Force recommends at least 18 hours for long term HRV analysis. However, Haaksma et al. [104] performed an in-depth study of the inﬂuence of different time segments on HRV and found that at least 20 hours of data were required for time domain variables or total power19 in frequency analysis.
The Task Force recommends avoiding the use of frequencies below LF in the PSD for HRV assessments as the major constituent of VLF is the nonharmonic component which is strongly affected by algorithms for baseline or trend removal. The Task Force also recommends that if the LF and HF are normalised by TP (the total power less the VLF and ULF contributions) then both the values for the absolute and normalised calculations should be recorded.
Furthermore, it should be noted that components of HRV provide a measure of the degree of autonomic modulation rather than the level of autonomic tone: the averages of the modulations do not represent an average level of tone. There is therefore a great deal of inter-patient variation. Typical values and their spread over typical patient populations can be found in Appendix C.
Other signiﬁcant recommendations include:
¾ ¼ ¼¼ ¯ ECG sampling rates between Hz and Hz,
¯ Careful checks to ensure baseline or trend removal does not affect the frequencies of interest, ¯ Use of an accepted and accurate ﬁducial20 point detector to identify a stable and noise-independent
beat location,
¯ Use of appropriate interpolation techniques, especially in the presence of artefact or ectopy, ¯ Careful thought as to whether the artefact and ectopic rejection criteria cause a bias in analysing
the data that is not discarded,
¯ Reporting the relative number and relative duration of RR intervals that were omitted and interpo-
lated,
19calculated between ¼ ¼¼¼½ Hz and ¼ Hz
20consistent reference point on each beat on the ECG
37

¯ Reporting the type of interpolation algorithm and frequency of resampling, ¯ Frequency domain methods to be preferred to time domain methods for short term recordings. The
recording should be at least 10 times the lower frequency bound of the investigated component, but no longer (to ensure stability of the signal)21,
¯ Short term HRV assessment to be carried out on 5-minute segments, ¯ 24-hour indices recommended to assess intervention therapies, ¯ Environmental variables to be controlled as much as possible during long-term ECG recordings
(nature of physical activity as well as mental and emotional state),
¯ Consideration of whether it is appropriate to compare HRV across patient groups and ¯ Simple automatic editors of RR sequences (such as static timing thresholds) not to be used since
they are known to have undesirable effects leading to potentially serious errors.
Sampling rates In the same year that Malik et al. published the recommendations, Abboud and Barnea [2] showed that a sampling frequency of 128 Hz is sufﬁcient, in patients with normal HRV levels, to give a large enough signal to noise ratio in the RR tachogram. However, for patients with signiﬁcantly lower levels (such as heart transplant patients) they found that a sampling rate of at least 1000 Hz is required.
1.8.5 Physiological and pathophysiological correlates
HRV analysis may permit inferences on the state and function of 1. the central oscillators, 2. the sympathetic and vagal efferent activity, 3. humoral factors, and 4. the sinus node.
21A minimum of one minute to assess the HF component and two minutes for the LF component.
38

Frequency domain methods are more easily interpreted in terms of physiological regulatory mechanisms and the HF band is considered a good marker of efferent vagal activity. The interpretation of the LF component22 as a marker of sympathetic modulation is more controversial. However, the ULF and VLF components account for 95% of the power in the PSD and their physiological correlates are still unknown.
1.8.6 Commercial manufacturers
Commercial companies rarely disclose the methods they employ for assessing HRV, although studies have been carried out on particular systems [195]. Information available in the public domain has been collated by clinicians [181] and a detailed overview of the use of different indices by commercial manufacturers and their products can be found in Kennedy et al. [148]. This 1995 report highlights the fact that most of the frequency and time domain parameters listed above are included in almost all commercial devices. In general all the standard HRV parameters are calculated, allowing the user to choose their preferred methods as well as setting relevant parameters (such as the size and type of window for calculating PSDs). Artefact and ectopic rejection criteria tend to follow Malik et al. [184] as closely as possible. For example, Reynolds Medical use a simple timing criterion for ectopic rejection and a high frequency noise threshold to reject artefactual segments.
1.8.7 Appropriate clinical applications
HRV assessment is considered by the task force on HRV Standards ([184]) as useful in the following clinical conditions:
¯ Assessment of risk after acute MI - Depressed HRV is a powerful predictor of mortality and of
arrhythmic complications. The predictive value of HRV is independent of other factors established for post-infarction risk stratiﬁcation (such as depressed LVEF and increased ventricular ectopic activity) [184, 282].
¯ Prediction of mortality - For prediction of all-cause mortality, HRV is similar to that of left ven-
tricular ejection fraction [184, 208].
¯ Prediction of arrhythmic events - HRV is superior to left ventricular ejection fraction in predicting
arrhythmic events such as sudden cardiac death or ventricular tachycardia [184, 208]
22particularly when expressed in normalised units
39

¯ Assessment of Myocardial Dysfunction - Most patients with a very advanced phase of the dis-
ease and a drastic reduction in HRV show little or no LF component, despite clinical signs of sympathetic activation. Therefore, in conditions characterised by a marked and unopposed persistent sympathetic excitation, the sinus node seems greatly to diminish its responsiveness to neural inputs.
¯ Assessment of outcome after cardiac transplantation: post-operative HRV is highly depressed
[257], [77], [14]. In 1995 Bernardi et al. [30] conducted a large study to measure HRV in response to carotid baroreceptor stimulation in 26 heart transplant recipients at 2 to 63 months after transplantation and found no evidence for return of parasympathetic control of heart rate during this period.
¯ Assessment of Diabetic Neuropathy - A reduction in the time domain parameters of HRV not
only carries a negative prognostic value but also precedes the clinical expression of autonomic neuropathy.
¯ Tetraplegia23 patients represent a unique clinical model to evaluate the contribution of supraspinal
mechanisms in determining the sympathetic activity responsible for LF oscillations of HRV since spinal sympathetic neurons are deprived of modulatory control and in particular of baroreﬂex supraspinal inhibitory inputs.
In 1996 Malik et al. [184] produced a summary of selected studies investigating the clinical value of HRV in cardiological diseases other than those reported above. They also point out that there are several well reported intervention strategies that lead to changes in a patient’s HRV, namely,
¯ ¬-blockade: ¬-blockers cause modest increases in HRV, although they prevent the normal rise in
the LF component observed in the morning hours. In conscious post-MI dogs, ¬-blockers do not modify HRV. Importantly, ¬-blockade increases HRV in the animals destined to be at low risk for
lethal arrhythmias post-MI.
¯ Anti-arrhythmic drugs: These tend to decrease HRV. ¯ Scopolamine: Low dose muscarinic receptor blockers markedly increase HRV indicating an in-
crease in vagal activity. However, the efﬁcacy during long term treatment with this drug is not
23Patients with chronic complete high cervical spinal cord lesions that have intact efferent vagal and sympathetic neural pathways directed to the sinus node.
40

known.
¯ Thrombolysis: HRV is higher 90 minutes after thrombolysis in patients with patency of the infarct
related artery24. The difference is not evident on a 24 hour assessment.
¯ Exercise Training: Exercise training over a reasonable period of time signiﬁcantly increases HRV
and regular exercise is thought to modify the autonomic balance. Exercise can also accelerate the recovery of the physiological sympathovagal interaction, as shown in post-MI patients.
1.8.8 Future research areas
The Task Force recommends the following areas for HRV assessment:
1. Physiological phenomena - investigating the change in HRV during the sleep cycle.
2. Physical training - Assessment of the autonomic nervous system to athletic training and rehabilitative exercise programmes after various disease states, prolonged bed rest and space ﬂight.
3. Pharmacological responses - Considerably more research is required to understand the effects and clinical relevance of altered vagatonic and adrenergetic tone on total HRV power and its various components in health and disease.
4. Risk stratiﬁcation - Prospective studies are needed to evaluate the sensitivity, speciﬁcity and predictive accuracy of combined testing (with other factors such as ST-segment variability).
5. Fetal and neonatal HRV studies - for risk stratiﬁcation and insight into autonomic maturation in the developing fetus.
6. Disease mechanisms - The role of the autonomic nervous system in essential hypertension is an important area of investigation. Furthermore, several autonomic disorders including Parkinson’s disease, multiple sclerosis, Guillain- Barre syndrome and orthostatic hypotension of the Shy-Drager type are associated with altered autonomic dysfunction and therefore changes in HRV may be an early manifestation of the condition and be useful in quantifying the rate of the disease progression and the efﬁcacy of therapeutic interventions. This approach may also be useful in evaluating secondary autonomic neurological disorders that accompany diabetes mellitus, alcoholism, and spinal cord injuries.
24Those whose artery remains open.
41

Malik et al. [184] suggest that additional population based studies involving the full age spectrum for both sexes need to be performed. Furthermore, recent research [38, 131] has shown that guidelines need to be formulated which address the issues of how exercise, wakefulness and drug administration affect variability and how HRV can be meaningfully quantiﬁed in the light of this.
This thesis addresses the ﬁrst and last points (1 and 6) above. In chapter 5, the changes in HRV
and the ANS (as measured by the ÀÄ -ratio) are investigated during the sleep cycle. Chapter 6 presents ÀÄ -ratio changes over the course of controlled experiments on orthosatic hypotensives to investigate the
reaction of the ANS to postural changes in such patients.
1.9 The problem of HRV measurement and repeatability
Although commercial systems for HRV measurement and assessment are available, no existing techniques are considered to be accurate or meaningful enough by clinicians to provide robust measures of patient welfare and outcome prediction [181]. The following points highlight the main reasons for this:
1. In 1993 the FDA stopped approving HRV monitors because they felt the there was no consensus on the usefulness or applicability of HRV measures [3]. Furthermore there was a lack of methods or studies to attest to the accuracy and validity of the methodologies of the commercial manufacturers.
2. Pre-processing methods for the RR time series tend to be arbitrary and ad hoc. Data is selected based on its usefulness for the study and lack of artefact. Therefore the techniques are rarely transferable to other studies.
3. Long term HRV metrics include beat-to-beat variations as well as deﬁnite shifts in the overall heart rate. A shift into tachycardia or bradycardia will lead to a rise in the contribution to the HRV measure employed, yet the intrinsic variability may be quite low. Detrending techniques are often employed to remove such shifts, yet these changes are part of the overall HRV.
4. The non-linear and nonstationary nature of HRV - This leads to abrupt changes in the signal so that HRV metrics are highly susceptible to outliers and artefacts. The complex variation of the RR intervals are due to many interacting stimuli on many different time scales with different magnitudes. It is difﬁcult to choose the window over which to assess HRV and an appropriate weighting for each scale (or contribution). For example, is a small change in the parasympathetic control more relevant than a slightly larger change in the sympathetic control?
42

5. Drugs are continually administered to an ITU patient and dominate the changes in HRV, seriously affecting the clinical utility of such measures.
6. The problem of inter-patient comparability - Due to signiﬁcant inter-patient variation within similar groups it is difﬁcult to ascribe deﬁnite values of HRV metrics to delineate pathology from normal behaviour.
1.10 Overview of thesis
This introductory chapter highlights the main problems that remain in HRV analysis. In a large proportion of the literature concerning HRV metrics, the data is pre-processed by hand, with experts performing artefact rejection and noise removal. Furthermore, many publications are contradictory in asserting which HRV methods produce useful results. This is sometimes due to the manner in which the data is selected or pre-processed. Malik [181] states that there is a need for a fully automatic method of HRV measurement (from the raw data) which is robust and will provide clinically useful results on recordings which possess a typical level of noise and artefact. Furthermore, Malik suggests that the perceived need for visual veriﬁcation and manual correction of long term records has discouraged the assessment of HRV in routine clinical practice and has conﬁned HRV investigations to academic research. The objectives of this thesis are therefore to (respectively) address each of the six problems detailed in section 1.9 as follows:
1. Chapter 4 introduces an artiﬁcal RR interval generator which provides a method of testing the accuracy of HRV estimation methods.
2. Chapter 3 presents methods for automatically removing artefact and ectopic beats from the ECG based upon beat morphology and timing with known conﬁdence levels, allowing the derivation of an RR tachogram with a known level of missing data. Chapter 4 presents a method for the optimal estimation25 of the power in the RR tachogram and results on artiﬁcial and real data are presented to evaluate the performance of these new algorithms in comparison to standard methods. These methods are patient type and ECG database independent .
3. To avoid the complications involved in assessing long term HRV introduced through the highly nonstationary nature of the RR tachogram, only short term periods are analysed, where the data
25In the least squares sense
43

can be considered to be stationary or quasi-stationary.
4. In particular, nonstationarity is reduced by evaluating HRV within sleep states (chapter 5) and during controlled head-up tilt experiments (chapter 6). The equivalence between PSD estimation techniques and non-stationary techniques (see section 1.6.3) for such data, allows the results of this thesis to apply not only to linear PSD-based HRV indices, but to a wider group of scaleindependent indices.
5. The issue of drug administration is addressed by limiting the analysis of real data within the thesis (in chapters 5 and 6) to patient groups with either no or highly similar medication regiments.
6. Chapter 5 addresses the issue of inter-patient comparability by presenting a detailed overview of the functioning of the ANS in response to the external and internal stimuli that can have a signiﬁcant effect on HRV variations. An analysis is then proposed which allows an improved method for minimising within-group HRV variations. An age and sex matched normal test group is compared to an obstructive sleep apnoeic group to demonstrate the improved ability of this method for minimising within-group variation, and increasing between-group separtion in terms
of the ÀÄ -raio.
This thesis therefore investigates signal processing methods for deriving a clinically useful HRV metric in the context of these six issues. Early chapters concentrate on a robust scheme for extracting an accurate, artefact-free, beat-to-beat heart rate time series (or RR tachogram) using ﬁrst morphology and then timing information from the ECG. A generic method of identifying ectopic beats and estimating HRV metrics in the noisy conditions of real clinical situations is then produced. Results of HRV signal analysis are presented with both an empirical and physiological justiﬁcation for concentrating on one particular branch of HRV research (frequency domain evaluation).
Chapter 2 presents a detailed description of a robust algorithm for locating peaks in the ECG (for calculating beat-to-beat timing intervals) and its performance on a standard database. Chapter 3 investigates different methods for removing abnormal beats from the ECG that have been shown to affect frequency-domain estimation of HRV. Chapter 4 gives an overview of frequency-domain metrics and, using artiﬁcially generated data for which the frequency components are known exactly, reports on a comparison between the various techniques for HRV analysis. Results are then presented to test the hypothesis that the removal of abnormal beat-to-beat timings from the heart rate time series is essential for
44

accurate HRV metric estimation. Chapter 5 describes results of frequency-domain HRV analysis on various patient groups. In particu-
lar, the activity-dependence of this type of evaluation is highlighted. A new type of analysis is proposed, involving sleep stage speciﬁc recordings, and results are presented to demonstrate its effectiveness in separating normal from unhealthy patients.
Chapter 6 demonstrates the performance of the algorithms developed in this thesis to assess cardiovascular changes in patients taking part in a strictly-controlled physiological test. The sensitivity of the subjects to external factors is examined and a resultant future research plan is proposed in the ﬁnal chapter.
45

Chapter 2
QRS detection
2.1 Introduction
The RR tachogram is formed from a series of beat-to-beat timing intervals. Therefore, in order to derive a meaningful RR tachogram, a salient point on the ECG waveform, which can be found consistently on each beat, must be identiﬁed. Since the R-peak is the easiest feature to identify, most beat detection algorithms are written to locate this point. The accuracy of the location in time of each peak, and hence the accuracy of the value of each inter-beat interval that comprises the RR tachogram, is therefore dependent on the sampling rate at which the ECG is digitised. As was highlighted in chapter 1, although the current ANSI standards [13] require a sampling frequency of at least 250Hz, subjects with extremely low variability in the RR tachogram may require digitisation rates of 500 to 1000Hz [2] to allow a high enough signal-to-noise ratio and differentiate between the subtle differences in HRV between certain patient populations. However, for the artiﬁcial data and the types of patients analysed in this thesis, sampling rates of 128Hz and 256Hz are sufﬁcient [2].
Furthermore, since beats other than normal (sinus rhythm) beats are generated from outside the normal conduction mechanisms they are not considered to be representative of autonomic control mechanisms that manifest the observed variability in the RR tachogram [181]. The beat-to-beat intervals that do not correspond to the time differences between two sinus beats must therefore be excluded from the RR tachogram. This is discussed in more detail, together with methods for identifying and removing abnormal (non-sinus) beats from the RR tachogram in chapter 3. This chapter provides an overview of the most popular and effective QRS detectors together with a detailed analysis of an implementation of the best known technique.
46

2.2 QRS detection algorithms - overview
In 1990 Friesen et al. [85], published a comparison of the noise sensitivity of the most robust automatic QRS detection algorithms available at the time. The following nine algorithms were chosen: Algorithms based upon amplitude and ﬁrst derivative:
¯ Moriet-Mahoudeaux’s [200] method based upon thresholded peak detection between restricted
windows deﬁned by thresholded derivatives,
¯ Fraden and Neuman’s scheme [82] similar to [200] but with rectiﬁcation and clipping of the signal, ¯ Gustafson’s ([102]) algorithm based upon analysis of consecutive derivatives and thresholding.
Algorithms based on ﬁrst derivatives only:
¯ Menrad’s algorithm ([193]), which locates QRS complexes by thresholding the time-derivative
within speciﬁc windows,
¯ The method of Holdinger ([117]), which is similar to that of Menrad ([193]) but involves several
consecutive derivatives. Algorithms based on ﬁrst and second derivatives:
¯ Balda’s method ([19]), which uses a thresholding scheme for both the ﬁrst and second derivatives
over a speciﬁed time window,
¯ Ahlstrom and Tompkins’ algorithm ([5]), which uses a similar method to Balda ([19]) with the
addition of rectiﬁcation and smoothing. Algorithms based upon digital ﬁlters:
¯ Engelese and Zeelenberg’s method ([76]), whereby the signal is differentiated and low pass ﬁltered
to locate amplitudes over a certain threshold. This deﬁnes regions within which alternate threshold crossings are sought. These are then categorised as being either baseline shifts or QRS complexes.
¯ Okada’s technique ([211]), which involves smoothing with a 3 point moving average ﬁlter, fol-
lowed by low pass ﬁltering, squaring and then thresholding to locate the QRS complex.
The test data in Friesen et al.’s paper [85] was a time series of idealised QRS complexes corrupted by the following noise and artefacts:
¦¼ ¾ 1. Power line interference. — 50Hz Hz mains noise (60Hz in US data) with an amplitude of up
to 50% of full scale deﬂection (FSD), the peak-to-peak ECG amplitude.
47

2. Electrode pop or contact noise. — Loss of contact between the electrode and the skin manifesting as sharp changes with saturation at FSD levels for periods of around 1 second on the ECG (usually due to an electrode being nearly or completely pulled off).
3. Patient–Electrode Motion Artefacts. — Movement of the electrode away from the contact area on the skin, leading to variations in the impedance between the electrode and skin causing potential variations in the ECG and usually manifesting themselves as rapid (but continuous) baseline jumps or complete saturation for up to 0.5 seconds.
4. Electromyographic (EMG) noise. — Electrical activity due to muscle contractions lasting around 50ms between DC and 10000 Hz with an average amplitude of 10% of the FSD on the ECG.
5. Baseline drift. — Usually from respiration with an amplitude of around 15% FSD at a frequency of 0.15 to 0.3Hz.
6. Data collecting device noise. — Artefacts generated by the signal processing hardware, such as signal saturation.
7. Electrosurgical noise. — Noise generated by other medical equipment present in the patient care environment at frequencies between 100kHz and 1MHz for between 1 and 10 seconds.
Engelese and Zeelenberg’s algorithm [76] performed best for the various combinations of noise, in part due to its powerline notch ﬁlter. If the same ﬁlter is added to any of the other algorithms, Engelese and Zeelenberg’s algorithm is no better than the others. The results of Friesen et al. [85] suggest that algorithms based on amplitude and slope are most immune to EMG noise (one of the largest noise contributions). However these algorithms are sensitive to baseline ﬂuctuations. If these can be corrected by high pass ﬁltering or other ﬁltering methods then they offer the best system for QRS detection. A detailed study of an algorithm which incorporates these features (the method of Hamilton and Tompkins [107]) is presented later in this chapter.
It should be noted that the Hamilton and Tompkins algorithm, like all of the non-pattern matching algorithms, is essentially a peak energy-amplitude detection algorithm which almost completely ignores the detailed morphology of the ECG.
48

2.2.1 Available data — the MIT-BIH database
Over recent years, advances in hardware technology have made possible the acquisition of large databases of multi-channel ECGs such as the Harvard and Massachusetts Institute of Technology Division of Health Science and Technology’s MIT-BIH arrhythmia database [194]. This comprises hundreds of two-channel ECGs recorded from patients who suffer from various known heart conditions, as well as examples of healthy ECGs. The two leads of ECG used in the MIT-BIH database are lead I (which gives a morphology similar to lead V5) and lead II (see ﬁgures 1.3 and 1.4 in chapter 1). These records have been annotated by clinicians and thus can be used to develop diagnostic software.
Tools, available from MIT’s web site1, enable the programmer or researcher to call libraries that read and compare the clinician-annotated ﬁles (for each patient) with any test algorithm he or she chooses. The database and libraries of comparative tests conform to the relevant American National Standards Institute (ANSI) guidelines [13] developed by the Association for the Advancement of Medical Instrumentation (AAMI) [1]. The MIT-BIH database is usually quoted as the ECG data source when results of detection algorithms are presented in the literature and all the associated analysis libraries are in ANSI C. This therefore makes it an ideal database on which to test and evaluate any new developments.
Another source of ECG data, used in later chapters of this thesis, was recorded using a multiparameter patient monitoring system developed in the Department of Engineering Science in Oxford University, known as the ”Software Monitor” [266]. Only three electrodes are used to record the ECG in the Software Monitor, one at V5 (the electrode position close to the cardiac apex, deﬁned as Ø intercostal space, anterior axillary line), one at RA (right arm) and one at LL (left leg) - see ﬁgure 1.3. This gives the following three possible ECG signals:
¯ V5—RA : Approximately equivalent to the clinical deﬁnition of channel V5. ¯ RA—LL : Equivalent to the clinical deﬁnition of channel II. ¯ LL—V5 : Unspeciﬁed in clinical literature.
The data collected using the Software Monitor is referred to as the SMP (Software Monitor Project) database. The ﬁrst channel of this database is therefore equivalent to the ﬁrst channel of the MITBIH database. Unless otherwise stated, single lead data in this thesis will be lead I from the MIT-BIH database.
1http://ecg.mit.edu
49

Each patient record in the MIT-BIH database, labelled 100-124 and 200-234, consists of 30 minutes of ECG’s sampled at 360Hz with 16 bit accuracy and labelled by experts. For the purposes of this study the ECG records have been down-sampled using the MIT tools2 to the same frequency and resolution (256Hz, 12 bit) as the ECG data recorded by the Software Monitor. The MIT tools account for any changes caused by the down-sampling (such as aliasing, and annotation timing differences) and generate header ﬁles to allow synchronisation of the labels with the new data ﬁles. The clinicians’ annotations consist of the following labels for each beat (a full list of which can be found in Appendix A):
¯ N — Normal; any beat that does not fall into the S, V, F or Q categories. This category also
includes Bundle Branch Block Beats (BBBB) which give a widened QRS complex and can be indicative of myocardial infarction3. However, the broadening is very hard to detect.
¯ V — Ventricular Ectopic Beat (VEB); ventricular premature beat, an (R-on-T)4 ventricular prema-
ture beat, or a ventricular escape beat.
¯ F — Fusion Beat; a fusion of a ventricular and a normal beat. ¯ Q — Paced Beat; a fusion of a paced (artiﬁcially induced) and a normal beat or a beat that cannot
be classiﬁed.
¯ S — Supraventricular Ectopic Beat (SVEB); an atrial or nodal (junctional) premature or escape
beat, or an aberrant atrial premature beat.
The latter two types of beats are excluded from the analysis described in this report. There are additional labels which are of interest:
¯ ½ ¼ U —- marks the centre of unreadable data segments, beginning Ñ× after the last beat label and ½ ¼Ñ× before the next,
¯ X —- a pseudo-beat label generated during a segment marked as unreadable,
¯ ℄ and — rhythm labels marking the onset and cessation of ventricular ﬁbrillation or ﬂutter (VF)
respectively.
2The xform executable. 3A blockage in the normal conduction paths of the heart that leads to permanent damage to the heart muscle. 4A potentially dangerous condition is induced when a premature ventricular contraction occurs during the T-wave of the preceding QRS-T complex. R-on-T phenomenon can induce ventricular tachycardia or ventricular ﬁbrillation.
50

Note that beat labels are never paired with rhythm labels and beat labelling is discontinued between

these labels. Incorporation of the MIT libraries into an algorithm that a user wishes to test enables the

generation of a test annotation ﬁle of time stamped event labels in a comparable format to the clinician

annotation ﬁles. When the MIT tools are run on these ﬁles a beat by beat comparison is performed, and

an output ﬁle is created that compares the time scoring of events. Two events are held to be simultaneous

¦½ ¼ (by the ANSI standards [1]) if they occur within

Ñ× of each other. Thus, in order to perform beat

by beat comparisons a pseudo-beat label ‘O’ is generated any time the test algorithm labels a point in the
½ ¼ data as a beat and there is no clinician scored label within Ñ×. Table 2.1 is a typical ﬁle generated by
these tools5 for scoring the results from the QRS detector to be described in chapter 3.3.1 being applied

to three different records (patients 100, 101 and 103).
Record Nn¼ Vn¼ Fn¼ On¼ Nv¼ Vv¼ Fv¼ Ov¼ No¼ Vo¼ Fo¼ Q Se Q+P
100 1901 1 0 0 0 0 0 0 0 0 0 100.00 100.00 101 1521 0 1 4 0 0 0 0 0 0 1 99.93 99.74 103 1725 0 0 1 0 0 0 0 4 0 0 99.77 99.94

Table 2.1: Standard output of MIT ﬁles.

Columns 2 to 12 refer to the beat by beat scoring with a capitalised label denoting the actual event (as
labelled by the clinicians) and the lower case letter denoting the labelling provided by the algorithm under
test. Nn¼, Vn¼ and Fn¼ are thus, respectively, the number of normals, VEBs and fusion beats that the test algorithm labelled as normals. On¼ is the number of normal pseudo-beats that the algorithm generated (a ‘normal’ label being generated when there was no beat there). Nv¼ and Vv¼ are, respectively, the numbers of normals and VEBs that have been labelled as VEBs. Fv¼ is the number of fusion beats labelled as VEBs and Ov¼ the number of pseudo VEB labels (a VEB label being generated by the algorithm when no beat at all occurred in the original)6. No¼, Vo¼ and Fo¼ are the number of pseudo-beats generated in the test
annotation ﬁle for the cases when there was a normal, VEB or fusion beat in the original data but the
algorithm failed to detect such a beat.
The scoring thus records the number of false positives (FP; beats identiﬁed by the algorithm when
the clinician has not scored one), false negatives (FN; beats missed by the algorithm when the clinician
has scored one) or true positives (TP; both annotations agree on the time of the event). These are thus
ÌÈ deﬁned as7 ÆÒ¼ · ÎÒ¼ · Ò¼, Æ ÆÓ¼ · ÎÓ¼ · Ó¼ and È ÇÒ¼. The ﬁnal two columns in
5the executable ‘bxb’ in particular 6Note that these latter four columns are zero in this example since this algorithm was only designed to identify normal beats 7Beat type classiﬁcation is detailed in the output ﬁle but incorrect classiﬁcation (such as labelling a VEB as a normal) does
51

table 2.1 are É Ë , the sensitivity of the algorithm or the number of True Positives (TP) as a percentage
· of the total that really exist and É È , the Positive Predictivity, or the number of TP’s as a percentage
of the number detected by the algorithm. These two parameters are therefore calculated as follows:

ÉË

ÌÈ

ÆÒ¼ · ÎÒ¼ · Ò¼

ÌÈ · Æ ÆÒ¼ · ÎÒ¼ · Ò¼ · ÆÓ¼ · ÎÓ¼ · Ó¼

(2.1)

É·È

ÌÈ

ÆÒ¼ · ÎÒ¼ · Ò¼

ÌÈ · È ÆÒ¼ · ÎÒ¼ · Ò¼ · ÇÒ¼

(2.2)

From table 2.1 one can see that patient 100’s heart beat 1902 times over the 30 minute period (an

average heart rate of 63.4 beats per minute (bpm)). All the beats were classiﬁed as normals by the

¾ ¿ algorithm (non zero entries in the Ò , Ö and Ø columns), although one of these beats was actually a

ÉË É · È ½¼¼± VEB. For this record, the and

are therefore both

for the algorithm under test.

The algorithm labelled patient 101’s ECG as containing 1522 normals, all of which were normals

except one fusion beat. However, four normals were detected by the algorithm when there were no actual

¼ beats there. Thus, the Sensitivity is ½ ½¾½¾·½·½·½

or

±. Furthermore, one fusion beat was

Ó ½ missed since a pseudo-beat was generated from the MIT annotation ﬁle ( ¼ ). Thus the Positive

¼ ¿ ¿± Predictivity is reduced to ½½¾½¾·½·½·½½

or

. Patient 103 has a total of 1729 beats, all of

which were normal, but 4 of which were missed by the algorithm. Only one beat was labelled as a

normal and did not actually occur. It is important to note that the ANSI standards ([13]) allow 5 minutes

of adjustment and adaptation for any algorithm being tested and therefore the ﬁrst ﬁve minutes of data

are not included in the results generated by the MIT tools.

2.3 The Hamilton and Tompkins QRS detector
Hamilton and Tompkins developed a robust algorithm for the detection of QRS complexes in single channel ECG data and reported the performance of the algorithm on the MIT-BIH database in their 1986 paper ([107]).
The method consists of two stages;
1. Pre-processing of time-series ECG data involving both linear and non-linear ﬁltering and
not affect the statistics; they are based on how many QRS complexes are detected regardless of their classiﬁcation.

52

2. Post-processing decision rules that operate on this output to identify relevant sections within the ECG for detailed analysis in order to extract the R-peak which is referred to as the ﬁducial point ([215]). It is this point that corresponds to the clinicians’ labelling in the annotation ﬁles.
This ﬁrst stage is broken down into four separate distinct ﬁltering procedures: 1. 5-15Hz Band Pass Filtering — A low pass ﬁlter to remove high-frequency noise (such as 50Hz
mains interference) is followed by high-pass ﬁltering to remove low frequency components due to breathing (at around 1Hz or below).
2. Slope Information Extraction — Differentiating the signal emphasises the changes from the baseline.
3. Squaring — This emphasises the higher frequencies (where the R-peak is to be found) and ensures that all the data is positive for the ﬁnal stage of ﬁltering;
4. Time Averaging — Integrating the squared signal within a moving window gives a measure of how the energy is distributed in the ECG and aids ﬁducial point localisation.
After preprocessing the following set of heuristics and rules are applied: 1. A peak (of the time averaged waveform) is located within a segment of the time averaged wave-
form. The segment is deﬁned by noting points where the time averaged waveform exceeds and then falls below a threshold, which is a fraction of the median-value of the last 10 ﬁducial points.
2. The ﬁducial point is then found by a scan-back procedure, searching back through the band-pass ﬁltered data for a peak between the points found in the above step.
3. If the time integrated packet is signiﬁcantly longer than usual (probably due to dominant P or T waves) then the length of the window of interest is set to between 150ms and 250ms.
4. Refractory Blanking: As a result of the properties of cardiac tissues, there is a minimum time required to repolarise. A new peak cannot therefore be detected until at least 200ms have elapsed since the last peak detection within the time averaged signal. If a positive detection occurs within this time frame either the previous or current beat must be false. The algorithm assumes the latter.
5. If a peak is not detected within a certain fraction (slightly greater than unity) of the current average RR interval then a secondary search through the band-ﬁltered data is conducted with lower thresholds on the median ﬁlter.
53

Using this method Hamilton and Tompkins quote a sensitivity of 99.69% and a positive predictivity of 99.77% over all of the non-paced records within the MIT-BIH database. A description of the implementation of this algorithm used for the work in this thesis now follows with results obtained on the same database originally used by Hamilton and Tompkins.

2.3.1 Detection of QRS complexes: Implementation of the Hamilton and Tompkins method.

The basic algorithm introduced in 2.3 forms the basis of the implementation described in this section.
´ µ Figure 2.1 illustrates the various stages of the pre-processor. The sampled input signal Ü Ò is scaled to ´ µ ´ µ ´ µ ¦ 1.0; Ò is the sampled signal after band-pass ﬁltering, Ò after differentiation, × Ò after squaring ´ µ and Ý Ò the ﬁnal output signal after time averaging.

¦ x(n) Scaling to 1

Band Pass Filter

Differentiate
¹ b(n)

Square
¹ d(n)

Time Av.
¹ s(n)

y(n)

Figure 2.1: Five stage ﬁlter sequence of Pan and and Tompkin’s QRS detector.

A series of heuristics applied to the time-averaged signal then determines in which regions of the ECG waveform, peak detection should take place.
Figure 2.2 shows the output for each of the above stages for three subjects in the MIT-BIH database,
¦½ ¼ with the original ECG data, (scaled to ) at the top. In order to compare the implementation of this
algorithm with the original results of Hamilton and Tompkins, the MIT-BIH data has been down-sampled to 128Hz. Each window in ﬁgure 2.2 therefore represents 5.5 seconds of data. Each stage introduces a delay (except for the point squaring), with a cumulative delay of 40 samples which has been corrected for in the plots shown.
Note that the algorithms were originally developed in 1985 when the standard sampling rate for ECGs was 128Hz. The plots shown in ﬁgure 2.2 are for an implementation of Hamilton and Tompkins original algorithms. Modiﬁcations of the original algorithm for today’s ANSI standard ([13]) will be described later in this chapter.
Band-pass ﬁltering is achieved by cascading a low-pass ﬁlter and high-pass ﬁlter, the output of which is plotted on the second row of ﬁgure 2.2. In the original algorithm the following difference equations

54

101
0.6

0.5

0.4

0.3

0.2

0.1

0

−0.1

1000

1100

1200

1300

1400

1500

1600

1700

¦½ Original ECG waveform scaled to .

7

6

5

4

3

2

1

0

−1

−2

−3 1000

1100

1200

1300

1400

1500

1600

1700

Band-Filtered Data (5-15 Hz) .

2.5

2

1.5

1

0.5

0

−0.5

−1

−1.5

−2 1000

1100

1200

1300

1400

1500

1600

1700

Slope information.

4.5

4

3.5

3

2.5

2

1.5

1

0.5

0 1000

1100

1200

1300

1400

1500

1600

1700

Point Squaring.

1.4

1.2

1

0.8

0.6

0.4

0.2

0 1000

1100

1200

1300

1400

1500

1600

1700

Time Integration.

103
0.6

0.5

0.4

0.3

0.2

0.1

0

−0.1

−0.2 1000

1100

1200

1300

1400

1500

1600

1700

10

8

6

4

2

0

−2

−4 1000

1100

1200

1300

1400

1500

1600

1700

3

2

1

0

−1

−2

−3 1000

1100

1200

1300

1400

1500

1600

1700

8 7 6 5 4 3 2 1 0 1000

1100

1200

1300

1400

1500

1600

1700

1.8 1.6 1.4 1.2
1 0.8 0.6 0.4 0.2
0 1000

1100

1200

1300

1400

1500

1600

1700

112
0.6

0.5

0.4

0.3

0.2

0.1

0

−0.1

−0.2 1000

1100

1200

1300

1400

1500

1600

1700

8

6

4

2

0

−2

−4 1000

1100

1200

1300

1400

1500

1600

1700

2.5 2
1.5 1
0.5 0
−0.5 −1
−1.5 −2
−2.5 1000

1100

1200

1300

1400

1500

1600

1700

6

5

4

3

2

1

0 1000

1100

1200

1300

1400

1500

1600

1700

1.4

1.2

1

0.8

0.6

0.4

0.2

0 1000

1100

1200

1300

1400

1500

1600

1700

Figure 2.2: 5.5 seconds of MIT-BIH ECG data sampled at a frequency of 128Hz, at each stage of data processing. The processing delays in each digital ﬁlter have been compensated for.

55

represent the equations for the low and high pass ﬁlters respectively 8:

Ð´ÒÌµ ¾Ð´ÒÌ Ìµ Ð´ÒÌ ¾Ìµ · Ü´ÒÌµ ¾Ü´ÒÌ Ìµ · Ü´ÒÌ ½¾Ìµ

´ÒÌ µ

´ÒÌ

Ìµ

´

Ð´ÒÌ ¿¾

µµ

·

Ð´ÒÌ

½ Ìµ

Ð´ÒÌ

½

Ì

µ

·

Ð´ÒÌ

¿¾Ì ¿¾

µ

(2.3)

´ µ ´ µ where Ò is the current sample number, Ì the sample rate, Ü Ò the original (scaled) data, Ð Ò the low´ µ pass ﬁltered data and Ò the subsequent high-pass (and thus band-ﬁltered) data. The low pass ﬁlter

introduces a delay of 6 samples, whilst the 32 point window of the high pass ﬁlter adds a further 16-

sample delay. Both ﬁlters are IIR ﬁlters and thus have a non-linear phase response which introduces

shape distortion. However, since the function of the processing is simply to locate high-energy regions

in the original ECG waveform, this should not affect the ability of the algorithm to locate the ﬁducial

points.

The third row of ﬁgure 2.2 demonstrates how differentiation of the signal emphasises the higher

frequency components such as the R wave. The 4-point difference equation introduces a further 2-sample

delay;

´ÒÌµ ½ ´¾ ´ÒÌµ · ´ÒÌ Ìµ ´ÒÌ ¿Ìµ ¾ ´ÒÌ Ìµµ

(2.4)

´ µ where ÒÌ is the output of the ﬁlter at the ÒØ sample

´ µ ´ ´ µµ The effect of point squaring (× ÒÌ

ÒÌ ¾) can clearly be seen on the fourth row of ﬁgure 2.2.

Note that the baseline has a very low value and the peaks are now localised within the region of the QRS

´ µ ´ µ complex. The positive values are time-averaged over a 32 point window (Ý ÒÌ

¿½¾ È¿½¾ × ÒÌ ) in

order to indicate the most likely regions for the QRS complex. This step contributes a further 16 sample

delay to the overall 40 sample delay.

However, since the ECG in the Software Monitor is sampled at 256Hz (in line with the 1999 ANSI

standards), changes in the implementation of the algorithm were necessary. Furthermore, given the

increase in power and performance of processors since 1986 an FIR band-pass ﬁlter design has been

introduced, involving ﬂoating-point calculations and many more sample delays. The choice of an FIR

ﬁlter rather than an IIR ﬁlter is motivated by the high levels of noise encountered in much of the data

analysed in later chapters. The peak-detection algorithm is therefore modiﬁed to perform the peak search

back through the band-pass ﬁltered data rather than the original ECG waveform. A linear phase response
8Integer coefﬁcients are used as integer multiplication was required to achieve real-time processing when the algorithm was originally designed.

56

is therefore required to ensure the accuracy in locating the time-stamp of the R-peak. Matlab5 has been used to calculate the coefﬁcients of the low-pass and high-pass ﬁlters speciﬁed by the criteria given in table 2.2. The linear-phase FIR ﬁlter is designed using the Parks-McClellan algorithm ([230]) based on

the Remez exchange algorithm and Chebyshev approximation theory to obtain a ﬁlter with an optimal

ﬁt between the desired and actual frequency responses. This is achieved by minimising the maximum

error between the desired frequency response and the actual frequency response. Filters designed by this method exhibit an equiripple behaviour in their frequency response in both the pass and stop bands.

Filter Type f1 (Hz) f2 (Hz) Rs (dB) Rp (bB) fs (Hz) Order

High Pass 0.00128 1.28

48

2.096 256 312

Low Pass 35

45 48.25 1.925 256 37

Table 2.2: Filter properties used for coefﬁcient generation with MATLAB5.

Rs is the attenuation between frequencies f1 and f2 (the transition band), Rp is the ripple in the pass band, fs is the sampling frequency and the order is the number of coefﬁcients required to meet the attenuation criteria. Figures 2.3 and 2.4 show the frequency and phase responses for the low-pass and high-pass ﬁlters respectively. Notice that they have a linear phase response over the range of interest (below 45Hz) and so the shape of the ECG waveform will not be distorted. There is now a cumulative band-pass ﬁlter delay of 175 samples (0.68s).
In the Hamilton and Tompkins algorithm (see section 2.3) the R peak is identiﬁed by searching for a maximum within a localised region of points whose amplitude is greater than a threshold set to be the median value of the last 10 R peaks. Tests of the median ﬁlter applied to the successive R peaks previously detected showed that the optimal number of peaks was ﬁve for this implementation. If a greater number of peaks was included, the median ﬁlter was not adaptive enough to track the ﬂuctuations in the amplitude of the R peak.
The median ﬁltering is implemented by saving the peak height of the last ﬁve time-integrated QRS packets (the last row on ﬁgure 2.2) and determining the median value. Then, when the time integrated data for a new beat crosses a threshold corresponding to a fraction, , of this value, a ﬂag is triggered so that the algorithm then begins to search for the peak in the central region of this time averaged packet.

57

Figure 2.3: Low pass ﬁlter frequency and phase response (dB/Hz and deg/Hz).
Figure 2.4: High pass ﬁlter frequency and phase response (dB/Hz and deg/Hz). 58

Figure 2.5: The time-averaged waveform for two consecutive QRS complexes. The upper threshold is set at 90% of the peak amplitude of each packet. The point where this intersects the time-averaged waveform deﬁnes the region in the original data in which the algorithm scans back to locate a peak.

The search is narrowed by deﬁning a window between the point at which a fraction, , of the current

peak is crossed on the upslope and the point at which it is crossed on the downslope (see ﬁgure 2.5). This

procedure is applied to each processed time-averaged energy packet and a search back procedure is then

initiated to look for the peak value (i.e. the R-peak) in the original ECG waveform within the central

window. Once found, this peak is labelled as the ﬁducial point. Values between 10% and 90% were

investigated (in 10% increments) in order to ﬁnd the optimal values of the thresholds and . These

¼ ¾ ¼ were found to be

and

.

2.3.2 Comparison of performance on MIT normal data

On further, more detailed analysis the algorithm was found to be particularly sensitive to the value of

and when tested on all of the 44 non-paced9 lead II ECGs from the MIT-BIH database for different
¼ ½ threshold values, an optimum was found for at . The optimum peak threshold, , remained ¼ unchanged at . Experiments on threshold adjustment showed that the data recorded from subjects

114, 201, 203 and 228 cause the most problems. The other ﬁles were fairly robust to small changes in

the value of .

The results for these values are presented in table 2.3.2, shown on the next page. The average over all

the relevant recordings in the MIT-BIH database of ÉË

¿¿± and É · È ¼ ± compare well

with the results reported in Hamilton and Tompkins’ 1986 paper (ÉË

± and É·È

±)

on the same data.

9as pacemaker spikes will cause problems during peak detection.

59

Record Nn¼ Vn¼ Fn¼ On¼ Nv¼ Vv¼ Fv¼ Ov¼ No¼ Vo¼ Fo¼ Q Se Q+P

100 1901 1 0 0 0 0 0 0 0 0 0 100.00 100.00

101 1521 0 1 4 0 0 0 0 0 0 1 99.93 99.74

103 1725 0 0 1 0 0 0 0 4 0 0 99.77 99.94

105 2117 29 4 133 0 0 0 0 4 0 1 99.77 94.17

106 1236 459 0 1 0 0 0 0 0 1 0 99.94 99.94

108 1461 13 2 257 0 0 0 0 4 0 0 99.73 85.17

109 2067 28 0 1 0 0 0 0 0 4 0 99.81 99.95

111 1774 1 0 3 0 0 0 0 1 0 0 99.94 99.83

112 2111 0 0 1 0 0 0 0 0 0 0 100.00 99.95

113 1506 0 0 0 0 0 0 0 0 0 0 100.00 100.00

114 1459 30 4 140 0 0 0 0 111 0 0 93.08 91.43

115 1637 0 0 0 0 0 0 0 0 0 0 100.00 100.00

116 1896 97 0 2 0 0 0 0 23 1 0 98.81 99.90

117 1284 0 0 1 0 0 0 0 0 0 0 100.00 99.92

118 1903 13 0 1 0 0 0 0 0 0 0 100.00 99.95

119 1297 364 0 1 0 0 0 0 0 0 0 100.00 99.94

121 1557 1 0 1 0 0 0 0 2 0 0 99.87 99.94

122 2054 0 0 2 0 0 0 0 0 0 0 100.00 99.90

123 1265 3 0 1 0 0 0 0 1 0 0 99.92 99.92

124 1315 36 5 1 0 0 0 0 0 11 0 99.20 99.93

200 1466 698 1 5 0 0 0 0 0 2 1 99.86 99.77

201 1265 198 2 1 0 0 0 0 56 0 0 96.32 99.93

202 1849 10 1 1 0 0 0 0 6 5 0 99.41 99.95

203 2083 369 2 61 0 0 0 0 20 4 3 98.91 97.57

205 2123 64 11 1 0 0 0 0 2 1 0 99.86 99.95

207 1482 109 0 6 0 0 0 0 1 0 0 99.94 99.62

208 1303 817 301 12 0 0 0 0 7 7 2 99.34 99.51

209 2515 1 0 7 0 0 0 0 2 0 0 99.92 99.72

210 2026 150 5 3 0 0 0 0 4 15 4 98.96 99.86

212 2285 0 0 1 0 0 0 0 0 0 0 100.00 99.96

213 2236 192 267 0 0 0 0 0 0 3 2 99.81 100.00

214 1663 212 3 3 0 0 0 0 0 0 0 100.00 99.84

215 2662 131 0 1 0 0 0 0 1 0 1 99.93 99.96

219 1722 51 0 1 0 0 0 0 0 0 0 100.00 99.94

220 1694 0 0 1 0 0 0 0 0 0 0 100.00 99.94

221 1704 309 0 1 0 0 0 0 0 7 0 99.65 99.95

222 2115 0 0 59 0 0 0 0 1 0 0 99.95 97.29

223 1736 447 8 1 0 0 0 0 0 8 0 99.64 99.95

228 1225 300 0 49 0 0 0 0 176 2 0 89.55 96.89

230 1858 1 0 1 0 0 0 0 0 0 0 100.00 99.95

231 1278 0 0 1 0 0 0 0 0 0 0 100.00 99.92

232 1485 0 0 5 0 0 0 0 0 0 0 100.00 99.66

233 1862 688 6 1 0 0 0 0 1 4 0 99.80 99.96

234 2288 0 0 1 0 0 0 0 0 3 0 99.87 99.96

Sum 77011 5822 623 774 0 0 0 0 427 78 15

Average

99.33 99.06

Table 2.3: Standard output of MIT ﬁles.

60

2.3.3 Discussion of results
The MIT tool set includes a waveform browser which loads and displays the original ﬁle together with an annotation ﬁle (either the standard ‘attribute’ ﬁle scored by clinicians or user generated). The display format is channel 0 as the upper trace and channel 1 as the lower. The annotations (as deﬁned earlier) that appear between the two channels refer to those scored by an analysis of channel 0.
The poor results from data ﬁle 114 can be explained by the presence of noise. In ﬁgure 2.7 one can observe that the clinicians have annotated a section of heavy noise correctly because the information in the second (lower) channel is also available to them. The algorithm, however, only analyses channel 0 (as with Hamilton and Tompkins original analysis) and identiﬁes several peaks within a high energy region in the second half of the trace (ﬁgure 2.6). Figure 2.8 shows how low energy QRS complexes can be missed unless the median ﬁlter threshold is reduced but this, of course, would have the effect of increasing the number of false positives.
Figure 2.9 demonstrates how artefacts can seriously affect the ECG waveform and hence the ability to locate the QRS complex. The human eye can just make out where the complexes are on the upper artefactual trace although the clinicians again used the second channel to identify the ﬁducial points. The algorithm cannot do anything else but miss all the beats during the artefact at the end of the upper trace (marked with an ‘O’). Figure 2.10 is a section of ﬁle 228 scored by clinicians. Note that the VEBs (annotated as ‘V’) have a much larger amplitude and width (and hence time integrated energy) and thus increase the median-ﬁltered average of the last ﬁve peaks. This has the effect that the algorithm misses the smaller amplitude QRS complexes (see ﬁgure 2.11).
The average performance over all the ﬁles of 99.33% sensitivity and 99.06% positive predictivity for this implementation of this algorithm is comparable to that of the original Hamilton and Tompkins algorithm. The slightly better results achieved by Hamilton and Tompkins are likely to be due to the utilisation of a scan back procedure in the case of a missing beat. However, an analysis of the beat-tobeat timing intervals is presented in the next chapter. The inclusion of such an heuristic in the algorithm may bias the results of the study.
The morphology of a heart beat can vary greatly depending on the patient and the detection hardware conﬁguration. Often a normal beat for one patient can resemble an abnormal beat for another. The Hamilton and Tompkins algorithm [107] is essentially a peak energy-amplitude detection algorithm which almost completely ignores the detailed morphology of the ECG.
61

CHANNEL 0

CHANNEL 1

TIME Figure 2.6: Incorrectly labelled ﬁle 114 by algorithm due to noise.

CHANNEL 0

CHANNEL 1

TIME Figure 2.7: File 114 correctly labelled by clinicians.

62

CHANNEL 0
CHANNEL 1 TIME
Figure 2.8: Low amplitude QRS complexes (in lead II, the upper channel) missed in ﬁle 114.

CHANNEL 0 CHANNEL 1

TIME Figure 2.9: Artefacts in ﬁle 203

63

CHANNEL 0

CHANNEL 1

TIME Figure 2.10: File 228 scored by the clinicians

CHANNEL 0

CHANNEL 1

TIME

Figure 2.11: Missed QRS complexes in ﬁle 228 due to high energy VEBs.

64

2.4 Conclusion.
Since beats other than normal (sinus rhythm) beats are generated from outside the normal conduction mechanisms they are not considered to be representative of autonomic control mechanisms that manifest the observed variability in the RR tachogram [181]. The beat-to-beat intervals that do not correspond to the time differences between two sinus beats must therefore be excluded from the RR tachogram.
Since the energy/amplitude detection algorithms described in this chapter are not able to distinguish between morphologies, they cannot be used for the exclusion of normal beats from the RR tachogram. Furthermore, the use of thresholds which cannot be pre-determined and are difﬁcult to set on-line indicates that a more adaptive and patient speciﬁc approach is necessary. To date, all attempts to recognise ectopic beats have relied on heuristics or pattern matching which are not sensitive to an individual’s ECG morphology [1, 85, 11]. Moreover they are based on necessarily unrepresentative and small populations [194] (due to the difﬁculty in collecting a necessarily large data base). Chapter 3 presents a set of possible solutions to these problems involving a generalisable procedure that can be trained in-situ on an individual.
65

Chapter 3
Abnormal Beat Detection in the ECG
3.1 Introduction
It is common practice to adjust the RR tachogram in order to remove the effect that abnormal (nonsinus, ectopic or aberrant) beats [138] would have on estimating HRV. While it is reasonable to attempt to remove artefacts in the ECG (such as spurious distortions of the signal such as muscle movement or electrode pop; see section 2.2), it is less obvious why the clinical community excludes ectopic beats from HRV analysis since ectopic beats, like sinus beats, are electro-physiological in origin.
There are two main arguments for the removal of ectopic beat related timings from the RR tachogram prior to the calculation of HRV metrics. Firstly, heart rate modulatory signals involving the brain and cardio-vascular system act upon the sinoatrial (SA) node in the heart, inﬂuencing the sinus rhythm. Assessments of autonomic function reﬂect the ability of this system to stimulate the SA node. Ectopic beats originate from secondary and tertiary pacemakers (see section 1.3) and this type of locally aberrant beat will temporarily disrupt normal neurocardiac modulation. Secondly, an ectopic beat will often appear late or early with respect to the timing of a sinus beat. This creates a sharp spike in the RR tachogram which is likely to add a signiﬁcant power contribution to the power spectrum at an artefactual frequency. Many of the commonly used standard time-series HRV measures involve Euclidean distance computations and therefore just one outlier (such as an ectopic beat) can signiﬁcantly alter the value of a metric.
Although bursts of sympathetic activity (signiﬁcantly higher in amplitude and duration than similar bursts during sinus rhythm) have been observed to follow sporadic ectopic beats, it is generally believed that isolated ectopic beats do not cause any signiﬁcant change in the HRV signal or its power spectrum
66

calculated once the ectopics beats have been removed [138]. Recent work on ’heart rate turbulence’ [241] (the changes in the RR tachogram in the few seconds following an ectopic beat) has shown that ectopic beats can cause a measurable change in the RR interval, but the effect is short lived and is generally ignored for the purpose of HRV metric calculation over ﬁve minutes periods [181]. Since HRV analysis is thought only to be relevant to the timing variations in the sinus rhythm, and the presence of ectopic beats can cause errors in the calculation of HRV metrics a robust method for excluding non-sinus beats and artefacts from the RR tachogram is therefore needed.
For the purposes of preprocessing to remove abnormal beats, the ECG can be thought of as two separate components;
1. The P-QRS-T wave generated from the cycle of depolarisation and polarisation of the cardiac muscle and,
2. the inter-beat timing separation between each P-QRS-T beat
Both of these components have generally accepted clinical deﬁnitions of normality (see sections 3.2.1 and 3.3.1) and this chapter presents methods for analysing the timing and morphology with respect to these deﬁnitions to produce a noise-free RR tachogram. An algorithm based upon morphology is presented initially. The application of this algorithm results in the exclusion of a high percentage of nonsinus beats from the ECG-derived RR tachogram, without the need for heuristics (as with conventional template matching algorithms). An analysis of the distribution of timings for artefacts, non-sinus and sinus beats is then presented which allows optimal application-speciﬁc timing thresholds to be chosen.
3.2 Pre-processing
3.2.1 Ectopic rejection
In general, there are two accepted methods for dealing with the effect of ectopic beats on the RR tachogram [181]. If the ectopic or anomalous beats are very occasional, they are removed and interpolation can be used to add a beat where a sinus beat would have been expected to occur. This is usual in spectral frequency methods where interpolation and resampling are often used to facilitate the calculation of the power spectral density (PSD) using standard methods. Alternatively, if the incidence of ectopics is high within a given segment then it is preferable to eliminate from the analysis, the segments of the HRV signal that contain such a high occurrence. However, this may be very restrictive for some patients
67

and lead to a great deal of data being discarded. Molgaard et al. [195] demonstrate how certain timeseries metrics (such as RMSSD - see section 1.6.3) are extremely sensitive to missed beats especially in patients with reduced HRV and therefore it is extremely important to consider whether the data in such cases should be used at all.
Although it is preferable to have an expert clinician selecting the beat classiﬁcation [138], the processing of lengthy data segments and long term studies is very time consuming. Furthermore, a human expert cannot reliably assign exact markers to the QRS complex over long periods of time and may be more prone to mistakes than automated methods. Malik [183] states that there is a need for a fully automatic method of HRV measurement (from the original ECG) which is robust and will provide clinically useful results for typical recordings. Furthermore, he suggests that the perceived need for visual veriﬁcation and manual correction of a long term ECG has discouraged the assessment of HRV in routine clinical practice and has conﬁned HRV investigations to academic research.
Malik et al. [182] recommend that RR intervals of sinus rhythm should not differ by more than
¾¼± whereas Kamath [138] suggests that each RR interval should not increase/decrease by more than ¿¾ ¾ ± with respect to the previous interval. Malik also recommends that all 5 minute segments
with fewer than 30 sinus beats should be rejected. Finally, it should be noted that the rejection criteria [138, 182] are either arbitrary or have been set through empirical testing on limited and disease-speciﬁc databases. There is no reason to consider them as deﬁnitive limits for general patient populations.
3.2.2 Artefact rejection
When considering the robustness of HRV analysis to RR interval error, Malik [183] suggests that sequences with fewer than 1000 sinus, or Normal-to-Normal (N-N), intervals should be rejected from a study. However, he also acknowledges that this is an arbitrary threshold. Many different exclusion criteria have been proposed by other authors [138, 147, 172, 181, 184], often with little justiﬁcation. In many cases, where trials have been carried out to analyse the performance of algorithms using different RR interval exclusion criteria, the types of noise and artefacts that are excluded, and/or the database being used, are not speciﬁed. In many studies the investigator visually excludes sections of data that appear to be heavily artefactual.
¼± For short term recordings, Kennedey [147] suggests that at least of a minute segment of data
should contain acceptable N-N intervals. Kamath [138] suggests that regions with the presence of ectopic
68

beats or noise for more than 3 seconds should be removed from any analysis. In order to exclude sections of data that involve major distortion, some medical equipment manufacturers have looked at the power in the high frequency content of the ECG and set upper limits for rejection, although the exact thresholds (of power and frequency) that they use are often proprietary information and therefore difﬁcult to ascertain.
Haaksma et. al. [104] have attempted to provide a more theoretical basis for rejecting artefacts and noise using Parseval’s theorem. The power evaluated in the frequency domain should be equal to the
´ µ power evaluated in the time domain. They postulate a Parseval index ÔËÄ Æ·ÆÀ which should be close
to unity for any given segment with enough data points to be statistically signiﬁcant. However, their
¦½ rejection criterion for ignoring segments with a Parseval index that deviates by more than from unity,
is still arbitrary and no justiﬁcation is given for this threshold.
3.2.3 Robust methods
In a comparison of geometric and time-series indices, Malik [183] found that the geometric indices are the most robust to errors introduced by automated HRV calculations of RR tachograms derived from long term ECG recordings. In particular the HRV (Triangular) index and TINN performed better than SDNN and SDANN metrics in noisy scenarios. However, the prevalence of studies reporting positive results involving the use of time-series, and more particularly spectral indices (which are thought to be even more sensitive to such errors) over geometric indices indicates that more robust methods for removing artefact and non-sinus beats from the RR tachogram are required for time-series analysis to be employed more universally.
Recently, blind source separation, or independent component analysis (ICA), has been used to separate biomedical signals into their (independent) components [22, 42, 135, 278, 283]. ICA involves taking multiple observations of a signal which is a mixture of several statistically independent signals and identifying the independent signal sources (usually by minimising or maximising a cost function such as mutual information or kurtosis). ICA is particularly advantageous where the signals that require separation overlap in the frequency domain, and for which traditional linear ﬁltering techniques are therefore not useful. As long as there is no correlation, or entrainment between different signals, and the signal to
½ noise ratio is high enough, then for Æ independently measured channels of input data, Æ sources
(or components) can be resolved. Therefore, if there are at least three channels of ECG available, the ECG can be resolved into two separate signals. For example, foetal and maternal ECG waveforms have
69

similar frequency components and are difﬁcult to record without cross-channel interference due to the proximity of the mother and foetus. Recently, Cardoso [42] successfully used ICA to separate out these two ECGs from observations of the mixed ECG signals from three electrodes. This works well because the assumption of signal source independence is valid.
The fact that independent signal sources are responsible for the generation of the ECG and many of the artefacts observed on the ECG suggests that ICA could also be used to remove artefacts from the ECG. Recently, Barros et al. [22] and others [110] have implemented ICA techniques to eliminate artefacts from the ECG such as electrode pop and muscle noise. However, ICA involves a non-linear transformation which will distort the ECG waveform to some extent and in some scenarios (such as diagnosis), this may be highly signiﬁcant. Although other non-linear techniques [242, 250], have also been used to remove stationary non-correlated noise from ECGs, such methods have not been used to remove artefacts as yet.
3.3 Using morphological information to identify normal QRS complexes
Since the variations in morphology are highly patient-speciﬁc it is logical to consider an adaptive algorithm that learns a template of normality based on Euclidean distance metric comparisons. This involves
creating an average of the last Ò artefact-free ECG waveforms (centred on the QRS complex) and then
performing a statistical comparison between this average or template and the next section of the ECG waveform. Patient 109 in the MIT-BIH database was chosen to test this method since the ﬁle contains a signiﬁcant proportion (2067 out of 2099) of normal QRS complexes with some inter-beat variation in morphology and a small number of abnormal morphologies (32 VEBs).
3.3.1 Template matching for the detection of ectopic beats
Recently Acar et al. [4] have developed an algorithm to remove ectopic beats for beat to beat HR measures based on timing considerations and template matching in a multiple-lead signal (using ectopic beats to form the templates). The differential of three ECG leads are added and thresholded to produce QRS complex candidates. The candidates are cross correlated with a pre-selected template with an acceptance threshold of 0.8. If the candidate fails then its energy is compared with the median of the last nine normal QRS complexes.Ectopic beat identiﬁcation is based upon both timing and morphological considerations. Firstly, if the new RR interval deviates from the median of the last nine normal-to-normal
70

½¼± (N-N) intervals by more than it is rejected. Malik et al. are quick to point out that this criterion ½¼± is arbitrary and will not disqualify ectopic beats which happen to fall within the timing window1,
although they claim that this misclassiﬁcation will not affect HRV analysis. Secondly, the morphology of the QRS complex is investigated with arbitrary thresholds on the original and differentiated signal, including a check on a median-ﬁltered template of the last nine P-waves2.
Although Malik et al. [4] claim a speciﬁcity of 0.99, a SVEB (Supra-Ventricular Ectopic Beat3) sensitivity of 0.99 and a VEB sensitivity of 0.98 for this technique, the results are speciﬁc to one type of commercial ECG recorder and conﬁned to a speciﬁc population group (69 healthy adult males) and may not be entirely representative of either the population as a whole or abnormal patient groups. The following sections explore methods which require fewer heuristics, fewer arbitrary thresholds, and no predeﬁned morphological templates.

Matching Indices (MSE and Correlation)

Initially, two statistical comparisons will be considered, the mean square error (MSE) between the test

ECG waveform and the template, and the correlation between the test ECG and the template. The

waveforms are energy normalised to emphasise differences in shape rather than scale as two similar

waveforms with signiﬁcantly different baselines will have a large MSE between them. The mean is

removed from each sample of the ECG waveform in the calculation of the correlation coefﬁcient, ,

[95] and the same procedure is applied for the calculation of the MSE. This is motivated by the need to

minimise the effect of baseline wander. The correlation coefﬁcient has been chosen since it is a standard

technique in image processing to quantify the difference between two patterns.

½ represents a

poor match while

½ represents a one-to-one correspondence between patterns.

Ò ´ µ If Ò is the mean value of the Ø pattern with samples then Ò ½ È ½ ÜÒ where ÜÒ is

Ò the Ø element of the Ø pattern. Similarly, if the mean of the template is calculated from Æ

´ µ ½
Æ

ÈÆ

½

È

½Ü

, where Ü is the Ø

element of the

Ø

(energy scaled) pattern and Æ is the number

´ µ of patterns used to calculate the template, ÜÆ

½ ÈÆ
ÆÒ

½

ÜÒ

.

Each pattern includes

all of the heart

beat from the P wave to the T wave (around one second for a heart rate of 60 bpm). The averaging

process and the comparison between the template and the next (test) ECG waveform are performed with
1Moreover, in this scenario the following compensatory pause will lead to the exclusion of a normal sinus beat as an ectopic beat.
2The P-waves are detected by assuming they are the peak of the waveform in a 200ms window before the R-peak. 3Originates from outside of the ventricles.

71

the R-peak of the QRS complex as the centre sample of the vector. By choosing to be equal to 64, this corresponds to creating a vector with 32 points either side of the R-peak. Down-sampling from 256Hz to 64Hz, therefore sets the window of interest (for calculating ) to be one second wide (0.5s either side
of the R-peak). Æ , the number of valid waveforms to be averaged to calculate the template, is set at 10
to allow a smoothing of the beat-to-beat variations common in the ECG [11, 121].
The MSE between the ÒØ pattern, ÜÒ and the template, ÜÆ , is given by

ÅË

½ ´ÜÒ Òµ ´ÜÆ Æµ ¾

(3.1)

and the correlation coefﬁcient, , is given by ([95])

½´ÜÒ Òµ ¢ ´ÜÆ Æµ

(3.2)

The strategy for classifying a beat as a normal or a VEB is presented in ﬁgure 3.1. If the Hamilton

and Tompkins algorithm (from chapter 2) detects a heart beat and then the correlation, , is greater than

the threshold Ñ Ò the beat is classiﬁed as a normal. However, if is less than Ñ Ò, then the beat

is classiﬁed as a VEB. The procedure is also repeated using the reciprocal MSE, (ÊÅ Ë

½
ÅË

),

instead of and thresholding on ÊÅ Ë Ñ Ò to compare the two quantities as exclusion methods.

Figure 3.1: Flow of logic for beat classiﬁcation. If a beat, detected by a conventional QRS detector, has
a template correlation value greater than Ñ Ò or an MLP reconstruction error greater than ÊÅ Ë Ñ Ò,
it is classiﬁed as abnormal. Otherwise the beat is labelled as a VEB.
72

mV

ÊÅ Ë

TIME
Figure 3.2: From top down: Original ECG waveform, ÊÅ Ë and for a 12 second segment of ﬁle
109 of the MIT-BIH database. Note the third QRS complex - a VEB - in the original ECG has a small
ÊÅ Ë . The dashed lines are the thresholds ÊÅ Ë Ñ Ò and Ñ Ò.

Results

The upper graph in ﬁgure 3.2 is a 12 second segment of the ECG waveform for subject 109 of the MIT-

BIH database. The waveform under test is moved sample by sample, and equations 3.1 and 3.2 are

computed using a template which is updated every time a valid QRS complex is detected. The middle
plot shows the sample-by-sample computation of the ÊÅ Ë . Note how the ÊÅ Ë varies greatly from

one QRS complex to another whereas the correlation peaks (in the lower graph) have a more uniform
distribution. The thresholds which distinguish ectopic from normal beats, ÊÅ Ë Ñ Ò and Ñ Ò, are

shown as dashed lines across the graphs.

Table 3.1 illustrates how increasing the correlation coefﬁcient threshold Ñ Ò from 0.25 to 0.8 leads

to a steadily increasing number of VEBs being correctly classiﬁed. However, this is also matched by an

¼ increase in the normals being misclassiﬁed by this system. A value of Ñ Ò

allows the highest

number of VEBs to be detected (28 out of 32, the maximum possible number, given that the Hamilton

and Tompkins algorithm only detects 28 of the beats that are annotated as VEBs; see table 2.3.2 in section

2.3.2) but this leads to more than half of the normals being classiﬁed as VEBs.

73

ÑÒ N

N

VEB VEB artefact Normals

classed classed classed classed classed missed

as N as VEB as VEB as N as VEB

0.80 840 1227

28

0

1

0

0.70 1929 138

27

0

1

0

0.60 2032 35

26

0

1

0

0.50 2058

9

26

0

1

0

0.40 2063

4

24

0

1

0

0.30 2065

3

8

0

1

0

0.25 2066

1

1

0

1

0

Table 3.1: Performance of Hamilton and Tompkins/Correlation combination algorithm on patient 109
for classifying beat morphologies for different values of Ñ Ò .

ÊÅË Ñ Ò
10.0 2.0 1.5 1.0 0.6 0.5

N classed
as N 1981 2053 2056 2059 2061 2062

N classed as VEB
86 14 11 8 6 5

VEB classed as VEB
28 26 26 22 14 6

VEB classed
as N 0 0 0 0 0 0

artefact classed as VEB
1 1 1 1 1 1

Normals missed
0 0 0 0 0 0

Table 3.2: Performance of Hamilton and Tompkins/ÊÅ Ë combination algorithm on patient 109 for classifying beat morphologies for different values of ÊÅ Ë Ñ Ò
.

74

