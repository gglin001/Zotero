Advanced Methods for Processing Bioelectrical Signals ProBisi Meeting 2004 Jyväskylä, 1 Oct 2004
ARTEFACT CORRECTION FOR HEART BEAT INTERVAL DATA
Saalasti Sami*, Seppänen Mikko* and Kuusela Antti*
* Firstbeat Technologies Ltd. Rautpohjankatu 6, FIN-40700 Jyväskylä, Finland e-mail: sami.saalasti@firstbeattechnologies.com, web page: www.firstbeattechnologies.com
Key words: Heart rate, inter-beat-interval, artefact correction, artefact detection, embedded systems. Abstract. Purpose: The goal of the studies has been to construct an enhanced artefact correction method for heart rate data. The purpose was to develop the correction to be applied in both PC off-line analysis and low processor embedded systems. Methods: We created a correction module, which takes into account physiological information and tested this module using artificial interference in resting and exercising HR-data. Results: The correction module was observed to find the correct heart rate level even in situations where the number of artefacts exceeded 50 % of the total number of inter-beat-intervals. In the cases of largest number of artefacts only heart rate level was found not the variability of heart rate. With smaller quantity of artefacts the results were found satisfactory. No time or heartbeats were lost in the correction. Applications: The observed short duration of calculations enables the use of the model also in embedded systems like heart rate monitors. Conclusions: The developed artefact correction module was proven to be fast, very accurate and reliable.
1

Saalasti Sami, Seppänen Mikko and Kuusela Antti.
1 INTRODUCTION Heart rate time series artefacts are caused by several sources. They are common, and often characteristic, for healthy and clinical subjects, in both laboratory and field monitoring, from sleep to sports. In the measurement environment, magnetic, electric, and RF noise may disturb the device, especially heart rate monitors. Furthermore, the contact difficulties of electrodes, such as the lack of moisture, a problem in the measurement equipment, or spikes produced by body movements may trigger errors [8].
Heart period (R-R interval, ms) R
T P Q
S
Figure 1. Upper figure presents a typical electrocardiograph (ECG) and bottom figure the deviation between consecutive RR intervals (RRI).
Also internal ”artefacts” exist that are initiated by the body. These arrhythmias are not actual artefacts in the technical sense but are irregular in physiological terms, alter computations, and are thus treated as artefacts. Different instantaneous arrhythmias are normal also for healthy subjects and could be considered characteristic for ECG (see Figure 1) and the heart rate time series. Arrhythmias like tachycardia and bradycardia are pathological and may cause extra (EB) or missing beats (MB) in the corresponding RR intervals [3]. Missing beats originate from unrecognized QRS-waves in the ECG, while extra beats originate from false detection of QRS-waves resulting in the splitting of the corresponding RRI into several. Measurement and triggering errors may originate from false detection of QRS-waves caused by a concurrence of amplitude modulation and respiratory movement, large T-wave related to QRS wave, bad electrode contact, or spikes produced by body movements [6]. Computer automated correction of the heart rate signal artefacts are discouraged, and manual
2

Saalasti Sami, Seppänen Mikko and Kuusela Antti.
editing should be performed instead [7]. However, the combination of manual editing and computer aided detection and correction may be feasible with large datasets [3].
Artefact detection procedures are often based on thresholds, such as beats exceeding or falling below twice the mean RRI in a predefined window. Also thresholds based on windowed standard deviation or the difference between successive RR intervals are used. Another perspective is to use a model to fit the time series and predict the following beats. Yet another threshold is utilized to define appropriate differences between the estimates and target values [8].
The seriousness and amount of corrupted data must be considered when editing the data, and the number of corrected beats is advised to report in connection with the analysis. The correction procedures and rules are combinations of adding the extra beat to neighboring beats or splitting the artefact beats. Missing beats are evenly split, meaning if the mean level of the RRI sequence is 2000 milliseconds, a 6000 ms artefact is split three times. Also noise may be added to create artificial variation in the corrected sequence. However, the total time of the series should stay unchanged. If the beat is not integer divisible, then it may have adjacent artefact beats and they have to be added before division. The beat may also be caused by a transient arrhythmia such as bradycardia.
It should be noted that missing beats may never be accurately corrected, since the exact time instant is lost forever. However, when the extra beats are added to the neighbouring beat, it results in correct reparation if and only if the neighbour is chosen properly and the neighbour is not an artefact itself.
The impact of artefacts on heart rate variability estimates is severe for both frequency and time domain analysis [2, 3]. The correction procedures are notable to restore the true beat-tobeat variation but the influence on variability estimates is less dramatic when considering occasional corrected artefact beats. Highly corrupted sections of data are advised to be left out of the analysis.
Heart rate monitors may produce a large number of artefacts during exercise because, for example, of body movements. This is illustrated in Figure 2. Some monitors record RR intervals up to 100000 beats and construct heart rate variability measures to estimate maximal oxygen uptake or relaxation [9]. However, a more common measure is the heart rate level used to produce estimates such as energy usage or to guide exercise intensity. Hence, the correction error does not cause a significant problem in these applications, since it mainly affects the beat to-beat variation.
3

Saalasti Sami, Seppänen Mikko and Kuusela Antti.
Figure 2. Upper figure presents a sequence of RR-intervals recorded with a heart rate monitor containing measurement errors. The lower figure presents part of the series with missing- and extra beats (MB and EB, respectively) marked.
A signal-to-noise ratio may be improved for certain applications by ranking the signal, e.g., by sorting the observations to positive integer numbers, allowing the same occurrences. Data ranking preserves the signal rhythm and oscillations but it deletes the acceleration of the signal [8].
Figure 3. The upper figure presents two normalized power spectrums of a heart period time series with spectrum calculated from original data dashed) and ranked data (solid line). The bottom figure illustrates power spectrums produced in a similar way but now ten missing beat artefacts are assigned to the time series.
The upper graph in Figure 3. illustrates a normalized power spectrum of original and dataranked signals. The interesting result is achieved when ten missing beats are introduced to the heart period time series. As demonstrated by the power spectrums, the dataranked signal better preserves the original frequency and power contents and is less sensitive to the
4

Saalasti Sami, Seppänen Mikko and Kuusela Antti.
artefacts. Modifications based on rank and sign are applied to the correlation coefficients estimation by Möttönen et al. [4, 5]. It seems that the implementation is very expensive to calculate and not practical for larger data processing or embedded systems with inefficient CPU (8-bit micro-controllers).
Different detection and correction heuristics and rules, as well as types of artefacts and the influence of artefacts on heart rate variability estimates, are considered by several authors, e.g., Berntson, Quigley, Jang, and Boysen [1], Berntson and Stonewell [2], Mulder [3], Porges and Byrne [6].
The goal of our studies was is to detect and correct as far as possible all machine-induced artefacts and all of the heart-based artefacts that have a detrimental effect on the computations. We aimed at combining expert knowledge in physiology, algorithms and implementation. Further goals were the easiness to use and applicability for the use in embedded systems like heart rate monitors.
2 METHODS
Figure 4 presents the main view of the system detecting correcting the heart beat artefacts. Both detection and correction are based on several heuristics introduced next.
2.1 Detection methods The first detection is based on maximal and minimal limits on the IBI. All intervals that exceed these so-called “hard” limits are marked as artefacts. After this a second method is used where gradient information of the two successive heartbeats (see Figure 1) is utilized. After that, the groups of non-artefact intervals are compared with each other to reduce the number of sub-series, which radically differ from their surroundings, in cases where there are massive amounts of artefactual intervals in the input data.
2.2 Correction methods After the detection of the likely artefactual intervals, these intervals are corrected to values that interfere less with the algorithms that are used to gain information from the data.
All adjacent intervals marked as artefacts are summed and handled as one artefact interval. These sums are divided to a number of new intervals so that the average error among these new intervals to the reference, neighbour, intervals is minimized. If the average error to the reference intervals could not be improved from what it was in the original series, then no changes are made. Two series of information result from this algorithm. They are the new corrected IBI series are the information of what intervals in the new series are different, corrected, from the original. This latter information can be used to weight the computations on the series in favour of the values that did not need correcting to further improve the reliability of the
5

Saalasti Sami, Seppänen Mikko and Kuusela Antti.
information gained.
Figure 4. Main view of the artefact detection and correction.
6

Saalasti Sami, Seppänen Mikko and Kuusela Antti.
Figure 5. Efficiency of correction as a function of missing beats and extra beats when using different threshold values for correction.
3 RESULTS The accuracy of artefact correction can be quantitatively assessed by artificially interfering a artefact free empirical data. The amount of artefacts can though be determined freely. The randomly generated artefacts contain both extra beats and missing beats. Figure 5 presents the efficiency of artefact correction as a function of missing/extra beats when using three different threshold values. The threshold value of correction determines the proportional limit under which the inter-beat-interval is classified to be correct. The smaller the allowed error in the corrected data the lower the efficiency of the correction. This means that if only five percent error is allowed, this produces for example 500 ± 25 ms (= 114 - 126 bpm when real value is 120 bpm) area of correct corrected value. If 15 % (e.g. = 500 ± 75 ms = 104 – 141 bpm, when real value is 120 bpm) error is allowed the correction is much more efficient. An artificially interfered IBI-series is presented in Figures 6 and 7, which consists both extra and missing beats. Despite the great number of artefacts the heart rate level can be determined to be similar compared to the original data, although the reconstruction of original heart rate variability is impossible. Figure 8 presents the same correction as previously described but now the quantity of artefacts better represents the noise of normal heart rate data. 3.1 ROM, RAM and CPU requirements The amount of artefacts affects the calculation time; however, the most significant factor is the length of the heart beat interval sequence. Figure 9 presents the empirical test of the CPUrequirement of the artefact correction module with 269 exercises measured from different individuals with different exercise length. The calculation time is close to linear respect to the
7

Saalasti Sami, Seppänen Mikko and Kuusela Antti.
heart beat interval sequence length. The following linear equation presents the relationship between heart beat interval sequence length and calculation time in the test setting:
calculation time (seconds)=4.1e-006*IBI length - 0.0041.
Figure 6. Artefact corrected heart rate data from exercise (upper panel) and uncorrected artificially interfered heart rate data.
Figure 7. Correction of artificially interfered resting HR-data containing great number of artefacts.
8

Saalasti Sami, Seppänen Mikko and Kuusela Antti.
4 APPLICATIONS The results have shown that our artefact correction method can detect and correct HR-data that contains even large number of artefacts so that the most important information is still maintained. The correction is fully automated and is though easy to use: No manual editing or user input is required (e.g. user is not required to set and test signal filtering parameters). The correction may be totally hidden from the user. Also an important factor considering the applicability of the current method is the short duration of the calculations enabling the use of the correction model also in embedded systems like heart rate monitors. 5 CONCLUSIONS The developed artefact correction module has proven to be fast, very accurate and reliable correction method. We claim that our artefact correction module is superior to other published or commercial solutions and takes in depth into account physiological information related to heart beat interval time series.
Figure 8. Correction of artificially interfered resting HR-data containing a quantity of artefacts typical of normal HR-recordings.
9

Saalasti Sami, Seppänen Mikko and Kuusela Antti.
Figure 9. Empirical results of the execution time of the artefact correction method. The x-axis presents the length of the heart beat interval sequence and y-axis the corresponding calculation time in seconds.
REFERENCES [1] G. G. Berntson, K. S. Quigley, J. F. Jang, and S. T. Boysen. An approach to artefact
identification: application to heart period data. Psychophysiology, 27(5):586–598, 1990. [2] G. G. Berntson and J. R. Stonewell. ECG artefacts and heart period variability: Don’t
miss a beat! Psychophysiology, 35:127–132, 1998. [3] L. J. M. Mulder. Assessment of cardiovascular reactivity by means of spectral analysis.
PhD thesis, Instituut voor Experimentele Psychologie van de Rijksuniversiteit Groningen, 1988. [4] J.Möttönen, V. Koivunen, and H. Oja. Sign and rank based methods for autocorrelation coefficient estimation. Tampere International Center for Signal Processing (TICSP) Seminar Presentation, 2000. [5] J. Möttönen, H. Oja, and V. Koivunen. Robust autocovariance estimation based on sign and rank correlation coefficients. IEEE HOS’99, 1999. [6] S. W. Porges and E. A. Byrne. Research methods for measurement of heart rate and respiration. Biological Psychology, 34:93–130, 1992. [7] Task Force of the European Society of Cardiology, the North American Society of Pacing, and Electrophysiology. Heart rate variability: standards of measurement, physiological interpretation, and clinical use. European Heart Journal, 17:354–381, 1996. [8] Saalasti, S. (2003). Neural networks for heart rate time series analysis. Academic Dissertation, University of Jyväskylä, Finland. [9] K. Väinämö, S. Nissilä, T. Mäkikallio, M. Tulppo, and J. Röning. Artificial neural networks for aerobic fitness approximation. International conference on Neural Networks (ICNN ’96),Washington DC, USA, June 3-6, 1996.
10

