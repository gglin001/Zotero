A Simple Method to Detect Atrial Fibrillation Using RR Intervals
Jie Lian, PhDa,*, Lian Wang, MSb, and Dirk Muessig, PhDa
Implantable loop recorders have been developed for long-term monitoring of cardiac arrhythmia, but their accuracy for atrial ﬁbrillation (AF) detection is unsatisfactory. We sought to develop and evaluate a simple method for detecting AF using RR intervals. The new AF detection algorithm is based on a map that plots RR intervals versus change of RR intervals (RdR). The map is divided by a grid with 25-ms resolution in 2 axes and nonempty cells are counted to classify AF and non-AF episodes. We evaluated the performance of the method using 4 PhysioNet databases: MIT-BIH AF database, MIT-BIH arrhythmia database, MIT-BIH normal sinus rhythm (NSR) database, and NSR RR interval database (total 145 patients, 1,826 hours NSR, 96 hours AF, and 11 hours other rhythms). Each record is divided into consecutive windows containing 32, 64, or 128 RR intervals. AF detection is performed for each window and classiﬁcation results are compared to annotations. A window is labeled true AF if >1/2 of cycles in the window are annotated as AF or non-AF otherwise. The RdR map shows signature patterns corresponding to various heart rhythms. Optimal nonempty cell cut-off threshold for AF detection was determined by receiver operating characteristic curve analysis, which yields excellent sensitivity and speciﬁcity for window sizes 32 (94.4% and 92.6%, respectively), 64 (95.8% and 94.3%), and 128 (95.9% and 95.4%). In conclusion, a single metric derived from the RdR map can achieve robust AF detection within as few as 32 heart beats. © 2011 Elsevier Inc. All rights reserved. (Am J Cardiol 2011;107:1494 –1497)

Many atrial ﬁbrillation (AF) episodes are asymptomatic1,2; thus reliable AF detection is needed to gauge the success of antiarrhythmic therapy. Many algorithms have been developed to detect AF by assessing regularity of RR intervals.3–12 However, these algorithms are limited by their computational complexity or unsatisfactory performance. In the present report, we present a simple yet robust method for AF detection using RR intervals.
Methods
The new AF detection algorithm is based on a map that shows the scatterplot of RR intervals versus change of RR intervals (dRRs; RdR map). Denote RRi, a series of RR intervals, where RRi represents the i-th RR interval. Further denote dRRi, a series of differences between 2 adjacent RR intervals, i.e., dRRi ϭ RRi Ϫ RRiϪ1. The RdR map is constructed by plotting the RR interval series in 1 axis (e.g., x) against the dRR series in another axis (e.g., y). Number of data points in the RdR map equals the length of the dRR series, and each data point represents 1 pair of RR interval and corresponding dRR interval.
aMicro Systems Engineering, Inc., Lake Oswego, Oregon; bProvidence Heart and Vascular Institute, Portland, Oregon. Manuscript received December 17, 2010; revised manuscript received and accepted January 18, 2011.
This work is fully supported by Biotronik SE and Co. KG, Berlin, Germany.
This work was presented in part at the 31st Annual Scientiﬁc Sessions of the Heart Rhythm Society, Denver, Colorado, May 12 to 15, 2010, and published in abstract form (Heart Rhythm 2010;7(suppl):S387, PO6 –16).
*Corresponding author: Tel: 503-744-8634; fax: 503-635-9610. E-mail address: jie.lian@biotronik.com (J. Lian).

Different from the conventional Lorenz plot, which is based on RR intervals3,11 or dRR intervals,4 the RdR map embeds RR intervals and dRR intervals in the same plot. As a result, heart rate (RR interval) and heart rate change (dRR) information are readily available for use in cardiac rhythm classiﬁcation.
As would be appreciated from the following examples (Figure 1), different heart rhythms show distinctive spatial distribution patterns in their RdR maps. In particular, AF rhythm is characterized by random data points scattered in a large area of the RdR map, reﬂecting irregularity in RR intervals and change of RR intervals. To quantify the sparseness of data points, the RdR map is divided by a 2-dimensional grid with 25-ms resolution in the 2 axes, and nonempty cells (NECs; i.e., contain Ն1 data point) are counted. For an episode of cardiac cycles (number of data points set to 32, 64, and 128 in this study), detection of AF rhythm is made if NEC exceeds a predeﬁned threshold. Otherwise, non-AF classiﬁcation is made.
Performance of the new AF detection algorithm was evaluated using 4 annotated PhysioNet databases13 (MITBIH AF database, MIT-BIH arrhythmia database, MIT-BIH normal sinus rhythm [NSR] database, and NSR RR interval database; Table 1). All together, these databases include 144 patients and provide RR interval data that include 1,826 hours NSR, 96 hours AF rhythm, and 11 hours other rhythms.
Each patient’s record is divided into consecutive (nonoverlapping) windows containing 32, 64, or 128 RR intervals. For reference, a window is labeled a true AF episode if Ͼ1/2 of cycles in the window are annotated as AF; otherwise the episode is non-AF. For each window, AF detection is performed and the classiﬁcation result (AF or non-AF) is compared to the reference (labeled based on

0002-9149/11/$ – see front matter © 2011 Elsevier Inc. All rights reserved. doi:10.1016/j.amjcard.2011.01.028

www.ajconline.org

Arrhythmias and Conduction Disturbances/Atrial Fibrillation Detection Using RR Intervals

1495

Figure 1. Representative examples of maps plotting RR intervals versus change of RR intervals corresponding to (A) atrial ﬁbrillation rhythm, (B) normal sinus rhythm with 1 premature ventricular complex, (C) persistent ventricular bigeminy, (D) mixed sinus rhythm and ventricular trigeminy, (E) typical atrial ﬂutter, and (F) ventricular tachycardia. The window size is set to 64 in these examples.

Table 1 Databases used in the study
Database
MIT-BIH normal sinus rhythm database Normal sinus rhythm RR interval database MIT-BIH atrial ﬁbrillation database MIT-BIH arrhythmia database Combined databases

Number of Records
18 54 25 48 145

Duration of NSR Rhythm (hours)
384 1276 149.1
17.3 1826.4

Duration of AF Rhythm (hours)
0 0 93.3 2.2 95.5

Duration of Other Rhythms (hours)
0 0 6.6 4.5 11.1

1496

The American Journal of Cardiology (www.ajconline.org)

databases. Overall, excellent sensitivity and speciﬁcity for AF detection are obtained for window sizes 32 (94.4% and 92.6%, respectively), 64 (95.8% and 94.3%), and 128 (95.9% and 95.4%).

Figure 2. Receiver operating characteristic curves for atrial ﬁbrillation detection corresponding to 3 different window sizes (32, 64, and 128) by changing the nonempty cell cut-off threshold.
annotations) to determine if it is true positive, false positive, true negative, or false negative. Sensitivity and speciﬁcity of AF detection are then calculated for each database and the combined databases. For each window size, receiver operating characteristic curve is obtained by changing the NEC threshold and area under the receiver operating characteristic curve is calculated. Optimal NEC cut-off threshold for AF detection is determined by searching for the shortest distance to the upper left corner.14
Results
Figure 1 shows representative examples of RdR maps corresponding to various heart rhythms. In general, distribution of data points is oriented from the lower left to the upper right of the RdR map because longer RR intervals tend to have positive dRR intervals, whereas shorter RR intervals are often associated with negative dRR intervals.
Clearly different cardiac rhythms show distinctive patterns on an RdR map. AF rhythm is characterized by scattered data points distributed in a large area (Figure 1), reﬂecting the irregularity of heart rate and change of heart rate. In contrast, other rhythms show Ն1 cluster in their RdR maps (Figure 1), implying the presence of a certain degree of rate and/or rhythm regularity. Note that a single premature ventricular complex during NSR generated 3 isolated data points because of the short premature ventricular complex coupling interval, long pause after the premature ventricular complex, and the following return to normal RR interval (Figure 1). Similarly, 3 additional clusters are generated in ventricular trigeminy rhythm, which has multiple “short–long–normal” cycles (Figure 1). In contrast, persistent ventricular bigeminy has a signature pattern of dual clusters because of the repetitive short–long sequence (Figure 1).
Calculated from the combined databases, Figure 2 shows AF detection receiver operating characteristic curves corresponding to 3 different window sizes (32, 64, and 128) by changing the NEC cut-off threshold. Areas under receiver operating characteristic curves are 0.978, 0.986, and 0.989 for the 3 window sizes, respectively. As expected, larger window size yields more robust AF detection. Optimal NEC cut-off thresholds were 23, 40, and 65 corresponding to window sizes 32, 64, and 128, respectively. Using optimal NEC cut-off threshold for each window size, Table 2 presents AF detection results in each dataset and combined

Discussion
This study presents a novel method for AF detection based on an RdR map constructed from RR intervals. Although increasing the window could yield more robust AF detection, excellent performance (Ͼ90% in sensitivity and speciﬁcity) could be achieved when analyzing only 32 cardiac cycles. Therefore, this method is well suited for realtime AF detection.
The hallmark of AF is an irregularly irregular ventricular rhythm. Such irregularity is often manifested in heart rate and change of heart rate, which are respectively embedded in 2 dimensions of the RdR map. In contrast, conventional AF detection methods usually measure only irregularity in RR intervals3,5,11 or dRR intervals4,5,8; thus important rhythm information (on heart rate change or heart rate) may be excluded. Therefore, although technically the RdR map may appear to be only a minor deviation from the conventional Lorenz plot,3,4,11 conceptually the RdR map represents a fundamental departure from the Lorenz plot approach because it embeds 2 (instead of 1) independent sources of heart rhythm information (heart rate and change of heart rate) into a single graph.
Direct comparison with other AF detection methods is hindered by nonuniform usage of test databases and/or performance metrics. Similar to Shouldice et al,6 we evaluated our algorithm in 4 large public databases, whereas most other studies used smaller/partial database or proprietary data.3–5,7–10,12,15 In this study, we used the standard deﬁnition of episode sensitivity and speciﬁcity, which are the most meaningful clinical measurements of true-positive rate and true-negative rate. The commonly used positive predictive value,4–6,8,12 however, is affected by AF prevalence. Another unique advantage of the present method is its simplicity. Classiﬁcation of AF and non-AF is based on a single metric NEC, which is a simple count of NECs on the RdR map. All other methods require evaluation of multiple metrics and/or more complex calculations usually involving ﬂoating point operations that are particularly challenging for implementation in battery-powered implantable devices.
The present AF detection method is particularly suitable for implementation in implantable loop recorders because of its high efﬁciency and accuracy, thus offering an attractive device feature for long-term cardiac rhythm monitoring and diagnosis, which may be used to assess the efﬁcacy of antiarrhythmic therapy and guide anticoagulation management in patients with AF.15 Furthermore, the intuitive RdR map offers a new way of analyzing cardiac rhythms. Although we have explored using only 1 metric for AF detection, the combination of multiple metrics may facilitate discrimination of various cardiac arrhythmias because their distinctive RdR patterns (Figure 1).
This study is limited mainly by the retrospective analysis of available databases that may not be representative of clinical data. Independent performance evaluation in a prospective dataset is highly desired. We also did not evaluate

Arrhythmias and Conduction Disturbances/Atrial Fibrillation Detection Using RR Intervals

1497

Table 2 Atrial ﬁbrillation detection results using optimal nonempty cell cut-off thresholds

Database

Window Size 32

Window Size 64

Window Size 128

Sensitivity

Speciﬁcity

Sensitivity

Speciﬁcity

Sensitivity

Speciﬁcity

MIT-BIH normal sinus rhythm database Normal sinus rhythm RR interval database MIT-BIH atrial ﬁbrillation database MIT-BIH arrhythmia database Combined databases

NA* NA* 94.3% 98.1% 94.4%

84.1% 95.1% 95.1% 77.0% 92.6%

NA* NA* 95.7% 97.7% 95.8%

87.4% 96.4% 96.0% 78.2% 94.3%

NA* NA* 95.8% 98.9% 95.9%

90.0% 97.2% 96.4% 78.8% 95.4%

* Calculation of sensitivity is not applicable for the MIT-BIH normal sinus rhythm and normal sinus rhythm RR interval databases because of the absence of a true atrial ﬁbrillation episode.
NA ϭ not applicable.

effects of RR interval artifacts frequently seen in clinical practice, e.g., because of T-wave oversensing, R-wave undersensing, noise interference, etc. In addition, like all other RR interval– based algorithms, the present method may fail to detect AF with relatively regular rhythm and produce a false alarm for non-AF rhythm with a certain degree of rhythm irregularity.
Supplementary data
Supplementary data associated with this article can be found, in the online version, at doi:10.1016/j.amjcard. 2011.01.028.
1. Orlov MV, Ghali JK, Araghi-Niknam M, Sherfesee L, Sahr D, Hettrick DA. Asymptomatic atrial ﬁbrillation in pacemaker recipients: incidence, progression, and determinants based on the atrial high rate trial. Pacing Clin Electrophysiol 2007;30:404 – 411.
2. Verma A, Minor S, Kilicaslan F, Patel D, Hao S, Beheiry S, Lakkireddy D, Elayi SC, Cummings J, Martin DO, Burkhardt JD, Schweikert RA, Saliba W, Tchou PJ, Natale A. Incidence of atrial arrhythmias detected by permanent pacemakers (PPM) post-pulmonary vein antrum isolation (PVAI) for atrial ﬁbrillation (AF): correlation with symptomatic recurrence. J Cardiovasc Electrophysiol 2007; 18:601– 606.
3. Park J, Lee S, Jeon M. Atrial ﬁbrillation detection by heart rate variability in Poincare plot. Biomed Eng Online 2009;8:38.
4. Sarkar S, Ritscher D, Mehra R. A detector for a chronic implantable atrial tachyarrhythmia monitor. IEEE Trans Biomed Eng 2008;55: 1219 –1224.
5. Ghodrati A, Murray B, Marinello S. RR interval analysis for detection of atrial ﬁbrillation in ECG monitors. Conf Proc IEEE Eng Med Biol Soc 2008;2008:601– 604.

6. Shouldice RB, Heneghan C, de Chazal P. Automated detection of paroxysmal atrial ﬁbrillation from inter-heartbeat intervals. Conf Proc IEEE Eng Med Biol Soc 2007;2007:686 – 689.
7. Kikillus N, Hammer G, Wieland S, Bolz A. Algorithm for identifying patients with paroxysmal atrial ﬁbrillation without appearance on the ECG. Conf Proc IEEE Eng Med Biol Soc 2007;2007:275–278.
8. Petrucci E, Balian V, Filippini G, Mainardi LT. Atrial ﬁbrillation detection algorithms for very long term ECG monitoring. Comput Cardiol 2005;32:623– 626.
9. Duverney D, Gaspoz JM, Pichot V, Roche F, Brion R, Antoniadis A, Barthelemy JC. High accuracy of automatic detection of atrial ﬁbrillation using wavelet transform of heart rate intervals. Pacing Clin Electrophysiol 2002;25:457– 462.
10. Tateno K, Glass L. Automatic detection of atrial ﬁbrillation using the coefﬁcient of variation and density histograms of RR and deltaRR intervals. Med Biol Eng Comput 2001;39:664 – 671.
11. Anan T, Sunagawa K, Araki H, Nakamura M. Arrhythmia analysis by successive RR plotting. J Electrocardiol 1990;23:243–248.
12. Moody GB, Mark RG. A new method for detecting atrial ﬁbrillation using R-R intervals. Comput Cardiol 1983;10:227–230.
13. Goldberger AL, Amaral LA, Glass L, Hausdorff JM, Ivanov PC, Mark RG, Mietus JE, Moody GB, Peng CK, Stanley HE. PhysioBank, PhysioToolkit, and PhysioNet: components of a new research resource for complex physiologic signals. Circulation 2000;101(suppl):E215– E220.
14. Sun XG, Hansen JE, Beshai JF, Wasserman K. Oscillatory breathing and exercise gas exchange abnormalities prognosticate early mortality and morbidity in heart failure. J Am Coll Cardiol 2010; 55:1814 –1823.
15. Hindricks G, Pokushalov E, Urban L, Taborsky M, Kuck KH, Lebedev D, Rieger G, Purerfellner H. Performance of a new leadless implantable cardiac monitor in detecting and quantifying atrial ﬁbrillation: results of the XPECT trial. Circ Arrhythmia Electrophysiol 2010;3: 141–147.

