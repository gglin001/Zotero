智慧型類神經網路設計之新型血壓計
Application the intelligent Neural Network to Design the Novel Blood Pressure Monitor
莊爵譽 Chueh-Yu Chuang 吳崇民 Chung-Min Wu 崑山科技大學電子工程研究所 Department of Electronic Engineering, Kun Shan University

摘要 在近代的預防醫學中，各種不同的生理參數已 廣泛應用於各種疾病的預防，以及疾病初期的偵 測，其中評估心血管疾病發生的機率常透過每日 的血壓量測來觀察。現今血壓量測方法，大多透 過氣泵對腕帶施加壓力，量測時手臂遭腕帶壓迫 而有不舒服的感覺，易造成受測者緊張，導致血 壓量測上之誤差，且無法做即時血壓監測。 心電圖中各波代表了心臟運作的各種狀態，其 中也包含有血壓的相關訊息，因此本研究擬將從 心電圖訊號中解析出血壓之相關特性。本研究將 發展新式之非侵入式血壓量測技術，設計智慧型 類神經網路演算法，以心電圖之特性參數計算血 壓值，此新型血壓機稱為心電血壓機。讓患者在 醫院或自家生活中，都可以隨時監測自我血壓， 除了改善量測時壓力所造成的不適感外，更可進 行長時間的連續血壓監測，掌握身體狀況，以避 免意外的發生。

1. 前言 在近代的預防醫學中，各種不同的生理參數以
廣泛測量並應用於各種疾病的預防以及疾病初期 的偵測方面，例如：體脂肪的量測、 Electroencephalography(EEG) 與 Event Related Potentials(ERPs) 對 於 精 神 認 知 狀 態 的 評 估 以 及 Electrocardiogram(ECG) 與 Heart Rate Variability (HRV)對於身體狀態的觀察等等，而血壓的參數也 可以評估心血管疾病發生的機率[1]。
在國際間有些許學者，持續探討血壓之量測技 術 ， 血 壓 量 測 主 要 分 為 侵 入 式 量 測 (Invasive measurement techniques)如圖1[4][8]與非侵入式量 測 (Noninvasive measurement techniques) 如 圖 2[3][4][5]兩種。

關鍵詞:類神經網路、血壓、心電圖

Abstract
In modern times, various different physiological parameters have been widely used in various diseases, prevention, and primary disease detection, which to observe the probability of occurrence of cardiovascular diseases, often through blood pressure measurements in the daily. The blood pressure measurement method that most of using the pressure on the wrist through the pump to measure the blood pressure in currently. The people were feeling uncomfortable, tension when the pressure on the arm, leading to the error on the measurement of blood pressure and this method cannot do real-time blood pressure monitoring. Electrocardiogram (ECG) represents the various operation states of the heart, which also contains blood pressure-related information, so this research tries to parse out the related features of blood pressure from the ECG signal. This research will develop a new non-invasive blood pressure measurement technology that designs the intelligent neural network algorithms to calculate the blood pressure value by the parameters of ECG, the new blood pressure measurement machine called the ECG-blood pressure machine. The users can be self-monitoring of blood pressure at any time in hospitals or their own life, in addition to improving the pressure of measurement caused by the discomfort, but also can be continuous blood pressure monitoring for a long period and to understand the physical condition to avoid accidents.
Keywords: Neural network, Blood Pressure, Electrocardiogram

圖1.Invasive measurement techniques[4]
圖2.Noninvasive measurement techniques[4] 其中侵入式量測數據較準確，可做長時間即時 之血壓監測，但易對人體組織遭成傷害，相對的 提高量測之危險性，此種量測方法只適用於大型 醫院，且有經過特殊訓練之醫護人員方可進行； 而非侵入式量測則不會對人體造成傷害，危險性

低，但無法做即時血壓監測，因操作方便，大多 數人都可學會，適合作為居家血壓觀測之量測技 術，雖量測數據與真實數據有些許誤差，但仍屬 可接受範圍。
在1905年KOROTKOFF提出非侵入式的腕帶 壓量測技術，即透過腕帶洩氣時，利用聽診器聆 聽血液通過血管之聲音，並觀察水銀刻度來確認 收縮壓及舒張壓的量測方法，此為水銀血壓計之 量測技術。但由於透過聽診器量測時，常會因量 測者之聽覺能力和主觀辨識的差異性，而造成量 測上的誤差。隨著醫學技術的發展，現今在醫療 電子化與數位化的帶動下，操作簡單、易觀察的 電子血壓計也漸漸取代傳統水銀血壓計。電子血 壓計以數位訊號處理的方法，運用脈搏血壓的共 振波形之數值比例，計算出血壓的收縮壓與舒張 壓[2][4][8]，此血壓共振波形如圖3所示。

圖4.系統流程圖
2.1 訊號量測 在訊號量測這部分裡，在ECG量測方面本研
究使用Einthoven triangle中的Lead I，Lead I量測方 法是以右臂與左臂的電位差，如圖5。

圖3.壓力訊號與共振訊號之關係[4] 非侵入式血壓量測方法，皆透過氣泵對腕帶施 加壓力，量測時手臂遭腕帶壓迫而有不舒服的感 覺，易造成受測者緊張，導致血壓在量測上產生 誤差。因此本研究將發展新式之非侵入式血壓量 測技術，以心電圖參數計算血壓值，除了可改善 非侵入式血壓量測之氣泵對腕帶施加壓力，所造 成的不適感外，更可進行長時間的即時血壓監 測。目前國內外對於血壓與心電圖之關聯性的相 關研究非常少[5]，本論文將以心電圖中PQRST波 與血壓訊號之相關特性參數，再運用倒傳遞類神 經網路作為血壓演算，並將心電圖與血壓訊號相 關特性參數作為輸入值，建立一新式之非侵入式 血壓量測技術。

圖 5. Einthoven triangle[9]
Lead的選擇方式以可從心電圖中清晰的分辨 出P、Q、R、S、T波，其因於P、Q、R、S、T波 代表了心臟的各種狀態，如圖6。

2. 實驗方法 本研究將建立心電圖與血壓量測電路，並進行
off line訊號處理，並偵測心電圖中PQRST波與血 壓波峰，並進行相關性分析。圖4為本研究系統流 程圖，主要分為2個部分說明(1)訊號量測、(2)訊 號處理。

圖 6. Electrophysiology of the heart[9] 本研究主要以心電圖換算血壓值，而心電圖訊

號是呈現心臟即時連續性號，因此本研究在血壓 量測方面是使用血管容積變化信號也就是所謂的 Photo-Plethysmograph(PPG)量測法，而非利用傳統 血壓計的量測法，主要原因是傳統式血壓計須透 過壓力並經過時間才能統計出受測者血壓，無法 即 時 對 映 心 電 圖 ， 而 PPG 是 利 用 光 學 感 測 器 量 測，人體末稍微血管的管徑變化量測方法是以左 臂的脈搏訊號，如圖7。

F(S)

=

⎧S ⎩⎨S

M M

−S +1 −

M
S

−1 M

> <

0 0

, M = 1,2,..., n

(1)

式(1)中的 S 為血壓或 ECG 之訊號，M 為第 n 筆

訊號值。

將血壓訊號與 ECG 訊號各偵測的波峰中最大的能

量作為主要特徵點的參考值，並與各波峰值進行

比例篩選，篩選範圍界定於 80%，若該波峰值大

於 80%，將歸列於該訊號的主要特徵點，如圖 10。

圖 7. 脈搏量測位置 PPG量測主要是觀察血管中血液的流動因受 到心臟搏動的影響，所產生的週期性變化，進而 造成血壓的週期性變化，這種血管管徑的變化也 會因為連續血壓的影響所呈現連續性變化，因此 本研究將此訊號作為即時性血壓的週期性訊號。
2.2 訊號處理 此部分主要進行血壓與心電圖之波峰偵測與
相關性分析，處理流程分為Peak detection with pattern’s correlation 、 Analysis of relationship between BP and ECG等兩個部分，如圖8所示。

圖10. 主要特徵點偵測之方式
(b) 遺失之主要特徵點偵測 在主要特徵點的偵測過程中，有些主要特徵
點會因條件不符合，而沒被檢測出來，由於血壓 與心電圖皆屬於周期波，因此本研究將進一步利 用平均週期來檢查，是否有未偵測到波峰。當兩 波峰間的距離大於平均區間時，則可能有波峰遺 失，如圖11所示，此時若區間內有其它的波峰， 便以樣本相關性分析找出遺失之波峰[10]。

圖8.訊號處理流程
Peak detection with pattern’s correlation 此部分主要對 BP 與 ECG 等訊號進行處理，
其中 BP 訊號主要偵測手指血壓波形的所有波峰 點。而 ECG 訊號主要偵測 P、Q、R、S、T 等波 的波峰點，分別按以下 3 個步驟進行:偵測主要特 徵點、遺失之主要特徵點偵測、其餘特徵點偵測， 如圖 9。

圖11. BP與ECG波峰遺失示意圖 本研究將建立一標準樣本以進行波形之相關 性分析，標準樣本為該訊號之參考點區間，例如: BP 之標準樣本為動脈收縮壓之波形，而 ECG 屬 於複合波，當 ECG 訊號準位飄移時，其參考點可 能並非為 R wave，因此利用 MATLAB 提供 ECG function 的 R wave 作為標準樣本，標準樣本之區 間設定如式(2)。
Array = [M (s) − 0.06(s) ≤ M (s) ≥ M (s) + 0.06(s) ] (2)

圖9.峰值偵測流程
(a) 偵測主要特徵點 血壓訊號之主要特徵點為動脈收縮壓為 B
wave，正常 ECG 訊號之主要特徵點為 R wave， 以下將對兩種訊號處理做說明。 血壓訊號與 ECG 訊號先進行波峰峰值偵測建立波 峰序列，如式(1)。

式(2)中 M 為主要特徵時間點，並選取前 0.06 秒 至後 0.06 秒總時間為 0.12 秒，其中 0.12 秒則是考 慮 ECG 主要特徵 QRS complex wave 的 QS 正常 區間最大值為 0.12 秒[6][9]。
當該訊號內有未偵測到波峰，便以標準樣本 進行波形相關性分析。當相關係數大於 68.2%(一 個標準差)，將新增於主要特徵點序列中，並讓標 準樣本對該波進行學習，其學習演算法為最小平 均演算法(MSE)，如式(3)。主要使樣本個人化，

並提升相關係數，降低辨識錯誤率，當遺失波峰 之主要特徵點偵測結束時，再以學習後之標準樣 本對整個序列進行相關性分析，並持續進行樣本 學習，直到無任何特徵點被偵測到為止。

w = 1 E(w − Δw)2 + w 2

(3)

式(3)中 w 為標準樣本，△w 為偵測到波形。

2.3 ECG 血壓機之設計 將心電訊號與血壓訊號相關特性較高的參
數，做為神經元的輸入端，進行網路演算及學習， 建立心電血壓機之雛形。本系統採用多層感知器 (multilayer perceptron, MLP)，結合誤差倒傳遞演 算法(Error Back Propagation, EBP)來進行網路學 習，此組合稱之為倒傳遞類神經網路[3]，如圖14 所示。

(c) 其餘特徵點偵測 主要特徵偵測點結束後，此流程以 ECG 特徵
點 R wave 為參考點，進行其餘波峰(P, Q, S, T)偵 測，偵測方式則依據各波與 R wave 之時間特性來 偵測[9]，如表 1。而血壓訊號則將兩波峰間之波 谷為動脈舒張壓特徵點。

表1. Electric events in the heat[9]

圖14. 倒傳遞類神經網路架構圖[7]
本研究將使用 MATLAB 的 GUI 系統建立 ECG 血壓機之介面，如圖 15，此介面主要功能將 顯示血壓推算、ECG 之各波峰偵測和心律的自回 歸分析。

Analysis of relationship between BP and ECG 本研究為找出新的特性參數發展新式之非侵
入式血壓量測技術，利用血壓與心電圖之關係 [5][6]，因此本研究首先進行 ECG 與 BP 之週期相 關性分析，於 BP 波峰 B 與 ECG 的 T 波峰發生時 間點一致，因此設置 T 波峰與 B 波峰之週期相關 性分析，接著進行 ECG 各波至 T 波之區間與收縮 壓之區間的特性分析，如圖 13 粗線部分及 T 波至 ECG 各波之區間與舒張壓之區間的特性分析，以 找出 ECG 相對應於收縮壓、舒張壓之特性參數。

圖 15. ECG 血壓機介面
3. 實驗結果 本研究邀請 5 位 20~26 歲受測者，同時進行心
電與血壓量測，如圖 16 所示。圖 16 為實際量測 圖，圖 16 中(A)為紅外線脈搏量測電路，圖 16 中 (B)為心電圖量測電路，將所量測的訊號將進行訊 號處理、相關性分析，並從相關性分析得此兩種 訊號之特性參數。

圖13. ECG特徵參數與血壓之相關性分析[6]

3.2 標準樣本辨識率 ECG 的標準樣本屬於複合波，因此只觀察
ECG 的標準樣本學習後之辨識率。圖 19 為標準樣 本分析與學習，特徵樣本與未偵測波峰之波形學 習，明顯提升相關係數。

圖16. 實際量測圖 3.1 訊號處理之波峰偵測
本研究先進行訊號處理，同時進行 BP 與 ECG 之訊號處理，並依序以波峰偵測圖進行解說。 圖 17 為 BP 訊號波峰偵測圖，圖 17(a)主要特徵之 參考點為圖中方形，圖 17(b)主要特徵點偵測圖中 圓形為 80%以上之主要特徵點，圖 17(c)找回遺失 之主要特徵點圖中三角形。

圖19. 標準樣本分析與學習

並統計偵測到的 R wave 數與實際觀察 R wave 數 之誤差百分比(表 2) ，標準樣本學習的確有助於 降低辨識錯誤率。
表2.R wave偵測辨識率

圖17. BP訊號波峰偵測
圖 18 為 ECG 訊號偵測流程圖，圖 18(a)主要特徵 之參考點為圖中方形，圖 18(b)主要特徵點偵測圓 形為 80%以上之主要特徵點，圖 18(c)遺失之主要 特徵點偵測圖中三角形，圖 18(d) 將進行其餘特 徵點徵測，心電圖的 P、Q、R、S、T 波峰。

3.3 心電圖與血壓特性分析 訊號處理後，將心電圖中 PQRST 波與血壓
訊號波峰，並依據本研究所設計之參數進行特性 分析統計(表 3)。由表 3 中將選取相關特性高於 68.2%(一個標準差)之區間參數(ET、RT、QT、ST、 TP、TQ、TR)作為類神經網路之輸入變數。
表3.心電圖與血壓特性分析

圖18. ECG訊號波峰偵測

3.4 血壓量測結果 將 ET、RT、QT、ST、TP、TQ、TR 等區間
做為類神經網路之輸入訊號，本研究將建立七個 輸入端的倒傳遞類神經網路架構，再經由 20 筆資

料學習後，並對 5 位受測者在加上 10 筆未進行血 壓特性分析資料進行血壓演算，演算所得量測值 與水銀血壓計量測值之結果，如表 4。其中有些 subject 與實際量測值有較大差異，可能是因為類 神經網路之學習資料不足。
表4.心電血壓計演算

June, 2006. [5] JB. Mark, Atlas of cardiovascular monitoring, Churchill Livingstone, New York, 1998. [6] 依日光，醫用電子計測技術，復漢出版社， 1995。 [7] 張斐章，張麗秋，類神經網路，東華書局， 2005。
[8] J. G. Webster ed., Medical Instrumentation Application and Design, 3rd ed., John Wiley & Sons, 1998. [9] Jaakko Malmivuo, Robert Plonsey, Bioelectromagnetism Principles and Applications of Bioelectric and Biomagnetic Fields, New York Oxford: UNIVERSITY PRESS,1995. [10] Chong-Min Wu, Quantification of Motor Unit Firing Patterns, National Cheng Kung University, Taiwan, 1998.

4. 討論 由測試的結果可以發現，雖然推算出血壓還不
是相當準確，但已相當接近水銀血壓計所量之血 壓值，未來在類神經網路之演算方面，還需要更 多的臨床測試與學習才能達到更為精確的數值， 且將與醫院合作收集侵入式血壓之量測數據，以 求更精準的計算出接近真實之血壓值。
本研究已完成心電血壓機之基本模型，經由實 際量測之結果，驗證本系統再現性良好。為了使 新式之非侵入式血壓量測技術實際運用於生活 上，本研究將改良心電圖 PQRST 波偵測方式， Offline 的分析系統改成 Online 的分析系統，讓患 者在醫院或自家生活中，都可以隨時監測自我血 壓，掌握身體狀況，以避免意外的發生。
參考文獻
[1] 陳政宇，李璟林，丁文宏，鄭國順，電子血 壓計之研製:基於微處理器架構的數位處理方 法，國立成功大學醫學工程研究所,2006。 [2] G. Drzewiecki, R. Hood, H. Apple, “Theory of the Oscillometric Maximum and the Systolic and Diastolic Detection Ratios”, Annals of Biomedical Engineering, vol. 22, p88-96, 1994. [3] Blitt CD, Hines RL, Monitoring in anesthesia and critical care medicine, Churchill, New York, p118, 1995. [4] Jay Horrow, MD Professor and Chair, Blood Pressure Measurement, Anesthesiology Drexel University College of Medicine Philadelphia, PA,

