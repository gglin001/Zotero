第２０卷第１期 ２００１年３月

Ｊ匕京生物医学Ｔ程 Ｂｃｉｊｉｎｇ Ｂｉｏｍｅｄｉｃａｌ Ｅｎｇｉｎｅｅｒｉｎｇ

Ｖ０１．２０ Ｎｏ １

Ｍａｒ．

２００１

心率变异信号的非均匀采样问题研究

李凌王志中蔡立羽

捕要心率变异性研究是目前的一个研究热点。心率变异性研究的主要对象——Ｒ Ｒ问期时问序列是一个

非均匀采样序列，这种非均匀性导致了许多『廿Ｊ题。本文提出ｒ一种基于三次样条的序列均匀重采样算法，并构造

了一种新的更直观的Ｒ—Ｒ间期信号模型。实验结果表明新算法确宴可以改善谱估计的结果和波形的形态，消除二

次伪谐波峰，并在大多数情况下减少偏差。更奄要的是，法算法使得Ｒ—Ｒ问期序列的物理意义更明确，从而使不

同信号间的比较和运算成为可能。

美蕾词心率变异Ｒ—Ｒ问期时间序列非均匀采样 三次样条

中围分类号Ｒ３１８．４

文献标识码

Ａ

文章编号１００２ ３２０８（２００１）Ｏｌ ００４７ ｏ●

Ｚｈｉｚｈｏｎｇ．㈨Ｊ Ｒｅｓｅａｒｃｈ ｏｆ Ｕｎｅｖｅｎｌｙ Ｓａｍｐｌｅｄ ＨＲＶ Ｓｉｇｎａｌ ＬＩ Ｌｉｎｇ，ＷＡＮＧ

Ｌｉｙｕ．Ｄｅｐａｒｔｍｅｎｔ ｏｆ Ｂｉｏｍｅｄｉｃａｌ

Ｅｎｇｉｎｅｅｒｉｎｇ，Ｓｈａｎｇｈａｉ ｄｉａｏｔｏｎｇ Ｕｎｉｖｅｒｓｉｔｙ，２０００３０

Ｒ—Ｒ…ｔ ｉ……一ｌｙ ｓａｍｐｌｅｄ…“． ［Ａｂｓｔｒａｃｔ］ＨＲＶ（ｈｅａｒｔ ｒａｔｅ ｖａｒｉａｂｉＪｉｔｙ）ｈａｓ ｂｅｅｎ ｓｔｕｄｉｅｄ Ｍｒ ｍａｎｙ ｙｅａｒｓ

ｒ”】ｓｅｒ／ｅｓ

ｕｎｅ砌ｎｅｓｓ ｉｎ…ｅ ｔｈｅ

ｗｈｌｅｈ ｒｅｓｕｌｔ

ｐｒｏｈｌｅｎ，ｓ．ｈ、ｔｈｉｓ ａｆｌｉｃ／ｅ’５ ｐｒｅｓｅｎｔｅｄ ａｎ ｅｖｅｎｌｙ ｒｅｓａｍｐｌｅ ａｌｇｏｒｉｔｈｍ ｂａｓｅｄ ｏｎ ｃｕｂｉｃ ｓｐｈｎｅ．Ｔｈｅｎ

ａ ｎｅｗ Ｄ】ｏｒｅ ｉｎｌｕｉｌｉｖｅ ｍｏｄｅｌ ｉｓ ａｌｓｏ ｐｒｅｓｅｎｔｅｄ Ｒｅｓｕｌｔｓ ｓｈｏｗ ｔｈａｔ ｔｈｅ ｎｅｗ ａｌｇｏｒｉｔｈｍ ｃａｎ ｉｍｐｒｏｖｅ ｔｈｅ ｒｅｓｕｌｔ ｏｆ ｓｐｅｃｔｒｕｍ ｅｓｔｉｍａｔｉｏｎ．

ｐｅａｋｓ，ａｎｄ…ｌｉｍｉｔ ｉｓ㈣ｍｏＥｃ ｃａｎ ｅｌｉｍｉｎａｔｅ ２ｎｄ ｆａｌｓｅ ｈａｒｍｏｎｉｃ

ｄｅｖｉａｔｉｏｎｓ ｉｎ ｍｏｓｔ ｃａｓｅｓ．Ａｎｄ ｉｔ

ｉｍｐｏｒｔａｎｔ ｔｈａｔ，ｔｈｅ ｒｅｓａｍｐｈｎｇ

ｍａｋｓ ｔｂｅ ｐｈｙｓｉｃａｌ ｍｅａｎｉｎｇ ｏｆ Ｒ Ｒ ｓｅｒｉｅｓ ｍｏｒｅ ｃｌｅａｒ，ａｎｄ ｔｈｅｒｅｂｙ ｍａｋｅｓ ｃｏｍｐａｒｉｓｏｎ ａｎｄ ｃａｌｃｕｌａｔｉｏｎ ａｍｏｎｇ ｄｉ什ｅｒｅｎｔ ｓｉｇｎａｌｓ

ｐｏｓｓｉｂｌｅ
［Ｋｅｙ ｗｏｒｄｓ］ＨＲＶ

Ｒ、Ｒ ｉｎｔｅｒｖａｌ ｓｅｒｉｅｓ

Ｕｎｅｖｅｎｌｙ ｓｙｍｐｌｉｎｇ

Ｃｕｂｉｃ ｓｐｌｉｎｅ

０引 言
心率变异性研究已经成为目前的一个研究热 点ｉＩ。ｊ，国内已有多篇论文发表，但有些研究者及其 论文没有重视这样一个问题，即Ｒ—Ｒ问期时间序列 事实上是一个非均匀采样序列，如果直接对该序列 进行谱分析，将可能导致许多问题。首先，这种非 均匀性会影响谱分析的结果．而且我们的实验表明 这种影响的大小是不确定的，与许多因素，如心电 数据的采样率，病人的心率等有关。其次，这种非 均匀性会使得信号的某些含义变得不确切，如该时 间序列的横轴将不是时间，而是心跳，单位为跳 （ｂｅａｔ），因而谱的频率轴的单位不是Ｈｚ（１／ｓ），而 应该是１／跳（１／ｂｅａｔ）。国内有部分文章和论文忽略 了这一点，所给出的谱分析的结果都用Ｈｚ作单位， 这是不确切的。第三，Ｒ—Ｒ间期时间序列不仅是一
作者筒介：李凌（１ ９７２一），男，现为上悔交通大学生物医学工程系 在读博士研究生．
作者单位：上海交通大学生物医学工程系（２０００３０）

个非均匀采样时间序列，而且这种非均匀性因人而 异，心跳快时采样率高，心跳慢时采样率低，即使 同一个人在不同的生理条件下（如睡眠状态和运动 状态），其平均采样率也差别很大．这显然极不利于 信号问的对比和分析。第四，ＨＲＶ研究的某些方向， 如心率变异与呼吸、血压等关系的研究，需要计算 Ｒ—Ｒ间期时间序列与其它生理信号之间的交叉谱， 这就要求这些信号的采样单位和采样频率是一致 的，Ｒ Ｒ间期时间序列显然不符合这个条件，因此 必须对Ｒ—Ｒ间期时间序列进行一些预处理。对于这 些问题，国内的研究者一般有三种态度：第一种认 为这种非均匀性非常小，可近似的认为该序列在时 间轴上是均匀采样的［‘４］；第二种则承认了这种非均 匀性的存在，但未作任何处理，而只是将频率轴的 单位改为１／跳“１；第三种则对这种非均匀性进行了 简单的处理，如对两相邻Ｒ—Ｒ间期进行插值后作为 新采样值等，从而使采样均匀化”］。大多数论文持第 一种态度，少数持第二种或第三种态度。本文将通 过构造一个简单的心率变异模型，对以上问题进行 探讨，并进而提出一个算法，实验结果表明该算法

　万方数据

·４８·

北京生物医学工程

第２０卷

有效可行且意义明确。

１算法

本算法的思路和上文提到的线性插值算法类 似．也是先对Ｒ－Ｒ间期时间序列进行插值，然后再

进行均匀重采样，使得采样均匀化。所不同的是本 算法并不是仅仅对两点之间进行线性插值，而是对

整个Ｒ—Ｒ间期序列进行三次样条插值，从而使结果 更台理、更准确。

设Ｒ Ｒ间期序列为ｒ，单位为秒（ｓ），原心电信 号采样频率为Ｆ（Ｈｚ），采样时间Ｔ（ｓ），则原始心

电信号数据长度为ＦＴ。对Ｒ—Ｒ间期序列ｒ在区间

［１，ＦＴ］上进行插值，则样点应为

堕堡

！ｔ！ ！！±！！！！ ：：：

样点Ｉ

Ｒｌ

Ｒｚ

…

苎』！
Ｒ一

根据三次样条插值的理论，可以计算出一分段 插值函数Ｒ（ｆ），使它在时间区间■，Ｆ，ｒ。Ｆ３上 是三次多项式：
Ｒ，０）一Ａ，ｆ。＋ｂｉｔ２十ｑｆ＋Ｄ， 并且满足如下条件： １）在采样点上，函数值与已知Ｒ—Ｒ间期值相 等，即
Ｒ（ｒＪＦ）＝ｒ，．Ｊ一１，２，…，Ｈ ２）在内样点（除ｒ。、＾外）上有直到二阶的连 续导数，即
Ｒ，ｌ（１，）一ＲＪ（ｔＪ） 刷Ｊ一１（￡Ｊ）一Ｒ’Ｊ（￡Ｊ）
Ｒ＿一。（｝，）＝Ｒ０（￡，）
Ｊ一２·３，…，＂一１
３）在外样点上，导数都置为零，即
Ｒ’（ｒ。Ｆ）一ＪＲ’（ｒ。Ｆ）一０
根据已经成熟的三次样条插值理论，可以算出 一符台上述条件的函数尺（￡），然后可根据不同的需 要进行不同采样频率的重采样。例如当仅需计算高、 低频之间功率谱的比值时，可取原Ｒ—Ｒ间期的平均 值作为重采样频率，而当需计算两Ｒ—Ｒ间期序列的 互谱时，则可取两平均值的中间值。
２模型构造及实验对比
目前使用最多的Ｒ—Ｒ间期序列构造模型是由 １４ｙｄａｍａｎ提出的积分式脉冲频率调制模型

（ｉｎｔｅｇｒａｌ ｐｕｌｓｅ ｆｒｅｑｕｅｎｃｙ ｍｏｄｕｌａｔｉｏｎ，ＦＰＦＭ）【８ｆ９］。 该模型由一个积分器和一个比较器构成．当有信号 输入模型时，积分器对该信号进行积分运算，并将 结果与阈值进行比较，当结果超过阈值时，比较器 输出一个脉冲（相当于实际心电中的Ｒ波）．同时将 积分器清零。该模型可用数学式子表示为：
ｒ’
Ｔ—ｒ１［１ ４－ｍ（幻］出
Ｊ‘｛
输入信号Ｓ（ｆ）＝ｌ＋ｍ（ｆ），Ｔ为阈值，“即为 输出值。该模型已得到了广泛的应用，但也存在某 些缺点。例如该模型并没有给出一事先认为是标准 的Ｒ—Ｒ间期信号，因此不利于对不同的谱分析方法 进行比较。所以我们提出了另一个较为直观且可以 给出一标准Ｒ—Ｒ间期信号的模型，并在此模型基础 上对各种谱分析方法进行分析探讨。
首先，我们假设对任意一个Ｒ Ｒ间期序列，都 对应存在一个连续的Ｒ Ｒ问期信号
尺（ｆ）＝Ｒｍ ４－Ｒ。（￡）
Ｒ一尺。。分别是该信号的直流部分和交流部分，Ｒ—Ｒ 间期序列就是对该信号进行非均匀采样所得到的一 组序列。通过对普通Ｒ—Ｒ间期序列的分析可知，Ｒ— Ｒ间期序列的采样间隔是有规律的，每次采样闻期 正是上次采样值的大小，即
ｔ。＋１＝Ｒ（｝。）
这样，只要有了Ｒ—Ｒ问期连续信号，就可以递 推地得到Ｒ—Ｒ间期序列。利用这个模型的好处是只 要对Ｒ—Ｒ间期连续信号进行均匀采样，就可以提供 一个标准信号，从而对各种算法进行对比。
我们分别取Ｒ—Ｒ信号为 Ｒ１＝０．６＋ｓｉｎ（２×声；×ｎ／２．９９６）×Ｏ．１＋
ＣＯＳ（２×由ｉ×ｎ／７．９２＋２）×０．１
Ｒ２—０．６＋ｓｉｎ（２×户ｉ×ｎ／２．９９６）×０．０５＋
ＣＯＳ（２×声ｉ×ｎ／３．１２－４－２）×０－０５＋ＣＯＳ （２ ｘ ｐｉ×ｎ／７．９２＋２）×０．０５ 信号由三部分组成：直流分量（即平均Ｒ—Ｒ间 期）、低频分量和高频分量（主要对应呼吸频段““）。 对以上两信号，首先如以上所述，可得到一模拟Ｒ— Ｒ问期序列。由该序列，可求得平均采样率。以该采 样频率对原始Ｒ—Ｒ问期信号进行采样，可得到一标 准等均匀采样Ｒ Ｒ问期序列。最后根据我们所提出 的算法．由模拟Ｒ—Ｒ间期序列，仍以该频率作为重 采样频率，可得到一重采样Ｒ—Ｒ间期序列。分别计

　万方数据

第ｌ期

心率变异信号的非均匀采样问题研究

·４９·

算三个序列的功率谱密度，并计算高频、低频之间 功率谱的比值，结果如图１、表２所示。
表２各种仿真条件下Ｒ１、Ｒ２高频 （０．１５ ０．４）、低频（Ｏ．０４ ０．１．５）功率谁之比

从表２和图ｌ可以看出，直接计算Ｒ—Ｒ间期的 功率谱会带来一定的偏差．而且还会有很明显的二 次伪谐波峰。当然，这种差别并不是很大，在大多 数情况下对研究结果影响较小。本算法在大多数情 况下可以减少这种偏差，并且消除二次伪谐波峰，同 时使功率谱的波的形态与原始信号更接近。但是，在

０４
ｏ
¨
一连一 雌 ｏ
¨
一¨九．． ∞ ｏ 一¨盛．．Ｏ

图１各时问序列的功率谱密度，自上至下依次为

（１）Ｒ Ｒ间期序列

（２）标准间期序列 （３）重采样序列

图ｚ不同直流分量情况下Ｒ·、Ｒ２信号高额、低频功率谱之比 （１ｊ Ｒ—Ｋ问期序列 （２）标准问期序列 （３）重采样序列

某些情况下，本算法的偏差也可能会大一些，这种 情况并不多，而且总的偏差也不显著。为了进一步

研究这种偏差的性质，又在不同的条件下对算法的 结果进行分析，即固定信号的交流分量，在不同的

　万方数据

。５ｕ‘

北京生物医学７－稃

第２０卷

直流分量情况Ｆ重复上述步骤。图２显示了在不同 直流分量情况下Ｒ】、Ｒ２信号三个采样序列高频 （０．１５一ｏ．４）、低频（ｏ．０４—０．１５）功率谱之比。从 图２可以看出，由信号的非均匀采样所引起的偏差 和信号的直流分量有较大关系。当信号的直流分量 较小时（即心跳较快时），这种偏差较明显，而本算 法则可以较好地减小这种误差。随着直流分量的增 大·这种偏差会慢慢变小，而本算法所导致的偏差 反而变大。这主要是由于当直流分量变大时，Ｒ Ｒ 间期变大，相邻两点的采样间隔也变大，信号的采 样率降低。导致本算法已经不能很好地还原出原始 信号。分析结果表明，当心跳较快时（Ｒ，Ｒ间期＜ ０．７５ ｓ．心率＞８０次／分），直接计算Ｒ Ｒ问期的功 率谱所带来的偏差较大·本算法效果较好；当心跳 平稳时（Ｒ Ｒ间期在０．７５ｓ和Ｉｓ之间，心率介于６０ 次／分和８０次／分之间），本算法的效果不明显，但 是能使采样均匀化；当心动过缓时（Ｒ—Ｒ问期＞ｉｓ， 心率＜６０ ０ｚ／分）．本算法完全不适用。在大多数情 况下，Ｒ－Ｒ问期不会大于ｌｓ，因此本算法还是有较 大的应用价值。
３结论
以上实验表明，本文所提出的算法确实可以改 善原先谱估汁的结果，改善功率谱波形的形态，消
除二次伪谐　万波方峰数，并 据在大多数情况下减少偏差。更

重要的是，本算法使得采样均匀化后，使得序列的 物理意义更明确．从而使不同信号问的比较和运算 成为可能。

参考文献

１

盯悖ｍ㈨‘ｏｏｄ岬锚叫Ⅷｏ Ｍａｒｃｏ Ｄｉ Ｒｉｅｍｏ—ｅｔ ａ１．２４ｈ ｓｅｑｕｅｎｔｉａｌ ｓｐｅｃｔｒａｌ ａｎａｌｙｓｉｓ ｏｌ Ｐ ｕｌ肿ｉｎｔｅｒｖａｌ １ｎ“旰ｍｏ”“ｇ

２主＝ｌＲｓ．。Ｉ。ＥＥＥ“ＴｒＡａｎ。ｓ。ＢⅢｉｏ。ｍ。ｅ。ｄ。。Ｅｌｎ。ｇ。，１ｈ９。８９ｈ．３６。（。１。１。）ｒａｌ：１…０６６１％，。１…０７ ５ｆ

ＩＥ雎ＴⅢ。Ｂ。㈣ｄ ｈｅａｒｔ ｆａｔ。。ａｎａｂ。ｌｌＩｙ

Ｅ。＊，１ ９８６，３３

（９）：９００～９“

３妨雪军．李炜，李铀，等．心率变异性作为植物神经功能检查

方法的探讨·北京生物医学工程·１ ９９６－１５（２）：６５

４鼍军’，梦孙ｒ苏琳＇等睡眠中的心率变异性＿北京牛物医

５艟家普，等心率变异和ＲＴ变异频域分析的方｝盂学研充斗物
医学工程学杂志．１９９８，ｌ ５（３）：２５６ ６郑达安，等．心理应澈时青年人Ｒ Ｒ问期变异性的蹭分析生
暂医学１程学托盖，１９ ９７．１４‘Ｉ）ｊ ３８
７杨慧芝等·评价。率变异性的～种新方法中国生物医学上

８张荣．“等．心率变旯性信号的话正１ＰＥＭ模型生物医学工程
９嚣譬’嚣、篇篇翳鞭脯圳触建 学杂志，１９９３．】ｏ（３）：３２５
１０ Ｈｏｙｅｒ，时ａ１．Ｎ。ｍ㈣¨眦１７”ｓ０¨…¨叶㈨州ｒｅｓｐｉｒａｔｏｒｙ
！：…”５’“““８“““。””。““。“””““～
（１ ９９９＿０８ １２收穑，ｌ ９９９”１ ３嫠同）

（上接第３ｌ页
３结论
我们根据分形理论完全自动地仿真出了心脏心 室模型中的Ｐｕｒｋｉｎｊｅ纤维传导系统，为进一步开展 心脏正问题研究打下了基础。本算法是在较低分辨 率的心室模型（４０×４０×４０心肌单元）上实现的，因 此采用的是较为简单的ＤＯｔ。系统，进一步的工作 是在并行机上实现心室模型的仿真，以提高模型的 分辨率和仿真速度。此算法不需要作任何修改便能 应用在新的模型中，完成Ｐｕｒｋｉｎ］ｅ纤维的自动生 成。当然，也可在新的模型中采用更为复杂的分形 算法。如ＰＬ系统，并在分枝上加入随机因子，从而

更好的拟合Ｐｕｒｋｉｎｊｅ纤维在心室壁上的分布。

参考文献

１ Ｄｕｒｒｅｒ Ｄ

Ｆｏｔａｌ ｅｘｃｉｔａｔｉｏｎ ｏｆ ｔｈｅ ｉｓｏｌａｔｅｄ ｈｕｍａ．ｈｅａｒｔ．

Ｃｉｒｃｕｌａｆｉｏｎ，１９７０．４１：８９９—９１１

２（：－ｏｌｄｂｅｒｇｅｒ ＡＩ。 Ｆｒａｃｔａｌ ｍｅｃｈａｎｉｓｍｓ ｉｎ ｔｈｅ ｅ】ｅｆｔｒｏｐｈｙｓｌｏｌ。ｇｙ ｏｆ ｔｈｅ ｈｅａｒｔ．ＩＥＥＥ Ｅｎｇｉｎｅｅｒｉｎｇ ｉｎ Ｍｅｄｉｃｉｎｅ ａｎｔｉ Ｂｉｏｌｏｇｙ，１９９２· ｔ３）：４７—５２
３彭虎等．心脏传导系统的分形描连．中国科学技术大学学报， １９９９。２０ ｆ３）：３４５—３４９
３齐东旭分形厦其计算机生成．北京：科学出版社，１９９４ｔ ３０

３１ （２０００—０１ １ ７收稿）

