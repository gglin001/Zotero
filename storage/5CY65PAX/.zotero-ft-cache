34th Annual International Conference of the IEEE EMBS San Diego, California USA, 28 August - 1 September, 2012
Atrial Fibrillation Detection using a Smart Phone
Jinseok Lee, Bersain A. Reyes, David D. McManus, Oscar Mathias, and Ki H. Chon


Abstract— We hypothesized that an iPhone 4s can be used
to detect atrial fibrillation (AF) based on its ability to record a pulsatile photoplethysmogram (PPG) signal from a fingertip using the built-in camera lens. To investigate the capability of the iPhone 4s for AF detection, 25 prospective subjects with AF pre- and post-electrical cardioversion were recruited. Using an iPhone 4s, we collected 2-minute pulsatile time series. We investigated 3 statistical methods consisting of the Root Mean Square of Successive Differences (RMSSD), the Shannon entropy (ShE) and the Sample entropy (SampE), which have been shown to be useful tools for AF assessment. The beat-tobeat accuracy for RMSSD, ShE and SampE was found to be 0.9844, 0.8494 and 0.9552, respectively. It should be recognized that for clinical applications, the most relevant objective is to detect the presence of AF or normal sinus rhythm (NSR) in the data. Using this criterion, we achieved an accuracy of 100% for both detecting the presence of either AF or NSR.
I. INTRODUCTION
ATRIAL fibrillation is the most common sustained arrhythmia. Over 3 million Americans are currently diagnosed, and the prevalence of AF is increasing with the aging of the U.S. population [1]. Through its association with increased risk for heart failure, stroke and mortality, AF has a profound impact on the longevity and quality of life of a growing number of people [2-3]. Although new AF treatment strategies have emerged over the last decade, a major challenge facing clinicians and researchers is the paroxysmal, often short-lived, and sometimes asymptomatic nature of AF. Our current inability to diagnose AF in minimally symptomatic patients with paroxysmal AF has important clinical implications, since even brief episodes of asymptomatic AF are associated with increased risk for stroke, heart failure, hospitalization, and death. Moreover, the treatment of patients with disabling symptoms from AF, including shortness of breath, syncope, and exertion intolerance, is often impeded by delays in diagnosis. Although the population burden of known AF is substantial, [4] studies have shown that more frequent monitoring can improve AF detection [5]. There is therefore a pressing need to develop methods for accurate AF detection and monitoring in order to improve patient care and reduce healthcare costs associated with treating complications from AF. Such a method would have important clinical and research applications for AF screening as well as in assessing treatment response (e.g. after cardioversion or AF ablation) and need for anticoagulation. For these reasons, the

importance of developing new AF detection technologies was emphasized by a recent National Institute of Health Heart Lung & Blood Institute Expert panel [6].
In our work, we developed a smartphone application to measure pulsatile time series and then use this data to detect AF real-time. We have recently successfully demonstrated that using a smart phone’s camera to image a finger tip pressed to it will yield pulsatile signals that are similar to heart rate fluctuations [7]. In addition, the use of pulsatile signals from smartphones has recently attracted the attention of many researchers [7-10]. Note that the approach does not require the need for additional hardware as the optical video monitoring of the skin with a standard digital camera contains sufficient information related to variability in the heart rate signal, and it consequently provides accurate heart rate time series. The only requirement is that the camera’s illumination and optical sensor be within finger tip range of each other.
In this paper, we introduce the feasibility of AF detection on an iPhone 4s. Specifically, we developed a comprehensive iPhone application for collection of pulsatile time series followed by real-time detection of AF using the following three statistical methods: RMSSD, ShE and SampE. We evaluated the AF detection performance with an iPhone 4s on 25 AF subjects undergoing electrical cardioversion.
II. METHODS
A. AF Databases and Clinical Data Collection
For the iPhone 4s data collection, 25 patients with AF who presented for electrical cardioversion to the University of Massachusetts Medical Center (UMMC) cardiac electrophysiology laboratory were recruited by trained study personnel (McManus, Mathias). 20 men and 5 women with an average age of 57.95 ± 13.64 years were recruited. Data collection was performed before and after electrical cardioversion. Our protocol for data collection was approved by the Institutional Review Boards of University of Massachusetts Medical Center (UMMC) and Worcester Polytechnic Institute (WPI). The camera of an iPhone 4s was placed on either the index or middle finger of study participants for 2 minutes prior to, and immediately after, cardioversion. Data were recorded with patients in the supine position with spontaneous breathing.
Fig. 1 shows an iPhone 4s prototype for AF detection. A signal is recorded by placing a finger over a camera and an illumination by a flashlight which is shown on the left panel. The right panel shows a captured image of our prototype for AF detection including heart rate and the pulsatile signal.

J. Lee, B.A. Reyes and K.H. Chon. Authors are with WPI, Worcester, MA 01609 USA (phone: 508-831-4114; e-mail: kichon@wpi.edu).
D.D. McManus and O. Mathias. Authors are with University of Massachusetts Medical Center, Worcester, MA 01609 USA.

978-1-4577-1787-1/12/$26.00 ©2012 IEEE

1177

a random white noise signal is expected to have the highest ShE value due to maximum uncertainty in predicting the patterns of the signal.

Fig. 1 A prototype for AF detection using iPhone 4s

B. Preprocessing

For the pulsatile signal acquisition, the iPhone 4s videos were recorded, and the signal was obtained by averaging 50x50 pixels of the green band for every frame [7][10]. The sampling rate for iPhone 4s was 30 frames/sec. Fig. 2(a) shows a representative pulsatile signal derived from an iPhone 4s. Note the similarity of an iPhone pulsatile signal to a sample PPG signal, which is shown in Fig. 2(b).

(a)

(b)

76

75

Intensity

74

73

72

71

70

61.0 61.2 61.4 61.6 61.8 62.0 62.2 Time (s)

30

32

34

35

36

Time (s)

Fig. 2 Pulsatile signals from (a) iPhone 4s and (b) a pulse oximeter

However, in rare cases, the sampling rate was slightly lower (e.g. ~25 Hz due to internal processing load). Due to the frame rate variability, we interpolated the pulsatile signal to 30 Hz using a cubic spline algorithm followed by peak detection. The peak detection algorithm incorporated a filter bank with variable cutoff frequencies, spectral estimates of the heart rate, rank-order nonlinear filters and decision logic [11].
C. Statistical Approach for AF Detection
1) RMSSD The RMSSD is used to quantify beat-to-beat variability. Since AF exhibits higher variability than NSR, the RMSSD is expected to be higher than those of NSR RR time series. As subjects have different mean heart rates, we normalize by dividing the RMSSD by the mean value of the RR time series.

3) Sample Entropy

The third component of the AF detection algorithm is the Sample entropy (SampE). The SampE is the negative natural logarithm of an estimate of the conditional probability that a subseries that match pointwise within a tolerance r also match at the next point, where self-matches are not included in calculating the probability. A high value of SampE indicates low similarity in the time series while a low value of Sample entropy indicates high similarity. Thus, the SampE is a useful tool to assess randomness of RR time series.

D. Performance Evaluation

The condition for AF detection is based on each threshold

value of

,

and

as

 If RMSSD/mean

then it is AF (RMSSD)

 If ShE

then it is AF (ShE)

 If SampE

then it is AF (SampE)

For each parameter set, we found the number of True

Positives (TP), True Negatives (TN), False Positives (FP)

and False Negative (FN) from the MIT-BIH AF and NSR databases. Subsequently, we calculated the sensitivity TP/(TP+FN), specificity TN/(TN+FP) and accuracy (TP+TN)/(TP+TN+FP+FN). For each statistical method, we found the threshold values providing the best (largest) area under the ROC curve. In addition, statistical testing using an ANOVA on ranks was done to see if there were significant differences among each dataset.

III. RESULTS

For subjects in AF, we found that the beat-by-beat accuracy for each algorithm was 0.9844, 0.8494 and 0.9552, for RMSSD, ShE and SampE, respectively. TABLE I summarizes overall sensitivity, specificity, and accuracy for each algorithm by database. For clinical applications, the relevant objective is to detect the presence of AF episodes from a given dataset. With this criterion, the AF and NSR detection accuracy was 100% for all 3 methods.
Fig. 3 shows statistical value distribution of a) RMSSD/mean, b) ShE and c) SampE for AF subjects preand post-cardioversion using an iPhone 4s. We found statistically significant differences (p<0.01) between iPhone AF vs. iPhone NSR.

2) Shannon Entropy The second component of the AF detection algorithm is Shannon entropy (ShE). The ShE provides a quantitative measure of uncertainty for a random variable. For example,

1178

TABLE I BEAT-BY-BEAT ANALYSIS OF SENSITIVITY, SPECIFICITY AND ACCURACY BASED ON EACH STATISTICAL METHOD ON 25 AF SUBJECTS PREAND POST- ELECTRICAL CARDIOVERSION

Rmssd/ mean

Shannon entropy

Sample entropy

AF subjects ( iphone4s)

Sensitivity Specificity Accuracy Sensitivity Specificity Accuracy Sensitivity Specificity Accuracy

0. 9763

0. 9961

0. 9844

0. 7461

1. 0000

0. 8494

0. 9258

0. 9980

0. 9552

0.4 (a)
0.3
0.2
0.1

RMSSD/Mean

1 (b)
0.8
0.6
0.4
0.2

Shannon Entropy

3 (c)
2
1

Sample Entropy

0 Pre-
cardioversion

Postcardioversion

0 Pre-
cardioversion

Postcardioversion

0 Pre-
cardioversion

Postcardioversion

Fig. 3. statistical value distribution of a) RMSSD/mean, b) ShE and c) SampE for AF subjects pre- and post-cardioversion using an iPhone 4s.

IV. CONCLUSION
In this paper, we show that AF can be accurately detected from pulsatile signals in the human fingertip using the camera of an iPhone 4s. The computation time including the processing stage was approximately 25 ms for each 64-beat segment on the iPhone 4s. Currently, clinical AF monitoring is cumbersome and/or expensive. Given the high prevalence of diagnosed paroxysmal and asymptomatic AF, as well as the increasing number of individuals at-risk for this potentially life-threatening arrhythmia, better and more readily available AF detection technology is needed. Given the ever-growing popularity of cell phones and smartphones, a smartphone-based AF detection application provides patients and their caregivers with access to an inexpensive and easy-to-use monitor for AF outside of the traditional health care establishment. Because the application does not involve a separate ECG sensor and instead employs built-in hardware, it is both novel and cost-effective. We believe this package will lead to better acceptance and more widespread use than existing out-of-hospital arrhythmia monitors. Further data are needed to explore the acceptability and feasibility of smartphone-based AF detection applications in older, at-risk populations.
REFERENCES
[1] A. S. Go, E. M. Hylek, K. A. Phillips et al., “Prevalence of diagnosed atrial fibrillation in adults:

national implications for rhythm management and stroke prevention: the AnTicoagulation and Risk Factors in Atrial Fibrillation (ATRIA) Study,” JAMA, vol. 285, no. 18, pp. 2370-5, May 9, 2001. [2] I. Hajjar, and T. A. Kotchen, “Trends in prevalence, awareness, treatment, and control of hypertension in the United States, 1988-2000,” JAMA, vol. 290, no. 2, pp. 199206, Jul 9, 2003. [3] T. S. Tsang, G. W. Petty, M. E. Barnes et al., “The prevalence of atrial fibrillation in incident stroke cases and matched population controls in Rochester, Minnesota: changes over three decades,” J Am Coll Cardiol, vol. 42, no. 1, pp. 93-100, Jul 2, 2003. [4] K. H. Humphries, C. R. Kerr, S. J. Connolly et al., “New-onset atrial fibrillation: sex differences in presentation, treatment, and outcome,” Circulation, vol. 103, no. 19, pp. 2365-70, May 15, 2001. [5] E. J. Benjamin, P. A. Wolf, R. B. D'Agostino et al., “Impact of atrial fibrillation on the risk of death: the Framingham Heart Study,” Circulation, vol. 98, no. 10, pp. 946-52, Sep 8, 1998. [6] E. J. Benjamin, P. S. Chen, D. E. Bild et al., “Prevention of atrial fibrillation: report from a national heart, lung, and blood institute workshop,” Circulation, vol. 119, no. 4, pp. 606-18, Feb 3, 2009. [7] C. G. Scully, J. Lee, J. Meyer et al., “Physiological parameter monitoring from optical recordings with a mobile phone,” IEEE Trans Biomed Eng, vol. 59, no. 2, pp. 303-6, Feb, 2012. [8] E. Jonathan, and M. Leahy, “Investigating a

1179

smartphone imaging unit for photoplethysmography,” Physiol Meas, vol. 31, no. 11, pp. N79-83, Nov, 2010. [9] M. J. Gregoski, M. Mueller, A. Vertegel et al., “Development and validation of a smartphone heart rate acquisition application for health promotion and wellness telehealth applications,” Int J Telemed Appl, vol. 2012, pp. 696324, 2012. [10] D. Grimaldi, Y. Kurylyak, F. Lamonaca et al., “Photoplethysmography Detection by Smartphone’s Videocamera,” in The 6th IEEE International Conference on Intelligent Data Acquisition and Advanced Computing Systems: Technology and Applications, Prague, Czech Republic, 2011. [11] M. Aboy, J. McNames, T. Thong et al., “An automatic beat detection algorithm for pressure signals,” IEEE Trans Biomed Eng, vol. 52, no. 10, pp. 1662-70, Oct, 2005.
1180

