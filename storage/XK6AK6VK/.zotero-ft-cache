biosensors
Article
Photoplethysmography and Deep Learning: Enhancing Hypertension Risk Stratiﬁcation
Yongbo Liang 1, Zhencheng Chen 1, Rabab Ward 2 and Mohamed Elgendi 2,3,4,* 1 School of Electrical Engineering, Guilin University of Electronic Technology, Guilin 541004, China; liangyongbo001@gmail.com (Y.L.); chenzhcheng@163.com (Z.C.) 2 School of Electrical and Computer Engineering, University of British Columbia, BC V6T 1Z4, Canada; rababw@ece.ubc.ca 3 Faculty of Medicine, University of British Columbia, BC V1Y 1T3, Canada 4 BC Children’s and Women’s Hospital, Vancouver, BC V6H 3N1, Canada * Correspondence: melgendi@bcchr.ubc.ca; Tel.: 604-600-4139
Received: 28 August 2018; Accepted: 14 October 2018; Published: 26 October 2018
Abstract: Blood pressure is a basic physiological parameter in the cardiovascular circulatory system. Long-term abnormal blood pressure will lead to various cardiovascular diseases, making the early detection and assessment of hypertension profoundly signiﬁcant for the prevention and treatment of cardiovascular diseases. In this paper, we investigate whether or not deep learning can provide better results for hypertension risk stratiﬁcation when compared to the classical signal processing and feature extraction methods. We tested a deep learning method for the classiﬁcation and evaluation of hypertension using photoplethysmography (PPG) signals based on the continuous wavelet transform (using Morse) and pretrained convolutional neural network (using GoogLeNet). We collected 121 data recordings from the Multiparameter Intelligent Monitoring in Intensive Care (MIMIC) Database, each containing arterial blood pressure (ABP) and photoplethysmography (PPG) signals. The ABP signals were utilized to extract blood pressure category labels, and the PPG signals were used to train and test the model. According to the seventh report of the Joint National Committee, blood pressure levels are categorized as normotension (NT), prehypertension (PHT), and hypertension (HT). For the early diagnosis and assessment of HT, the timely detection of PHT and the accurate diagnosis of HT are signiﬁcant. Therefore, three HT classiﬁcation trials were set: NT vs. PHT, NT vs. HT, and (NT + PHT) vs. HT. The F-scores of these three classiﬁcation trials were 80.52%, 92.55%, and 82.95%, respectively. The tested deep method achieved higher accuracy for hypertension risk stratiﬁcation when compared to the classical signal processing and feature extraction method. Additionally, the method achieved comparable results to another approach that requires electrocardiogram and PPG signals.
Keywords: pulse morphology; pulse oximeter; blood pressure monitoring; pulse arrival time; global health; digital medicine; wearable devices; hypertension assessment; hypertension evaluation

1. Introduction
Cardiovascular diseases (CVDs) have become a major contributor to human mortality [1]. According to the latest statistics produced by the World Health Organization (WHO), the mortality rate from CVDs will rise from 246 people per one million in 2015 to 264 people per one million in 2030 [2,3]. It is known that abnormal blood pressure can produce many complications for the heart, kidneys, and other vital organs, causing irreversible injury. Therefore, early diagnosis, treatment, and control of hypertension could play an important role in the prevention and treatment of CVDs. However, due to the complexity of the formation of hypertension, there is still no effective means to completely cure it; only constant blood pressure measurement and hypertension assessment, which enable adjustments

Biosensors 2018, 8, 101; doi:10.3390/bios8040101

www.mdpi.com/journal/biosensors

Biosensors 2018, 8, 101

2 of 13

to the drug situation, allow the stabilization of blood pressure at healthy levels [4,5]. A more invasive blood pressure measurement method, which is the gold standard, involves inserting a catheter into an artery to conduct real-time monitoring. This approach is only suitable for critical patients and also carries the risk of infection. The most common technique used for blood pressure measurement is Korotkoff’s sound and oscillographic method [6]. Both of these techniques require the use of an upper arm cuff and utilize the cuff pressure and release process to detect systolic and diastolic pressure. These two intelligent methods are the most widely used and are continuously being optimized. Their simple operation and reliable results have been accepted by medical staff and patients. Although this technology is widely accepted, the requirement of a cuff creates obstacles for its wider spread and application.
In recent years, new methods of blood pressure detection and evaluation have been proposed; the methods based on arterial wave propagation theory [7–10] and photoplethysmogram (PPG) morphology theory [11–13] have been studied most. The former method assesses blood pressure levels by measuring pulse transit time (PTT) [14]. This method usually requires two physiological signals, such as electrocardiogram (ECG) and PPG signals [15]. This approach has been explored by a number of past studies, verifying the feasibility of the solution. The acquisition of two signals increases the stability of the method; however, it increases the operational complexity, especially the acquisition of the ECG. It does not require the sleeve, but there are still more problems to be solved. The latter method assesses blood pressure levels by establishing a PPG morphological feature model [16]. This method requires a PPG signal of higher quality, such as high sampling rates and sampling precision, and is very sensitive to many kinds of noises; this also limits its wide application.
At present, health care has entered a new era. Deep learning has become a powerful computational method that has been used to solve many types of identiﬁcation and classiﬁcation problems. Deep learning is used to automatically learn the optimal features of raw signals. The typical framework of deep learning includes deep belief networks (DBN), stacked autoencoders (SAE), convolutional neural networks (CNN), etc. [17]. Deep learning technology has rapidly developed in recent years and has been applied, for example, to image recognition [18], speech recognition, and object identiﬁcation [19]. In the ﬁeld of biomedical engineering, a large amount of medical data is also being recognized and mined. Some researchers have used this powerful method for practical medical applications, such as breast cancer detection, heartbeat classiﬁcation using ECG signals, brain tumor image recognition, etc. [20–22]. With the huge amount of medical data, deep learning also has the potential to play a more important role in mining health information from wearables, monitoring medical information, and diagnosing disease, among other ﬁelds.
It is known that human tissues and organs undergo certain effects and experience changes during different stages of hypertension. This is especially true for the cardiovascular circulatory system. PPG signals contain abundant physiological information on cardiovascular circulatory processing. A series of blood-pressure-level assessments based on ECG and PPG signals were recently performed by the authors. This recent work [23] showed that the replacement of arterial blood pressure (ABP) with PPG signals is very promising. Another recent paper [24] by our group, using the same dataset as in this publication, compared the pulse arrival time (PAT, based on ECG and PPG signals) and PPG morphological theory (based only on PPG). The PAT feature and many PPG morphological features were extracted and used to classify blood pressure (BP) categories individually and in combination. The limitations of using feature extraction are (1) the feature points of each heartbeat needed to be extracted correctly [25–27], (2) the ECG and PPG signals have to be of high quality, and (3) optimal ﬁltering is required [28–31].

Biosensors 2018, 8, 101

3 of 13

To eliminate the classical feature extraction phase, we introduced a transfer learning method based on the pretrained convolutional neural network (CNN). Common pretrained CNN methods include AlexNet, VGGNet, and GoogLeNet, which are trained based on the ImageNet Large Scale Visual Recognition Challenge (ILSVRC) dataset [2]. In this paper, we propose a method of classifying hypertension using continuous wavelet transformation and GoogLeNet [32], which only needs the PPG signal to realize the identiﬁcation and classiﬁcation of hypertension. It has many advantages, such as having a low demand for the original signal, being rapid, and having a wide range of applications.
2. Materials and Methods
2.1. Data Acquisition
In this study, the ABP (measured using a catheter in the radial artery) and photoplethysmograph (PPG) signals were used to carry out the assessment and classiﬁcation of hypertension. They were collected from the Multiparameter Intelligent Monitoring in Intensive Care Database (MIMIC [33,34]), which is a free-to-use database that contains multiple and complex-parameter recordings of tens of thousands of intensive care unit (ICU) patients. The ABP signals were used to extract the blood pressure level labels, which are deﬁned as normotension (NT), prehypertension (PHT), and hypertension (HT) in the seventh report of the Joint National Committee on Prevention, Detection, Evaluation, and Treatment of High Blood Pressure (JNC7 [35]) by the US National Institutes of Health. Therefore, the records with missing peaks, pulsus bisferiens, no signal (sensor-off), and so on were excluded from this study to extract the blood pressure labels accurately. Ultimately, 121 subjects’ recordings were collected, each with stable, complete ABP and PPG signals and with 120 s lengths and 125 Hz sampling rates.
2.2. Signal Pre-Processing
Each recording consisted of two signals. These were ABP and PPG signals, which were used as the target source and predicted source, respectively. The ABP signals were not processed and were only used to extract systolic blood pressure (SBP) and diastolic blood pressure (DBP) and then to determine the blood pressure level labels as described in the JNC7. The PPG signals were processed with a 0.5–10 Hz Chebyshev II bandpass ﬁlter to remove the noise [36]. Following this, amplitude normalization was performed on the ﬁltered PPG signals. In addition, the ABP and processed PPG signals were cut into 5 s signal segments. Figure 1 shows the structure of the signal processing.

Biosensors 2018, 8, 101

4 of 13

Figure 1. A signal processing structure. Note: PPG stands for photoplethysmogram, ECG stands for electrocardiogram, BP stands for blood pressure, and JNC7 stands for the Seventh Report of the Joint National Committee.
2.3. PPG Signal Transformation Using Continuous Wavelet Transform (CWT)
Since the pretrained CNN network accepts Red-Green-Blue (RGB) images as input, the raw PPG signals of this paper were one-dimensional vector signals. Therefore, the raw PPG signals were ﬁrst converted to produce a feature representation. Following this, we adopted the continuous wavelet transform (CWT) to convert the PPG signals to RGB images. CWT has been considered an effective method for analyzing frequency information along with time. Each PPG signal segment was converted to a time-frequency representation, called a scalogram, by continuous wavelet transform.
A scalogram, which is plotted as a graph of time and frequency, is the absolute value of the continuous wavelet transform coefﬁcients of a signal. Compared with a spectrogram, a scalogram can better identify the low-frequency or fast-changing frequency component of the signal. PPG signals are a fusion of heart activity, vascular relaxation processes, and microcirculation system status; therefore, its time–frequency domain information is rich and diverse. The PPG signal is transformed into a scalogram using the wavelet coefﬁcients of continuous wavelet transform, which can be used to locate different frequency components. This recognizable scale RGB image is very beneﬁcial for extracting and learning about the features of convolutional neural networks, especially pretrained CNN. In this study, we obtained the absolute value of the wavelet coefﬁcients for each signal segment using analytic morse (3,60) wavelet, setting the VoicesperOctave to 12 through the cwtﬁlterbank of the Wavelet toolbox, and then converting them to RGB images. Finally, the RGB images were adjusted to the size of 224 × 224 × 3, which is a requirement of GoogLeNet. Following this, the image-like data were fed into the pretrained CNN to produce their corresponding CNN features. Figure 2 illustrates the scalograms of the three different blood pressure categories.

Biosensors 2018, 8, 101

5 of 13

Figure 2. The scalogram cases of the three different blood pressure categories. Note: PPG stands for photoplethysmogram.
2.4. Pretrained Convolutional Neural Network (GoogLeNet)
GoogLeNet is a pretrained convolutional neural network structure proposed by Szegedy in 2015 [37]. It uses the inception structure to build a deep learning neural network. This structure makes good use of the computational resources in the network without increasing the computational load or increasing the width and depth of the network. Due to GoogLeNet’s ability to generalize extracted depth characteristics, it can be applied to a variety of computer vision identiﬁcation and classiﬁcation problems. GoogLeNet has 22 layers and is trained on 1.2 million high-resolution RGB images from the ImageNet dataset. It can classify these images into 1000 different categories with state-of-the-art performance. The categories mainly include conventional things, such as cats, dogs, fruits, cars, etc. GoogLeNet is also regarded as a trained deep learning network that can be converted to new image classiﬁcation applications using a smaller number of training images, such as medical image diagnosis, signal spectrum recognition, etc. In previous studies, some researchers have also shown that the classiﬁcation of biosignals into categories can be achieved using GoogLeNet [38,39].
Transfer learning is one structural model of deep learning [40]. In brief, one basic convolutional neural network can be trained based on a large database. Some successful pretrained CNNs include LeNet, AlexNet, VGG, and GoogLeNet. These pretrained CNNs can be directly used to recognize more than 1000 objects. As the generalization ability of the extracted depth characteristics by transfer learning is very strong, it can be applied to other, different computer vision identiﬁcation and classiﬁcation problems (e.g., MRI medical images and physiological signals). The retraining does not change the structure; rather, it ﬁne-tunes the parameters. With regard to RGB images, different images have varying features, such as edges, texture, etc. Thus, transfer learning can have wider applications if it can be transformed to RGB images.
For this paper, the signal classiﬁcation study was transferred to image identiﬁcation and classiﬁcation by continuous wavelet transformation. GoogLeNet, which is ﬁne-tuned and trained based on the dataset in this study, solved the problem of signal classiﬁcation effectively. Compared with AlexNet and VGG networks, which adopt convolutional layers and full-connection layers [32], GoogLeNet has deeper depth but a smaller model size [37]. It adopts sub-network and inception for

Biosensors 2018, 8, 101

6 of 13

the ﬁrst time and shows superior performance. Deeper network depth and smaller model size have become the main reasons for selecting a pretrained CNN network.
GoogLeNet adopts the 224 × 224 × 3 sized RGB image as the input. However, the signals of this study were discrete sampling signals with sampling rates of 125 Hz and 5 s in length. Therefore, all training and testing signals were ﬁrst processed by continuous wavelet transform and then converted to 224 × 224 × 3 sized RGB images. Each image represented an independent signal segment. In this study, the training of GoogLeNet used the Batch and Epoch settings; the minimum Batch size was 15, while the maximum Epoch was 20. In addition, Fully Connected was set as “loss3-classiﬁer”, and Softmax was set as “prob.”
2.5. Hypertension Classiﬁcation
As we know, according to the hypertension categories of the JNC7 report, blood pressure levels for adults are divided into normotension (NT), prehypertension (PHT), and hypertension (HT). In order to classify hypertension based on a PPG signal, three classiﬁcation experiments were conducted: NT versus PHT, NT versus HT, and non-HT (NT + PHT) versus HT. This study used 80% of the dataset for training, and the remaining 20% was used for testing. All the signal processing, modeling, and evaluating were carried out in MATLAB software (R2018a version), which is developed and released by the MathWorks company. In addition, the training and testing of the model required the Neural Network Toolbox Model for the GoogLeNet Network support package. Refer to Figure 3 for the ﬂowchart of this study.

Figure 3. Flowchart of the study.
3. Results
In this study, data recordings with a sampling rate of 125 Hz containing ABP and PPG signals were collected from the MIMIC physiological database. Raw ABP signals, which were used for the extraction of blood pressure categories, were not processed. Raw PPG signals were processed with a 0.5–10 Hz Chebyshev II bandpass ﬁlter [36] and then processed by normalization. Next, each recording was cut into several 5 s signal segments. Each PPG signal segment was converted into a scalogram by continuous wavelet transform and then fed into the training and testing of the GoogLeNet model. Sensitivity, speciﬁcity, accuracy, and F1 scores were used to evaluate the classiﬁcation performance, which was calculated based on the classiﬁcation confusion matrix.
Table 1 shows the classiﬁcation performance of the three trials. Figure 4 illustrates the receiver operating characteristic (ROC) curve of the three classiﬁcation trials. To our knowledge, there have not been any comparable studies addressing this research context. Artery wave propagation theory, which uses ECG and PPG signals, and PPG morphological theory, which uses PPG signals, has been most commonly studied [41]. This study used raw PPG signals and did not extract morphological features to classify the BP into categories. Therefore, in order to evaluate the performance of this study,

Biosensors 2018, 8, 101

7 of 13

a comparative analysis with the artery wave propagation theory and PPG morphological theory were conducted on the same dataset, as shown in Table 1.
Note that there was no overﬁtting problem in this study. We compared the classiﬁcation accuracy based on the training set and testing set. The accuracy based on the testing set was similar to the accuracy based on the training set. This meant that the model was stable for predictions when new data were used.
In previous research [24], blood pressure classiﬁcation using PAT and PPG features extracted from ECG and PPG signals was also conducted using the same dataset in this study. Table 1 shows that the F1 scores found in this study were higher than the classiﬁer using 10 PPG features. This indicates that GoogLeNet achieves better performance than extracting PPG morphological features based on poor quality PPG signals collected from elderly ICU patients. In addition, this study achieved a performance similar to artery wave propagation theory. This indicates that this study, which exclusively used raw PPG signals, has promising potential to replace the ECG and PPG hypertension classiﬁcation method.

Table 1. Classiﬁcation performance of the proposed deep learning method and feature-based methods on the same recordings from the MIMIC database [33]. Note, NT, PHT, and HT represent normotension, prehypertension, and hypertension, respectively. PAT stands for pulse arrival time, CWT stands for continuous wavelet transform, KNN stands for k-nearest neighbors.

This study
PAT feature [24] (ECG and PPG signals)
PPG features [24] (only PPG signal)

Trial
NT (46) vs. PHT (41) NT (46) vs. PHT (34) (NT + PHT) (87) vs. HT (34)
NT (46) vs. PHT (41) NT (46) vs. HT (34) (NT+PHT) (87) vs. HT (34)
NT (46) vs. PHT (41) NT (46) vs. HT (34) (NT+PHT) (87) vs. HT (34)

Feature
CWT scalogram CWT scalogram CWT scalogram
PAT and 10 PPG features PAT and 10 PPG features PAT and 10 PPG features
10 PPG features 10 PPG features 10 PPG features

Classiﬁer GoogLeNet
KNN KNN

F1
80.52% 92.55% 82.95%
84.34% 94.84% 88.49%
78.62% 86.94% 78.44%

Figure 4. The receiver operating characteristic (ROC) curve of the three classiﬁcation trials.

Biosensors 2018, 8, 101

8 of 13

4. Discussion
The conventional evaluation of hypertension mainly applies the blood pressure detection method. The categories of blood pressure are classiﬁed according to the blood pressure value. It is known that cuff-type blood pressure detection is often affected by the white-coat phenomenon, reading problems, and difﬁcult operation for the elderly, etc. [42]. These factors limit its widespread application. However, hypertension and other cardiovascular diseases are becoming increasingly serious in the world, with an urgent demand for new blood pressure detection and hypertension assessment methods [43]. PPG signals can reﬂect the state of the cardiovascular circulatory system in real time, and the measurement method is noninvasive. These factors, as well as the PPG’s convenience and low cost, have allowed it to become an important means of noninvasive detection and assessment of cardiovascular health [44]. However, since PPG signals are very susceptible to the patient’s age, movement, respiration, and other interferences, previous research based on the PPG signal has often encountered difﬁculty in accurately identifying and extracting feature points. The development of deep learning technology provides a potential way around these difﬁculties by automatically and robustly extracting the features from raw signals.
This paper presented an automatic classiﬁcation and risk stratiﬁcation method for hypertension using PPG signals based on a continuous wavelet transform and pretrained convolutional neural network (GoogLeNet). This method has many potential applications, such as in ICU wards and wearable PPG devices (e.g., ﬁnger probes or smartwatches, etc.). It should be noted that for a wearable device, the trained deep learning model will need to be extensive. Indeed, a wearable device always has low computational complexity and small memory. However, cloud computing technology has become very mature. Wearable devices are used to collect signals, and cloud platforms with trained deep learning models are used to predict real-time data and send results to a wearable device. These techniques have been applied in many commercial smart devices.
In the development and evolution of hypertension, human blood pressure is experienced at different levels, including normotension, prehypertension, hypertension, and other stages. For the early diagnosis and assessment of hypertension, the timely detection of prehypertension and the accurate diagnosis of hypertension are signiﬁcant factors. Therefore, in this study, three hypertension classiﬁcation trials were set: NT versus PHT, NT versus HT, and non-HT (NT plus PHT) versus HT. Table 1 demonstrates the classiﬁcation performance of the three classiﬁcation trials. As can be seen from Table 1, all three F1 scores were more than 0.8, with those over 0.9 classiﬁed as hypertension. As this study was based on the PPG signals of patients in ICU wards, it was accepted that the quality of the PPG signal would not be ideal. Therefore, these results show the potential outcomes of applying this method.
PAT is a highly studied parameter in new types of cufﬂess blood pressure detection methods and has been explored by many studies in the context of blood pressure detection [14,45]. In a previous study, blood pressure classiﬁcation using PAT and PPG features that were extracted from ECG and PPG signals was also conducted [24]. The same dataset used in that study was used in this study. From Table 1, we can see that the F1 score of this study was higher than the classiﬁer using 10 PPG features. This means that GoogLeNet is easily able to achieve better performance than extracting PPG morphological features based on the poor quality PPG signals that are collected from elderly ICU patients. In addition, this study achieved performance similar to artery wave propagation theory. This means that this study, which only used raw PPG signals, has a strong potential to replace the ECG and PPG method to classify hypertension. It is established that for artery wave propagation theory, it is necessary to collect ECG and PPG signals simultaneously and to accurately identify and extract the morphological features of these signals. This requirement greatly limits its wider application. Compared to traditional research methods, the proposed method has more potential applications and greater practical value. The advantages are more obvious.
Exploring novel blood pressure detection and hypertension risk stratiﬁcation was the main focus of this paper, and the authors have researched this area extensively in the past [23,24,46]. It is evident

Biosensors 2018, 8, 101

9 of 13

that difﬁculty arises mainly from the extraction of features from physiological signals with differing qualities. Therefore, a new exploration using deep learning technology was conducted. The results demonstrated good performance and potential. Deep learning techniques have grown quickly in recent years. For example, ECG classiﬁcation was ﬁrst studied using a deep learning model in 2016 [47–49]. It provided a new approach to processing and analyzing ECG signals. Blood pressure is a basic and important physiological parameter that is challenging to detect and classify using non-invasive PPG signals. Deep learning techniques have an advantage when used for the classiﬁcation of new blood pressure categories. The current study helps us to understand how deep learning may be used for the assessment of blood pressure. With the development of deep learning in recent years, more complete deep learning toolboxes have been released, especially MATLAB R2018, introduced in the methodology section.
A bigger dataset is always ideal for such studies. For our study, we used signals collected from 121 subjects, and each recording was 120 s in length per subject. When creating the training and testing sets, each subject signal was cut down to 24 ﬁve-second windows. Therefore, 2904 signal segments were used to create the RGB images. The training set consisted of 2323 images, and the testing set consisted of 581 images. For these thousands of images, the training time of each trial lasted more than 350 min. The computation complexity was high and, therefore, taken into consideration during the training phase.
It is noteworthy that many studies have used the MIMIC database assuming that all the simultaneously collected signals were synchronized [50–54]. However, the creators of the MIMIC database have reported errors in the data matching and alignment in of some recordings, as mentioned by Clifford et al. [14], conﬁrming that not all the signals were synchronized. This issue is not important for us, as we analyzed the PPG signal alone.
Although the method proposed in this study has outstanding advantages, its challenges cannot be ignored. The limitations of this study were that the dataset used was still small, and each sample was only 2 min in length. Much more validation and optimization with more clinical data will continue in future work. In addition, a main problem of this study was that the training stage was too long. However, this is a common problem in the training of deep learning models. Another time-consuming stage was the continuous wavelet transform and conversion to the scalogram. However, the scalogram was beneﬁcial in showing the different frequency components of the PPG signal, which can improve the classiﬁcation performance. Fortunately, the computational complexity problem can be ignored because, in practice, only a fully trained model is used, which requires a short time for prediction. The speciﬁc advantages and disadvantages are summarized as follows:
Advantages:
1. Can be completely automated 2. No need to extract morphological features 3. No special requirement for the signal quality of the PPG signal 4. Applicable to real-time processing of big data
Disadvantages:
1. Demands higher processing power and resources 2. Needs more training time 3. Requires training with large-scale data
The ECG and PPG methods are indeed very promising methods for noninvasive continuous blood pressure monitoring. The PAT method has a relatively stable blood pressure correlation, which has also been studied and conﬁrmed by previous research. ECG and PPG can provide a more clinical diagnosis with ECG signals, in addition to providing blood pressure detection. However, it is known that it is not easy to obtain a stable ECG signal using an ECG device and a PPG device in different settings.

Biosensors 2018, 8, 101

10 of 13

Additionally, the acquisition of ECG signals is a barrier to the wider application of this technology. It is also known that, despite the ease of operating an oscillographic electronic sphygmomanometer, many people are unable to use it properly. Therefore, reducing the complexity of the installation and operation is still an issue that has to be considered. This study showed that using deep learning technology and raw PPG signals is very promising and forms a novel exploration for deep learning potential in blood pressure assessment.
This study’s proposed method could play a major role in the early detection of hypertension in low- and middle-income countries (LMICs). With the use of only PPG signals, which are easy to use, simple, and effective, utilizing the six-step framework for a global health approach [55] can lead to decreased morbidity and mortality rates in LMICs.
5. Conclusions
In clinical settings, the computer-aided diagnosis of hypertension can signiﬁcantly reduce the workload of doctors and nurses, especially in Intensive Care Unit wards. An automatic diagnosis and warning system for hypertension is, therefore, a necessary component of timely and accurate screening and treatment of the disease. We hypothesized that deep learning will provide better results when compared to the classical method. Results showed that the proposed deep learning method (combining continuous wavelet transform and the GoogLeNet) achieved higher accuracy than PPG features extracted from PPG signals. The proposed deep learning method does require a higher quality PPG signals and does not require extraction of the PPG morphological feature, making it easy to apply in many situations. In future research, using an increased sample size, we will be able to continue improving the performance for hypertension risk stratiﬁcation. This paper used a non-GPU device. In the future, we plan to further expand the dataset, include more noise sample records and use a GPU-based workstation for model optimization and learning.
Author Contributions: Y.L. and M.E. performed the statistical analysis. Y.L., Z.C., R.W., and M.E. conceived the study and drafted the manuscript. M.E. designed the study and led this investigation. All authors approved the ﬁnal manuscript.
Funding: This research was funded by BC Children’s & Women’s Hospital and The University of British Columbia, Canada.
Conﬂicts of Interest: The authors declare no competing ﬁnancial or non-ﬁnancial interests.
References
1. Koivistoinen, T.; Lyytikäinen, L.P.; Aatola, H.; Luukkaala, T.; Juonala, M.; Viikari, J.; Lehtimäki, T.; Raitakari, O.T.; Kähönen, M.; Hutri-Kähönen, N. Pulse Wave Velocity Predicts the Progression of Blood Pressure and Development of Hypertension in Young Adults. Hypertension 2018, 71, 451–456. [CrossRef] [PubMed]
2. Ribas Ripoll, V.J.; Wojdel, A.; Romero, E.; Ramos, P.; Brugada, J. ECG assessment based on neural networks with pretraining. Appl. Soft Comput. 2016, 49, 399–406. [CrossRef]
3. Roth, G.A.; Forouzanfar, M.H.; Moran, A.E.; Barber, R.; Nguyen, G.; Feigin, V.L.; Naghavi, M.; Mensah, G.A.; Murray, C.J. Demographic and Epidemiologic Drivers of Global Cardiovascular Mortality. N. Engl. J. Med. 2015, 372, 1333–1341. [CrossRef] [PubMed]
4. Whelton, P.K.; Carey, R.M.; Aronow, W.S.; Casey, D.E.; Collins, K.J.; Himmelfarb, C.D.; DePalma, S.M.; Gidding, S.; Jamerson, K.A.; Jones, D.W.; et al. 2017 ACC/AHA/AAPA/ABC/ACPM/AGS/APhA/ASH/ ASPC/NMA/PCNA Guideline for the Prevention, Detection, Evaluation, and Management of High Blood Pressure in Adults: A Report of the American College of Cardiology/American Heart Association Task Force on Clinical Practice Guidelines. J. Am. Coll. Cardiol. 2018, 71, e127–e248. [CrossRef] [PubMed]
5. Nerenberg, K.A.; Zarnke, K.B.; Leung, A.A.; Dasgupta, K.; Butalia, S.; McBrien, K.; Harris, K.C.; Nakhla, M.; Cloutier, L.; Gelfer, M.; et al. Hypertension Canada’s 2018 Guidelines for Diagnosis, Risk Assessment, Prevention, and Treatment of Hypertension in Adults and Children. Can. J. Cardiol. 2018, 34, 506–525. [CrossRef] [PubMed]

Biosensors 2018, 8, 101

11 of 13

6. Salvetti, A. Personal View: A Centenary of Clinical Blood Pressure Measurement: A Tribute to Scipione Riva-Rocci. Blood Press. 1996, 5, 325–326. [CrossRef] [PubMed]
7. Mukkamala, R.; Hahn, J.O.; Inan, O.T.; Mestha, L.K.; Kim, C.S.; Toreyin, H.; Kyal, S. Toward Ubiquitous Blood Pressure Monitoring via Pulse Transit Time: Theory and Practice. IEEE Trans. Bio-Med. Eng. 2015, 62, 1879–1901. [CrossRef] [PubMed]
8. Messas, E.; Pernot, M.; Couade, M. Arterial wall elasticity: State of the art and future prospects. Diagn. Interv. Imaging 2013, 94, 561–569. [CrossRef] [PubMed]
9. Ding, X.R.; Zhang, Y.T.; Liu, J.; Dai, W.X.; Tsang, H.K. Continuous Cufﬂess Blood Pressure Estimation Using Pulse Transit Time and Photoplethysmogram Intensity Ratio. IEEE Trans. Bio-Med. Eng. 2016, 63, 964–972. [CrossRef] [PubMed]
10. Poleszczuk, J.; Debowska, M.; Dabrowski, W.; Wojcik-Zaluska, A.; Zaluska, W.; Waniewski, J. Subject-speciﬁc pulse wave propagation modeling: Towards enhancement of cardiovascular assessment methods. PLoS ONE 2018, 13, e0190972. [CrossRef] [PubMed]
11. Yoon, Y.Z.; Kang, J.M.; Kwon, Y.; Park, S.; Noh, S.; Kim, Y.; Park, J.; Hwang, S.W. Cuff-less Blood Pressure Estimation using Pulse Waveform Analysis and Pulse Arrival Time. IEEE J. Biomed. Heal. Inf. 2018, 22, 1068–1074. [CrossRef] [PubMed]
12. Xing, X.; Sun, M. Optical blood pressure estimation with photoplethysmography and FFT-based neural networks. Biomed. Opt. Express 2016, 7, 3007–3020. [CrossRef] [PubMed]
13. Li, Y.; Wang, Z.; Zhang, L.; Yang, X.; Song, J. Characters available in photoplethysmogram for blood pressure estimation: Beyond the pulse transit time. Australas. Phys. Eng. Sci. Med. 2014, 37, 367–376. [CrossRef] [PubMed]
14. Ding, X.; Yan, B.P.; Zhang, Y.T.; Liu, J.; Zhao, N.; Tsang, H.K. Pulse transit time based continuous cufﬂess blood pressure estimation: A new extension and a comprehensive evaluation. Sci. Rep. 2017, 7, 11554. [CrossRef] [PubMed]
15. Zhang, Y.; Feng, Z. A SVM Method for Continuous Blood Pressure Estimation from a PPG Signal. In Proceedings of the 9th International Conference on Machine Learning and Computing—ICMLC 2017, Singapore, 24–26 February 2017; pp. 128–132.
16. Rundo, F.; Ortis, A.; Battiato, S.; Conoci, S. Advanced bio-inspired system for noninvasive cuff-less blood pressure estimation from physiological signal analysis. Computation 2018, 6, 46. [CrossRef]
17. Zhang, Q.; Yang, L.T.; Chen, Z.; Li, P. A survey on deep learning for big data. Inf. Fusion 2018, 42, 146–157. [CrossRef]
18. Antipov, G.; Baccouche, M.; Berrani, S.-A.; Dugelay, J.-L. Effective training of convolutional neural networks for face-based gender and age prediction. Pattern Recognit. 2017, 72, 15–26. [CrossRef]
19. Jiao, Z.; Gao, X.; Wang, Y.; Li, J.; Xu, H. Deep Convolutional Neural Networks for mental load classiﬁcation based on EEG data. Pattern Recognit. 2018, 76, 582–595. [CrossRef]
20. Faust, O.; Hagiwara, Y.; Hong, T.J.; Lih, O.S.; Acharya, U.R. Deep learning for healthcare applications based on physiological signals: A review. Comput. Methods Programs Biomed. 2018, 161, 1–13. [CrossRef] [PubMed]
21. Cao, C.; Liu, F.; Tan, H.; Song, D.; Shu, W.; Li, W.; Zhou, Y.; Bo, X.; Xie, Z. Deep learning and its applications in biomedicine. Genom. Proteom. Bioinform. 2018, 16, 17–32. [CrossRef] [PubMed]
22. Miotto, R.; Wang, F.; Wang, S.; Jiang, X.; Dudley, J.T. Deep learning for healthcare: Review, opportunities and challenges. Brief. Bioinform. 2017. [CrossRef] [PubMed]
23. Martínez, G.; Howard, N.; Abbott, D.; Lim, K.; Ward, R.; Elgendi, M. Can photoplethysmography replace arterial blood pressure in the assessment of blood pressure? J. Clin. Med. 2018, 7, 316.
24. Liang, Y.; Chen, Z.; Ward, R.; Elgendi, M. Hypertension assessment via ECG and PPG Signals: An evaluation using MIMIC Database. Diagnostics 2018, 8, 65. [CrossRef] [PubMed]
25. Elgendi, M.; Norton, I.; Brearley, M.; Abbott, D.; Schuurmans, D. Systolic peak detection in acceleration photoplethysmograms measured from emergency responders in tropical conditions. PLoS ONE 2013, 8, 76585. [CrossRef] [PubMed]
26. Elgendi, M.; Norton, I.; Brearley, M.; Abbott, D.; Schuurmans, D. Detection of a and b waves in the acceleration photoplethysmogram. Biomed. Eng. Online 2014, 13, 139. [CrossRef] [PubMed]
27. Elgendi, M. Detection of c, d, and e waves in the acceleration photoplethysmogram. Comput. Methods Programs Biomed. 2014, 117, 125–136. [CrossRef] [PubMed]

Biosensors 2018, 8, 101

12 of 13

28. Elgendi, M.; Fletcher, R.; Norton, I.; Brearley, M.; Abbott, D.; Lovell, N.H.; Schuurmans, D. On time domain analysis of photoplethysmogram signals for monitoring heat stress. Sensors 2015, 15, 24716–24734. [CrossRef] [PubMed]
29. Elgendi, M.; Fletcher, R.R.; Norton, I.; Brearley, M.; Abbott, D.; Lovell, N.H.; Schuurmans, D. Frequency analysis of photoplethysmogram and its derivatives. Comput. Methods Programs Biomed. 2015, 122, 503–512. [CrossRef] [PubMed]
30. Elgendi, M. Optimal signal quality index for photoplethysmogram signals. Bioengineering 2016, 3, 21. [CrossRef] [PubMed]
31. Elgendi, M.; Norton, I.; Brearley, M.; Fletcher, R.R.; Abbott, D.; Lovell, N.H.; Schuurmans, D. Towards investigating global warming impact on human health using derivatives of photoplethysmogram signals. Int. J. Environ. Res. Public Heal. 2015, 12, 12776–12791. [CrossRef] [PubMed]
32. Krizhevsky, A.; Sutskever, I.; Hinton, G.E. Imagenet classiﬁcation with deep convolutional neural networks. In Proceedings of the Advances in Neural Information Processing Systems, Lake Tahoe, NV, USA, 3–6 December 2012; pp. 1097–1105.
33. Saeed, M.; Villarroel, M.; Reisner, A.T.; Clifford, G.; Lehman, L.W.; Moody, G.; Heldt, T.; Kyaw, T.H.; Moody, B.; Mark, R.G. Multiparameter intelligent monitoring in intensive care II: A public-access intensive care unit database. Crit. Care Med. 2011, 39, 952–960. [CrossRef] [PubMed]
34. Johnson, A.E.; Pollard, T.J.; Shen, L.; Li-wei, H.L.; Feng, M.; Ghassemi, M.; Moody, B.; Szolovits, P.; Celi, L.A.; Mark, R.G. MIMIC-III, a freely accessible critical care database. Sci. Data 2016, 3, 160035. [CrossRef] [PubMed]
35. Chobanian, A.V.; Bakris, G.L.; Black, H.R.; Cushman, W.C.; Green, L.A.; Izzo, J.L., Jr.; Jones, D.W.; Materson, B.J.; Oparil, S.; Wright, J.T., Jr.; et al. Seventh report of the Joint National Committee on Prevention, Detection, Evaluation, and Treatment of High Blood Pressure. Hypertension 2003, 42, 1206–1252. [CrossRef] [PubMed]
36. Liang, Y.; Elgendi, M.; Chen, Z.; Ward, R. An optimal ﬁlter for short photoplethysmogram signals. Sci. Data 2018, 5, 180076. [CrossRef] [PubMed]
37. Szegedy, C.; Wei, L.; Yangqing, J.; Sermanet, P.; Reed, S.; Anguelov, D.; Erhan, D.; Vanhoucke, V.; Rabinovich, A. Going deeper with convolutions. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR), Boston, MA, USA, 7–12 June 2015; pp. 1–9.
38. He, Z.; Zhang, X.; Cao, Y.; Liu, Z.; Zhang, B.; Wang, X. LiteNet: Lightweight neural network for detecting arrhythmias at resource-constrained mobile devices. Sensors 2018, 18, 1229. [CrossRef] [PubMed]
39. Xiong, Z.; Stiles, M.K.; Zhao, J. Robust ECG signal classiﬁcation for detection of atrial ﬁbrillation using a novel neural network. Computing 2017, 44, 1.
40. Bengio, Y. Deep learning of representations for unsupervised and transfer learning. In Proceedings of the ICML Workshop on Unsupervised and Transfer Learning, Bellevue, WA, USA, 28 June–2 July 2011; pp. 17–37.
41. Geddes, L.A.; Voelz, M.H.; Babbs, C.F.; Bourland, J.D.; Tacker, W.A. Pulse transit time as an indicator of arterial blood pressure. Psychophysiology 1981, 18, 71–74. [CrossRef] [PubMed]
42. Pickering, T.G. Principles and techniques of blood pressure measurement. Cardiol. Clin. 2002, 20, 207–223. [CrossRef]
43. Liang, Y.; Chen, Z.; Ward, R.; Elgendi, M. A new, short-recorded photoplethysmogram dataset for blood pressure monitoring in China. Sci. Data 2018, 5, 180020. [CrossRef] [PubMed]
44. Elgendi, M. On the analysis of ﬁngertip photoplethysmogram signals. Curr. Cardiol. Rev. 2012, 8, 14–25. [CrossRef] [PubMed]
45. Zhang, Q.; Zhou, D.; Zeng, X. Highly wearable cuff-less blood pressure and heart rate monitoring with single-arm electrocardiogram and photoplethysmogram signals. Biomed. Eng. Online 2017, 16, 23. [CrossRef] [PubMed]
46. Elgendi, M.; Liang, Y.; Ward, R. Toward generating more diagnostic features from photoplethysmogram waveforms. Diseases 2018, 6, 20. [CrossRef] [PubMed]
47. Al Rahhal, M.M.; Bazi, Y.; AlHichri, H.; Alajlan, N.; Melgani, F.; Yager, R.R. Deep learning approach for active classiﬁcation of electrocardiogram signals. Inf. Sci. 2016, 345, 340–354. [CrossRef]

Biosensors 2018, 8, 101

13 of 13

48. Acharya, U.R.; Fujita, H.; Oh, S.L.; Hagiwara, Y.; Tan, J.H.; Adam, M. Application of deep convolutional neural network for automated detection of myocardial infarction using ECG signals. Inf. Sci. 2017, 415, 190–198. [CrossRef]
49. Kiranyaz, S.; Ince, T.; Gabbouj, M. Real-time patient-speciﬁc ECG classiﬁcation by 1-D convolutional neural networks. IEEE Trans. Biomed. Eng. 2016, 63, 664–675. [CrossRef] [PubMed]
50. Forouzanfar, M.; Ahmad, S.; Batkin, I.; Dajani, H.R.; Groza, V.Z.; Bolic, M. Coefﬁcient-free blood pressure estimation based on pulse transit time–cuff pressure dependence. IEEE Trans. Biomed. Eng. 2013, 60, 1814–1824. [CrossRef] [PubMed]
51. Wang, R.; Jia, W.; Mao, Z.-H.; Sclabassi, R.J.; Sun, M. Cuff-free blood pressure estimation using pulse transit time and heart rate. In Proceedings of the 12th International Conference on Signal Processing (ICSP), Hangzhou, China, 19–23 October 2014.
52. Zhang, Q.; Chen, X.; Fang, Z.; Xue, Y.; Zhan, Q.; Yang, T.; Xia, S. Cuff-less blood pressure measurement using pulse arrival time and a Kalman ﬁlter. J. Micromech. Microeng. 2017, 27, 024002. [CrossRef]
53. Pﬂugradt, M.; Geissdoerfer, K.; Goernig, M.; Orglmeister, R. A fast multimodal ectopic beat detection method applied for blood pressure estimation based on pulse wave velocity measurements in wearable sensors. Sensors 2017, 17, 158. [CrossRef] [PubMed]
54. Feng, J.; Huang, Z.; Zhou, C.; Ye, X. Study of continuous blood pressure estimation based on pulse transit time, heart rate and photoplethysmography-derived hemodynamic covariates. Australas. Phys. Eng. Sci. Med. 2018, 41, 403–413. [CrossRef] [PubMed]
55. Elgendi, M.; Howard, N.; Lovell, N.; Cichocki, A.; Brearley, M.; Abbott, D.; Adatia, I. A six-step framework on biomedical signal analysis for tackling noncommunicable diseases: Current and future perspectives. JMIR Biomed. Eng. 2016, 1, e1. [CrossRef]
© 2018 by the authors. Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (http://creativecommons.org/licenses/by/4.0/).

