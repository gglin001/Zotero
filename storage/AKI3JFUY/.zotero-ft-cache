VYSOKÃ‰ UÄŒENÃ TECHNICKÃ‰ V BRNÄš
BRNO UNIVERSITY OF TECHNOLOGY
FAKULTA ELEKTROTECHNIKY A KOMUNIKAÄŒNÃCH TECHNOLOGIÃ
FACULTY OF ELECTRICAL ENGINEERING AND COMMUNICATION
ÃšSTAV BIOMEDICÃNSKÃ‰HO INÅ½ENÃRSTVÃ
DEPARTMENT OF BIOMEDICAL ENGINEERING

STANOVENÃ KREVNÃHO TLAKU POMOCÃ CHYTRÃ‰HO TELEFONU
BLOOD PRESSURE ESTIMATION USING SMARTPHONE

DIPLOMOVÃ PRÃCE
MASTER'S THESIS
AUTOR PRÃCE
AUTHOR
VEDOUCÃ PRÃCE
SUPERVISOR

Bc. Martin VaÅ™eÄka Ing. Andrea NÄ›mcovÃ¡

BRNO 2018

DiplomovÃ¡ prÃ¡ce

magisterskÃ½ navazujÃ­cÃ­ studijnÃ­ obor BiomedicÃ­nskÃ© inÅ¾enÃ½rstvÃ­ a bioinformatika

Ãšstav biomedicÃ­nskÃ©ho inÅ¾enÃ½rstvÃ­

Student: Bc. Martin VaÅ™eÄka

ID: 164219

RoÄnÃ­k: 2

AkademickÃ½ rok: 2017/18

NÃZEV TÃ‰MATU:
StanovenÃ­ krevnÃ­ho tlaku pomocÃ­ chytrÃ©ho telefonu

POKYNY PRO VYPRACOVÃNÃ:
1) Prostudujte moÅ¾nosti mÄ›Å™enÃ­ tlaku krve (TK), zamÄ›Å™te se zejmÃ©na na metody vyuÅ¾Ã­vajÃ­cÃ­ chytrÃ½ telefon. Seznamte se s prostÅ™edÃ­m pro vÃ½voj aplikacÃ­ pro Android (alternativnÄ› iOS). 2) NasnÃ­mejte testovacÃ­ data pomocÃ­ vhodnÃ½ch senzorÅ¯ chytrÃ©ho telefonu a referenÄnÃ­ data pomocÃ­ nÄ›kterÃ© z konvenÄnÃ­ch metod pro mÄ›Å™enÃ­ TK. 3) VytvoÅ™te algoritmus pro stanovenÃ­ TK z nasnÃ­manÃ½ch dat. 4) Optimalizujte algoritmus. Statisticky porovnejte vÃ½sledky s referencÃ­. 5) VytvoÅ™te aplikaci pro chytrÃ½ telefon a popiÅ¡te jejÃ­ architekturu. 6) Diskutujte vÃ½sledky, pouÅ¾itelnost aplikace v reÃ¡lnÃ©m Å¾ivotÄ›, vliv prostÅ™edÃ­, pÅ™Ã­padnÄ› vliv pouÅ¾itÃ©ho chytrÃ©ho telefonu.

DOPORUÄŒENÃ LITERATURA: [1] CHANDRASEKARAN, V., R. DANTU, S. JONNADA, S. THIYAGARAJA a K. P. SUBBU. Cuffless Differential Blood Pressure Estimation Using Smart Phones. IEEE Transactions on Biomedical Engineering. 2013, 60(4), 1080-1089. ISSN 0018-9294.
[2] DIAS JUNIOR, A., S. MURALI, F. RINCON a D. ATIENZA. Methods for reliable estimation of pulse transit time and blood pressure variations using smartphone sensors. Microprocessors and Microsystems. 2016, 46, 84-95. ISSN 01419331.

TermÃ­n zadÃ¡nÃ­: 5.2.2018
VedoucÃ­ prÃ¡ce: Ing. Andrea NÄ›mcovÃ¡ Konzultant:

TermÃ­n odevzdÃ¡nÃ­: 18.5.2018
prof. Ing. Ivo ProvaznÃ­k, Ph.D. pÅ™edseda oborovÃ© rady

UPOZORNÄšNÃ: Autor diplomovÃ© prÃ¡ce nesmÃ­ pÅ™i vytvÃ¡Å™enÃ­ diplomovÃ© prÃ¡ce poruÅ¡it autorskÃ¡ prÃ¡va tÅ™etÃ­ch osob, zejmÃ©na nesmÃ­ zasahovat nedovolenÃ½m zpÅ¯sobem do cizÃ­ch autorskÃ½ch prÃ¡v osobnostnÃ­ch a musÃ­ si bÃ½t plnÄ› vÄ›dom nÃ¡sledkÅ¯ poruÅ¡enÃ­ ustanovenÃ­ Â§ 11 a nÃ¡sledujÃ­cÃ­ch autorskÃ©ho zÃ¡kona Ä. 121/2000 Sb., vÄetnÄ› moÅ¾nÃ½ch trestnÄ›prÃ¡vnÃ­ch dÅ¯sledkÅ¯ vyplÃ½vajÃ­cÃ­ch z ustanovenÃ­ ÄÃ¡sti druhÃ©, hlavy VI. dÃ­l 4 TrestnÃ­ho zÃ¡konÃ­ku Ä.40/2009 Sb.
Fakulta elektrotechniky a komunikaÄnÃ­ch technologiÃ­, VysokÃ© uÄenÃ­ technickÃ© v BrnÄ› / TechnickÃ¡ 3058/10 / 616 00 / Brno

ABSTRAKT
KrevnÃ­ tlak je jednÃ­m ze zÃ¡kladnÃ­ch ukazatelÅ¯ zdravotnÃ­ho stavu kardiovaskulÃ¡rnÃ­ho systÃ©mu. VysokÃ½ krevnÃ­ tlak je hlavnÃ­m rizikovÃ½m faktorem pro vznik ischemickÃ© choroby srdeÄnÃ­, aterosklerÃ³zy a mozkovÃ½ch pÅ™Ã­hod. Z toho dÅ¯vodu je dÅ¯leÅ¾itÃ© sledovat dlouhotrvajÃ­cÃ­ zmÄ›ny hodnoty krevnÃ­ho tlaku a vÄas na tyto zmÄ›nu reagovat. ZaÅ™Ã­zenÃ­ pro mÄ›Å™enÃ­ krevnÃ­ho tlaku nenÃ­ standardnÃ­m vybavenÃ­m domÃ¡cnosti, zatÃ­m co velmi dobÅ™e vybavenÃ½ chytrÃ½ telefon ano. ChytrÃ© telefony obsahujÃ­ velkÃ© mnoÅ¾stvÃ­ senzorÅ¯ pomocÃ­ niÅ¾ lze mÄ›Å™it biomedicÃ­nskÃ© signÃ¡ly. Tato prÃ¡ce se zamÄ›Å™uje na vytvoÅ™enÃ­ aplikace schopnÃ© stanovit hodnotu krevnÃ­ho tlaku pomocÃ­ dat zÃ­skanÃ½ch ze senzorÅ¯ chytrÃ©ho telefonu.
KLÃÄŒOVÃ SLOVA
krevnÃ­ tlak, TK, fotopletysmografie, PPG, fonokardiografie, FKG, doba pÅ™enosu pulzu, PTT, chytrÃ½ telefon, Android, Android Studio, Matlab, zpracovÃ¡nÃ­ signÃ¡lu
ABSTRACT
Blood pressure is one of the basic indicators of the health state of the cardiovascular system. High blood pressure is the main risk factor of ischemic heart disease, atherosclerosis and stroke. Therefore, it is important to monitor long-term changes in blood pressure and respond in time to these changes. Blood pressure meters are not standard household equipment, while a well-equipped smartphone is. Smartphones contain a large number of sensors capable of measuring biomedical signals. This thesis focuses on creating an application capable of determining blood pressure using data obtained from these sensors.
KEYWORDS
blood pressure, BP, photoplethysmography, PPG, phonocardiography, PCG, pulse transit time, PTT, smartphone, Android, Android Studio, Matlab, signal processing
VAÅ˜EÄŒKA, Martin. StanovenÃ­ krevnÃ­ho tlaku pomocÃ­ chytrÃ©ho telefonu. Brno, 2018, 80 s. DiplomovÃ¡ prÃ¡ce. VysokÃ© uÄenÃ­ technickÃ© v BrnÄ›, Fakulta elektrotechniky a komunikaÄnÃ­ch technologiÃ­, Ãšstav biomedicÃ­nskÃ©ho inÅ¾enÃ½rstvÃ­. VedoucÃ­ prÃ¡ce: Ing. Andrea NÄ›mcovÃ¡
VysÃ¡zeno pomocÃ­ balÃ­Äku thesis verze 3.03; http://latex.feec.vutbr.cz

PROHLÃÅ ENÃ
ProhlaÅ¡uji, Å¾e svou diplomovou prÃ¡ci na tÃ©ma â€StanovenÃ­ krevnÃ­ho tlaku pomocÃ­ chytrÃ©ho telefonuâ€œ jsem vypracoval samostatnÄ› pod vedenÃ­m vedoucÃ­ho diplomovÃ© prÃ¡ce a s pouÅ¾itÃ­m odbornÃ© literatury a dalÅ¡Ã­ch informaÄnÃ­ch zdrojÅ¯, kterÃ© jsou vÅ¡echny citovÃ¡ny v prÃ¡ci a uvedeny v seznamu literatury na konci prÃ¡ce.
Jako autor uvedenÃ© diplomovÃ© prÃ¡ce dÃ¡le prohlaÅ¡uji, Å¾e v souvislosti s vytvoÅ™enÃ­m tÃ©to diplomovÃ© prÃ¡ce jsem neporuÅ¡il autorskÃ¡ prÃ¡va tÅ™etÃ­ch osob, zejmÃ©na jsem nezasÃ¡hl nedovolenÃ½m zpÅ¯sobem do cizÃ­ch autorskÃ½ch prÃ¡v osobnostnÃ­ch a/nebo majetkovÃ½ch a jsem si plnÄ› vÄ›dom nÃ¡sledkÅ¯ poruÅ¡enÃ­ ustanovenÃ­ S 11 a nÃ¡sledujÃ­cÃ­ch autorskÃ©ho zÃ¡kona Ä. 121/2000 Sb., o prÃ¡vu autorskÃ©m, o prÃ¡vech souvisejÃ­cÃ­ch s prÃ¡vem autorskÃ½m a o zmÄ›nÄ› nÄ›kterÃ½ch zÃ¡konÅ¯ (autorskÃ½ zÃ¡kon), ve znÄ›nÃ­ pozdÄ›jÅ¡Ã­ch pÅ™edpisÅ¯, vÄetnÄ› moÅ¾nÃ½ch trestnÄ›prÃ¡vnÃ­ch dÅ¯sledkÅ¯ vyplÃ½vajÃ­cÃ­ch z ustanovenÃ­ ÄÃ¡sti druhÃ©, hlavy VI. dÃ­l 4 TrestnÃ­ho zÃ¡konÃ­ku Ä. 40/2009 Sb.

Brno . . . . . . . . . . . . . . .

.................................. podpis autora

PODÄšKOVÃNÃ
RÃ¡d bych podÄ›koval vedoucÃ­ semestrÃ¡lnÃ­ prÃ¡ce panÃ­ Ing. Andree NÄ›mcovÃ© za odbornÃ© vedenÃ­, konzultace, trpÄ›livost a podnÄ›tnÃ© nÃ¡vrhy k prÃ¡ci.

Brno . . . . . . . . . . . . . . .

.................................. podpis autora

Obsah

Ãšvod

11

1 KrevnÃ­ tlak

12

1.1 Tlak krve . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

1.2 KonvenÄnÃ­ mÄ›Å™enÃ­ krevnÃ­ho tlaku . . . . . . . . . . . . . . . . . . . . 14

1.2.1 PalpaÄnÃ­ metoda . . . . . . . . . . . . . . . . . . . . . . . . . 14

1.2.2 AuskultaÄnÃ­ metoda . . . . . . . . . . . . . . . . . . . . . . . 15

1.2.3 OscilometrickÃ¡ metoda . . . . . . . . . . . . . . . . . . . . . . 16

1.2.4 UltrazvukovÃ¡ metoda . . . . . . . . . . . . . . . . . . . . . . . 17

1.2.5 FotopletysmografickÃ¡ metoda . . . . . . . . . . . . . . . . . . 18

2 OperaÄnÃ­ systÃ©m Android

20

2.1 Platforma Android . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

2.2 Verze operaÄnÃ­ho systÃ©mu . . . . . . . . . . . . . . . . . . . . . . . . 20

2.3 Architektura operaÄnÃ­ho systÃ©mu . . . . . . . . . . . . . . . . . . . . 21

2.4 VÃ½voj aplikacÃ­ pro platformu Android . . . . . . . . . . . . . . . . . . 22

2.4.1 VÃ½vojovÃ© prostÅ™edÃ­ . . . . . . . . . . . . . . . . . . . . . . . . 22

2.4.2 ZÃ¡klady aplikace . . . . . . . . . . . . . . . . . . . . . . . . . 23

3 MÄ›Å™enÃ­ krevnÃ­ho tlaku pomocÃ­ telefonu

26

3.1 Doba pÅ™enosu pulsu . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

3.2 Senzory chytrÃ©ho telefonu . . . . . . . . . . . . . . . . . . . . . . . . 27

3.2.1 Fonokardiografie . . . . . . . . . . . . . . . . . . . . . . . . . 28

3.2.2 Fotopletysmografie . . . . . . . . . . . . . . . . . . . . . . . . 29

3.3 VÃ½poÄet hodnoty krevnÃ­ho tlaku . . . . . . . . . . . . . . . . . . . . . 30

3.3.1 SystolickÃ½ arteriÃ¡lnÃ­ tlak . . . . . . . . . . . . . . . . . . . . . 30

3.3.2 DiastolickÃ½ arteriÃ¡lnÃ­ tlak . . . . . . . . . . . . . . . . . . . . 31

3.4 Volba chytrÃ©ho telefonu . . . . . . . . . . . . . . . . . . . . . . . . . . 32

3.4.1 MinimÃ¡lnÃ­ poÅ¾adavky na zaÅ™Ã­zenÃ­ . . . . . . . . . . . . . . . . 32

3.4.2 ZvolenÃ© zaÅ™Ã­zenÃ­ . . . . . . . . . . . . . . . . . . . . . . . . . . 33

4 VÃ½voj mobilnÃ­ aplikace

35

4.1 ZaloÅ¾enÃ­ projektu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

4.2 Architektura aplikace . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

4.3 Kompatibilita . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

4.4 OprÃ¡vnÄ›nÃ­ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

4.5 Akvizice fotopletysmografickÃ½ch dat . . . . . . . . . . . . . . . . . . . 38

4.5.1 OvlÃ¡dÃ¡nÃ­ fotoaparÃ¡tu . . . . . . . . . . . . . . . . . . . . . . . 38

4.5.2 ZpracovÃ¡nÃ­ obrazovÃ½ch dat . . . . . . . . . . . . . . . . . . . . 42 4.5.3 RenderScript . . . . . . . . . . . . . . . . . . . . . . . . . . . 48 4.6 Akvizice fonokardiografickÃ½ch dat . . . . . . . . . . . . . . . . . . . . 51 4.6.1 OvlÃ¡dÃ¡nÃ­ zvukovÃ½ch zaÅ™Ã­zenÃ­ . . . . . . . . . . . . . . . . . . . 51 4.6.2 ZpracovÃ¡nÃ­ zvukovÃ½ch dat . . . . . . . . . . . . . . . . . . . . 54 4.7 Synchronizace zÃ¡znamÅ¯ . . . . . . . . . . . . . . . . . . . . . . . . . . 55 4.7.1 ÄŒasovÃ© zÃ¡kladny . . . . . . . . . . . . . . . . . . . . . . . . . 56 4.7.2 Synchronizace poÄÃ¡tkÅ¯ . . . . . . . . . . . . . . . . . . . . . . 56 4.7.3 PÅ™esnost senzorÅ¯ . . . . . . . . . . . . . . . . . . . . . . . . . 58 4.8 HlavnÃ­ spouÅ¡tÄ›cÃ­ aktivita . . . . . . . . . . . . . . . . . . . . . . . . . 59 4.9 TestovÃ¡nÃ­ aplikace . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

5 ZpracovÃ¡nÃ­ dat

63

5.1 PÅ™edzpracovÃ¡nÃ­ signÃ¡lÅ¯ . . . . . . . . . . . . . . . . . . . . . . . . . . 63

5.1.1 PPG signÃ¡l . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

5.1.2 FKG signÃ¡l . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

5.2 Synchronizace zÃ¡znamÅ¯ . . . . . . . . . . . . . . . . . . . . . . . . . . 65

5.3 Detekce vrcholÅ¯ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66

5.3.1 PulsnÃ­ vlna . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

5.3.2 PrvnÃ­ a druhÃ¡ srdeÄnÃ­ ozva . . . . . . . . . . . . . . . . . . . . 67

6 VyhodnocenÃ­ dat

70

7 ZÃ¡vÄ›r

72

Literatura

74

Seznam symbolÅ¯, veliÄin a zkratek

79

Seznam obrÃ¡zkÅ¯
1.1 ZmÄ›na laminÃ¡rnÃ­ho proudÄ›nÃ­ v turbulentnÃ­ . . . . . . . . . . . . . . . 14 1.2 Princip auskultaÄnÃ­ metody. . . . . . . . . . . . . . . . . . . . . . . . 16 1.3 ÄŒasovÃ½ prÅ¯bÄ›h signÃ¡lu z tlakovÃ© manÅ¾ety a jeho zpracovÃ¡nÃ­. . . . . . 17 1.4 Princip ultrazvukovÃ© (Dopplerovy) metody. . . . . . . . . . . . . . . . 18 2.1 VÃ½vojovÃ© prostÅ™edÃ­ Android Studio . . . . . . . . . . . . . . . . . . . 23 3.1 Princip mÄ›Å™enÃ­ doby pÅ™enosu pulsu (PTT) z EKG a PPG. . . . . . . 27 3.2 Komponenty prvnÃ­ a druhÃ© srdeÄnÃ­ ozvy . . . . . . . . . . . . . . . . 28 3.3 Lokalizace srdeÄnÃ­ch chlopnÃ­ a jejich ozev . . . . . . . . . . . . . . . . 29 3.4 FrekvenÄnÃ­ charakteristika mikrofonu rÅ¯znÃ½ch zaÅ™Ã­zenÃ­. . . . . . . . . 33 3.5 ChytrÃ½ telefon Samsung Galaxy S7 . . . . . . . . . . . . . . . . . . . 34 4.1 VÃ½vojovÃ½ diagram ovlÃ¡dÃ¡nÃ­ fotoaparÃ¡tu . . . . . . . . . . . . . . . . . 39 4.2 VÃ½vojovÃ½ diagram stavÅ¯ a pÅ™echodÅ¯ tÅ™Ã­dy MediaRecorder . . . . . . . 42 4.3 Pozice bitÅ¯ jednotlivÃ½ch sloÅ¾ek barevnÃ©ho modelu ARGB . . . . . . . 44 4.4 PodvzorkovÃ¡nÃ­ barvonosnÃ½ch sloÅ¾ek formÃ¡tu YUV . . . . . . . . . . . 46 4.5 PrÃ¡ce a sdÃ­lenÃ­ zdrojÅ¯ systÃ©mu Androidu s platformou RenderScript . 49 4.6 Synchronizace audio a video zÃ¡znamu . . . . . . . . . . . . . . . . . . 57 4.7 Å½Ã¡dost o pÅ™idÄ›lenÃ­ oprÃ¡vnÄ›nÃ­ po spuÅ¡tÄ›nÃ­ aplikace . . . . . . . . . . . 60 4.8 GUI aplikace . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61 4.9 PÅ™ipojenÃ­ sluchÃ¡tek pÅ™es 3,5 mm Jack konektor . . . . . . . . . . . . 62 5.1 Filtrace PPG signÃ¡lu . . . . . . . . . . . . . . . . . . . . . . . . . . . 64 5.2 SignÃ¡l FKG po filtraci a obÃ¡lka tohoto signÃ¡lu . . . . . . . . . . . . . 65 5.3 Detekce zÃ¡jmovÃ½ch bodÅ¯ v PPG a FKG signÃ¡lu . . . . . . . . . . . . 68 6.1 KorelaÄnÃ­ diagram mezi í µí±í µí±†í µí±Ÿí µí±’í µí±“ a í µí±í µí±† . . . . . . . . . . . . . . . . . . . . 71

Seznam tabulek
1.1 KrevnÃ­ tlak dle vÄ›ku . . . . . . . . . . . . . . . . . . . . . . . . . . . 13 2.1 Verze operaÄnÃ­ho systÃ©mu Android . . . . . . . . . . . . . . . . . . . 21 6.1 Informace o vyÅ¡etÅ™ovanÃ½ch uÅ¾ivatelÃ­ch . . . . . . . . . . . . . . . . . . 70 6.2 VÃ½sledky jednotlivÃ½ch mÄ›Å™enÃ­ . . . . . . . . . . . . . . . . . . . . . . 70

Seznam vÃ½pisÅ¯
4.1 OprÃ¡vnÄ›nÃ­ potÅ™ebnÃ¡ pro zÃ¡pis a akvizici dat . . . . . . . . . . . . . . 37 4.2 UkÃ¡zka prÃ¡ce se tÅ™Ã­dou CameraManager . . . . . . . . . . . . . . . . 38 4.3 UkÃ¡zka metody onOpened() tÅ™Ã­dy CameraDeviceStateCallback . . . . 40 4.4 UkÃ¡zka metody onReady() tÅ™Ã­dy CameraCaptureSessionStateCallback 41 4.5 Konfigurace tÅ™Ã­dy MediaRecorder . . . . . . . . . . . . . . . . . . . . 43 4.6 Konfigurace tÅ™Ã­dy ImageReader . . . . . . . . . . . . . . . . . . . . . 43 4.7 UkÃ¡zka metody onImageAvailable zpracovÃ¡vajÃ­cÃ­ formÃ¡t JPEG . . . . 45 4.8 UkÃ¡zka metody getAverageValueOfRedChannel() . . . . . . . . . . . . 45 4.9 UkÃ¡zka metody onImageAvailable zpracovÃ¡vajÃ­cÃ­ formÃ¡t YUV . . . . 47 4.10 ZÃ­skÃ¡nÃ­ PPG signÃ¡lu z formÃ¡tu YUV na platformÄ› RenderScript . . . 50 4.11 UkÃ¡zka prÃ¡ce se tÅ™Ã­dou AudioRecord . . . . . . . . . . . . . . . . . . 52 4.12 ZÃ­skÃ¡nÃ­ informacÃ­ o pÅ™ipojenÃ½ch zvukovÃ½ch zaÅ™Ã­zenÃ­ch . . . . . . . . . 53 4.13 UkÃ¡zka se tÅ™Ã­dou AudioTrack . . . . . . . . . . . . . . . . . . . . . . 54 5.1 VÃ½poÄet zpoÅ¾dÄ›nÃ­ a synchronizace PPG a FKG signÃ¡lu . . . . . . . . 66 5.2 VÃ½poÄet hodnoty krevnÃ­ho tlaku . . . . . . . . . . . . . . . . . . . . . 69

Ãšvod
VysokÃ½ krevnÃ­ tlak, neboli hypertenze, je kardiovaskulÃ¡rnÃ­ onemocnÄ›nÃ­, jenÅ¾ je pÅ™Ã­Äinou Äi spoleÄnÃ½m faktorem kardiovaskulÃ¡rnÃ­ch chorob. TÃ­mto onemocnÄ›nÃ­m trpÃ­ ve vÄ›ku mezi 25 a 65 lety 35 % populace. DÅ¯vodem je fakt, Å¾e hypertenze v poÄÃ¡teÄnÃ­m stÃ¡diu nemÃ¡ tÃ©mÄ›Å™ Å¾Ã¡dnÃ© pÅ™Ã­znaky, a proto vÄ›tÅ¡ina postiÅ¾enÃ½ch jedincÅ¯ tento problÃ©m neÅ™eÅ¡Ã­ a nebo o nÄ›m vÅ¯bec nevÃ­. CÃ­lem tÃ©to prÃ¡ce je poskytnout tÄ›mto lidem moÅ¾nost mÄ›Å™enÃ­ krevnÃ­ho tlaku bez vynaloÅ¾enÃ­ nÃ¡kladÅ¯ na poÅ™Ã­zenÃ­ zaÅ™Ã­zenÃ­, kterÃ© je k tomuto ÃºÄelu pÅ™Ã­mo urÄenÃ©.[46]
ChytrÃ© telefony jsou v dneÅ¡nÃ­ dobÄ› vybaveny vÃ½konnÃ½mi procesory, fotoaparÃ¡ty s vysokÃ½m rozliÅ¡enÃ­m, senzory zaznamenÃ¡vajÃ­cÃ­ akcelerometrickÃ¡ data, svÄ›telnÃ½mi senzory a kvalitnÃ­mi mikrofony. Na zÃ¡kladÄ› tohoto vybavenÃ­ je moÅ¾nÃ© snÃ­mat, zpracovÃ¡vat a vyhodnocovat biomedicÃ­nskÃ¡ data.
Stanovit hodnotu krevnÃ­ho tlaku lze za pomoci fotopletysmografie a fonokardiografie. Fotopletysmogram lze nahradit fotoaparÃ¡tem a pÅ™isvÄ›tlovacÃ­ diodou. Fonokardiogram lze zÃ­skat za pomoci mikrofonu telefonu pÅ™iloÅ¾enÃ©ho k hrudi. V obou signÃ¡lech je pak sledovÃ¡n prÅ¯chod pulsnÃ­ vlny. Na zÃ¡kladÄ› prÅ¯chodu pulsnÃ­ vlny arteriÃ¡lnÃ­m Å™eÄiÅ¡tÄ›m lze zjistit hodnotu krevnÃ­ho tlaku.
V prvnÃ­ kapitole tÃ©to prÃ¡ce je popsÃ¡n krevnÃ­ tlak a jeho vlastnosti. TakÃ© je zde popsÃ¡no fungovÃ¡nÃ­ zaÅ™Ã­zenÃ­ a principy metod mÄ›Å™Ã­cÃ­ krevnÃ­ tlak. DruhÃ¡ kapitola popisuje operaÄnÃ­ systÃ©m Android a vÃ½voj aplikacÃ­ na tuto platformu. TÅ™etÃ­ kapitola popisuje metody pro mÄ›Å™enÃ­ hodnoty krevnÃ­ho tlaku pomocÃ­ senzorÅ¯ chytrÃ©ho telefonu, vÃ½poÄet hodnoty krevnÃ­ho tlaku a volbu zaÅ™Ã­zenÃ­ vyhovujÃ­cÃ­ pro tento konkrÃ©tnÃ­ ÃºÄel. Ve ÄtvrtÃ© kapitole je popsÃ¡n vÃ½voj aplikace na operaÄnÃ­ systÃ©m Android umoÅ¾ÅˆujÃ­cÃ­ akvizici dat. PÃ¡tÃ¡ kapitola popisuje zpracovÃ¡nÃ­ namÄ›Å™enÃ½ch zÃ¡znamÅ¯ a stanovenÃ­ hodnoty krevnÃ­ho tlaku.
11

1 KrevnÃ­ tlak
KrevnÃ­ tlak je jeden ze zÃ¡kladnÃ­ch parametrÅ¯, kterÃ© jsou dÅ¯leÅ¾itÃ© pro diagnostiku, Å™Ã­zenÃ­ lÃ©Äby, a hodnocenÃ­ zdravotnÃ­ho stavu kardiovaskulÃ¡rnÃ­ho systÃ©mu. Z toho dÅ¯vodu je mÄ›Å™enÃ­ krevnÃ­ho tlaku jednÃ­m z nejÄastÄ›ji provÃ¡dÄ›nÃ½ch vÃ½konÅ¯ pÅ™i nÃ¡vÅ¡tÄ›vÄ› lÃ©kaÅ™e. KrevnÃ­ tlak odrÃ¡Å¾Ã­ stav psychickÃ© i fyzickÃ© zÃ¡tÄ›Å¾e, proto bÄ›hem dne jeho hodnota vÃ½raznÄ› kolÃ­sÃ¡.[46]

1.1 Tlak krve

ObÄ›hovou soustavu ÄlovÄ›ka lze chÃ¡pat jako uzavÅ™enÃ½ hydrodynamickÃ½ systÃ©m tvoÅ™enÃ½ srdcem, cÃ©vami a krvÃ­. V tomto systÃ©mu zastupuje srdeÄnÃ­ sval svÃ½mi pravidelnÃ½mi stahy funkci pumpy zajiÅ¡Å¥ujÃ­cÃ­ proudÄ›nÃ­ krve elastickÃ½m potrubÃ­m tvoÅ™enÃ½m cÃ©vami. VÃ½sledkem spoluprÃ¡ce srdeÄnÃ­ aktivity a perifernÃ­ho odporu cÃ©v vznikÃ¡ krevnÃ­ tlak definovanÃ½ jako sÃ­la pÅ¯sobÃ­cÃ­ na stÄ›nu cÃ©v, kterÃ½mi proudÃ­ krev. KrevnÃ­ tlak patÅ™Ã­ mezi zÃ¡kladnÃ­ parametry udÃ¡vajÃ­cÃ­ hemodynamickÃ½ stav obÄ›hovÃ© soustavy. V medicÃ­nÄ› se krevnÃ­ tlak udÃ¡vÃ¡ v jednotkÃ¡ch mmHg (milimetr rtuÅ¥ovÃ©ho sloupce) resp. torr. Vztah mezi obecnÄ› pouÅ¾Ã­vanÃ½mi jednotkami tlaku a jednotkami pouÅ¾Ã­vanÃ½mi v medicÃ­nÄ› je uveden v rovnici 1.1.[41]

1 í µí±í µí±¡í µí±š = 101325 í µí±ƒ í µí± = 760 í µí±¡í µí±œí µí±Ÿí µí±Ÿ = 760 í µí±ší µí±ší µí°»í µí±”

(1.1)

Tlak se v rÅ¯znÃ½ch ÄÃ¡stech krevnÃ­ho Å™eÄiÅ¡tÄ› liÅ¡Ã­, a proto je krevnÃ­m tlakem obvykle mÃ­nÄ›n tlak v arteriÃ¡lnÃ­m Å™eÄiÅ¡ti. DÃ¡le se krevnÃ­ tlak mÄ›nÃ­ v prÅ¯bÄ›hu srdeÄnÃ­ho cyklu. SrdeÄnÃ­ cyklus se sklÃ¡dÃ¡ z fÃ¡ze relaxace zvanÃ© diastola a fÃ¡ze kontrakce zvanÃ© systola. KrevnÃ­ tlak kolÃ­sÃ¡ mezi dvÄ›ma extrÃ©my. NejvyÅ¡Å¡Ã­ hodnoty je dosaÅ¾eno pÅ™i systole a nejniÅ¾Å¡Ã­ pÅ™i diastole.[34, 41]
SystolickÃ½ tlak je nejvyÅ¡Å¡Ã­ tlak ve vypuzovacÃ­ fÃ¡zi srdeÄnÃ­ho cyklu. V tÃ©to fÃ¡zi je pÅ™ekonÃ¡n tlak v aortÄ›, coÅ¾ zpÅ¯sobÃ­ otevÅ™enÃ­ polomÄ›sÃ­ÄitÃ½ch chlopnÃ­ a nÃ¡slednÃ© vypuzenÃ­ krve do arteriÃ¡lnÃ­ho Å™eÄiÅ¡tÄ›. Na konci systoly zaÄne tlak v komorÃ¡ch klesat. DÃ­ky vyÅ¡Å¡Ã­mu tlaku v arteriÃ¡lnÃ­m Å™eÄiÅ¡ti jsou uzavÅ™eny polomÄ›sÃ­ÄitÃ© chlopnÄ› a nastÃ¡vÃ¡ tak fÃ¡ze plnÄ›nÃ­ komor. Komory se opÄ›t plnÃ­ krvÃ­, ÄÃ­mÅ¾ klesÃ¡ tlak v arteriÃ¡lnÃ­m Å™eÄiÅ¡ti. DiastolickÃ½ tlak je pak nejniÅ¾Å¡Ã­ tlak ve fÃ¡zi plnÄ›nÃ­ komor.[29, 50, 56]
Krom hodnot systolickÃ©ho (í µí±í µí±†) a diastolickÃ©ho tlaku (í µí±í µí°·) se dÃ¡le pouÅ¾Ã­vÃ¡ hodnota stÅ™ednÃ­ho (í µí±í µí±€ ) a pulsnÃ­ho tlaku (í µí±í µí±ƒ ). PulsnÃ­ tlak lze vypoÄÃ­tat dle vztahu 1.2. StÅ™ednÃ­ tlak lze vypoÄÃ­tat dle vztahu 1.3.[41]

í µí±í µí±ƒ = í µí±í µí±† âˆ’ í µí±í µí°·

í µí±í µí±€

=

í µí±í µí°·

+

í µí±í µí±ƒ 3

(1.2) (1.3)

12

SystolickÃ½ tlak se v prÅ¯bÄ›hu Å¾ivota postupnÄ› zvyÅ¡uje. U kojencÅ¯ a malÃ½ch dÄ›tÃ­ se pohybuje v rozmezÃ­ 80â€“85 mmHg. U vÄ›tÅ¡Ã­ch dÄ›tÃ­ v rozmezÃ­ 110â€“120 mmHg. U dospÄ›lÃ©ho jedince se systolickÃ½ tlak pohybuje v rozsahu 100â€“140 mmHg, pÅ™iÄemÅ¾ tlak 120 mmHg je brÃ¡n jako fyziologickÃ¡ hodnota. DiastolickÃ½ tlak je mÄ›Å™Ã­tkem perifernÃ­ho odporu a nepodlÃ©hÃ¡ vÃ½raznÄ›jÅ¡Ã­m zmÄ›nÃ¡m, jako tlak systolickÃ½. Krom prvnÃ­ch let Å¾ivota, kdy se pohybuje v rozsahu 45â€“50 mmHg, se diastolickÃ½ tlak pohybuje kolem hodnoty 80 mmHg. Hodnoty krevnÃ­ho tlaku v rÅ¯znÃ½ch obdobÃ­ch Å¾ivota jsou uvedeny v tab. 1.1.[42]

Tab. 1.1: KrevnÃ­ tlak dle vÄ›ku [42]

Kojenec VÄ›tÅ¡Ã­ dÃ­tÄ› DospÄ›lÃ½ muÅ¾ DospÄ›lÃ¡ Å¾ena

NormÃ¡lnÃ­ TK [mmHg] 80/45 110/70 120/80 120/80

NÃ­zkÃ½ TK [mmHg] < 80/45 < 110/70 < 100/60 < 100/70

VysokÃ½ TK [mmHg] > 85/50 > 120/80 > 140/90 > 140/90

Krev vypuzenÃ¡ srdcem proudÃ­ v cÃ©vÃ¡ch za fyziologickÃ½ch podmÃ­nek laminÃ¡rnÄ›. LaminÃ¡rnÃ­ proudÄ›nÃ­ je charakteristickÃ© rovnobÄ›Å¾nÃ½m pohybem jednotlivÃ½ch vrstev, pÅ™iÄemÅ¾ se jednotlivÃ© vrstvy pohybujÃ­ rÅ¯znou rychlostÃ­. Vlivem nÃ­zkÃ©ho tÅ™enÃ­ se krev ve stÅ™edu cÃ©vy pohybuje nejrychleji a naopak vlivem vysokÃ©ho tÅ™enÃ­ u stÄ›ny nejpomaleji. Za urÄitÃ½ch podmÃ­nek vznikajÃ­ v krevnÃ­m proudu vÃ­ry a proudÄ›nÃ­ se mÄ›nÃ­ z laminÃ¡rnÃ­ho na turbulentnÃ­. TurbulentnÃ­ proudÄ›nÃ­ je charakteristickÃ© chaotickÃ½m promÃ­chÃ¡vÃ¡nÃ­m vrstev. Vznik vÃ­rÅ¯ pÅ™i turbulentnÃ­m proudÄ›nÃ­ je doprovÃ¡zen zvukovÃ½mi fenomÃ©ny, kterÃ½ch se vyuÅ¾Ã­vÃ¡ u vÄ›tÅ¡iny metod pro mÄ›Å™enÃ­ krevnÃ­ho tlaku.[50, 56]
PÅ™echod z laminÃ¡rnÃ­ho proudÄ›nÃ­ na turbulentnÃ­ pÅ™edpovÃ­dÃ¡ parametr Reynoldsova ÄÃ­sla, kterÃ½ je vypoÄÃ­tÃ¡n dle vztahu 1.4. [29]

í µí±…í µí±’

=

í µí±‘

Â·

í µí±£ í µí¼‚

Â·

í µí¼Œ

(1.4)

Kde, ve vztahu pro proudÄ›nÃ­ krve cÃ©vami, je í µí±‘ prÅ¯mÄ›r cÃ©vy, í µí±£ lineÃ¡rnÃ­ rychlost

proudu krve, í µí¼Œ hustota krve a í µí¼‚ je dynamickÃ¡ viskozita krve. Reynoldsovo ÄÃ­slo je

bezrozmÄ›rnÃ©. Je-li hodnota Reynoldsova ÄÃ­sla vÄ›tÅ¡Ã­ neÅ¾ 200, pak se v proudu objevujÃ­

ojedinÄ›lÃ© turbulence. PÅ™i pÅ™ekroÄenÃ­ hodnoty 1 000 je jiÅ¾ proudÄ›nÃ­ plnÄ› turbulentnÃ­.

ZmÄ›na laminÃ¡rnÃ­ho proudÄ›nÃ­ v turbulentnÃ­ je vyobrazena na obrÃ¡zku 1.1. [29, 56]

13

Obr. 1.1: ZmÄ›na laminÃ¡rnÃ­ho proudÄ›nÃ­ v turbulentnÃ­ [29]
1.2 KonvenÄnÃ­ mÄ›Å™enÃ­ krevnÃ­ho tlaku
KonvenÄnÃ­ metody pro mÄ›Å™enÃ­ krevnÃ­ho tlaku lze rozdÄ›lit dle zÃ¡sahu do organismu na invazivnÃ­ (pÅ™Ã­mÃ©) a neinvazivnÃ­ (nepÅ™Ã­mÃ©). PÅ™i invazivnÃ­m mÄ›Å™enÃ­ je nutnÃ½ pÅ™Ã­mÃ½ kontakt s krevnÃ­m Å™eÄiÅ¡tÄ›m. Toho je dosaÅ¾eno naruÅ¡enÃ­m cÃ©vnÃ­ stÄ›ny pomocÃ­ jehly Äi katetru. DÃ­ky tomu je moÅ¾nÃ© mÄ›Å™it tlak v perifernÃ­ch ÄÃ¡stech cÃ©vnÃ­ho Å™eÄiÅ¡tÄ›. PÅ™Ã­mÃ© metody jsou vhodnÃ© pro mÄ›Å™enÃ­ dynamickÃ½ch zmÄ›n krevnÃ­ho tlaku a zÃ­skÃ¡nÃ­ velmi pÅ™esnÃ½ch hodnot. Naopak neinvazivnÃ­ metody zÃ­skÃ¡vajÃ­ data z povrchu tÄ›la. Obvyklou souÄÃ¡stÃ­ nepÅ™Ã­mÃ½ch metod je pouÅ¾itÃ­ tlakovÃ© manÅ¾ety omezujÃ­cÃ­ prÅ¯tok krve v mÄ›Å™enÃ©m mÃ­stÄ›, coÅ¾ zpÅ¯sobÃ­ zÃºÅ¾enÃ­ cÃ©vy a vznik turbulentnÃ­ho proudÄ›nÃ­.[41]
JelikoÅ¾ se praktickÃ¡ ÄÃ¡st tÃ©to prÃ¡ce zamÄ›Å™uje na zhotovenÃ­ neinvazivnÃ­ metody mÄ›Å™enÃ­ krevnÃ­ho tlaku pomocÃ­ mobilnÃ­ho telefonu, nejsou v tÃ©to prÃ¡ci rozebrÃ¡ny metody invazivnÃ­.
NeinvazivnÃ­ mÄ›Å™enÃ­ krevnÃ­ho tlaku je dnes nejpouÅ¾Ã­vanÄ›jÅ¡Ã­ metodou pro jeho stanovenÃ­. HlavnÃ­m dÅ¯vodem je Å¡etrnost vÅ¯Äi pacientovi a ÄasovÃ¡ nenÃ¡roÄnost. VÄ›tÅ¡ina neinvazivnÃ­ch metod je nespojitÃ¡.[41]
1.2.1 PalpaÄnÃ­ metoda
JednÃ¡ se o velmi jednoduchou manuÃ¡lnÃ­ metodu, pro jejÃ­Å¾ provedenÃ­ je nutnÃ½ pouze tonometr. ManÅ¾eta je umÃ­stÄ›na nad loket ruky pacienta. Na zÃ¡pÄ›stÃ­ tÃ©Å¾e ruky je
14

nahmatÃ¡n puls na vÅ™etennÃ­ tepnÄ› (arteria radialis). NafouknutÃ­m manÅ¾ety nad hodnotu systolickÃ©ho tlaku dojde k uzavÅ™enÃ­ paÅ¾nÃ­ tepny (arteria brachialis), ÄÃ­mÅ¾ vymizÃ­ pulsace na tepnÄ› vÅ™etennÃ­. PostupnÃ½m upouÅ¡tÄ›nÃ­m manÅ¾ety dojde k obnovenÃ­ pulsace. Hodnota odeÄtenÃ¡ ze stupnice tonometru pÅ™i obnovenÃ­ pulsace pak odpovÃ­dÃ¡ hodnotÄ› systolickÃ©ho tlaku. NevÃ½hodou tÃ©to metody je nemoÅ¾nost stanovenÃ­ hodnoty tlaku diastolickÃ©ho.[27]
1.2.2 AuskultaÄnÃ­ metoda
Princip tÃ©to metody je v zÃ¡kladu podobnÃ½ metodÄ› palpaÄnÃ­. RozdÃ­lem je detekce akustickÃ½ch fenomÃ©nÅ¯ za pomoci fonendoskopu mÃ­sto sledovÃ¡nÃ­ pulsace. Hlavice fonendoskopu je zasunuta pod tlakovou manÅ¾etu, Äi je pÅ™iloÅ¾ena distÃ¡lnÄ› nad arterii. PÅ™ed nafouknutÃ­m manÅ¾ety je nahmatÃ¡n puls na vÅ™etennÃ­ tepnÄ›. TlakovÃ¡ manÅ¾eta je nafukovÃ¡na do vymizenÃ­ pulsace. Tlak z manÅ¾ety je postupnÄ› odpouÅ¡tÄ›n (rychlostÃ­ 2â€“3 mmHg/s). PrvnÃ­ slyÅ¡itelnÃ© zvuky jsou znÃ¡mkou prÅ¯toku krve arteriÃ­, kterÃ½m odpovÃ­dÃ¡ hodnota systolickÃ©ho tlaku. ManÅ¾eta je dÃ¡le upouÅ¡tÄ›na, pÅ™iÄemÅ¾ se akustickÃ© fenomÃ©ny zesilujÃ­. Po dosaÅ¾enÃ­ urÄitÃ©ho maxima se zaÄne hlasitost fenomÃ©nÅ¯ zeslabovat, aÅ¾ ÃºplnÄ› zaniknou. Tato hodnota odpovÃ­dÃ¡ tlaku diastolickÃ©mu.[34, 41, 46]
VÃ½Å¡e zmÃ­nÄ›nÃ© akustickÃ© fenomÃ©ny byly objeveny v roce 1905 ruskÃ½m chirurgem Nikolajem SergejeviÄem Korotkovem â€“ Korotkovovy fenomÃ©ny. Za vznik tÄ›chto fenomÃ©nÅ¯ je povaÅ¾ovÃ¡na zmÄ›na laminÃ¡rnÃ­ho proudÄ›nÃ­ na turbulentnÃ­ a takÃ© naopak turbulentnÃ­ho v laminÃ¡rnÃ­ v dÅ¯sledkÅ¯ zÃºÅ¾enÃ­ mÃ­sta arterie natlakovanou manÅ¾etou. Korotkovy fenomÃ©ny je moÅ¾nÃ© rozdÄ›lit do 5 navazujÃ­cÃ­ch fÃ¡zÃ­.[46]
I. PrvnÃ­ jasnÃ½ tÃ³n pÅ™ipomÃ­najÃ­cÃ­ kapajÃ­cÃ­ kohoutek (zÃ¡roveÅˆ se objevuje pulsace). II. TÃ³ny majÃ­ charakter Å¡elestu (delÅ¡Ã­ a tlumenÄ›jÅ¡Ã­). III. Hlasitost tÃ³nÅ¯ dosahuje maxima (ostrÃ© a hlasitÃ©). IV. DochÃ¡zÃ­ k oslabenÃ­ tÃ³nÅ¯ (mÃ©nÄ› zÅ™etelnÃ©, mÄ›kkÃ© a tlumenÃ©). V. VymizenÃ­ tÃ³nÅ¯.
SystolickÃ½ tlak pak odpovÃ­dÃ¡ hodnotÄ› na stupnici tonometru pÅ™i prvnÃ­ fÃ¡zi KorotkovovÃ½ch fenomÃ©nÅ¯ a diastolickÃ½ tlak pÅ™i fÃ¡zi pÃ¡tÃ©. Princip auskultaÄnÃ­ metody je vyobrazen na obrÃ¡zku 1.2.[41]
AuskultaÄnÃ­ metoda je nejspolehlivÄ›jÅ¡Ã­ a nejvyuÅ¾Ã­vanÄ›jÅ¡Ã­ metodou pro stanovenÃ­ hodnoty krevnÃ­ho tlaku. V oblasti kardiologie je povaÅ¾ovÃ¡na za referenÄnÃ­. Metoda vyuÅ¾Ã­vÃ¡ minimum pÅ™Ã­strojÅ¯ a je mÃ©nÄ› technologicky nÃ¡roÄnÃ¡. I pÅ™esto jsou zde urÄitÃ¡ omezenÃ­ a zdroje chyb: obtÃ­Å¾nÄ› se zÃ­skÃ¡vajÃ­ hodnoty v hluÄnÃ©m prostÅ™edÃ­, je velmi zÃ¡vislÃ¡ na zruÄnosti osoby provÃ¡dÄ›jÃ­cÃ­ mÄ›Å™enÃ­ a takÃ© na volbÄ› sprÃ¡vnÃ©ho rozmÄ›ru tlakovÃ© manÅ¾ety.[34, 41, 46]
15

Obr. 1.2: Princip auskultaÄnÃ­ metody. [41]

1.2.3 OscilometrickÃ¡ metoda
Metoda je zaloÅ¾ena na snÃ­mÃ¡nÃ­ tlakovÃ½ch zmÄ›n uvnitÅ™ manÅ¾ety, kterÃ½m odpovÃ­dajÃ­ pulsace artÃ©rie. Velikost tÄ›chto pulsacÃ­ je dÃ¡na hodnotou transmurÃ¡lnÃ­ho tlaku, kterÃ½ je dÃ¡n rozdÃ­lem tlaku uvnitÅ™ a vnÄ› tepny. TransmurÃ¡lnÃ­ho tlak lze vypoÄÃ­tat dle vztahu 1.5.[27]

í µí±í µí±¡í µí±Ÿí µí±í µí±›í µí± í µí±ší µí±¢í µí±ŸÃ¡í µí±™í µí±›Ã­ = í µí±í µí±˜í µí±Ÿí µí±£í µí±’ âˆ’ (í µí±í µí±¡í µí±˜Ã¡í µí±›Ã­ + í µí±í µí±ší µí±í µí±›Å¾í µí±’í µí±¡í µí±¦)

(1.5)

Kde tlak uvnitÅ™ arterie (vnitÅ™nÃ­) je dÃ¡n pÅ™Ã­mo tlakem krve vypuzovanÃ© srdcem. Tlak vnÄ› arterie (vnÄ›jÅ¡Ã­) je dÃ¡n pÅ¯sobenÃ­m okolnÃ­ch tkÃ¡nÃ­ (svaly, kÅ¯Å¾e apod.) a tlakem manÅ¾ety. Tlak okolnÃ­ch tkÃ¡nÃ­ lze zanedbat vzhledem k podstatnÄ› vÄ›tÅ¡Ã­mu tlaku v manÅ¾etÄ›. Ta je skrz okolnÃ­ tkÃ¡Åˆ v tÄ›snÃ©m kontaktu s artÃ©riÃ­. SpoleÄnÄ› tvoÅ™Ã­ mechanickou soustavu, pÅ™es kterou jsou pÅ™enÃ¡Å¡eny oscilace na tlakovÃ½ senzor.[27]
PÅ™i zvÃ½Å¡enÃ­ vnÄ›jÅ¡Ã­ho tlaku (nafouknutÃ­ manÅ¾ety) nad hodnotu tlaku vnitÅ™nÃ­ho je artÃ©rie uzavÅ™ena. PostupnÃ½m sniÅ¾ovÃ¡nÃ­m vnÄ›jÅ¡Ã­ho tlaku dojde k opÄ›tovnÃ©mu prÅ¯chodu krve artÃ©riÃ­ a vzniku oscilacÃ­, jejichÅ¾ amplituda postupnÄ› narÅ¯stÃ¡. PÅ™i urÄitÃ© hodnotÄ› vnÄ›jÅ¡Ã­ho tlaku dosahujÃ­ oscilace maxima amplitudy. Maximum odpovÃ­dÃ¡ stÅ™ednÃ­ hodnotÄ› arteriÃ¡lnÃ­ho tlaku. Po pÅ™ekroÄenÃ­ tÃ©to hodnoty amplituda oscilacÃ­ klesÃ¡, aÅ¾ ÃºplnÄ› vymizÃ­.[27, 41]

16

Pro urÄenÃ­ hodnot systolickÃ©ho a diastolickÃ©ho tlaku je prÅ¯bÄ›h oscilacÃ­ filtrovÃ¡n filtrem typu hornÃ­ propust a nÃ¡slednÄ› je detekovÃ¡na obÃ¡lka. DerivacÃ­ obÃ¡lky vznikajÃ­ dva extrÃ©my. PÅ™enesenÃ­m bodu s nejvyÅ¡Å¡Ã­ hodnotou na prÅ¯bÄ›h tlaku v manÅ¾etÄ› nalezneme hodnotu systolickÃ©ho tlaku. DiastolickÃ½ tlak je pak nalezen pÅ™enesenÃ­m bodu s nejniÅ¾Å¡Ã­ hodnotou na prÅ¯bÄ›h tlaku v manÅ¾etÄ›. ÄŒasovÃ½ prÅ¯bÄ›h signÃ¡lu z tlakovÃ© manÅ¾ety a jeho zpracovÃ¡nÃ­ je vyobrazeno na obrÃ¡zku 1.3.[27, 41]

Obr. 1.3: ÄŒasovÃ½ prÅ¯bÄ›h signÃ¡lu z tlakovÃ© manÅ¾ety a jeho zpracovÃ¡nÃ­.[41]

Tuto metodu dnes vyuÅ¾Ã­vÃ¡ Å™ada dostupnÃ½ch tonometrÅ¯. Je vhodnÃ¡ i pro dlouhodobÃ© monitorovÃ¡nÃ­, ale je velmi citlivÃ¡ na pohyby pacienta v prÅ¯bÄ›hu mÄ›Å™enÃ­. Oproti auskultaÄnÃ­ metodÄ› nenÃ­ zÃ¡vislÃ¡ na okolnÃ­m zvuku.[41]

1.2.4 UltrazvukovÃ¡ metoda

UltrazvukovÃ¡ metoda vyuÅ¾Ã­vÃ¡ principu Dopplerova jevu. StejnÄ› jako u pÅ™edchozÃ­ch metod je vyuÅ¾ito tlakovÃ© manÅ¾ety, pod kterou je ovÅ¡em upevnÄ›no ultrazvukovÃ© vysÃ­lacÃ­ a pÅ™ijÃ­macÃ­ zaÅ™Ã­zenÃ­. VyslanÃ½ ultrazvukovÃ½ signÃ¡l se dostÃ¡vÃ¡ skrz tkÃ¡nÄ› aÅ¾ k artÃ©rii, kde se ÄÃ¡steÄnÄ› odrÃ¡Å¾Ã­ od pohybujÃ­cÃ­ se stÄ›ny artÃ©rie a krevnÃ­ch elementÅ¯ (obzvlÃ¡Å¡tÄ› ÄervenÃ½ch krvinek). DochÃ¡zÃ­ ke zmÄ›nÄ› frekvence, kterÃ¡ je zachycena pÅ™ijÃ­maÄem. Velikost zmÄ›ny je dÃ¡na vztahem 1.6.[27]

í µí±“í µí°·

=

2í µí±£í µí±“0

Â· í µí±í µí±œí µí± (í µí»¼) í µí±

(1.6)

17

Kde í µí±£ je rychlost prÅ¯toku krve, í µí»¼ je dopplerovskÃ½ Ãºhel, í µí±“0 je frekvence vlnÄ›nÃ­ vysÃ­laÄe a í µí± je rychlost Å¡Ã­Å™enÃ­ ultrazvukovÃ© vlny ve tkÃ¡ni. [27]
PÅ™i tlaku manÅ¾ety v rozmezÃ­ systolickÃ©ho a diastolickÃ©ho tlaku jsou detekovÃ¡ny dva signÃ¡ly, kterÃ© odpovÃ­dajÃ­ otevÃ­rÃ¡nÃ­ a uzavÃ­rÃ¡nÃ­ artÃ©rie. Je-li tlak v manÅ¾etÄ› vyÅ¡Å¡Ã­ neÅ¾ tlak systolickÃ½ je artÃ©rie uzavÅ™ena, pokud je niÅ¾Å¡Ã­, je artÃ©rie otevÅ™ena. PÅ™i zvyÅ¡ovÃ¡nÃ­ tlaku v manÅ¾etÄ› se budou oba signÃ¡ly vzÃ¡jemnÄ› pÅ™ibliÅ¾ovat, aÅ¾ dojde k jejich splynutÃ­. Toto splynutÃ­ pak odpovÃ­dÃ¡ hodnotÄ› systolickÃ©ho tlaku. OpaÄnÄ› je tomu pÅ™i sniÅ¾ovÃ¡nÃ­ tlaku v manÅ¾etÄ›, kdy se oba signÃ¡ly od sebe vzÃ¡jemnÄ› vzdalujÃ­, aÅ¾ dojde k vymizenÃ­ jednoho z nich. Tento okamÅ¾ik pak odpovÃ­dÃ¡ hodnotÄ› diastolickÃ©ho tlaku. Princip ultrazvukovÃ© metody je vyobrazen na obrÃ¡zku 1.6.[27]
Obr. 1.4: Princip ultrazvukovÃ© (Dopplerovy) metody.[27]
1.2.5 FotopletysmografickÃ¡ metoda
Tato metoda byla vyvinuta ÄeskÃ½m profesorem Janem PeÅˆÃ¡zem. JednÃ¡ se o zpÅ¯sob spojitÃ©ho mÄ›Å™enÃ­ krevnÃ­ho tlaku. Na rozdÃ­l od pÅ™edchozÃ­ch metod vyuÅ¾Ã­vajÃ­cÃ­ch tlakovÃ© manÅ¾ety, kterÃ¡ je v tomto pÅ™Ã­padÄ› umÃ­stÄ›na na prstu, je u tÃ©to metody vÅ¾dy zajiÅ¡tÄ›n alespoÅˆ minimÃ¡lnÃ­ prÅ¯tok krve. ManÅ¾eta je navÃ­c vybavena infraÄervenou diodou o vlnovÃ© dÃ©lce 940 nm a fotoÄlÃ¡nkem. VlnovÃ¡ dÃ©lka 940 nm je velmi dobÅ™e absorbovÃ¡na oxyhemoglobinem, kterÃ½ je obsaÅ¾en v okysliÄenÃ© krvi. Tlak v manÅ¾etÄ› je Å™Ã­zen zpÄ›tnovazebnÃ­m regulaÄnÃ­m systÃ©mem, tak aby se nemÄ›nila intenzita svÄ›tla
18

a objem krve v prstu zÅ¯stal konstantnÃ­. Pulzace manÅ¾ety jsou sledovÃ¡ny a vyhodnocovÃ¡ny fotopletysmografickou soustavou. Metoda je obvykle vyuÅ¾Ã­vÃ¡na u pacientÅ¯, kteÅ™Ã­ jsou v klidu, jelikoÅ¾ je velmi citlivÃ¡ na pohyb.[41]
19

2 OperaÄnÃ­ systÃ©m Android
Tato kapitola pojednÃ¡vÃ¡ o vÃ½voji aplikacÃ­ bÄ›Å¾Ã­cÃ­ch na platformÄ› Android. V nÃ¡sledujÃ­cÃ­ch sekcÃ­ch jsou shrnuty zÃ¡kladnÃ­ poznatky o operaÄnÃ­m systÃ©mu Android a jeho architektuÅ™e. DÃ¡le je popsÃ¡no vÃ½vojovÃ© prostÅ™edÃ­ Android Studio vÄetnÄ› nÃ¡strojÅ¯ potÅ™ebnÃ½ch pro vÃ½voj aplikacÃ­. Kapitola objasÅˆuje pojmy, kterÃ© jsou dÅ¯leÅ¾itÃ© pro nÃ¡slednÃ½ vÃ½voj aplikace.
2.1 Platforma Android
V souÄasnÃ© dobÄ› je Android nejrychleji rostoucÃ­, nejrozÅ¡Ã­Å™enÄ›jÅ¡Ã­ a otevÅ™enÃ½ (open source) mobilnÃ­ operaÄnÃ­ systÃ©m. Je zaloÅ¾enÃ½ na linuxovÃ©m jÃ¡dÅ™e. O vÃ½voj tohoto operaÄnÃ­ch systÃ©mu se v souÄasnÃ© dobÄ› starÃ¡ spoleÄnost Google. Android je primÃ¡rnÄ› urÄen pro mobilnÃ­ zaÅ™Ã­zenÃ­, jako jsou chytrÃ© telefony, tablety, nositelnosti (hodinky, sport testery) a jinÃ©.
PÅ¯vodnÃ­ spoleÄnost Android Inc. byla zaloÅ¾ena ÄtveÅ™icÃ­ vÃ½vojÃ¡Å™Å¯ v roce 2003. PÅ¯vodnÃ­m cÃ­lem bylo navrhnout a vyvinout operaÄnÃ­ systÃ©m pro digitÃ¡lnÃ­ fotoaparÃ¡ty. OvÅ¡em v tÃ© dobÄ› nebyl tento trh pÅ™Ã­liÅ¡ rozÅ¡Ã­Å™enÃ½, proto zapoÄali vÃ½voj operaÄnÃ­ho systÃ©mu pro mobilnÃ­ zaÅ™Ã­zenÃ­.
V roce 2005 spoleÄnost Android Inc. odkoupila spoleÄnost Google, jehoÅ¾ cÃ­lem bylo prorazit na trh s mobilnÃ­mi zaÅ™Ã­zenÃ­mi. V roce 2007 Google zaloÅ¾il konsorcium OHA (Open Handset Alliance), pod kterÃ© spadajÃ­ vÃ½robci mobilnÃ­ch telefonÅ¯, telekomunikaÄnÃ­ operÃ¡toÅ™i a technologickÃ© firmy, jejichÅ¾ cÃ­lem bylo vytvoÅ™it novÃ½ systÃ©m pro mobilnÃ­ zaÅ™Ã­zenÃ­. Android Alpha byl nÃ¡zev prvnÃ­ verze rozÅ¡iÅ™itelnÃ©ho a flexibilnÃ­ho operaÄnÃ­ho systÃ©mu, zaloÅ¾enÃ©ho na linuxovÃ©m jÃ¡dÅ™e. Aplikace bÄ›Å¾Ã­cÃ­ na tÃ©to platformÄ› byly napsanÃ© v programovacÃ­m jazyce Java. PÅ™i vÃ½voji byly kladeny poÅ¾adavky, aby bylo moÅ¾nÃ© systÃ©m integrovat do souÄasnÃ½ch, ale i novÃ½ch mobilnÃ­ch telefonÅ¯. Od roku 2007 proÅ¡el Android velkÃ½m mnoÅ¾stvÃ­m zmÄ›n, kterÃ© zdokonalily tento operaÄnÃ­ systÃ©m.[4, 39]
2.2 Verze operaÄnÃ­ho systÃ©mu
OperaÄnÃ­ systÃ©m Android se neustÃ¡le vyvÃ­jÃ­ a je rozÅ¡iÅ™ovÃ¡n o novÃ© funkce. VyÅ¾itÃ­ tohoto operaÄnÃ­ho systÃ©mu je v mobilnÃ­ch zaÅ™Ã­zenÃ­ch ÄÃ­m dÃ¡l ÄastÄ›jÅ¡Ã­. HlavnÃ­m dÅ¯vodem je neustÃ¡le se zvÄ›tÅ¡ujÃ­cÃ­ obchod s aplikacemi, zvanÃ½ Google Play, a velmi pÅ™Ã­jemnÃ© uÅ¾ivatelskÃ© prostÅ™edÃ­.
VyuÅ¾itÃ­ jednotlivÃ½ch verzÃ­ operaÄnÃ­ho systÃ©mu Android je uvedeno v tab.2.1. Data byla naposledy aktualizovÃ¡na 9. 11. 2017. Z tabulky je patrnÃ©, Å¾e starÅ¡Ã­ch verzÃ­ postupnÄ› ubÃ½vÃ¡. V tabulce nejsou zobrazeny verze systÃ©mu se souÄasnÃ½m vyuÅ¾itÃ­m
20

menÅ¡Ã­m neÅ¾ 0,1 %. StarÅ¡Ã­ verze postupnÄ› ztrÃ¡cejÃ­ podporu, jsou pomalÃ© a nemajÃ­ velkÃ© mnoÅ¾stvÃ­ dostupnÃ½ch aplikacÃ­, jako verze novÃ©. AktuÃ¡lnÄ› nejpouÅ¾Ã­vanÄ›jÅ¡Ã­ verze operaÄnÃ­ho systÃ©mu Android nese nÃ¡zev Marshmallow a verzovÃ© oznaÄenÃ­ 6.0.[24]

Tab. 2.1: Verze operaÄnÃ­ho systÃ©mu Android [24]

Verze

OznaÄenÃ­

API VyuÅ¾itÃ­

2.3.3 - 2.3.7 Gingerbread

10 0.5 %

4.0.3 - 4.0.4 Ice Cream Sandwich 15 0.5 %

4.1.x

Jelly Bean

16 2.2 %

4.2.x

17 3.1 %

4.3

18 0.9 %

4.4

KitKat

19 13.8 %

5.0

Lollipop

21 6.4 %

5.1

22 20.8 %

6.0

Marshmallow

23 30.9 %

7.0

Nougat

24 17.6 %

7.1

25 3.0 %

8.0

Oreo

26 0.3 %

2.3 Architektura operaÄnÃ­ho systÃ©mu
Pro vÃ½voj aplikacÃ­ je nutnÃ© seznÃ¡mit se se zÃ¡kladnÃ­mi informacemi o architektuÅ™e operaÄnÃ­ho systÃ©mu a jeho principech. OperaÄnÃ­ systÃ©m Android se sklÃ¡dÃ¡ z 5 hlavnÃ­ch vrstev, kterÃ½mi jsou Linux Kernel, Libraries, Android Runtime, Application Framework a Applications.[43]
Linux Kernel
NejniÅ¾Å¡Ã­ vrstvou operaÄnÃ­ho systÃ©mu Android je upravenÃ© linuxovÃ© jÃ¡dro. PÅ¯vodnÃ­ jÃ¡dro populÃ¡rnÃ­ho operaÄnÃ­ho systÃ©mu Linux obsahovalo pÅ™Ã­liÅ¡ mnoho funkcÃ­, kterÃ© na mobilnÃ­ch zaÅ™Ã­zenÃ­ch nelze vyuÅ¾Ã­t. Proto bylo nutnÃ© provÃ©st jejich redukci. SamotnÃ© jÃ¡dro zajiÅ¡Å¥uje pÅ™Ã­mou komunikaci s hardwarem mobilnÃ­ho zaÅ™Ã­zenÃ­. TÃ©Å¾ zajiÅ¡Å¥uje sprÃ¡vu pamÄ›ti a procesÅ¯, zÃ¡kladnÃ­ sÃ­Å¥ovou vrstvu a rÅ¯znÃ© hardwarovÃ© ovladaÄe pro komunikaci s perifÃ©riemi.[43]
JelikoÅ¾ Android mÅ¯Å¾e bÄ›Å¾et na spoustÄ› rÅ¯znÃ½ch zaÅ™Ã­zenÃ­ (hardwarovÄ› se liÅ¡Ã­cÃ­ch), bylo nutnÃ© na Ãºrovni jÃ¡dra vytvoÅ™it vrstvu HAL (Hardware Abstraction Layer), jenÅ¾ vytvÃ¡Å™Ã­ rozhranÃ­ pro komunikaci vyÅ¡Å¡Ã­ch vrstev systÃ©mu s hardwarem. DÃ­ky tomu

21

nenÃ­ nutnÃ©, aby vÃ½vojÃ¡Å™ znal pÅ™esnou hardwarovou specifikaci zaÅ™Ã­zenÃ­, pro kterou aplikaci vyvÃ­jÃ­.[43]
Libraries Nad jÃ¡drem se nachÃ¡zÃ­ vrstva nativnÃ­ch knihoven napsanÃ½ch v jazyce C Äi C++. Ty tvoÅ™Ã­ mezivrstvu mezi linuxovÃ½m jÃ¡drem a vyÅ¡Å¡Ã­mi vrstvami. Aplikace, kterÃ© pracujÃ­ s daty, zde mohou napÅ™Ã­klad vyuÅ¾Ã­t relaÄnÃ­ databÃ¡zovÃ½ systÃ©m SQLite. TaktÃ©Å¾ jsou zde grafickÃ© knihovny, knihovny mÃ©diÃ­ a spousty dalÅ¡Ã­ch. Tato vrstva nahrazuje funkcionalitu, o kterou bylo jÃ¡dro redukovÃ¡no.[43]
Android Runtime ATR (Android Runtime) je virtuÃ¡lnÃ­ stroj, kterÃ½ vytvÃ¡Å™Ã­ bÄ›hovÃ© prostÅ™edÃ­ pro spuÅ¡tÄ›nÃ© aplikace napsanÃ© v jazyce Java. KaÅ¾dÃ¡ aplikace v systÃ©mu funguje jako samostatnÃ½ proces, kterÃ½ vyuÅ¾Ã­vÃ¡ vlastnÃ­ instanci virtuÃ¡lnÃ­ho stroje.[43]
Application Framework DalÅ¡Ã­ vrstva, ze kterÃ© je operaÄnÃ­ systÃ©m Android sestaven je softwarovÃ¡ struktura poskytujÃ­cÃ­ opakovatelnÄ› pouÅ¾itelnÃ½ software (ovlÃ¡dacÃ­ prvky, ikony), pÅ™Ã­stup k sluÅ¾bÃ¡m a manaÅ¾erÅ¯m systÃ©mu. JednÃ¡ se tedy o nejdÅ¯leÅ¾itÄ›jÅ¡Ã­ vrstvu pro vÃ½vojÃ¡Å™e.[43]
Applications NejvyÅ¡Å¡Ã­ vrstvu architektury operaÄnÃ­ho systÃ©mu Android tvoÅ™Ã­ aplikace samotnÃ©. ObecnÄ› mÅ¯Å¾eme aplikace rozdÄ›lit na dva druhy. PrvnÃ­m z nich jsou systÃ©movÃ© aplikace, kterÃ© slouÅ¾Ã­ na telefonovÃ¡nÃ­, sprÃ¡vu kontaktÅ¯, pÅ™ijÃ­mÃ¡nÃ­ zprÃ¡v, fotografovÃ¡nÃ­ a podobnÄ›. DruhÃ½m druhem jsou aplikace uÅ¾ivatelem doinstalovanÃ©. JednÃ¡ se o aplikace staÅ¾enÃ© z obchodu Google Play Äi manuÃ¡lnÄ› nainstalovanÃ©.[43]
2.4 VÃ½voj aplikacÃ­ pro platformu Android
Aplikace pro platformu Android mohou bÃ½t vyvÃ­jeny v rÅ¯znÃ½ch programovacÃ­ch jazycÃ­ch Äi jejich kombinacemi. AktuÃ¡lnÄ› je moÅ¾nÃ© vyvÃ­jet android aplikace v programovacÃ­m jazyce Kotlin, Java Äi C++.[8, 43]
2.4.1 VÃ½vojovÃ© prostÅ™edÃ­
NeoddÄ›litelnou souÄÃ¡stÃ­ vÃ½voje je i volba vÃ½vojovÃ©ho prostÅ™edÃ­. V souÄasnÃ© dobÄ› lze aplikace bÄ›Å¾Ã­cÃ­ na platformÄ› Android vyvÃ­jet v rÅ¯znÃ½ch prostÅ™edÃ­ch. Mezi nejvÃ­ce rozÅ¡Ã­Å™enÃ¡ vÃ½vojovÃ¡ prostÅ™edÃ­ patÅ™Ã­ Android Studio a Eclipse. Do nedÃ¡vna bylo
22

oficiÃ¡lnÃ­m vÃ½vojovÃ½m prostÅ™edÃ­m Eclipse. JednÃ¡ se o flexibilnÃ­ vÃ½vojovÃ© prostÅ™edÃ­, kterÃ© umoÅ¾Åˆuje nainstalovat doplÅˆky pro dalÅ¡Ã­ programovacÃ­ jazyky, kterÃ½mi jsou napÅ™Ã­klad PHP, Python, Ruby, C++ a dalÅ¡Ã­. PrÃ¡vÄ› dÃ­ky flexibilitÄ› a jednotnÃ©mu prostÅ™edÃ­ je mezi vÃ½vojÃ¡Å™i oblÃ­benÃ©. Pro vÃ½voj v prostÅ™edÃ­ Eclipse je nutnÃ© stÃ¡hnout plugin ADT (Android Development Tools), kterÃ½ umoÅ¾Åˆuje pracovat s aplikacemi na platformÄ› Android. Vzhledem k nÃ¡roÄnosti konfigurace nenÃ­ toto vÃ½vojovÃ© prostÅ™edÃ­ zaÄÃ¡teÄnÃ­kÅ¯m doporuÄovÃ¡no.[43]
Android Studio je oficiÃ¡lnÃ­ vÃ½vojovÃ© prostÅ™edÃ­ zaloÅ¾enÃ© na IntelliJ IDEA, urÄenÃ© primÃ¡rnÄ› pro vÃ½voj aplikacÃ­ na platformu Android od spoleÄnosti Google. Je volnÄ› dostupnÃ© a multiplatformnÃ­. Instalace je velmi jednoduchÃ¡ - nenÃ­ tÅ™eba doinstalovÃ¡vat pluginy, na rozdÃ­l od Eclipse. SouÄÃ¡stÃ­ instalaÄnÃ­ho balÃ­Äku je Android Studio IDE (Integrated Development Environment), Android SDK Tools, kompilÃ¡tor a zÃ¡kladnÃ­ emulÃ¡tor. VÃ½vojovÃ© prostÅ™edÃ­ po nainstalovÃ¡nÃ­, spuÅ¡tÄ›nÃ­ a zaloÅ¾enÃ­ projektu je vyobrazeno na obr. 2.1.[5, 43, 45]
Obr. 2.1: VÃ½vojovÃ© prostÅ™edÃ­ Android Studio
2.4.2 ZÃ¡klady aplikace
ZÃ¡kladnÃ­mi stavebnÃ­mi prvky jsou komponenty realizovanÃ© jako tÅ™Ã­dy. KaÅ¾dÃ¡ komponenta slouÅ¾Ã­ jako vstupnÃ­ bod skrz kterÃ½ mÅ¯Å¾e systÃ©m nebo uÅ¾ivatel vstoupit do aplikace. ExistujÃ­ ÄtyÅ™i rÅ¯znÃ© druhy komponent, pÅ™iÄemÅ¾ nÄ›kterÃ© jsou zÃ¡vislÃ© na ostatnÃ­ch.[8]
23

â€¢ Aktivity (Activities) â€¢ SluÅ¾by (Services) â€¢ PosluchaÄe (Broadcast receivers) â€¢ PoskytovatelÃ© obsahu (Content providers)
KaÅ¾dÃ¡ z tÄ›chto komponent slouÅ¾Ã­ k jinÃ©mu ÃºÄelu a mÃ¡ odliÅ¡nÃ½ Å¾ivotnÃ­ cyklus, kterÃ½ urÄuje jak je komponenta vytvoÅ™ena a zniÄena.[8]
Aktivity
Aktivity jsou stavebnÃ­mi bloky uÅ¾ivatelskÃ©ho rozhranÃ­. Jsou hierarchicky uspoÅ™Ã¡danÃ©. Po spuÅ¡tÄ›nÃ­ aplikace se tedy otevÅ™e hlavnÃ­ spouÅ¡tÄ›cÃ­ aktivita, ze kterÃ© jsou v pÅ™Ã­padÄ› potÅ™eby spouÅ¡tÄ›ny dalÅ¡Ã­ aktivity. Jedna aktivita odpovÃ­dÃ¡ prÃ¡vÄ› jednÃ© obrazovce, a proto aplikace obvykle obsahujÃ­ vÃ­ce aktivit, mezi kterÃ½mi se uÅ¾ivatel pÅ™epÃ­nÃ¡. KaÅ¾dÃ¡ aktivita by mÄ›la mÃ­t svÅ¯j konkrÃ©tnÃ­ ÃºÄel. TÃ­m je myÅ¡leno napÅ™Ã­klad vyplnÄ›nÃ­ formulÃ¡Å™e, nastavenÃ­ parametrÅ¯ Äi vybrÃ¡nÃ­ poloÅ¾ky ze seznamu. Aktivita tedy definuje GUI (Graphical User Interface), pÅ™es kterÃ© je zajiÅ¡tÄ›na interakce uÅ¾ivatel-aplikace a opaÄnÄ›.[8]
SluÅ¾by
SluÅ¾by jsou komponenty, kterÃ© bÄ›Å¾Ã­ na pozadÃ­ a provÃ¡dÃ­ dlouhodobÄ› bÄ›Å¾Ã­cÃ­ operace, jako je napÅ™Ã­klad pÅ™ehrÃ¡vÃ¡nÃ­ hudby Äi stahovÃ¡nÃ­. TakÃ© jsou vyuÅ¾ity k pÅ™Ã­stupu vzdÃ¡lenÃ½ch zdrojÅ¯, u kterÃ½ch nenÃ­ znÃ¡ma doba odezvy, napÅ™Ã­klad kontrola dostupnosti aktualizacÃ­ Äi pÅ™ipojenÃ­ k serveru. Na rozdÃ­l od aktivit, sluÅ¾by neposkytujÃ­ Å¾Ã¡dnÃ© uÅ¾ivatelskÃ© rozhranÃ­.[1, 43]
PosluchaÄe
Komponenta Broadcast receivers nenÃ­ do ÄeskÃ©ho jazyka obvykle pÅ™eklÃ¡dÃ¡na. PomÄ›rnÄ› volnÃ½m pÅ™ekladem vznikÃ¡ nÃ¡zev PÅ™ijÃ­maÄe vysÃ­lÃ¡nÃ­ Äi PosluchaÄe. OvÅ¡em ani jeden z tÄ›chto pÅ™ekladÅ¯ zcela nevystihuje vlastnost tÃ©to komponenty. Komponenta primÃ¡rnÄ› slouÅ¾Ã­ k naslouchÃ¡nÃ­ oznÃ¡menÃ­, kterÃ½mi mohou bÃ½t systÃ©movÃ© Äi vlastnÃ­ zprÃ¡vy.[8, 43]
VÅ¡e se odehrÃ¡vÃ¡ na pozadÃ­ zaÅ™Ã­zenÃ­ bez jakÃ©hokoliv uÅ¾ivatelskÃ©ho rozhranÃ­. UdÃ¡lost, kterou posluchaÄe zachytÃ¡vajÃ­ jsou takzvanÃ© zÃ¡mÄ›ry (Intents). VydavatelÃ© (systÃ©m Äi aplikace) vytvÃ¡Å™ejÃ­ zÃ¡mÄ›ry, kterÃ© jsou nÃ¡slednÄ› smÄ›Å™ovÃ¡ny do vysÃ­lÃ¡nÃ­. Ty jsou zachytÃ¡vÃ¡ny pÅ™ijÃ­maÄi, kterÃ© majÃ­ stejnÃ© zÃ¡mÄ›ry objednanÃ© Äi registrovanÃ©.[8, 43]
IdeÃ¡lnÃ­m pÅ™Ã­kladem je pÅ™Ã­jetÃ­ SMS zprÃ¡vy. V momentÄ›, kdy dorazÃ­ SMS do telefonu, operaÄnÃ­ systÃ©m Android to vhodnÄ› oznÃ¡mÃ­ tÃ­m, Å¾e vyÅ¡le zÃ¡mÄ›r SMS_received. VÅ¡echny pÅ™ijÃ­maÄe, kterÃ© majÃ­ stejnÃ© zÃ¡mÄ›ry tento zÃ¡mÄ›r pÅ™ijmou a spustÃ­ sluÅ¾bu,
24

kterÃ¡ stÃ¡hne pÅ™Ã­chozÃ­ SMS zprÃ¡vu. PotÃ© si uÅ¾ivatel zprÃ¡vu skrz nÄ›kterou z aplikacÃ­ zobrazÃ­. DalÅ¡Ã­m dobrÃ½m pÅ™Ã­kladem je napÅ™Ã­klad upozornÄ›nÃ­ na nÃ­zkÃ½ stav baterie.[43]
Jak jiÅ¾ bylo naznaÄeno vÃ½Å¡e, existujÃ­ 2 druhy broadcastÅ¯ a to systÃ©movÃ© Äi vlastnÃ­.[8, 43] PoskytovatelÃ© obsahu PoslednÃ­ komponentou jsou poskytovatelÃ© obsahu. Jak jiÅ¾ nÃ¡zev napovÃ­dÃ¡, umoÅ¾ÅˆujÃ­ uklÃ¡dÃ¡nÃ­ a sdÃ­lenÃ­ dat mezi vÃ­ce aplikacemi Äi procesy. Aplikace tak mÅ¯Å¾e pÅ™istoupit k datÅ¯m jinÃ© aplikace, kterÃ© vystupujÃ­ jako poskytovatelÃ© obsahu.[1, 43]
25

3 MÄ›Å™enÃ­ krevnÃ­ho tlaku pomocÃ­ telefonu
MobilnÃ­ telefony jsou v dneÅ¡nÃ­ dobÄ› neodmyslitelnou souÄÃ¡stÃ­ naÅ¡ich Å¾ivotÅ¯. Z toho dÅ¯vodu jsou tato zaÅ™Ã­zenÃ­ neustÃ¡le rozÅ¡iÅ™ovÃ¡na o novÃ© funkce. Dnes se jiÅ¾ prakticky nesetkÃ¡me s klasickÃ½m mobilnÃ­m telefonem, jenÅ¾ byl omezen pouze na volÃ¡nÃ­ a posÃ­lÃ¡nÃ­ zprÃ¡v. Tyto telefony byly vytlaÄeny telefony chytrÃ½mi (smartphone), kterÃ© jsou postaveny na pokroÄilÃ½ch operaÄnÃ­ch systÃ©mech. MomentÃ¡lnÄ› nejznÃ¡mÄ›jÅ¡Ã­mi operaÄnÃ­mi systÃ©my jsou Android, iOS a Windows Phone. OperaÄnÃ­ systÃ©m umoÅ¾Åˆuje uÅ¾ivateli instalovat aplikace tÅ™etÃ­ch stran a tÃ­m znaÄnÄ› rozÅ¡Ã­Å™it funkcionalitu zaÅ™Ã­zenÃ­.
Krom programovÃ©ho vybavenÃ­ (software - SW) je taktÃ©Å¾ dÅ¯leÅ¾itÃ© i technickÃ© vybavenÃ­ (hardware - HW) zaÅ™Ã­zenÃ­. Jednou z velkÃ½ch skupin HW jsou senzory, pomocÃ­ nichÅ¾ zaÅ™Ã­zenÃ­ interaguje s okolÃ­m. Tyto senzory je moÅ¾nÃ© vyuÅ¾Ã­t pro snÃ­mÃ¡nÃ­ biomedicÃ­nskÃ½ch dat. DÃ­ky velmi vysokÃ©mu vÃ½poÄetnÃ­mu vÃ½konu souÄasnÃ½ch zaÅ™Ã­zenÃ­ je moÅ¾nÃ© tyto biomedicÃ­nskÃ© signÃ¡ly na tomtÃ©Å¾ zaÅ™Ã­zenÃ­ i zpracovat.
V poslednÃ­ch letech byly pÅ™edstaveny novÃ© zpÅ¯soby mÄ›Å™enÃ­ krevnÃ­ho tlaku pomocÃ­ rÅ¯znÃ½ch senzorÅ¯. JednÃ¡ se pÅ™edevÅ¡Ã­m o experimentÃ¡lnÃ­ metody, kterÃ© nejsou v bÄ›Å¾nÃ© praxi prozatÃ­m vyuÅ¾Ã­vÃ¡ny. NejslibnÄ›jÅ¡Ã­ metody z tÃ©to oblasti jsou zaloÅ¾eny na mÄ›Å™enÃ­ doby pÅ™enosu pulsu (Pulse Transit Time - PTT), kterÃ½ udÃ¡vÃ¡ Äas, za kterÃ½ projde pulsnÃ­ vlna mezi dvÄ›ma mÃ­sty arteriÃ¡lnÃ­ho Å™eÄiÅ¡tÄ›.[26, 28, 31, 33]

3.1 Doba pÅ™enosu pulsu

ZÃ¡kladnÃ­ princip vÅ¡ech metod mÄ›Å™Ã­cÃ­ PTT je fakt, Å¾e tuhost artÃ©riÃ­ zvyÅ¡uje hodnotu krevnÃ­ho tlaku, u kterÃ©ho je pÅ™edpoklÃ¡dÃ¡na pÅ™Ã­mÃ¡ korelace s rychlost Å¡Ã­Å™enÃ­ pulsnÃ­ vlny (Pulse Wave Velocity - PWV) v arteriÃ¡lnÃ­m Å™eÄiÅ¡ti. PWV patÅ™Ã­ dnes mezi zÃ¡kladnÃ­ metodu hodnocenÃ­ arteriÃ¡lnÃ­ tuhosti â€“ ztrÃ¡ty elasticity. ZtrÃ¡ta elasticity je bÄ›Å¾nÃ¡ s pÅ™ibÃ½vajÃ­cÃ­m vÄ›kem. To je zpÅ¯sobeno stÃ¡rnutÃ­m a mechanickÃ½m namÃ¡hÃ¡nÃ­m elastinovÃ½ch vlÃ¡ken ve stÄ›nÃ¡ch artÃ©riÃ­. MÃ­ru tuhosti danÃ©ho Ãºseku arteriÃ¡lnÃ­ho Å™eÄiÅ¡tÄ› charakterizuje parametr PWV, kterÃ½ lze vypoÄÃ­tat dle vztahu 3.1, jenÅ¾ odpovÃ­dÃ¡ vzdÃ¡lenosti mezi dvÄ›ma body arteriÃ¡lnÃ­ho Å™eÄiÅ¡tÄ› â–³í µí±¥ uraÅ¾enÃ© pulsnÃ­ vlnou za Äas í µí±ƒ í µí±‡ í µí±‡ . Rychlost Å¡Ã­Å™enÃ­ pulsnÃ­ vlny je pÅ™Ã­mo ÃºmÄ›rnÃ¡ tlaku krve. PÅ™i zvÃ½Å¡enÃ­ krevnÃ­ho tlaku dojde ke zvÃ½Å¡enÃ­ tuhosti artÃ©riÃ­ a tedy ke zvÃ½Å¡enÃ­ PWV, coÅ¾ mÃ¡ za nÃ¡sledek snÃ­Å¾enÃ­ PTT. PÅ™i snÃ­Å¾enÃ­ tlaku dojde ke snÃ­Å¾enÃ­ tuhosti artÃ©riÃ­, snÃ­Å¾enÃ­ PWV a zvÃ½Å¡enÃ­ PTT. PomocÃ­ PTT je pak moÅ¾nÃ© predikovat zmÄ›ny krevnÃ­ho tlaku bÄ›hem krÃ¡tkÃ½ch ÄasovÃ½ch ÃºsekÅ¯.[28, 31]

í µí±ƒ í µí±Š í µí±‰ = â–³í µí±¥ í µí±ƒ í µí±‡ í µí±‡

(3.1)

26

Parametr PTT byl nejprve mÄ›Å™en mezi dvÄ›ma body konkrÃ©tnÃ­ artÃ©rie. PotÃ© byl prvnÃ­ bod nahrazen mÄ›Å™enÃ­m signÃ¡lÅ¯ ze srdeÄnÃ­ho svalu v podobÄ› elektrokardiogramu (EKG), fonokardioframu (FKG) Äi impedanÄnÃ­ho kardiogramu (IKG).V pÅ™Ã­padÄ› EKG vlna R v odpovÃ­dÃ¡ dobÄ› otevÅ™enÃ­ polomÄ›sÃ­ÄitÃ½ch chlopnÃ­, vypuzenÃ­ krve do aorty a vzniku pulsnÃ­ vlny. V druhÃ©m bodÄ› je potÃ© detekovÃ¡na pulsnÃ­ vlna pomocÃ­ tlakovÃ© manÅ¾ety Äi fotopletysmografu umÃ­stÄ›nÃ©m na koneÄku prstu. Princip mÄ›Å™enÃ­ PTT je vyobrazen na obrÃ¡zku 3.1. Pro detekci pulsnÃ­ vlny bÃ½vÃ¡ obvykle vyuÅ¾it zÃ¡znam EKG a fotopletysmograf (Photopletysmograph - PPG) umÃ­stÄ›nÃ½ na koneÄku prstu.[26, 31]
Obr. 3.1: Princip mÄ›Å™enÃ­ doby pÅ™enosu pulsu (PTT) z EKG a PPG.[31] Bod v PPG signÃ¡lu odpovÃ­dajÃ­cÃ­ pÅ™Ã­chodu pulsnÃ­ vlny je v rÅ¯znÃ½ch algoritmech jinÃ½. NÄ›kterÃ© zdroje udÃ¡vajÃ­ 50 % maxima pulsnÃ­ vlny [31], jinÃ© zdroje maximum pulsnÃ­ vlny [26, 33], dÃ¡le 25 % maxima, bod nejvÄ›tÅ¡Ã­ho sklonu nÃ¡bÄ›Å¾nÃ© hrany aj. Bod v PPG signÃ¡lu je vÅ¾dy volen dle pouÅ¾itÃ©ho algoritmu.
3.2 Senzory chytrÃ©ho telefonu
Z nepÅ™ebernÃ©ho mnoÅ¾stvÃ­ senzorÅ¯, kterÃ½mi jsou chytrÃ© telefony vybaveny, je pro mÄ›Å™enÃ­ krevnÃ­ho tlaku vhodnÃ© vyuÅ¾Ã­t kombinaci mikrofonu a fotoaparÃ¡tu, pomocÃ­ nichÅ¾ jsme schopni zÃ­skat PPG a FKG signÃ¡l. Tyto konkrÃ©tnÃ­ senzory byly zvoleny na zÃ¡kladÄ› pracÃ­ zabÃ½vajÃ­cÃ­ se touto problematikou.[26, 33, 40]
27

VÃ½poÄet PTT zahrnuje zÃ­skÃ¡nÃ­ Äasu pÅ™Ã­chodu pulsnÃ­ vlny (Pulse Arrival Time PAT) u obou bodÅ¯ v tomtÃ©Å¾ arteriÃ¡lnÃ­m Å™eÄiÅ¡ti, mezi kterÃ½mi je PTT mÄ›Å™en. Jakmile jsou tyto Äasy zaznamenÃ¡ny je moÅ¾nÃ© vypoÄÃ­tat PTT dle vztahu 3.2.[26]

í µí±ƒ í µí±‡ í µí±‡ = í µí±ƒ í µí°´í µí±‡1 âˆ’ í µí±ƒ í µí°´í µí±‡0

(3.2)

3.2.1 Fonokardiografie
ProximÃ¡lnÃ­1 bod, kterÃ½ odpovÃ­dÃ¡ í µí±ƒ í µí°´í µí±‡0, je v tomto pÅ™Ã­padÄ› zÃ­skÃ¡n ze signÃ¡lu FKG pomocÃ­ mikrofonu pÅ™iloÅ¾enÃ©ho na hrudnÃ­k uÅ¾ivatele. Lokalizace srdeÄnÃ­ch ozev je nÃ¡roÄnÃ¡, ale pro vÃ½poÄet hodnoty krevnÃ­ho tlaku naprosto nezbytnÃ¡. BÄ›hem srdeÄnÃ­ho cyklu vznikajÃ­ vibrace zpÅ¯sobenÃ© mechanickou aktivitou (otevÃ­rÃ¡nÃ­ a zavÃ­rÃ¡nÃ­ srdeÄnÃ­ch chlopnÃ­) Å¡Ã­Å™Ã­cÃ­ se skrz hrudnÃ­k. Srdce produkuje pÅ™evÃ¡Å¾nÄ› ÄtyÅ™i srdeÄnÃ­ ozvy. U zdravÃ©ho ÄlovÄ›ka je velmi dobÅ™e rozpoznatelnÃ¡ prvnÃ­ (S1) a druhÃ¡ (S2) srdeÄnÃ­ ozva. JednotlivÃ© komponenty S1 a S2 jsou vyobrazeny na obrÃ¡zku 3.2. Lokalizace srdeÄnÃ­ch chlopnÃ­ a je potÃ© vyobrazena na obrÃ¡zku 3.3.[26, 29, 33, 40]
PrvnÃ­ srdeÄnÃ­ ozva se sklÃ¡dÃ¡ ze ÄtyÅ™ hlavnÃ­ch komponent. PrvnÃ­ komponenta S1 (1) odpovÃ­dÃ¡ kontrakci komor, jeÅ¾ zvyÅ¡uje tlak, a tak tlaÄÃ­ krev smÄ›rem k sÃ­nÃ­m, coÅ¾ zpÅ¯sobÃ­ uzavÅ™enÃ­ cÃ­patÃ½ch chlopnÃ­ (mitrÃ¡lnÃ­ a trikuspidÃ¡lnÃ­). UzavÅ™enÃ­ cÃ­patÃ½ch chlopnÃ­ odpovÃ­dÃ¡ druhÃ© komponentÄ› S1 (2). TÅ™etÃ­ komponenta S1 (3) odpovÃ­dÃ¡ oscilacÃ­m krve pÅ™i otevÅ™enÃ­ polomÄ›sÃ­ÄitÃ½ch chlopnÃ­ (aortÃ¡lnÃ­ a pulmonÃ¡lnÃ­). ÄŒtvrtÃ¡ komponenta S1 (4) odpovÃ­dÃ¡ turbulencÃ­m zpÅ¯sobenÃ½ch krvÃ­ proudÃ­cÃ­ skrze aortu. DruhÃ¡ srdeÄnÃ­ ozva se sklÃ¡dÃ¡ ze dvou sloÅ¾ek (1 a 2), kterÃ© odpovÃ­dajÃ­ uzavÅ™enÃ­ polomÄ›sÃ­ÄitÃ½ch chlopnÃ­ (aortÃ¡lnÃ­ a pulmonÃ¡lnÃ­).[26]

Obr. 3.2: Komponenty prvnÃ­ a druhÃ© srdeÄnÃ­ ozvy.[26]
1proximÃ¡lnÃ­ â€“ bliÅ¾Å¡Ã­ poÄÃ¡tku Äi vzniku
28

Vzniku pulsnÃ­ vlny odpovÃ­dÃ¡ tÅ™etÃ­ a ÄtvrtÃ¡ komponenta S1, pÅ™i kterÃ© je vypuzovÃ¡na krev do arteriÃ¡lnÃ­ho Å™eÄiÅ¡tÄ›. Tento okamÅ¾ik odpovÃ­dÃ¡ í µí±ƒ í µí°´í µí±‡0.[26]
Jako nejlepÅ¡Ã­ mÃ­sto pro snÃ­mÃ¡nÃ­ FKG signÃ¡lu se ukÃ¡zala mitrÃ¡lnÃ­ oblast. Tato oblast je charakteristickÃ¡ pÅ™ijatelnÃ½m drÅ¾enÃ­m telefonu pÅ™i mÄ›Å™enÃ­ zÃ¡znamu PPG, dostateÄnou amplitudou S1 i S2, kterÃ¡ je dÅ¯leÅ¾itÃ¡ pro vÃ½poÄet diastolickÃ©ho tlaku krve.[33]
P A
T M
Obr. 3.3: Lokalizace srdeÄnÃ­ch chlopnÃ­ a jejich ozev. PrvnÃ­ srdeÄnÃ­ ozva je produkovÃ¡na uzavÅ™enÃ­m mitrÃ¡lnÃ­ (M) a trikuspidÃ¡lnÃ­ (T) chlopnÄ› a otevÅ™enÃ­m aortÃ¡lnÃ­ (A) a pulmonÃ¡lnÃ­ (P) chlopnÄ›. DruhÃ¡ srdeÄnÃ­ ozva je produkovÃ¡na uzavÅ™enÃ­m aortÃ¡lnÃ­ (A) a pulmonÃ¡lnÃ­ (P) chlopnÄ›.[33]
3.2.2 Fotopletysmografie
DistÃ¡lnÃ­2 bod, kterÃ½ odpovÃ­dÃ¡ í µí±ƒ í µí°´í µí±‡1, je v tomto pÅ™Ã­padÄ› zÃ­skÃ¡n ze signÃ¡lu PPG za pomoci fotoaparÃ¡tu a LED umÃ­stÄ›nÃ© vedle objektivu. Oproti signÃ¡lu FKG je zÃ­skÃ¡nÃ­ PPG signÃ¡lu pomÄ›rnÄ› snadnÃ©. VyÅ¡etÅ™ovanÃ¡ osoba pÅ™iloÅ¾Ã­ koneÄek prstu souÄasnÄ› pÅ™es objektiv i LED. SvÄ›tlo emitovanÃ© LED je rozptÃ½leno, odraÅ¾eno a absorbovÃ¡no pÅ™i prÅ¯chodu Å¾ivou tkÃ¡nÃ­. VÃ½raznÃ© zmÄ›ny jasovÃ½ch hodnot jsou pak zachyceny snÃ­maÄem fotoaparÃ¡tu pÅ™i rÅ¯znÃ©m mnoÅ¾stvÃ­ krve v koneÄku prstu (prÅ¯chod pulsnÃ­ vlny). Na zÃ¡kladÄ› zmÄ›n jasovÃ½ch hodnot jednotlivÃ½ch snÃ­mkÅ¯ v Äase je zÃ­skÃ¡n PPG signÃ¡l.[33]
2distÃ¡lnÃ­ â€“ vzdÃ¡lenÃ½, umÃ­stÄ›nÃ½ na opaÄnÃ© stranÄ›, neÅ¾ je poÄÃ¡tek
29

3.3 VÃ½poÄet hodnoty krevnÃ­ho tlaku
PÅ™i stanovenÃ­ hodnoty krevnÃ­ho tlaku vychÃ¡zÃ­me ze zkuÅ¡enostÃ­ zÃ­skanÃ½ch z pracÃ­ [33], [26] a [40]. Tyto prÃ¡ce se zabÃ½vajÃ­ stejnou problematikou.
V prÃ¡ci [33] je podrobnÄ› rozebrÃ¡na metoda pro stanovenÃ­ hodnoty krevnÃ­ho tlaku pomocÃ­ dvou telefonÅ¯. AutoÅ™i nejprve popisujÃ­ zpÅ¯sob synchronizace mezi obÄ›ma zaÅ™Ã­zenÃ­mi pÅ™es Bluetooth. PrvnÃ­ zaÅ™Ã­zenÃ­ snÃ­mÃ¡ FKG signÃ¡l pomocÃ­ mikrofonu z hrudnÃ­ku vyÅ¡etÅ™ovanÃ© osoby. DruhÃ© zaÅ™Ã­zenÃ­ snÃ­mÃ¡ PPG signÃ¡l pomocÃ­ fotoaparÃ¡tu a pÅ™isvÄ›tlovacÃ­ LED z koneÄku prstu. Hodnota PTT je stanovena na zÃ¡kladÄ› S1 signÃ¡lu FKG a vrcholu pulsu v PPG signÃ¡lu. Na zÃ¡kladÄ› PTT je potÃ© stanoven systolickÃ½ tlak dle vztahu 3.3. DiastolickÃ½ tlak je potÃ© odhadnut na zÃ¡kladÄ› doby trvÃ¡nÃ­ vypuzovacÃ­ fÃ¡ze srdeÄnÃ­ho cyklu.
PrÃ¡ce [26] a [40] potÃ© pÅ™edstavujÃ­ vylepÅ¡enÃ­ v podobÄ› vyuÅ¾itÃ­ pouze jednoho zaÅ™Ã­zenÃ­. Princip je tÃ©mÄ›Å™ totoÅ¾nÃ½ s pÅ™edchozÃ­ pracÃ­. PrÃ¡ce [26] velmi podrobnÄ› popisuje vÃ½voj aplikace na operaÄnÃ­ systÃ©m Android. I pÅ™esto, Å¾e jsou oba signÃ¡ly (PPG a FKG) snÃ­mÃ¡ny stejnÃ½m zaÅ™Ã­zenÃ­m, jejich synchronizace je problematickÃ¡. AutoÅ™i zde popisujÃ­ princip synchronizace na zÃ¡kladÄ› poklepu koneÄkem prstu. KaÅ¾dÃ© klepnutÃ­ pÅ™es objektiv fotoaparÃ¡tu zpÅ¯sobÃ­ jeho zakrytÃ­ a zÃ¡roveÅˆ generuje zvuk, jenÅ¾ je zaznamenÃ¡n. SouÄasnÄ› tak vznikne vrchol v PPG i FKG signÃ¡lu. Pokud jsou oba signÃ¡ly sprÃ¡vnÄ› zarovnÃ¡ny vznik vrcholÅ¯ je ve stejnÃ©m ÄasovÃ©m okamÅ¾iku.
Pokud nenÃ­ PPG signÃ¡l pÅ™esnÄ› synchronizovanÃ½ s FKG signÃ¡lem vznikne nepÅ™esnost pÅ™i vÃ½poÄtu PTT, coÅ¾ zpÅ¯sobÃ­ nesprÃ¡vnÃ½ vÃ½poÄet hodnoty krevnÃ­ho tlaku. Synchronizace PPG a FKG signÃ¡lÅ¯ je popsÃ¡na v sekci 4.7. Pokud jsou signÃ¡ly vzÃ¡jemnÄ› synchronizovÃ¡ny lze stanovit hodnotu krevnÃ­ho tlaku.[33]

3.3.1 SystolickÃ½ arteriÃ¡lnÃ­ tlak
V prvÃ© Å™adÄ› je nutnÃ© vypoÄÃ­tat PTT dle vztahu 3.2. Kde í µí±ƒ í µí°´í µí±‡0 odpovÃ­dÃ¡ S1 a í µí±ƒ í µí°´í µí±‡1 odpovÃ­dÃ¡ vrcholu pulsnÃ­ vlny v PPG signÃ¡lu. PotÃ© lze systolickÃ½ tlak vypoÄÃ­tat dle vztahu 3.3, kterÃ½ vznikl na zÃ¡kladÄ› lineÃ¡rnÃ­ regrese z vÃ­ce neÅ¾ 500 mÄ›Å™enÃ­ dle [33].
Tento vztah odpovÃ­dÃ¡ rovnici pÅ™Ã­mky ve smÄ›rnicovÃ©mu tvaru í µí±¦ = í µí±˜í µí±¥ + í µí±, kde âˆ’0, 425 je smÄ›rnice pÅ™Ã­mky í µí±˜ a konstanta +214 odpovÃ­dÃ¡ í µí±, jeÅ¾ urÄuje prÅ¯seÄÃ­k pÅ™Ã­mky s osou y. Konstanta +214 byla stanovena v [33] z vÃ½sledkÅ¯ namÄ›Å™enÃ½ch hodnot systolickÃ©ho tlaku a PTT, kterÃ© byly proloÅ¾eny pÅ™Ã­mkou, aby byl zÃ­skÃ¡n regresnÃ­ vztah, ze kterÃ©ho lze zÃ­skat tuto konstantu. Tato konstanta je vztaÅ¾enÃ¡ k metodÄ› popsanÃ© v [33]. Pro ÃºÄely tÃ©to prÃ¡ce bude nutnÃ© stanovit novou konstantu í µí±, ale zachovat smÄ›rnici í µí±˜.

í µí±í µí±† [í µí±ší µí±ší µí°»í µí±”] = âˆ’0, 425 Â· í µí±ƒ í µí±‡ í µí±‡ + 214

(3.3)

30

3.3.2 DiastolickÃ½ arteriÃ¡lnÃ­ tlak
Pro odhad diastolickÃ©ho tlaku je nutnÃ© znÃ¡t zÃ¡kladnÃ­ Ãºdaje o uÅ¾ivateli, kterÃ½mi jsou hmotnost, vÃ½Å¡ka a vÄ›k. Nejprve je tÅ™eba stanovit systolickÃ½ objem (Stroke Volume SV). Ten lze vypoÄÃ­tat dle vztahu 3.4. Za klidovÃ½ch podmÃ­nek u zdravÃ©ho dospÄ›lÃ©ho ÄlovÄ›ka se SV pohybuje kolem hodnoty 70 ml.[29, 33]

í µí±†í µí±‰ [í µí±ší µí±™] = âˆ’6, 6 + 0, 25 Â· (í µí°¸í µí±‡ âˆ’ 35) âˆ’ 0, 62 Â· í µí°»í µí±… + 40, 4 Â· í µí°µí µí±†í µí°´ âˆ’ 0, 51 Â· í µí±£Ä›í µí±˜ (3.4)
Kde í µí°¸í µí±‡ je doba vypuzenÃ­ (Ejection Time - ET), jeÅ¾ odpovÃ­dÃ¡ dobÄ› trvÃ¡nÃ­ vypuzovacÃ­ fÃ¡ze srdeÄnÃ­ho cyklu, kterÃ½ zaÄÃ­nÃ¡ S1 a konÄÃ­ S2. ET tedy lze vypoÄÃ­tat dle vztahu 3.5. DalÅ¡Ã­m parametrem potÅ™ebnÃ½m k vÃ½poÄtu SV je í µí°µí µí±†í µí°´. Povrch tÄ›la (Body Surface Area - BSA) je vypoÄÃ­tÃ¡n dle vztahu 3.6, kde hmotnost je zadÃ¡vÃ¡na v kilogramech a vÃ½Å¡ka v centimetrech. PoslednÃ­m parametrem je í µí°»í µí±…, jenÅ¾ odpovÃ­dÃ¡ tepovÃ© frekvenci (Heart Rate - HR), kterou lze vypoÄÃ­tat dle vztahu 3.7, kde í µí±› je poÄet detekovanÃ½ch pulsÅ¯ a â–³í µí±¡ je dÃ©lka zÃ¡znamu v sekundÃ¡ch.

í µí°¸í µí±‡ [í µí±ší µí± ] = í µí±†2 âˆ’ í µí±†1

(3.5)

í µí°µí µí±†í µí°´ [í µí±š2] = 0.007184 Â· â„í µí±ší µí±œí µí±¡í µí±›í µí±œí µí± í µí±¡0.425 Â· í µí±£Ã½Å¡í µí±˜í µí±0.725

(3.6)

í µí°»í µí±… [í µí±¡í µí±’í µí±/í µí±ší µí±–í µí±›] = í µí±› Â· 60 â–³í µí±¡

(3.7)

Po vÃ½poÄtu systolickÃ©ho objemu je moÅ¾nÃ© vypoÄÃ­tat pulsnÃ­ tlak dle vztahu 3.8.

Tlak diastolickÃ½ lze pak vypoÄÃ­tat vyjÃ¡dÅ™enÃ­m ze vztahu 1.2 jako rozdÃ­l tlaku systo-

lickÃ©ho a pulsnÃ­ho.[33]

í µí±í µí±ƒ

[í µí±ší µí±ší µí°»í µí±”] =

í µí±†í µí±‰ (0, 013 Â· â„í µí±ší µí±œí µí±¡í µí±›í µí±œí µí± í µí±¡ âˆ’ 0, 007 Â· í µí±£Ä›í µí±˜ âˆ’ 0, 004 Â· í µí°»í µí±…) + 1, 307

(3.8)

31

3.4 Volba chytrÃ©ho telefonu
Aby bylo moÅ¾nÃ© PPG a FKG signÃ¡l zaznamenÃ¡vat, je nutnÃ©, aby zvolenÃ© zaÅ™Ã­zenÃ­ splÅˆovalo minimÃ¡lnÃ­ poÅ¾adavky kladenÃ© tÄ›mito signÃ¡ly.
3.4.1 MinimÃ¡lnÃ­ poÅ¾adavky na zaÅ™Ã­zenÃ­
Krom splnÄ›nÃ­ minimÃ¡lnÃ­ch poÅ¾adavkÅ¯ pro zÃ¡znam PPG a FKG signÃ¡lÅ¯, je vyÅ¾adovÃ¡no, aby zaÅ™Ã­zenÃ­ bylo dostateÄnÄ› vÃ½konnÃ©. DÃ­ky tomu je moÅ¾nÃ© zÃ­skanÃ¡ data v reÃ¡lnÃ©m Äase zpracovat a poskytnout tak uÅ¾ivateli zpÄ›tnou vazbu.
PÅ™i experimentech bylo zjiÅ¡tÄ›no, Å¾e poskytnutÃ­ zpÄ›tnÃ© vazby znaÄnÄ› napomÃ¡hÃ¡ umÃ­stit potÅ™ebnÃ© senzory na sprÃ¡vnÃ© mÃ­sto, ze kterÃ©ho lze signÃ¡ly snÃ­mat v poÅ¾adovanÃ© kvalitÄ›. Tato zpÄ›tnÃ¡ vazba je nezbytnÃ¡ pro lokalizaci sprÃ¡vnÃ©ho mÃ­sta pro mÄ›Å™enÃ­ FKG signÃ¡lu. NavÃ­c audiovizuÃ¡lnÃ­ zpÄ›tnÃ¡ vazba obohacuje uÅ¾ivatelskou zkuÅ¡enost, coÅ¾ ÄinÃ­ tuto metodu pÅ™itaÅ¾livÄ›jÅ¡Ã­.[26]
FotoaparÃ¡t
PoÅ¾adavky kladenÃ© na fotoaparÃ¡t, kterÃ½m je snÃ­mÃ¡n PPG signÃ¡l, jsou splnÄ›ny tÃ©mÄ›Å™ kaÅ¾dÃ½m chytrÃ½m telefonem. Ten musÃ­ bÃ½t schopen zaznamenat minimÃ¡lnÄ› 22 snÃ­mkÅ¯ za sekundu (frame per second - fps). VÄ›tÅ¡ina energie PPG signÃ¡lu se nachÃ¡zÃ­ v nÃ­zkofrekvenÄnÃ­m sloÅ¾kÃ¡ch v rozsahu 5â€“11 Hz. Aby nebyl poruÅ¡en vzorkovacÃ­ teorÃ©m je tedy nutnÃ© zajistit minilÃ¡lnÃ­ vzorkovacÃ­ frekvenci 22 Hz, jinak dojde k neobnovitelnÃ© ztrÃ¡tÄ› dat.[26]
MinimÃ¡lnÃ­ poÅ¾adavky nesplÅˆujÃ­ zaÅ™Ã­zenÃ­, jenÅ¾ majÃ­ pÅ™isvÄ›tlovacÃ­ diodu umÃ­stÄ›nou pÅ™Ã­liÅ¡ daleko od objektivu fotoaparÃ¡tu Äi nemajÃ­ pÅ™isvÄ›tlovacÃ­ diodu vÅ¯bec. TÃ­m je znemoÅ¾nÄ›no souÄasnÃ© pÅ™iloÅ¾enÃ­ koneÄku prstu pÅ™es objektiv a diodu zÃ¡roveÅˆ. Bez prosvÃ­cenÃ­ koneÄku prstu nenÃ­ moÅ¾nÃ© PPG signÃ¡l zÃ­skat.
RozliÅ¡enÃ­ snÃ­maÄe ani dalÅ¡Ã­ parametry nemajÃ­ na kvalitu PPG zÃ¡znamu znaÄnÃ½ vliv. Naopak je Å¾Ã¡doucÃ­ snÃ­Å¾it rozliÅ¡enÃ­ video zÃ¡znamu a tÃ­m snÃ­Å¾it vÃ½poÄetnÃ­ Äas algoritmu (mÃ©nÄ› dat ke zpracovÃ¡nÃ­).[33]
Mikrofon
Na rozdÃ­l od fotoaparÃ¡tu je mikrofon zÃ¡kladnÃ­ vybavenÃ­ kaÅ¾dÃ©ho telefonu. VÄ›tÅ¡ina chytrÃ½ch telefonÅ¯ je vybavena vÃ­ce mikrofony - obvykle dvÄ›ma. DÃ­ky tomu je moÅ¾nÃ© potlaÄit hluk okolÃ­ pÅ™i hovoru Äi zaznamenÃ¡vat stereo zvuk (napÅ™Ã­klad pÅ™i nahrÃ¡vnÃ­ videozÃ¡znamu).[38]
Oblast slyÅ¡itelnosti se u ÄlovÄ›ka nachÃ¡zÃ­ v rozmezÃ­ 16 Hz aÅ¾ 20 kHz. Pro kvalitnÃ­ zpracovÃ¡nÃ­ akustickÃ½ch signÃ¡lÅ¯ je nutnÃ© zvolit mikrofon, jehoÅ¾ frekvenÄnÃ­ charakteristika pokrÃ½vÃ¡ oblast slyÅ¡itelnosti. Toho bohuÅ¾el nenÃ­ vÅ¾dy dosaÅ¾eno. Pro vÃ½robce
32

mobilnÃ­ch telefonÅ¯ je velmi dÅ¯leÅ¾itÃ©, aby zvolenÃ½ mikrofon pracoval velmi dobÅ™e v rozsahu od 250 Hz do 4 kHz. V tomto rozsahu se totiÅ¾ nachÃ¡zejÃ­ nejdÅ¯leÅ¾itÄ›jÅ¡Ã­ sloÅ¾ky Å™eÄi, na kterÃ© je lidskÃ© ucho nejcitlivÄ›jÅ¡Ã­. Na obr. 3.4 je vyobrazena frekvenÄnÃ­ charakteristika mikrofonu rÅ¯znÃ½ch zaÅ™Ã­zenÃ­ od spoleÄnosti Apple. Z grafu je patrnÃ©, Å¾e zaÅ™Ã­zenÃ­ iPhone a iPhone 3GS nejsou vhodnÃ© pro mÄ›Å™enÃ­ nÃ­zkÃ½ch frekvenÄnÃ­ch pÃ¡sem.[38, 50]
Obr. 3.4: FrekvenÄnÃ­ charakteristika mikrofonu rÅ¯znÃ½ch zaÅ™Ã­zenÃ­.[38]
FrekvenÄnÃ­ charakteristika mikrofonu, pouÅ¾itÃ©ho v danÃ©m zaÅ™Ã­zenÃ­, nenÃ­ vÃ½robcem bÄ›Å¾nÄ› udÃ¡vanÃ½ parametr. Proto je vÃ½bÄ›r zaÅ™Ã­zenÃ­ znaÄnÄ› obtÃ­Å¾nÃ½ - je nutnÃ© vyzkouÅ¡et, zdali zaÅ™Ã­zenÃ­ vyhovuje.
FrekvenÄnÃ­ spektrum srdeÄnÃ­ch ozev se nachÃ¡zÃ­ pÅ™evÃ¡Å¾nÄ› v rozmezÃ­ 10â€“400 Hz. Z toho dÅ¯vodu je nutnÃ© zajistit vzorkovacÃ­ frekvenci minimÃ¡lnÄ› 800 Hz, jinak dojde k poruÅ¡enÃ­ vzorkovacÃ­ho teorÃ©mu a tÃ­m k neobnovitelnÃ© ztrÃ¡tÄ› dat. MinimÃ¡lnÃ­ vzorkovacÃ­ frekvence je splnÄ›na vÅ¡emi zaÅ™Ã­zenÃ­mi (povahou telefonu je zpracovÃ¡vat lidskÃ½ hlas, jehoÅ¾ frekvence je nÄ›kolikanÃ¡sobnÄ› vyÅ¡Å¡Ã­). ProblÃ©mem je ovÅ¡em citlivost mikrofonu na nÃ­zkofrekvenÄnÃ­ sloÅ¾ky. Ze zaÅ™Ã­zenÃ­ch uvedenÃ½ch na obr. 3.4 tÄ›mto poÅ¾adavkÅ¯m vyhovuje pouze iPhone 3G, jenÅ¾ je jako jedinÃ½ schopnÃ½ zaznamenÃ¡vat i nÃ­zkofrekvenÄnÃ­ sloÅ¾ky audio signlÃ¡lu. Pro zÃ¡znam audio signÃ¡lu jsou nejÄastÄ›ji pouÅ¾Ã­vÃ¡ny vzorkovacÃ­ frekvence 44,1 kHz a 48 kHz. Z toho dÅ¯vodu je vhodnÃ©, pro snÃ­Å¾enÃ­ vÃ½poÄetnÃ­ho Äasu, audiozÃ¡znam podvzorkovat na frekvenci blÃ­zkou 800 Hz.[26, 33, 38]
3.4.2 ZvolenÃ© zaÅ™Ã­zenÃ­
VÃ½Å¡e uvedenÃ½m poÅ¾adavkÅ¯m vyhovuje napÅ™Ã­klad zaÅ™Ã­zenÃ­ Galaxy S7 od spoleÄnosti Samsung. DÅ¯vodem volby tohoto zaÅ™Ã­zenÃ­ byla schopnost mikrofonu zaznamenÃ¡vat
33

nÃ­zkofrekvenÄnÃ­ sloÅ¾ky audio signÃ¡lu. Tato skuteÄnost byla zjiÅ¡tÄ›na empiricky parametry mikrofonu nebyly nalezeny na strÃ¡nkÃ¡ch vÃ½robce ani pÅ™idruÅ¾enÃ½ch fÃ³rech.
JednÃ¡ se o vÃ½konnÃ© a kvalitnÄ› vybavenÃ© zaÅ™Ã­zenÃ­. VÃ½kon zaÅ™Ã­zenÃ­ zajiÅ¡Å¥uje osmijÃ¡drovÃ½ procesor Samsung Exynos 8890 o frekvenci 2,3 GHz v kombinaci se 4 GB pamÄ›ti RAM. PrimÃ¡rnÃ­ fotoaparÃ¡t mÃ¡ rozliÅ¡enÃ­ 12,2 Mpx a je tedy nadmÃ­ru dostaÄujÃ­cÃ­. UmÃ­stÄ›nÃ­ LED je v pÅ™ijatelnÃ© vzdÃ¡lenosti objektivu fotoaparÃ¡tu. ZadnÃ­ strana fotoaparÃ¡tu je vyobrazena na obrÃ¡zku 3.5.[51]
Obr. 3.5: ChytrÃ½ telefon Samsung Galaxy S7 [51] Jak je zmÃ­nÄ›no vÃ½Å¡e, PPG signÃ¡l lze pomÄ›rnÄ› snadno zÃ­skat. Naopak zÃ­skÃ¡nÃ­ FKG signÃ¡lu je velice problematickÃ©. ZÃ¡znam je velice citlivÃ½ na okolnÃ­ ruÅ¡enÃ­, a proto je nutnÃ© nahrÃ¡vat v klidnÃ© mÃ­stnosti. DalÅ¡Ã­m problÃ©mem jsou pohyby vyÅ¡etÅ™ovanÃ© osoby. Pohyb mikrofonu po kÅ¯Å¾i mÃ¡ za nÃ¡sledek neobnovitelnÃ© zniÄenÃ­ zÃ¡znamu. Tyto pohyby jsou obvykle zpÅ¯sobeny pÅ™iloÅ¾enÃ­m prstu pÅ™i mÄ›Å™enÃ­ PPG signÃ¡lu a zmÄ›nou objemu hrudi vlivem dÃ½chÃ¡nÃ­. Aby se zabrÃ¡nilo vzniku nekvalitnÃ­ho zÃ¡znamu je bÄ›hem mÄ›Å™enÃ­ nutnÃ© poskytnout vyÅ¡etÅ™ovanÃ© osobÄ› zpÄ›tnou vazbu v podobÄ› audio-vizuÃ¡lnÃ­ reprezentace. SignÃ¡l FKG je moÅ¾nÃ© zesÃ­lit a v reÃ¡lnÃ©m Äase pÅ™ehrÃ¡vat, coÅ¾ ovÅ¡em vyÅ¾aduje pÅ™Ã­sluÅ¡enstvÃ­ v podobÄ› sluchÃ¡tek. DalÅ¡Ã­ moÅ¾nostÃ­ je zobrazit PPG a FKG signÃ¡ly na displeji telefonu. ZpÄ›tnou vazbu ovÅ¡em nelze zajistit, bez aplikace vytvoÅ™enÃ© pro tento konkrÃ©tnÃ­ ÃºÄel.
34

4 VÃ½voj mobilnÃ­ aplikace
Na zÃ¡kladÄ› problematickÃ©ho snÃ­mÃ¡nÃ­ obou signÃ¡lÅ¯, popsanÃ½ch v pÅ™edchozÃ­ kapitole, je Å¾Ã¡doucÃ­ vytvoÅ™it aplikaci usnadÅˆujÃ­cÃ­ akvizici dat. Toho je dosaÅ¾eno zajiÅ¡tÄ›nÃ­m zpÄ›tnÃ© vazby v reÃ¡lnÃ©m Äase uÅ¾ivateli, kterÃ½ signÃ¡ly mÄ›Å™Ã­. Podoba zpÄ›tnÃ© vazby PPG signÃ¡lu je vizuÃ¡lnÃ­. JednÃ¡ se o vyobrazenÃ­ grafu prÅ¯mÄ›rnÃ½ch jasovÃ½ch hodnot ÄervenÃ© sloÅ¾ky jednotlivÃ½ch snÃ­mkÅ¯. ZpÄ›tnou vazbu FKG signÃ¡lu lze realizovat vizuÃ¡lnÄ› v podobÄ› grafu Äi v podobÄ› audia pÅ™ehrÃ¡vanÃ©ho skrze pÅ™ipojenÃ¡ sluchÃ¡tka. V ideÃ¡lnÃ­m pÅ™Ã­padÄ› kombinacÃ­ obou - audiovizuÃ¡lnÄ›.
4.1 ZaloÅ¾enÃ­ projektu
Pro vÃ½voj aplikace bylo zvoleno vÃ½vojovÃ© prostÅ™edÃ­ Android Studio. ZaloÅ¾enÃ­ novÃ©ho projektu je velmi jednoduchÃ© a intuitivnÃ­. PÅ™i jeho zaklÃ¡dÃ¡nÃ­ je nutnÃ© zvolit nejniÅ¾Å¡Ã­ verzi operaÄnÃ­ho systÃ©mu, na kterou lze aplikaci nainstalovat a potÃ© spustit. Na zÃ¡kladÄ› vyuÅ¾itÃ­ jednotlivÃ½ch verzÃ­, uvedenÃ½ch v tabulce 2.1, byla zvolena verze 6.0, tedy Android Marshmallow. PÅ™i vÃ½voji se ovÅ¡em ukÃ¡zalo, Å¾e tato verze nenÃ­ pro ÃºÄely aplikace dostaÄujÃ­cÃ­. Z tohoto dÅ¯vodu bylo nutnÃ© celÃ½ projekt povÃ½Å¡it na verzi 7.0, tedy Android Nougat. HlavnÃ­m dÅ¯vodem byla nemoÅ¾nost zajiÅ¡tÄ›nÃ­ ÄasovÃ© znÃ¡mky u FKG signÃ¡lu, kterÃ¡ je nutnÃ¡ pro synchronizaci s PPG signÃ¡lem. Po zvÃ½Å¡enÃ­ minimÃ¡lnÃ­ verze bylo nutnÃ© provÃ©st revizi kÃ³du a opravit ÄÃ¡sti, jeÅ¾ se staly zastaralÃ© Äi nefunkÄnÃ­.
4.2 Architektura aplikace
ProgramovÃ¡ ÄÃ¡st projektu se sestÃ¡vÃ¡ z jednÃ© aktivity, dvou tÅ™Ã­d implementovanÃ½ch v programovacÃ­m jazyce Java a nativnÃ­ho skriptu na platformÄ› RenderScript. Pro pochopenÃ­ architektury projektu je nutnÃ¡ alespoÅˆ zÃ¡kladnÃ­ znalost objektovÄ› orientovanÃ©ho programovÃ¡nÃ­ (Object-Oriented Programming - OOP) a prÃ¡ce ve vlÃ¡knech.
TÅ™Ã­dy a aktivity
PrvnÃ­ ze dvou tÅ™Ã­d nese nÃ¡zev VideoDataAcquisition. PrimÃ¡rnÃ­ ÃºÄel tÃ©to tÅ™Ã­dy je prÃ¡ce s fotoaparÃ¡tem telefonu, nahrÃ¡nÃ­ video zÃ¡znamu, zpracovÃ¡nÃ­ snÃ­mkÅ¯ v reÃ¡lnÃ©m Äase a poskytnutÃ­ zpÄ›tnÃ© vazby.
DruhÃ¡ tÅ™Ã­da nese nÃ¡zev AudioDataAcquisition. JejÃ­ primÃ¡rnÃ­ ÃºÄel je nahrÃ¡vÃ¡nÃ­ audio zÃ¡znamu skrz mikrofon telefonu, poskytnutÃ­ zpÄ›tnÃ© vazby a synchronizace audio zÃ¡znamu s video zÃ¡znamem.
35

Aby bylo moÅ¾nÃ© vyuÅ¾Ã­t funkcionalitu vÃ½Å¡e uvedenÃ½ch tÅ™Ã­d je nutnÃ© nejprve vytvoÅ™it jejich instanci. Instance tÅ™Ã­dy je v OOP konkrÃ©tnÃ­ datovÃ½ objekt uloÅ¾enÃ½ v pamÄ›ti vytvoÅ™enÃ½ na zÃ¡kladÄ› vzoru - tÅ™Ã­dy. Ten se nachÃ¡zÃ­ v poÄÃ¡teÄnÃ­m stavu definovanÃ½ konstruktorem - zavolanÃ¡ metoda pÅ™i instanci tÅ™Ã­dy. Inicializace tÄ›chto tÅ™Ã­d je provedena v hlavnÃ­ spouÅ¡tÄ›cÃ­ aktivitÄ›.
Tato aktivita byla vytvoÅ™ena pÅ™i zaloÅ¾enÃ­ projektu, a proto nese nÃ¡zev MainActivity. JednÃ¡ se o startovnÃ­ bod aplikace, kde pÅ™i jejÃ­m spuÅ¡tÄ›nÃ­ nabÄ›hne prÃ¡vÄ› tato aktivita. Ta zkontroluje oprÃ¡vnÄ›nÃ­ a pÅ™ipravÃ­ GUI. V pÅ™Ã­padÄ›, Å¾e aplikace nemÃ¡ dostateÄnÃ¡ oprÃ¡vnÄ›nÃ­ je uÅ¾ivateli nabÃ­dnuto jejich udÄ›lenÃ­. OprÃ¡vnÄ›nÃ­, jeÅ¾ aplikace vyÅ¾aduje, jsou pro jejÃ­ bÄ›h aplikace esenciÃ¡lnÃ­. JmenovitÄ› se jednÃ¡ oprÃ¡vnÄ›nÃ­ pouÅ¾Ã­vat fotoaparÃ¡t, mikrofon a zapisovat do souborovÃ©ho systÃ©mu. Bez udÄ›lenÃ­ tÄ›chto oprÃ¡vnÄ›nÃ­ je aplikace bezpodmÃ­neÄnÄ› ukonÄena.
VÃ½hodou vÃ½Å¡e uvedenÃ©ho ÄlenÄ›nÃ­ kÃ³du je nezÃ¡vislost tÅ™Ã­d VideoDataAcquisition a AudioDataAcquisition na ostatnÃ­ch ÄÃ¡stech aplikace. Na zÃ¡kladÄ› tÄ›chto tÅ™Ã­d lze tedy celkem pohodlnÄ› vytvoÅ™it aplikaci, kterÃ¡ zpracovÃ¡vÃ¡ stejnÃ¡ data, ale mÃ¡ jinÃ½ vÃ½stup. NapÅ™Ã­klad na zÃ¡kladÄ› tÅ™Ã­dy VideoDataAcquisition lze vytvoÅ™it aplikaci mÄ›Å™Ã­cÃ­ tepovou frekvenci.
Optimalizace vÃ½konu
Z dÅ¯vodu vÃ½konnostnÃ­ nÃ¡roÄnosti nÄ›kterÃ½ch operacÃ­ (nahrÃ¡vÃ¡nÃ­ audia a videa) bylo nutnÃ© pÅ™esunout zÃ¡tÄ›Å¾ z hlavnÃ­ho vlÃ¡kna (Main Thread), kterÃ© je zodpovÄ›dnÃ© za veÅ¡kerÃ© udÃ¡losti dÄ›jÃ­cÃ­ se na obrazovce telefonu, do samostatnÃ½ch vlÃ¡ken. SpouÅ¡tÄ›nÃ­ nÃ¡roÄnÃ½ch operacÃ­ v tomto vlÃ¡knÄ› zpÅ¯sobÃ­, Å¾e uÅ¾ivatel mÅ¯Å¾e pozorovat zadrhÃ¡vÃ¡nÃ­, zpoÅ¾dÄ›nÃ­ a nedostateÄnÄ› citlivou odezvu na vstup (napÅ™. kliknutÃ­ na tlaÄÃ­tko). Pokud je hlavnÃ­ vlÃ¡kno zablokovÃ¡no na vÃ­ce neÅ¾ pÄ›t sekund systÃ©m umoÅ¾nÃ­ uÅ¾ivateli aplikaci ukonÄit pÅ™Ã­mo. Na tomto zÃ¡kladÄ› bylo pro kaÅ¾dou tÅ™Ã­du vytvoÅ™eno samostatnÃ© vlÃ¡kno bÄ›Å¾Ã­cÃ­ na pozadÃ­ - VideoThread a AudioThread.[14]
4.3 Kompatibilita
PÅ™i vÃ½voji aplikace je velmi dÅ¯leÅ¾itÃ© seznÃ¡mit se s doporuÄenÃ½mi postupy, podporovanÃ½mi formÃ¡ty a technickÃ½mi detaily. HlavnÃ­m dÅ¯vodem je kompatibilita mezi rÅ¯znÃ½mi druhy zaÅ™Ã­zenÃ­. Ty se vzÃ¡jemnÄ› liÅ¡Ã­ pouÅ¾itÃ½m HW pÅ™i jejich vÃ½robÄ›. Proto s kaÅ¾dou novou verzÃ­ operaÄnÃ­ho systÃ©mu Android vychÃ¡zÃ­ dokument definice kompatibility (Compatibility Definition Document - CDD). Tento dokument uvÃ¡dÃ­ poÅ¾adavky, kterÃ© musÃ­ bÃ½t splnÄ›ny, aby byla zaÅ™Ã­zenÃ­ kompatibilnÃ­ s nejnovÄ›jÅ¡Ã­ verzÃ­ systÃ©mu Android. Dokument je dÅ¯leÅ¾itÃ½ jak pro vÃ½robce, tak pro vÃ½vojÃ¡Å™e (programÃ¡tora). VÃ½robce musÃ­ zajistit, aby zaÅ™Ã­zenÃ­ bylo HW kompatibilnÃ­ s verzÃ­ operaÄnÃ­ho
36

systÃ©mu na kterou cÃ­lÃ­. VÃ½vojÃ¡Å™ mÃ¡ dÃ­ky dokumentu dostupnÃ© informace, jakÃ¡ funkcionalita musÃ­ bÃ½t splnÄ›na verzÃ­ operaÄnÃ­ho systÃ©mu, na kterou aplikaci vyvÃ­jÃ­. Na zÃ¡kladÄ› CDD, verze 7.0, byla stanovena nÃ¡sledujÃ­cÃ­ kritÃ©ria pro snÃ­mÃ¡nÃ­ PPG a FKG signÃ¡lu. VÃ½znam neznÃ¡mÃ½ch tÅ™Ã­d a zkratek je vysvÄ›tlen v odpovÃ­dajÃ­cÃ­m kontextu tÃ©to kapitoly.[2]
PoÅ¾adavky video signÃ¡lu
â€¢ VÅ¡echny video kodÃ©ry a dekodÃ©ry musÃ­ podporovat barevnÃ½ formÃ¡t YUV420. â€¢ Podpora video kodeku H.264 (pro kÃ³dovÃ¡nÃ­ i dekÃ³dovÃ¡nÃ­) je vyÅ¾adovÃ¡na
vÅ¡emi zaÅ™Ã­zenÃ­mi. â€¢ Camera2 API musÃ­ podporovat formÃ¡t YUV_420_888 a JPEG jako vÃ½stup
pro tÅ™Ã­du ImageReader.[2]
PoÅ¾adavky audio signÃ¡lu
â€¢ Podpora audio formÃ¡tu PCM a WAVE je vyÅ¾adovÃ¡na vÅ¡emi zaÅ™Ã­zenÃ­mi. â€¢ Pro zÃ¡znam syrovÃ©ho audio signÃ¡lu musÃ­ zaÅ™Ã­zenÃ­ podporovat tyto vlastnosti:
â€“ FormÃ¡t: PCM â€“ BitovÃ¡ hloubka: 16 bit â€“ VzorkovacÃ­ frekvence: 8 000, 11 025, 16 000, 44 100 Hz â€“ KanÃ¡ly: Mono â€¢ ZÃ¡znam pro vÃ½Å¡e uvedenÃ© vzorkovacÃ­ frekvence musÃ­ bÃ½t proveden bez nadvzorkovÃ¡nÃ­ Äi podvzorkovÃ¡nÃ­ (HW Å™eÅ¡enÃ­) a musÃ­ zahrnovat odpovÃ­dajÃ­cÃ­ antialiasingovÃ½ filtr.[2]
4.4 OprÃ¡vnÄ›nÃ­
Aby bylo moÅ¾nÃ© vyuÅ¾Ã­vat funkÄnost nÃ­Å¾e uvedenÃ½ch tÅ™Ã­d, je nutnÃ©, aby byla aplikaci pÅ™idÄ›lena dostateÄnÃ¡ oprÃ¡vnÄ›nÃ­. OprÃ¡vnÄ›nÃ­ aplikace se definuje v souboru AndroidManifest.xml. PotÅ™ebnÃ¡ oprÃ¡vnÄ›nÃ­ jsou uvedena ve vÃ½pisu 4.1.[3, 12, 20]
1 <!-- PouÅ¾Ã­vÃ¡nÃ­ fotoaparÃ¡tu --> 2 <uses -permission android:name="android.permission.CAMERA" /> 3 <!-- NahrÃ¡vÃ¡nÃ­ audio zÃ¡znamu --> 4 <uses -permission android:name="android.permission.RECORD_AUDIO" /> 5 <!-- NahrÃ¡vÃ¡nÃ­ video zÃ¡znamu --> 6 <uses -permission android:name="android.permission.RECORD_VIDEO" /> 7 <!-- ZÃ¡pis do souborovÃ©ho systÃ©mu --> 8 <uses -permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
VÃ½pis 4.1: OprÃ¡vnÄ›nÃ­ potÅ™ebnÃ¡ pro zÃ¡pis a akvizici dat
37

4.5 Akvizice fotopletysmografickÃ½ch dat
Jak jiÅ¾ bylo naznaÄeno, tÅ™Ã­da VideoDataAcquisition sdruÅ¾uje metody a objekty, skrze kterÃ© lze ovlÃ¡dat fotoaparÃ¡t telefonu, zpracovÃ¡vat jednotlivÃ© snÃ­mky a poskytovat informace o aktuÃ¡lnÃ­m stavu snÃ­manÃ© osoby. Tato sekce popisuje funkci tÃ©to tÅ™Ã­dy.
4.5.1 OvlÃ¡dÃ¡nÃ­ fotoaparÃ¡tu
VÃ½vojovÃ½ diagram ovlÃ¡dÃ¡nÃ­ fotoaparÃ¡tu je vyobrazen na obr. 4.1. Jeho dÃ­lÄÃ­ ÄÃ¡sti jsou podrobnÄ› rozebrÃ¡ny v nÃ¡sledujÃ­cÃ­ch podsekcÃ­ch. PrÅ¯bÄ›h diagramu popisuje stav od otevÅ™enÃ­ fotoaparÃ¡tu aÅ¾ po zÃ­skÃ¡nÃ­ po obrazovÃ½ch dat. TÅ™Ã­dy MediaRecorder a ImageReader jsou popsÃ¡ny v sekci 4.5.2.
CameraManager
KlÃ­ÄovÃ½m prvkem Camera2 API je tÅ™Ã­da CameraManager. Ta zajiÅ¡Å¥uje detekci, charakterizaci a zprostÅ™edkovÃ¡nÃ­ pÅ™Ã­stupu k jednotlivÃ½m fotoaparÃ¡tÅ¯m. PouÅ¾itÃ­m metody getCameraIdList() lze zÃ­skat identifikÃ¡tor vÅ¡ech aktuÃ¡lnÄ› dostupnÃ½ch fotoaparÃ¡tÅ¯. Na zÃ¡kladÄ› identifikÃ¡toru lze pak zÃ­skat dodateÄnÃ© informace o konkrÃ©tnÃ­m fotoaparÃ¡tu pomocÃ­ metody getCameraCharacteristics(). JednÃ¡ se pouze o vÃ½pis funkcÃ­, kterÃ½mi fotoaparÃ¡t disponuje - jsou tedy nemÄ›nitelnÃ©. Pro ÃºÄely tÃ©to aplikace lze tedy zjistit, zdali vybranÃ½ fotoaparÃ¡t disponuje pÅ™isvÄ›tlovacÃ­ diodou Äi s jakÃ½mi rozliÅ¡enÃ­mi je schopen pracovat. PoslednÃ­, zde zmÃ­nÄ›nou, metodou je metoda openCamera(), jeÅ¾ vytvoÅ™Ã­ pÅ™Ã­stup ke konkrÃ©tnÃ­mu HW fotoaparÃ¡tu. Vstupem tÃ©to metody je identifikÃ¡tor fotoaparÃ¡tu a instance tÅ™Ã­dy CameraDeviceStateCallback. UkÃ¡zka prÃ¡ce se tÅ™Ã­dou CameraManager je uvedena ve vÃ½pisu 4.2.[3, 19, 20, 25]
1 // Instance tÅ™Ã­dy CameraManager pomocÃ­ systÃ©movÃ© sluÅ¾by 2 mCameraManager = (CameraManager)
appContext.getSystemService(appContext.CAMERA_SERVICE); 3 4 // IdentifikÃ¡tor hlavnÃ­ho fotoaparÃ¡tu 5 mCameraId = mCameraManager.getCameraIdList()[0]; 6 7 // Informace o fotoaparÃ¡tu 8 mCharacteristics = mCameraManager.getCameraCharacteristics(mCameraId); 9 10 // Zji Å¡ t Ä› n Ã­ p Å™ Ã­ tomnosti p Å™ isv Ä› tlovac Ã­ diody 11 boolean flash = m C h a r a c t e r i s t i c s . get ( C a m e r a C h a r a c t e r i s t i c s . F L A S H _ I N F O _ A V A I L A B L E ) 12 13 // Otev Å™ en Ã­ fotoapar Ã¡ tu na konkr Ã© tn Ã­ m vl Ã¡ kn Ä› ( m Ba c kg ro u nd H an dl e r ) 14 mCame raManage r . openCamera ( mCameraId , mCameraDeviceStateCallback ,
mBackgroundHandler);
VÃ½pis 4.2: UkÃ¡zka prÃ¡ce se tÅ™Ã­dou CameraManager
38

CameraCaptureSession setRepeatingRequest()
CameraCaptureSessionStateCallback onActive()
onCaptureQueueEmpty() onClosed()
onConï¬gureFailed() onConï¬gured() onReady()
onSurfacePrepared()

CameraManager getCameraIdList() getCameraCharacteristics()
openCamera()
CaptureRequest CaptureRequest.Builder
addTarget() build() set()
MediaRecorder getSurface()
ImageReader getSurface()

cameraId
CameraDeviceStateCallback onClosed()
onDisconnected() onError()
onOpened() CameraDevice
close() createCaptureRequest() createCaptureSession()

Obr. 4.1: VÃ½vojovÃ½ diagram ovlÃ¡dÃ¡nÃ­ fotoaparÃ¡tu. ModrÃ© bloky reprezentujÃ­ promÄ›nnÃ©. Å edÃ© bloky reprezentujÃ­ instanci konkrÃ©tnÃ­ tÅ™Ã­dy. UvnitÅ™ tÄ›chto blokÅ¯ se nachÃ¡zejÃ­ dÅ¯leÅ¾itÃ© veÅ™ejnÃ© metody (zelenÃ© bloky) tÃ©to tÅ™Ã­dy. TuÄnÃ© Å¡ipky oznaÄujÃ­ inicializaci danÃ© tÅ™Ã­dy z konkrÃ©tnÃ­ metody tÅ™Ã­dy jinÃ©. KlasickÃ© Å¡ipky oznaÄujÃ­ vstupy a vÃ½stupy metod.
CameraDeviceStateCallback
Instance tÅ™Ã­dy CameraDeviceStateCallback je nÃ¡vratovÃ½ objekt (callback object) reagujÃ­cÃ­ na zmÄ›nu stavu fotoaparÃ¡tu. ZmÄ›na stavu fotoaparÃ¡tu vyvolÃ¡ zavolÃ¡nÃ­ konkrÃ©tnÃ­ metody obsluhujÃ­cÃ­ tento stav. Metody jsou nÃ¡sledujÃ­cÃ­.[18]
â€¢ onClosed() - zavolÃ¡no po zavÅ™enÃ­ fotoaparÃ¡tu â€¢ onDisconnected() - zavolÃ¡no pokud jiÅ¾ nenÃ­ fotoaparÃ¡t k dispozici â€¢ onError() - zavolÃ¡no pÅ™i vÃ¡Å¾nÃ© chybÄ› (napÅ™. chybÄ› pÅ™i otevÃ­rÃ¡nÃ­ fotoaparÃ¡tu) â€¢ onOpened() - zavolÃ¡no po otevÅ™enÃ­ (skrz CameraManager)
39

JelikoÅ¾ se jednÃ¡ o prÃ¡ci s HW, je tedy nutnÃ© vyuÅ¾Ã­t vÃ½Å¡e uvedenÃ© stavy. DÅ¯vodem je fakt, Å¾e po zavolÃ¡nÃ­ metody openCamera() z instance tÅ™Ã­dy CameraManager, vyÅ¾aduje fotoaparÃ¡t urÄitÃ½ Äas, neÅ¾-li se otevÅ™e. Po jeho ÃºspÄ›Å¡nÃ©m otevÅ™enÃ­ je zavolÃ¡na metoda onOpened(), jejÃ­Å¾ vstupnÃ­ parametr je instance tÅ™Ã­dy CameraDevice. UkÃ¡zaka metody onOpened() je uvedena ve vÃ½pisu 4.3.[3, 18]

CameraDevice

Instance tÅ™Ã­dy CameraDevice reprezentuje jiÅ¾ konkrÃ©tnÃ­ fotoaparÃ¡t. PÅ™ed zapoÄetÃ­m snÃ­mÃ¡nÃ­ je ovÅ¡em nutnÃ© alokovat vyrovnÃ¡vacÃ­ pamÄ›Å¥ (buffer). Ten je v tomto pÅ™Ã­padÄ› reprezentovÃ¡n tÅ™Ã­dou Surface. Tato vyrovnÃ¡vacÃ­ pamÄ›Å¥ je obvykle vytvoÅ™ena svÃ½mi spotÅ™ebiteli - v pÅ™Ã­padÄ› tÃ©to aplikace tÅ™Ã­dou MediaRecorder a tÅ™Ã­dou ImageReader, za pomoci metody getSurface(). JinÃ½mi slovy MediaRecorder a ImageReader vytvoÅ™Ã­ vyrovnÃ¡vacÃ­ pamÄ›Å¥ vyhovujÃ­cÃ­ jejich poÅ¾adavkÅ¯m. DÃ¡le je nutnÃ© vytvoÅ™it relaci snÃ­mÃ¡nÃ­, kterÃ© jsou pÅ™iÅ™azeny jednotlivÃ© vyrovnÃ¡vacÃ­ pamÄ›ti. Ty jsou potÃ© plnÄ›ny obrazovÃ½mi daty z konkrÃ©tnÃ­ho fotoaparÃ¡tu - CameraDevice. Novou relaci snÃ­mÃ¡nÃ­ lze vytvoÅ™it pomocÃ­ metody createCaptureSession(), jejÃ­miÅ¾ vstupnÃ­mi parametry jsou jednotlivÃ© vyrovnÃ¡vacÃ­ pamÄ›ti a instance tÅ™Ã­dy CameraCaptureSessionStateCallback. UkÃ¡zka vytvoÅ™enÃ­ novÃ© relace je uvedena ve vÃ½pisu 4.3.[3, 17, 52]

1 public void onOpened(CameraDevice cameraDevice) {

2 // PÅ™idÃ¡nÃ­ instancÃ­ vyrovnÃ¡vacÃ­ch pamÄ›ti do listu

3

List <Surface > surfaces = new ArrayList <>();

4

surfaces . add ( mMediaRecorder . getSurface () );

5

surfaces . add ( mImageReader . getSurface () );

6

7 // Relace snÃ­mÃ¡nÃ­ na konkrÃ©tnÃ­m vlÃ¡knÄ› (mBackgroundHandler)

8

cameraDevice.createCaptureSession(surfaces , mCameraCaptureSessionStateCallback ,

mBackgroundHandler);

9}

VÃ½pis 4.3: UkÃ¡zka metody onOpened() tÅ™Ã­dy CameraDeviceStateCallback

CameraCaptureSessionStateCallback
PodobnÄ› jako tÅ™Ã­da CameraDeviceStateCallback i tato tÅ™Ã­da implementuje nÃ¡vratovÃ½ objekt reagujÃ­cÃ­ na zmÄ›ny stavu relace snÃ­mÃ¡nÃ­. JejÃ­ metody jsou nÃ¡sledujÃ­cÃ­.[16]
â€¢ onActive() - zavolÃ¡no pÅ™i spuÅ¡tÄ›nÃ­ relace â€¢ onCaptureQueueEmpty() - zavolÃ¡no pÅ™i Å¾Ã¡dosti o dalÅ¡Ã­ snÃ­mek â€¢ onClosed() - zavolÃ¡no po ukonÄenÃ­ relace â€¢ onConfigureFailed() - zavolÃ¡no pÅ™i nevyhovujÃ­cÃ­ konfiguraci CameraDevice â€¢ onConfigured() - zavolÃ¡no po nakonfigurovÃ¡nÃ­ CameraDevice â€¢ onReady() - zavolÃ¡no vÅ¾dy, kdyÅ¾ relace nemÃ¡ Å¾Ã¡dnou dalÅ¡Ã­ Å¾Ã¡dost o snÃ­mek â€¢ onSurfacePrepared() - zavolÃ¡no pÅ™i pÅ™edbÄ›Å¾nÃ©m pÅ™idÄ›lenÃ­ vyrovnÃ¡vacÃ­ pamÄ›ti

40

Pokud nebudeme uvaÅ¾ovat chybovÃ© stavy, je nejprve zavolÃ¡na metoda onConfigured(), jejÃ­Å¾ zavolÃ¡nÃ­ je dÅ¯kazem, Å¾e konfigurace CameraDevice byla ÃºspÄ›Å¡nÃ¡. DÃ¡le je zavolÃ¡na metoda onReady(), ve kterÃ© je nutnÃ© vytvoÅ™it Å¾Ã¡dost o zachycenÃ­ snÃ­mku - CaptureRequest. CaptureRequest lze vytvoÅ™it pomocÃ­ metody build() tÅ™Ã­dy CaptureRequest.Builder. UkÃ¡zka metody onReady() je uvedena ve vÃ½pisu 4.4. [16, 21, 22]
Instanci tÅ™Ã­dy CaptureRequest.Builder lze zÃ­skat pomocÃ­ metody createCaptureRequest() tÅ™Ã­dy CameraDevice. JednÃ¡ se o tÅ™Ã­du zodpovÄ›dnou za stavbu a konfiguraci Å¾Ã¡dosti. Skrze metodou addTarget() jsou pÅ™iÅ™azeny vyrovnÃ¡vacÃ­ pamÄ›ti do nÃ­Å¾ budou odesÃ­lÃ¡na obrazovÃ¡ data (je moÅ¾nÃ© pouÅ¾Ã­t pouze vyrovnÃ¡vacÃ­ pamÄ›ti, jeÅ¾ byly pÅ™edÃ¡ny v metodÄ› createCaptureSession()). DÃ¡le je zde moÅ¾nÃ© nastavit stav pÅ™isvÄ›tlovacÃ­ diody - pro vyuÅ¾itÃ­ v tÃ©to aplikaci je dioda ve stavu svÃ­tilny (torch). Pokud je vÅ¡e nakonfigurovÃ¡no, pak zavolÃ¡nÃ­m metody build je vytvoÅ™ena instance tÅ™Ã­dy CaptureRequest.[21, 22]
Pro zapoÄetÃ­ snÃ­manÃ­ je nutnÃ© zajistit nekoneÄnÃ© opakovÃ¡nÃ­ (v pÅ™Ã­padÄ› video zÃ¡znamu) zÃ­skÃ¡vÃ¡nÃ­ obrazovÃ½ch dat touto relacÃ­. Toho lze docÃ­lit zavolÃ¡nÃ­m metody setRepeatingRequest() aktuÃ¡lnÃ­ relace. Vstupem tÃ©to funkce je jiÅ¾ nÃ¡mi nakonfigurovanÃ½ CaptureRequest. PotÃ© je zavolÃ¡na metoda onActive, kterÃ¡ znaÄÃ­ zaÄÃ¡tek relace snÃ­mÃ¡nÃ­. UvnitÅ™ tÃ©to metody je Å¾Ã¡doucÃ­ zaznamenat Äasovou znÃ¡mku kvÅ¯li nÃ¡slednÃ© synchronizaci audio a video zÃ¡znamu, tak aby bylo mÄ›Å™enÃ­ platnÃ©. Synchronizace je podrobnÄ› rozebrÃ¡na v sekci 4.7.[16]

1 public void onReady(CameraCaptureSession session) {

2 // Instance tÅ™Ã­dy CaptureRequest.Builder dle vzoru CameraDevice.TEMPLATE_RECORD

3

CaptureRequest.Builder builder =

mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_RECORD);

4

5 // RozsvÃ­cenÃ­ pÅ™isvÄ›tlovacÃ­ diody v reÅ¾imu svÃ­tilny

6

builder.set(CaptureRequest.FLASH_MODE , CameraMetadata.FLASH_MODE_TORCH);

7

8 // PÅ™iÅ™azenÃ­ vyrovnÃ¡vacÃ­ch pamÄ›tÃ­

9

builder . addTarget ( mImageReader . getSurface () );

10

builder . addTarget ( mMediaRecorder . getSurface () );

11

12 // Sestaven Ã­ Å¾ Ã¡ dosti

13

CaptureRequest request = builder.build();

14

15 // Vytvo Å™ en Ã­ nekone Ä n Ã© smy Ä ky Å¾ Ã¡ dost Ã­ na konkr Ã© tn Ã­ m vl Ã¡ kn Ä› ( m B a c k g r o u n d H a n d l e r )

16

session.setRepeatingRequest(request , null , mBackgroundHandler);

17 }

VÃ½pis 4.4: UkÃ¡zka metody onReady() tÅ™Ã­dy CameraCaptureSessionStateCallback

41

4.5.2 ZpracovÃ¡nÃ­ obrazovÃ½ch dat
Jakmile jsou vyrovnÃ¡vacÃ­ pamÄ›ti plnÄ›ny obrazovÃ½mi daty, je vhodnÃ© data zpracovat. K tomuto ÃºÄelu nÃ¡m poslouÅ¾Ã­ tÅ™Ã­dy MediaRecorder a ImageReader. V pÅ™Ã­padÄ› nahrÃ¡vÃ¡nÃ­ bÄ›Å¾nÃ©ho video zÃ¡znamu je tÅ™Ã­da MediaRecorder naprosto dostaÄujÃ­cÃ­. OvÅ¡em v pÅ™Ã­padÄ› tÃ©to aplikace je Å¾Ã¡doucÃ­ uÅ¾ivateli zobrazit zpracovanÃ¡ obrazovÃ¡ data v podobÄ› PPG signÃ¡lu. TÅ™Ã­da MediaRecorder bohuÅ¾el neposkytuje Å¾Ã¡dnÃ© informace o aktuÃ¡lnÄ› zpracovanÃ½ch snÃ­mcÃ­ch. Proto bylo nutnÃ© vyuÅ¾Ã­t tÅ™Ã­du ImageReader, kterÃ¡ umoÅ¾Åˆuje zpracovÃ¡vat obrazovÃ¡ data pÅ™Ã­mo.[37, 44]
MediaRecorder
Instance tÃ©to tÅ™Ã­dy je bÄ›Å¾nÄ› vyuÅ¾Ã­vÃ¡na pro nahrÃ¡vÃ¡nÃ­ audio a video zÃ¡znamÅ¯. VÃ½vojÃ¡Å™i nabÃ­zÃ­ velkÃ© mnoÅ¾stvÃ­ nastavenÃ­, kterÃ© ovlivÅˆuje kvalitu vÃ½slednÃ©ho zÃ¡znamu. TÅ™Ã­da MediaRecorder pracuje na principu stavovÃ©ho automatu, jehoÅ¾ stavy a pÅ™echody mezi nimi jsou vyobrazeny na obrÃ¡zku 4.2.[44]

Error

reset()

error

release()
Released

Initial

setAudioSource() setVideoSource()

reset()

Initialized

setAudioSource() setVideoSource()

reset() / stop()
Recording

setOutputFormat()

reset()

setAudioEncoder()

setVideoEncoder()

DataSourceConfigurated

setOutputFile() setVideoSize()

setPreviewDisplay()

prepare()

setVideoFrameRate()

reset()

start()

Prepared

Obr. 4.2: VÃ½vojovÃ½ diagram stavÅ¯ a pÅ™echodÅ¯ tÅ™Ã­dy MediaRecorder [44]
PÅ™ed zapoÄetÃ­m nahrÃ¡vÃ¡nÃ­ video zÃ¡znamu je vyÅ¾adovÃ¡na konfigurace instance tÅ™Ã­dy MediaRecorder. Ta je uvedena ve vÃ½pisu 4.5. Po konfiguraci je zavolÃ¡na metoda prepare(), jeÅ¾ pÅ™ipravÃ­ MediaRecorder na sbÄ›r a kÃ³dovÃ¡nÃ­ dat. Po ÃºspÄ›Å¡nÃ©m prÅ¯bÄ›hu lze vyuÅ¾Ã­t metodu getSurface() pro zÃ­skÃ¡nÃ­ vyrovnÃ¡vacÃ­ pamÄ›ti. Pokud je fotoaparÃ¡t otevÅ™enÃ½, jsou pÅ™iÅ™azeny vyrovnÃ¡vacÃ­ pamÄ›ti a je vytvoÅ™ena Å¾Ã¡dost snÃ­mÃ¡nÃ­, pak je moÅ¾nÃ© pomocÃ­ metody start() zahÃ¡jit zpracovÃ¡nÃ­ obrazovÃ½ch dat. NahrÃ¡vÃ¡nÃ­ je ukonÄeno zavolÃ¡nÃ­m metody stop(). Po tÃ©to metodÄ› jiÅ¾ nelze zavolat metodu start()
42

bez opÄ›tovnÃ© konfigurace. DÃ¡le metoda reset() pÅ™esune MediaRecorder do stavu neÄinnosti. V poslednÃ­ Å™adÄ› metoda release() uvolnÃ­ veÅ¡kerÃ© asociovanÃ© zdroje touto tÅ™Ã­dou. VÃ½stupem je video zÃ¡znam ve formÃ¡tu MP4.[44]
1 // Inicializace 2 mMediaRecorder = new MediaRecorder(); 3 4 // NastavenÃ­ zdroje obrazovÃ½ch dat 5 mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.SURFACE); 6 7 // NastavenÃ­ vÃ½stupnÃ­ho formÃ¡tu souboru 8 mMediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4); 9 10 // Nastaven Ã­ cesty v souborov Ã© m syst Ã© mu , kde bude z Ã¡ znam ulo Å¾ en 11 mMedi aRecorde r . setOutputFile ( mFilePath ) ; 12 13 // Nalezen Ã­ vyhovuj Ã­ c Ã­ ho rozli Å¡ en Ã­ pro pot Å™ eby t Ã© to aplikace 14 S t r e a m C o n f i g u r a t i o n M a p map =
mCharacteristics . get ( CameraCharacteristics . SCALER_STREAM_CONFIGURATION_MAP ); 15 mVideoSize = c ho o se Vi de oS i ze ( map . getOu tputSize s ( MediaRecorder . class ) ) ; 16 17 // Nastaven Ã­ vzorkovac Ã­ frekvence - po Ä tu sn Ã­ mku za sekundu 18 mMediaRecorder . s etV ideo Fra meR ate ( VIDEO_FRAME_RATE ) ; 19 20 // Nastaven Ã­ rozli Å¡ en Ã­ videa 21 mMedi aRecorde r . setVideoSize ( mVideoSize . getWidth () , mVideoSize . getHeight () ) ; 22 23 // Nastaven Ã­ kod Ã© ru 24 mMedi aRecorde r . se tV id e oE nc od er ( MediaRecorder . VideoEncoder . H264 ) ; 25 26 // Nastaven Ã­ orientace video z Ã¡ znamu (90 odpov Ã­ d Ã¡ pozici na v Ã½ Å¡ ku ) 27 mMedi aRecorde r . s e t O r i e n t a t i o n H i n t (90) ;
VÃ½pis 4.5: Konfigurace tÅ™Ã­dy MediaRecorder
ImageReader
JelikoÅ¾ tÅ™Ã­da MediaRecorder neumoÅ¾Åˆuje pÅ™Ã­stup k jednotlivÃ½m snÃ­mkÅ¯m, nenÃ­ tak moÅ¾nÃ© zÃ­skat PPG signÃ¡l. Z toho dÅ¯vodu je pro zÃ­skÃ¡nÃ­ PPG signÃ¡lu pouÅ¾ita tÅ™Ã­da ImageReader. Ta umoÅ¾Åˆuje pÅ™Ã­mÃ½ pÅ™Ã­stup k obrazovÃ½m datÅ¯m. TÅ™Ã­da ImageReader je nakonfigurovÃ¡na pÅ™i jejÃ­ inicializaci. Metoda newInstance() oÄekÃ¡vÃ¡ ve vstupnÃ­ch parametrech Å¡Ã­Å™ku a vÃ½Å¡ku snÃ­mku, formÃ¡t a maximÃ¡lnÃ­ poÄet snÃ­mkÅ¯ zpracovÃ¡vanÃ½ch zÃ¡roveÅˆ. Konfigurace tÅ™Ã­dy ImageReader je uvedena ve vÃ½pisu 4.6.
1 // Inicializace 2 mImageReader = ImageReader.newInstance(mVideoSize.getWidth(),
mVideoSize.getHeight(), ImageFormat.YUV_420_888 , 1); 3 4 // NastavenÃ­ zpracovÃ¡nÃ­ novÃ½ch snÃ­mkÅ¯ na konkrÃ©tnÃ­m vlÃ¡knÄ› (mBackgroundHandler) 5 mImageReader.setOnImageAvailableListener(mOnImageAvailableListener ,
mBackgroundHandler);
VÃ½pis 4.6: Konfigurace tÅ™Ã­dy ImageReader
43

RozmÄ›ry snÃ­mku jsou v tomto pÅ™Ã­padÄ› stejnÃ© jako v tÅ™Ã­dÄ› MediaRecorder. TÅ™Ã­da ImageFormat sdruÅ¾uje veÅ¡kerÃ© dostupnÃ© formÃ¡ty zÃ¡znamu obrazovÃ½ch dat na platformÄ› Android. Je dÅ¯leÅ¾itÃ© poznamenat, Å¾e nÄ›kterÃ© formÃ¡ty vyÅ¾adujÃ­ konkrÃ©tnÃ­ HW, a proto je nelze vyuÅ¾Ã­t na nÄ›kterÃ½ch zaÅ™Ã­zenÃ­ch - viz CDD v sekci 4.3.
DÃ¡le je nutnÃ© pomocÃ­ metody setOnImageAvailableListener() pÅ™iÅ™adit instanci tÅ™Ã­dy ImageReader nÃ¡vratovÃ© rozhranÃ­. Toto rozhranÃ­ reaguje na novÃ© snÃ­mky. Obsahuje pouze metodu onImageAvailable(), ve kterÃ© je moÅ¾nÃ© zpracovat obrazovÃ¡ data. PÅ™Ã­klady tÃ©to metody jsou uvedeny ve vÃ½pise 4.7 pro formÃ¡t JPEG a ve vÃ½pise 4.9 pro formÃ¡t YUV_420_888.
FormÃ¡t JPEG PrvnÃ­m vyuÅ¾itÃ½m formÃ¡tem byl komprimovanÃ½ JPEG. Snahou pÅ™i vyuÅ¾itÃ­ tohoto formÃ¡tu bylo vyhnutÃ­ se zpracovÃ¡nÃ­ obrazovÃ½ch dat na nativnÃ­ Ãºrovni. Abychom byli schopni stanovit prÅ¯mÄ›rnou hodnotu ÄervenÃ©ho kanÃ¡lu, bylo nutnÃ© pÅ™evÃ©st JPEG na Bitmap formÃ¡t. Tento pÅ™evod je uveden ve vÃ½pisu 4.7. TÅ™Ã­da Bitmap, jeÅ¾ reprezentuje tento formÃ¡t, zahrnuje metodu getPixel(). Ta oÄekÃ¡vÃ¡ na vstupu souÅ™adnice pixelu. DÃ­ky tomu lze zÃ­skat hodnoty vÅ¡ech pixelÅ¯ pomocÃ­ dvou cyklÅ¯ dle rozmÄ›ru snÃ­mku. VÃ½stupem metody je datovÃ½ typ integer, jenÅ¾ definuje barvu v barevnÃ©m prostoru sRGB. KaÅ¾dÃ¡ barva je sloÅ¾ena ze tÅ™Ã­ barevnÃ½ch sloÅ¾ek a alfa kanÃ¡lu.[15, 36, 32, 23]
â€¢ Alpha kanÃ¡l - prÅ¯hlednost â€¢ Red - ÄervenÃ¡ â€¢ Green - zelenÃ¡ â€¢ Blue - modrÃ¡
KaÅ¾dÃ¡ z vÃ½Å¡e uvedenÃ½ch sloÅ¾ek nabÃ½vÃ¡ celoÄÃ­selnÃ© hodnoty mezi 0 a 255. To odpovÃ­dÃ¡ 8 bitÅ¯m na kaÅ¾dou sloÅ¾ku. JelikoÅ¾ se pixel sklÃ¡dÃ¡ z tÄ›chto 4 sloÅ¾ek, je zapsÃ¡n pomocÃ­ 32-bitovÃ©ho ÄÃ­sla. Hodnota prÅ¯hlednosti je zapsÃ¡na bity na pozici 31â€“24, ÄervenÃ¡ na pozici 23â€“16, zelenÃ¡ na pozici 15â€“8 a modrÃ¡ na pozici 7â€“0. Toto je vyobrazeno na obrÃ¡zku 4.3. ZÃ­skÃ¡nÃ­ prÅ¯mÄ›rnÃ© jasovÃ© hodnoty ÄervenÃ© sloÅ¾ky jednotlivÃ½ch pixelÅ¯ konkrÃ©tnÃ­ho snÃ­mku je uvedeno ve vÃ½pisu 4.8.[32]
Obr. 4.3: Pozice bitÅ¯ jednotlivÃ½ch sloÅ¾ek barevnÃ©ho modelu ARGB [32]
44

Tento postup se ukÃ¡zal znaÄnÄ› nevyhovujÃ­cÃ­. HlavnÃ­m problÃ©mem byla velmi nÃ­zkÃ¡ vzorkovacÃ­ frekvence video zÃ¡znamu. PÅ™i rozliÅ¡enÃ­ 320 Ã— 240 pixelÅ¯ dosahovala pÅ™ibliÅ¾nÄ› 6 Hz. Takto rapidnÃ­ snÃ­Å¾enÃ­ vzorkovacÃ­ frekvence bylo zapÅ™Ã­ÄinÄ›no internÃ­m pÅ™evodem obrazovÃ½ch dat do formÃ¡tu JPEG a vÃ½poÄtem prÅ¯mÄ›rnÃ½ch jasovÃ½ch hodnot ÄervenÃ© sloÅ¾ky na tomto vlÃ¡knÄ›. SamotnÃ½ pÅ™evod do formÃ¡tu JPEG snÃ­Å¾il vzorkovacÃ­ frekvenci z pÅ¯vodnÃ­ch 30 Hz na 12 Hz, vÃ½poÄet prÅ¯mÄ›ru dÃ¡le z 12 Hz na 6 Hz. V sekci 3.4.1, je uvedeno, Å¾e minimÃ¡lnÃ­ vzorkovacÃ­ frekvence PPG signÃ¡lu je 22 Hz, jinak dojde k poruÅ¡enÃ­ vzorkovacÃ­ho teorÃ©mu a tÃ­m k neobnovitelnÃ© ztrÃ¡tÄ› dat. Z toho dÅ¯vodu nenÃ­ moÅ¾nÃ© tento postup zpracovÃ¡vÃ¡nÃ­ obrazovÃ½ch dat pouÅ¾Ã­t.

1 // ZpracovÃ¡nÃ­ obrazovÃ½ch dat - formÃ¡t JPEG

2 public void onImageAvailable(ImageReader reader) {

3

Image image = reader.acquireNextImage();

4

ByteBuffer buffer = image.getPlanes()[0]. getBuffer();

5

byte[] bytes = new byte[buffer.capacity()];

6

buffer.get(bytes);

7

Bitmap bitmap = BitmapFactory.decodeByteArray(bytes , 0, bytes.length , null);

8

9

// VÃ½poÄet prÅ¯mÄ›rnÃ© jasovÃ© hodnoty ÄervenÃ© sloÅ¾ky

10

int redAvg = getAverageValueOfRedChannel(bitmap);

11

image . close () ;

12 }

VÃ½pis 4.7: UkÃ¡zka metody onImageAvailable zpracovÃ¡vajÃ­cÃ­ formÃ¡t JPEG

1 // VÃ½poÄet prÅ¯mÄ›rnÃ© jasovÃ© hodnoty ÄervenÃ© sloÅ¾ky snÃ­mku

2 private int getAverageValueOfRedChannel(Bitmap bitmap) {

3

int width = bitmap.getWidth();

4

int height = bitmap.getHeight();

5

6

// Suma jasovÃ½ch hodnot ÄervenÃ© sloÅ¾ky vÅ¡ech pixelÅ¯

7

int red = 0;

8

9

// ProchÃ¡zenÃ­ jednotlivÃ½ch pixelÅ¯

10

for (int x = 0; x < width; x++) {

11

for (int y = 0; y < height; y++) {

12

int pixel = bitmap.getPixel(x, y);

13

14

// JasovÃ¡ hodnota ÄervenÃ© sloÅ¾ky barevnÃ©ho modelu ARGB

15

red += (pixel >> 16) & 0xff;

16

}

17

}

18

19

// VÃ½poÄet prÅ¯mÄ›rnÃ© jasovÃ© hodnoty ÄervenÃ© sloÅ¾ky ve snÃ­mku

20

return red / (width * height); // Suma dÄ›lenÃ¡ poÄtem pixelÅ¯

21 }

VÃ½pis 4.8: UkÃ¡zka metody getAverageValueOfRedChannel()

45

FormÃ¡t YUV Po pÅ™edchozÃ­ zkuÅ¡enosti s formÃ¡tem JPEG bylo zÅ™ejmÃ©, Å¾e implementace zpracovÃ¡nÃ­ obrazovÃ½ch dat v programovacÃ­m jazyce Java nenÃ­ vhodnÃ¡, jelikoÅ¾ nesplÅˆuje minimÃ¡lnÃ­ poÅ¾adavky pro snÃ­mÃ¡nÃ­ signÃ¡lu PPG. Na tomto zÃ¡kladÄ› bylo nutnÃ© implementovat zpracovÃ¡nÃ­ obrazovÃ½ch dat na nativnÃ­ Ãºrovni, protoÅ¾e zpracovÃ¡nÃ­ formÃ¡tu YUV je nÃ¡roÄnÄ›jÅ¡Ã­. Pro tyto ÃºÄely je dokumentacÃ­ [3] doporuÄen formÃ¡t YUV_420_888.
OznaÄenÃ­ YUV, vztaÅ¾enÃ© k digitÃ¡lnÃ­mu zpracovÃ¡nÃ­, je obvykle pouÅ¾Ã­vÃ¡no k popisu formÃ¡tÅ¯ kÃ³dovanÃ½ch pomocÃ­ barevnÃ©ho modelu YCbCr. FormÃ¡t YUV_420_888 tedy reprezentuje obecnÃ½ formÃ¡t YCbCr pracujÃ­cÃ­ s oddÄ›lenou jasovou sloÅ¾kou Y a chrominanÄnÃ­mi komponenty definujÃ­cÃ­mi barevnÃ½ odstÃ­n - Cb reprezentuje modrou chrominanÄnÃ­ sloÅ¾ku a Cr reprezentuje Äervenou chrominanÄnÃ­ sloÅ¾ku.[35, 36]
ÄŒÃ­slo 420 v nÃ¡zvu popisuje zpÅ¯sob podvzorkovÃ¡nÃ­ barvonosnÃ½ch sloÅ¾ek ve prospÄ›ch sloÅ¾ky jasu, na kterou je lidskÃ© oko citlivÄ›jÅ¡Ã­. TypiÄtÄ›jÅ¡Ã­ znaÄenÃ­ zpÅ¯sobu podvzorkovÃ¡nÃ­ je ve formÃ¡tu J:a:b, kde J urÄuje velikost vzorku, a urÄuje poÄet barvonosnÃ½ch sloÅ¾ek prvnÃ­ho Å™Ã¡dku a b urÄuje poÄet barvonosnÃ½ch sloÅ¾ek druhÃ©ho Å™Ã¡dku. JednotlivÃ© pÅ™Ã­klady jsou vyobrazeny na obrÃ¡zku 4.4. SchÃ©ma 4:4:4 zachovÃ¡vÃ¡ vzorkovacÃ­ frekvenci v obou smÄ›rech. SchÃ©ma 4:2:2 zachovÃ¡vÃ¡ vertikÃ¡lnÃ­ vzorkovacÃ­ frekvenci, ale horizontÃ¡lnÃ­ vzorkovacÃ­ frekvence je snÃ­Å¾ena na polovinu. SchÃ©ma 4:2:0 sniÅ¾uje vzorkovacÃ­ frekvenci na polovinu v obou smÄ›rech.[35]
Obr. 4.4: PodvzorkovÃ¡nÃ­ barvonosnÃ½ch sloÅ¾ek formÃ¡tu YUV [35]
46

DÃ¡le ÄÃ­slo 888 v nÃ¡zvu odpovÃ­dÃ¡ 8 bitÅ¯m na vzorek kaÅ¾dÃ© sloÅ¾ky. ObrazovÃ¡ data v tomto formÃ¡tu jsou vÅ¾dy reprezentovÃ¡na tÅ™emi samostatnÃ½mi barevnÃ½mi plochami (plane). PoÅ™adÃ­ tÄ›chto ploch v poli, vrÃ¡cenÃ©ho metodou getPlanes() tÅ™Ã­dy Image, je garantovÃ¡no - na pozici 0 nalezneme sloÅ¾ku jasu Y, na pozici 1 sloÅ¾ku U (Cb) a na pozici 2 sloÅ¾ku V (Cr). ZÃ­skÃ¡nÃ­ jednotlivÃ½ch sloÅ¾ek je uvedeno ve vÃ½pisu 4.9. JednotlivÃ© sloÅ¾ky jsou uloÅ¾eny v bytovÃ©m poli (vektorovÃ¡ reprezentace), proto je nutnÃ© zÃ­skat dodateÄnÃ© informace o zpÅ¯sobu jejich uloÅ¾enÃ­ pomocÃ­ metod getRowStride() a getPixelStride(). JednotlivÃ© metody vracÃ­ krok Å™Ã¡dku Äi pixelu.[36]

1 // ZpracovÃ¡nÃ­ obrazovÃ½ch dat - formÃ¡t YUV_420_888

2 public void onImageAvailable(ImageReader reader) {

3

// ZÃ­skÃ¡nÃ­ nejnovÄ›jÅ¡Ã­ch obrazovÃ½ch dat

4

Image image = reader.acquireNextImage();

5

6

// Pole barevnÃ½ch ploch

7

Image.Plane[] planes = image.getPlanes();

8

9

// Deklarace bytovÃ© pamÄ›ti

10

ByteBuffer buffer;

11

12

// SloÅ¾ka jasu

13

buffer = planes [0]. getBuffer();

14

byte[] y = new byte[buffer.remaining()];

15

buffer.get(y);

16

17

// ModrÃ¡ chrominanÄnÃ­ sloÅ¾ka

18

buffer = planes [1]. getBuffer();

19

byte[] u = new byte[buffer.remaining()];

20

buffer.get(u)

21

22

// ÄŒervenÃ¡ chrominanÄnÃ­ sloÅ¾ka

23

buffer = planes [2]. getBuffer();

24

byte[] v = new byte[buffer.remaining()];

25

buffer.get(v);

26

27

// DodateÄnÃ© informace o zpÅ¯sobu uloÅ¾enÃ­ sloÅ¾ek vÃ½Å¡e - promÄ›nnÃ© y, u, v

28

int yRowStride = planes [0]. getRowStride();

29

int yPixelStride = planes [0]. getPixelStride();

30

int uvRowStride = planes [1]. getRowStride();

// u == v

31

int uvPixelStride = planes [1]. getPixelStride(); // u == v

32

33

// RenderScript

34

// ............

35

36

// UvolnÄ›nÃ­ prostÅ™edkÅ¯ (doÅ¡lo by k pÅ™eteÄenÃ­ vyrovnÃ¡vacÃ­ pamÄ›ti)

37

image . close () ;

38 }

VÃ½pis 4.9: UkÃ¡zka metody onImageAvailable zpracovÃ¡vajÃ­cÃ­ formÃ¡t YUV

Z vÃ½Å¡e uvedenÃ©ho vyplÃ½vÃ¡, Å¾e nejpÅ™esnÄ›jÅ¡Ã­ho vÃ½sledku bylo dosaÅ¾eno pÅ™i pouÅ¾itÃ­ formÃ¡tu YUV_444_888, jenÅ¾ nenÃ­ podvzorkovanÃ½. BohuÅ¾el zaÅ™Ã­zenÃ­, na kterÃ©m byla aplikace vyvÃ­jena tento formÃ¡t nepodporuje. ObdobnÄ› dopadl i formÃ¡t

47

YUV_422_888. Na formÃ¡t YUV_420_888 je v dokumentaci nejvÃ­ce odkazovÃ¡no. Tento formÃ¡t musÃ­ bÃ½t totiÅ¾ podporovanÃ½ vÅ¡emi zaÅ™Ã­zenÃ­mi, jenÅ¾ implementujÃ­ Camera2 API - viz CDD 4.3.[36, 37]
PÅ™i pouÅ¾itÃ­ formÃ¡tu YUV_420_888 a zpracovÃ¡nÃ­ obrazovÃ½ch dat pomocÃ­ platformy RenderScript je dosaÅ¾eno vzorkovacÃ­ frekvence 30 Hz. Toto Å™eÅ¡enÃ­ tedy splÅˆuje minimÃ¡lnÃ­ poÅ¾adavky pro akvizici PPG signÃ¡lu.
4.5.3 RenderScript
JednÃ¡ se o platformu zaloÅ¾enou na Androidu, pracujÃ­cÃ­ na nativnÃ­ Ãºrovni. VyuÅ¾Ã­vÃ¡ se pro velmi nÃ¡roÄnÃ© vÃ½poÄetnÃ­ Ãºlohy. PsanÃ­ kÃ³du na platformÄ› RenderScript se velmi podobÃ¡ psanÃ­ kÃ³du v programovacÃ­m jazyce C Äi C++. Je ovÅ¡em moÅ¾nÃ© vyuÅ¾Ã­t pouze funkce, kterÃ© jsou definovanÃ© v RenderScript API. KonkrÃ©tnÄ› se jednÃ¡ o sprÃ¡vu zdrojÅ¯ a Å™Ã­zenÃ­ jÃ¡dra. API je dostupnÃ© ve tÅ™ech rÅ¯znÃ½ch jazycÃ­ch - Java, C++ a C99 (verze programovacÃ­ho jazyka C ). DÃ­ky svÃ© rychlosti je Äasto vyuÅ¾Ã­vÃ¡n v aplikacÃ­ch zamÄ›Å™ujÃ­cÃ­ch se na nÄ›kterou z nÃ¡sledujÃ­cÃ­ch operacÃ­.[48, 49]
â€¢ ZpracovÃ¡nÃ­ obrazÅ¯ (image processing) â€¢ VÃ½poÄetnÃ­ fotografie (computational photography) â€¢ PoÄÃ­taÄovÃ© vidÄ›nÃ­ (computer vision)
VysokÃ© rychlosti je dosaÅ¾eno dÃ­ky paralelnÃ­mu vÃ½poÄtu dat. JinÃ½mi slovy je pracovnÃ­ zÃ¡tÄ›Å¾ rozloÅ¾ena na vÅ¡echna jÃ¡dra vÅ¡ech dostupnÃ½ch vÃ½poÄetnÃ­ch jednotek CPU, GPU Äi DSP. To umoÅ¾Åˆuje implementovat sloÅ¾itÄ›jÅ¡Ã­ algoritmy bez obav ze ztrÃ¡ty vÃ½konu. NÃ­zkoÃºrovÅˆovÃ© bÄ›hovÃ© prostÅ™edÃ­ platformy RednerScript je ovlÃ¡dÃ¡no nadÅ™azenÃ½m systÃ©mem - Androidem. Ten odpovÃ­dÃ¡ za sprÃ¡vu pamÄ›ti - Renderscript pracuje pouze s pamÄ›tÃ­, jeÅ¾ mu byla pÅ™idÄ›lena. Komunikace systÃ©mu Android s platformou RenderScript je asynchronnÃ­ - dotazy jsou umÃ­sÅ¥ovÃ¡ny do fronty a jsou zpracovÃ¡ny jakmile je to moÅ¾nÃ©. PrÃ¡ce a sdÃ­lenÃ­ zdrojÅ¯ systÃ©mu Android s platformou RenderScript je vyobrazena na obrÃ¡zku 4.5. ObvyklÃ½ postup pro vyuÅ¾itÃ­ platformy RenderScript z programovacÃ­ho jazyka Java je nÃ¡sledujÃ­cÃ­.[48, 49]
1. Inicializovat kontext platformy RenderScript 2. Zarezervovat pamÄ›Å¥ a svÃ¡zat jÃ­ (pÅ™idÄ›lit) platformou RenderScript 3. VytvoÅ™it skript 4. Naplnit pÅ™idÄ›lenou pamÄ›Å¥ daty 5. Nastavit globÃ¡lnÃ­ promÄ›nnÃ© 6. Spustit pÅ™Ã­sluÅ¡nÃ© funkce 7. ZÃ­skat novÃ¡ data z pamÄ›ti 8. ZniÄit kontext platformy RenderScript
48

Android Framework AplikaÄnÃ­ kÃ³d Androidu
TÅ™Ã­dy reï¬‚ektujÃ­cÃ­ kÃ³d RenderScriptu
RenderScript Runtime KÃ³d RenderScriptu
Graï¬ckÃ© a vÃ½poÄetnÃ­ jÃ¡dro RenderScriptu

PÅ™idÄ›lenÃ­ pamÄ›ti ÄŒtenÃ­ / ZÃ¡pis

VÃ¡zÃ¡nÃ­ pamÄ›ti

PamÄ›Å¥

ÄŒtenÃ­ / ZÃ¡pis

Obr. 4.5: PrÃ¡ce a sdÃ­lenÃ­ zdrojÅ¯ systÃ©mu Androidu s platformou RenderScript [7]

ObrazovÃ¡ data jsou zÃ­skÃ¡vÃ¡na ve formÃ¡tu YUV_420_888. BarevnÃ½ model YUV ovÅ¡em neobsahuje sloÅ¾ky potÅ™ebnÃ© k zÃ­skÃ¡nÃ­ PPG signÃ¡lu pÅ™Ã­mo. Proto je nutnÃ© pÅ™evÃ©st obrazovÃ¡ data z barevnÃ©ho modelu YUV na ARGB dle vztahu 4.1, kde jednotlivÃ© sloÅ¾ky Y, U, V odpovÃ­dajÃ­ hodnotÄ› konkrÃ©tnÃ­ho pixelu reprezentovanÃ© 8-bitovÃ½m ÄÃ­slem (0â€“255). SloÅ¾ky A, R, G, B jsou taktÃ©Å¾ reprezentovÃ¡ny 8-bitovÃ½m ÄÃ­slem (0â€“255), a proto je brÃ¡na v potaz pouze celoÄÃ­selnÃ¡ ÄÃ¡st vÃ½poÄtu. DÃ¡le musÃ­ bÃ½t rozsah vÃ½poÄtu udrÅ¾en v rozmezÃ­ 0â€“255. V pÅ™Ã­padÄ›, Å¾e je hodnota menÅ¡Ã­ neÅ¾ 0, je rovna 0. V pÅ™Ã­padÄ›, Å¾e je vÄ›tÅ¡Ã­ neÅ¾ 255, je rovna 255. Pozice jednotlivÃ½ch bitÅ¯ barevnÃ©ho modelu ARGB jsou vyobrazeny na obrÃ¡zku 4.3. JelikoÅ¾ je PPG signÃ¡l zÃ­skÃ¡n pouze z prÅ¯mÄ›rnÃ© jasovÃ© hodnoty ÄervenÃ© sloÅ¾ky jednotlivÃ½ch pixelÅ¯ konkrÃ©tnÃ­ho snÃ­mku lze vÃ½poÄet ostatnÃ­ch sloÅ¾ek ignorovat. TÃ­m je snÃ­Å¾ena vÃ½poÄetnÃ­ nÃ¡roÄnost. V ideÃ¡lnÃ­m pÅ™Ã­padÄ› je vÃ½stupem algoritmu pÅ™Ã­mo prÅ¯mÄ›rnÃ¡ jasovÃ¡ hodnota ÄervenÃ© sloÅ¾ky konkrÃ©tnÃ­ho snÃ­mku.[6, 49]

í µí°´ = 255

í µí±…

=

í µí±Œ

+ í µí±‰

Â·

1436 1024

âˆ’ 179

í µí°º

=

í µí±Œ

âˆ’ í µí±ˆ

Â·

46549 131072

+ 44 âˆ’ í µí±‰

Â·

93604 131072

+ 91

í µí°µ

=

í µí±Œ

+ í µí±ˆ

Â·

1814 1024

âˆ’ 227

(4.1)

49

VÃ½poÄet jasovÃ© hodnoty ÄervenÃ© sloÅ¾ky konkrÃ©tnÃ­ho pixelu vyÅ¾aduje pro vÃ½poÄet pouze sloÅ¾ku jasu Y a Äervenou chrominaÄnÃ­ sloÅ¾ku V (Cr). Z toho dÅ¯vodu nenÃ­ nutnÃ© alokovat pamÄ›Å¥ pro sloÅ¾ku U (Cb). ZÃ­skÃ¡nÃ­ jasovÃ© hodnoty ÄervenÃ© sloÅ¾ky konkrÃ©tnÃ­ho pixelu a prÅ¯mÄ›r tÄ›chto jasovÃ½ch hodnot konkrÃ©tnÃ­ho snÃ­mku je uveden ve vÃ½pise 4.10. Po zÃ­skÃ¡nÃ­ jasovÃ© hodnoty ÄervenÃ© sloÅ¾ky konkrÃ©tnÃ­ho pixelu, pomocÃ­ metody getRedFromYuv(), je tato hodnota pÅ™iÄtena do globÃ¡lnÃ­ promÄ›nnÃ© pixelSum. Z tÃ©to promÄ›nnÃ© je potÃ© vypoÄÃ­tÃ¡n prÅ¯mÄ›r jako podÃ­l tÃ©to promÄ›nnÃ© poÄtem pixelÅ¯ snÃ­mku (Å¡Ã­Å™í µí±˜í µí± Â· í µí±£Ã½Å¡í µí±˜í µí±) pomocÃ­ metody getRedAvg(). PÅ™ed vstupem kaÅ¾dÃ©ho novÃ©ho snÃ­mku je nutnÃ© vynulovat promÄ›nnou pixelSum pomocÃ­ metody reset().

1 #pragma version (1) // Verze RenderScriptu

2 #pragma rs java_package_name(cz.vutbr.bpdataacquisition) // NÃ¡zev balÃ­Äku

3 #pragma rs_fp_relaxed // NastavenÃ­ pÅ™esnosti desetinnÃ½ch mÃ­st

4

5 static int pixelSum = 0; // Suma jasovÃ½ch hodnot ÄervenÃ© sloÅ¾ky

6

7 uint width , height; // RozmÄ›ry snÃ­mku

8 uint vPixelStride , vRowStride; // Krok pixelÅ¯ a Å™Ã¡dkÅ¯

9

10 rs_allocation ypsIn , vIn ; // P Å™ id Ä› len Ã© pam Ä› ti

11

12 // Z Ã­ sk Ã¡ n Ã­ jasov Ã½ ch hodnot Ä erven Ã© slo Å¾ ky z YUV form Ã¡ tu

13 void __attribute__ (( kernel ) ) getRedFromYuv ( uint32_t x , uint32_t y ) {

14

// VÃ½poÄet pozice chrominanÄnÃ­ sloÅ¾ky na zÃ¡kladÄ› pozice sloÅ¾ky jasu

15

uint uvIndex = vPixelStride * (x/2) + vRowStride * (y/2);

16

17

// ZÃ­skÃ¡nÃ­ Y a V z pamÄ›ti na konkrÃ©tnÃ­ch souÅ™adnicÃ­ch

18

uchar yps = rsGetElementAt_uchar(ypsIn , x, y);

19

uchar v = rsGetElementAt_uchar(vIn , uvIndex);

20

21

// VÃ½poÄet jasovÃ© hodnoty ÄervenÃ© sloÅ¾ky a udrÅ¾enÃ­ hodnoty v rozmezÃ­ 0-255

22

uchar red = clamp(yps + v * 1436 / 1024 - 179, 0, 255);

23

24

// AktualizovÃ¡nÃ­ hodnoty sdÃ­lenÃ© mezi vlÃ¡kny - suma

25

rsAtomicAdd(&pixelSum , red);

26 }

27

28 // V Ã½ po Ä et pr Å¯ m Ä› rn Ã© jasov Ã© hodnoty Ä erven Ã© slo Å¾ ky sn Ã­ mku

29 int __attribute__ (( kernel ) ) getRedAvg ( int x ) {

30

return pixelSum / (width * height);

31 }

32

33 // Vynulov Ã¡ n Ã­ hodnot , aby mohl b Ã½ t spo Ä Ã­ t Ã¡ n dal Å¡ Ã­ sn Ã­ mek

34 void reset () {

35

pixelSum = 0;

36 }

VÃ½pis 4.10: ZÃ­skÃ¡nÃ­ PPG signÃ¡lu z formÃ¡tu YUV na platformÄ› RenderScript

50

4.6 Akvizice fonokardiografickÃ½ch dat
TÅ™Ã­da AudioDataAcquisition sdruÅ¾uje metody a objekty, skrze kterÃ© lze pracovat s mikrofonem zaÅ™Ã­zenÃ­, zpracovÃ¡vat jednotlivÃ© vzorky audio signÃ¡lu a poskytovat zpÄ›tnou vazbu uÅ¾ivateli. Tato sekce popisuje funkci tÃ©to tÅ™Ã­dy.
4.6.1 OvlÃ¡dÃ¡nÃ­ zvukovÃ½ch zaÅ™Ã­zenÃ­
Akvizice audio signÃ¡lu na operaÄnÃ­m systÃ©mu Android je oproti video signÃ¡lu podstatnÄ› jednoduÅ¡Å¡Ã­. Pokud je nahrÃ¡vÃ¡nÃ­ audio a video zÃ¡znamu oddÄ›leno, je nutnÃ© provÃ©st vzÃ¡jemnou synchronizaci. V tÃ©to sekci jsou popsÃ¡ny jednotlivÃ© tÅ™Ã­dy umoÅ¾ÅˆujÃ­cÃ­ ovlÃ¡dÃ¡nÃ­ zvukovÃ½ch zaÅ™Ã­zenÃ­ a zÃ¡znam Äi pÅ™ehrÃ¡vÃ¡nÃ­ zvukovÃ½ch dat.
AudioRecord
TÅ™Ã­da AudioRecord odpovÃ­dÃ¡ za sprÃ¡vu zvukovÃ½ch zdrojÅ¯. PÅ™i inicializaci tÃ©to tÅ™Ã­dy jsou v konstruktoru oÄekÃ¡vÃ¡ny parametry, jenÅ¾ definujÃ­ zpÅ¯sob zÃ¡znamu zvukovÃ½ch dat. Parametry jsou nÃ¡sledujÃ­cÃ­.[12]
â€¢ Zdroj zvukovÃ½ch dat â€¢ VzorkovacÃ­ frekvence â€¢ NastavenÃ­ kanÃ¡lÅ¯ â€¢ KÃ³dovÃ¡nÃ­ a bitovou hloubku â€¢ Velikost vyrovnÃ¡vacÃ­ pamÄ›ti
Instance tÅ™Ã­dy AudioRecord umoÅ¾Åˆuje pÅ™Ã­mÃ½ pÅ™Ã­stup ke zvukovÃ½m datÅ¯m. PÅ™i jejÃ­m vytvoÅ™enÃ­ si tato instance tÅ™Ã­dy inicializuje vyrovnÃ¡vacÃ­ pamÄ›Å¥, kterÃ¡ bude po spuÅ¡tÄ›nÃ­ nahrÃ¡vÃ¡nÃ­ plnÄ›na zvukovÃ½mi daty - vzorky. Velikost vyrovnÃ¡vacÃ­ pamÄ›ti urÄuje, jak dlouho lze zaznamenÃ¡vat zvukovÃ¡ data, neÅ¾-li dojde k pÅ™eteÄenÃ­, a tak ke ztrÃ¡tÄ› dat.[12]
NahrÃ¡vÃ¡nÃ­ je zahÃ¡jeno zavolÃ¡nÃ­m metody startRecording(). Po zavolÃ¡nÃ­ tÃ©to metody se vyrovnÃ¡vacÃ­ pamÄ›Å¥ zaÄne plnit zvukovÃ½mi daty. Ty je nutnÃ© neustÃ¡le odebÃ­rat pomocÃ­ metody read(). DoporuÄenÃ½m zpÅ¯sobem je pouÅ¾itÃ­ while cyklu, jehoÅ¾ podmÃ­nka je splnÄ›na, dokud nenÃ­ vnÄ›jÅ¡Ã­m zÃ¡sahem zmÄ›nÄ›n jejÃ­ stav.[12]
Metoda read() umoÅ¾Åˆuje vracet zvukovÃ¡ data v rÅ¯znÃ½ch datovÃ½ch typech (byte[], short[], ByteBuffer). VÃ½bÄ›r sprÃ¡vnÃ©ho datovÃ©ho typu zÃ¡visÃ­ na dalÅ¡Ã­m zpracovÃ¡nÃ­ zvukovÃ½ch dat. Vzhledem k tomu, Å¾e pro pÅ™evod analogovÃ©ho signÃ¡lu na digitÃ¡lnÃ­ pouÅ¾Ã­vÃ¡me lineÃ¡rnÃ­ pulznÄ› kÃ³dovou modulaci (Pulse Code Modulation - PCM) o bitovÃ© hloubce 16 bitÅ¯, je vhodnÃ© vyuÅ¾Ã­t datovÃ½ typ short, jenÅ¾ je takÃ© reprezentovÃ¡n 16 bity. DÃ­ky tomu jeden vzorek odpovÃ­dÃ¡ jednÃ© hodnotÄ› v poli. V pÅ™Ã­padÄ› pouÅ¾itÃ­ datovÃ©ho typu byte by byl jeden vzorek reprezentovÃ¡n dvÄ›ma hodnotami v
51

poli - dvÄ›ma byty. Toto Å™eÅ¡enÃ­ by ovÅ¡em zkomplikovalo Ãºpravu amplitudy signÃ¡lu. PrÃ¡ce se tÅ™Ã­dou AudioRecord je uvedena ve vÃ½pise 4.11.[10, 12]
ZpracovÃ¡nÃ­ zvukovÃ½ch dat je ukonÄeno zmÄ›nou podmÃ­nky while cyklu. PlnÄ›nÃ­ vyrovnÃ¡vacÃ­ pamÄ›ti je zastaveno pomocÃ­ metody stop(). DÃ¡le je vhodnÃ© uvolnit veÅ¡kerÃ© zdroje, jenÅ¾ byly vyuÅ¾Ã­vÃ¡ny, pomocÃ­ metody release().[12]

1 int BUFFER_SIZE = 1024; // Velikost vyrovnÃ¡vacÃ­ pamÄ›ti

2

3 // Inicializace

4 mAudioRecord = new AudioRecord(

5

MediaRecorder.AudioSource.MIC , // Zdroj audio signÃ¡lu

6

8000, // VzorkovacÃ­ frekvence

7

AudioFormat.CHANNEL_IN_MONO , // NastavenÃ­ kanÃ¡lÅ¯

8

AudioFormat.ENCODING_PCM_16BIT , // NastavenÃ­ kÃ³dovÃ¡nÃ­ a bitovÃ© hloubky

9

BUFFER_SIZE * 2); // Velikost vyrovnÃ¡vacÃ­ pamÄ›ti v bytech

10

11 // Za Ä Ã¡ tek nahr Ã¡ v Ã¡ n Ã­

12 mAudioRecord . startRecording () ;

13 mIsRecording = true ; // Stav nahr Ã¡ v Ã¡ n Ã­ ( pro while cyklus )

14

15 // Pole pro Ä ten Ã­ dat z vyrovn Ã¡ vac Ã­ pam Ä› ti ( pro metodu read () )

16 short rawData [] = new short [ BUFFER_SIZE ];

17

18 // Z Ã¡ pis do souborov Ã© ho syst Ã© mu

19 FileOutputStream os = null ;

20 os = new FileOutputStream ( mFilePath + " . pcm " ) ;

21

22 // Zastaven Ã­ cyklu vy Å¾ aduje zm Ä› nu prom Ä› nn Ã© mIsRecording na hodnotu false

23 while ( mIsRecording ) { // Ukon Ä eno nap Å™ Ã­ klad po kliknut Ã­ na tla Ä Ã­ tko STOP

24

// ÄŒtenÃ­ zvukovÃ½ch dat z vyrovnÃ¡vacÃ­ pamÄ›ti

25

mAudioRecord.read(rawData , 0, BUFFER_SIZE);

26

27

//PÅ™evod datovÃ©ho typu short na byte

28

byte byteData[] = short2byte(rawData);

29

30

// ZÃ¡pis zvukovÃ½ch dat do souboru v bytech

31

os.write(byteData , 0, BUFFER_SIZE * 2);

32 }

33

34 mAudioRecord . stop () ; // Ukon Ä en Ã­ nahr Ã¡ v Ã¡ n Ã­

35 mAudioRecord . release () ; // Uvoln Ä› n Ã­ zdroj Å¯

VÃ½pis 4.11: UkÃ¡zka prÃ¡ce se tÅ™Ã­dou AudioRecord

AudioManager
PrimÃ¡rnÃ­ ÃºÄel tÃ©to tÅ™Ã­dy je poskytnout pÅ™Ã­stup k ovlÃ¡dÃ¡nÃ­ hlasitosti mÃ©diÃ­ a mÃ³dÅ¯m vyzvÃ¡nÄ›nÃ­. Mimo jinÃ© obsahuje velkÃ© mnoÅ¾stvÃ­ konstant a informacÃ­ o aktuÃ¡lnÄ› pÅ™ipojenÃ½ch zvukovÃ½ch pÅ™Ã­sluÅ¡enstvÃ­ch. Toho je vyuÅ¾ito, aby se zabrÃ¡nilo pÅ™ipojenÃ­ sluchÃ¡tek se zabudovanÃ½m mikrofonem - tzv. headset. ZvukovÃ¡ data jsou potÃ© zÃ­skÃ¡vÃ¡na z obou mikrofonÅ¯ zÃ¡roveÅˆ (mikrofon zabudovanÃ½ v telefonu a mikrofon zabudovanÃ½ ve sluchÃ¡tkÃ¡ch) v rÃ¡mci jednoho kanÃ¡lu, coÅ¾ nenÃ­ Å¾Ã¡doucÃ­. Mezi povolenÃ¡ zvukovÃ¡

52

pÅ™Ã­sluÅ¡enstvÃ­, skrze kterÃ© je uÅ¾ivateli poskytnuta zpÄ›tnÃ¡ vazba (pÅ™ehrÃ¡vÃ¡nÃ­ zvukovÃ½ch dat), patÅ™Ã­ drÃ¡tovÃ¡ sluchÃ¡tka a veÅ¡kerÃ¡ bluetooth zaÅ™Ã­zenÃ­ podporujÃ­cÃ­ profil A2DP (bluetooth sluchÃ¡tka, bluetooth reproduktor apod.) slouÅ¾Ã­cÃ­ k bezdrÃ¡tovÃ©mu pÅ™enosu hudby. ZjiÅ¡tÄ›nÃ­, zdali je pÅ™ipojenÃ© nÄ›kterÃ© z povolenÃ©ho pÅ™Ã­sluÅ¡enstvÃ­, je uvedeno ve vÃ½pise 4.12. Na zÃ¡kladÄ› tÃ©to metody je rozhodnuto, zdali bude vyuÅ¾ita tÅ™Ã­da AudioTrack pro pÅ™ehrÃ¡vÃ¡nÃ­ zÃ­skanÃ½ch zvukovÃ½ch dat.[9, 11]

1 private boolean isHeadphonesPlugged (){

2

// ZÃ­skÃ¡nÃ­ vÅ¡ech zvukovÃ½ch zaÅ™Ã­zenÃ­ch pÅ™ipojenÃ½ch k systÃ©mu

3

AudioDeviceInfo[] audioDevices =

mAudioManager.getDevices(AudioManager.GET_DEVICES_ALL);

4

5

// ZjiÅ¡tÄ›nÃ­ typu zaÅ™Ã­zenÃ­

6

for(AudioDeviceInfo deviceInfo : audioDevices) {

7

if(deviceInfo.getType() == AudioDeviceInfo.TYPE_WIRED_HEADPHONES ||

deviceInfo.getType() == AudioDeviceInfo.TYPE_BLUETOOTH_A2DP) {

8

// Pokud se jednÃ¡ o drÃ¡tovÃ¡ sluchÃ¡tka Äi BT zaÅ™Ã­zenÃ­ (A2DP)

9

return true;

10

}

11

}

12

return false; // Pokud nenÃ­ nalezeno odpovÃ­dajÃ­cÃ­ pÅ™Ã­sluÅ¡enstvÃ­

13 }

VÃ½pis 4.12: ZÃ­skÃ¡nÃ­ informacÃ­ o pÅ™ipojenÃ½ch zvukovÃ½ch zaÅ™Ã­zenÃ­ch

AudioTrack
Je-li k zaÅ™Ã­zenÃ­ pÅ™ipojeno nÄ›kterÃ© z povolenÃ©ho pÅ™Ã­sluÅ¡enstvÃ­, jsou skrze nÄ›j v reÃ¡lnÃ©m Äase pÅ™ehrÃ¡vÃ¡na zÃ­skanÃ¡ zvukovÃ¡ data. Pro tento ÃºÄel je vhodnÃ© vyuÅ¾Ã­t tÅ™Ã­du AudioTrack. ObdobnÄ› jako inicializace tÅ™Ã­dy AudioRecord i tato tÅ™Ã­da v konstruktoru oÄekÃ¡vÃ¡ parametry definujÃ­cÃ­ zpÅ¯sob zÃ¡znamu zvukovÃ½ch dat, jeÅ¾ se chytÃ¡me skrze instanci tÃ©to tÅ™Ã­dy pÅ™ehrÃ¡t. Nespornou vÃ½hodou tÃ©to tÅ™Ã­dy je moÅ¾nost pÅ™ehrÃ¡vat syrovÃ¡ PCM data.[13]
Po vytvoÅ™enÃ­ instance tÃ©to tÅ™Ã­dy je rozhodnuto na zÃ¡kladÄ› pÅ™Ã­sluÅ¡enstvÃ­, zdali budou zvukovÃ¡ data pÅ™ehrÃ¡vÃ¡na Äi nikoliv. Pokud je podmÃ­nka splnÄ›na, je zavolÃ¡na metoda play(). DÃ¡le je nutnÃ© do tÃ©to tÅ™Ã­dy zvukovÃ¡ data cyklicky zapisovat. K tomu lze vyuÅ¾Ã­t stejnÃ½ cyklus, ve kterÃ©m jsou zvukovÃ¡ data zÃ­skÃ¡vÃ¡na tÅ™Ã­dou AudioRecord. ZÃ­skanÃ¡ zvukovÃ¡ data jsou zapisovÃ¡na do vyrovnÃ¡vacÃ­ pamÄ›ti pomocÃ­ metody write(), jeÅ¾ byla inicializovÃ¡na pÅ™i vytvoÅ™enÃ­ instance tÅ™Ã­dy AudioTrack. ZapsanÃ¡ data jsou dÃ¡le pÅ™ehrÃ¡na skrze pÅ™ipojenÃ© pÅ™Ã­sluÅ¡enstvÃ­. PÅ™ehrÃ¡vÃ¡nÃ­ je ukonÄeno zavolÃ¡nÃ­m metody stop(). PrÃ¡ce se tÅ™Ã­dou AudioTrack je uvedena ve vÃ½pisu 4.13.[13]
JelikoÅ¾ jsou srdeÄnÃ­ ozvy slabÄ› slyÅ¡itelnÃ©, je hlasitost zaÅ™Ã­zenÃ­ automaticky nastavena na maximÃ¡lnÃ­ ÃºroveÅˆ. OvÅ¡em i toto zesÃ­lenÃ­ nemusÃ­ bÃ½t pro dobrou slyÅ¡itelnost dostaÄujÃ­cÃ­. Z toho dÅ¯vodu byl pÅ™idÃ¡n dalÅ¡Ã­ stupeÅˆ zesÃ­lenÃ­, jenÅ¾ pÅ™Ã­mo multiplikuje amplitudu zvukovÃ½ch dat konkrÃ©tnÃ­ hodnotou navolenou v GUI - v rozsahu 1,0â€“10,0.

53

1 // Inicializace

2 mAudioTrack = new AudioTrack(

3

AudioManager.STREAM_MUSIC , // VÃ½stup

4

8000, // VzorkovacÃ­ frekvence

5

AudioFormat.CHANNEL_OUT_MONO , // NastavenÃ­ kanÃ¡lÅ¯

6

AudioFormat.ENCODING_PCM_16BIT , // NastavenÃ­ kÃ³dovÃ¡nÃ­ a bitovÃ© hloubky

7

BUFFER_SIZE , // Velikost vyrovnÃ¡vacÃ­ pamÄ›ti

8

AudioTrack.MODE_STREAM); // MÃ³d pÅ™ehrÃ¡vÃ¡nÃ­

9

10 // Pole pro Ä ten Ã­ dat z vyrovn Ã¡ vac Ã­ pam Ä› ti ( pro metodu read () t Å™ Ã­ dy AudioRecord )

11 short rawData [] = new short [ BUFFER_SIZE ];

12

13 // Pole pro z Ã¡ pis modifikovan Ã½ ch dat ( pro metodu write () t Å™ Ã­ dy AudioTrack )

14 short playData [] = new short [ BUFFER_SIZE ];

15

16 // Pokud je p Å™ ipojeno n Ä› kter Ã© z povolen Ã½ ch p Å™ Ã­ slu Å¡ enstv Ã­

17 if ( i s He a d p h o n e sP l u g g e d () ) {

18

// NastavenÃ­ hlasitosti mÃ©diÃ­ na maximum

19

mAudioManager.setStreamVolume(AudioManager.STREAM_MUSIC ,

mAudioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC), 0);

20

21

// ZahÃ¡jenÃ­ pÅ™ehrÃ¡vÃ¡nÃ­ zvukovÃ½ch dat

22

mAudioTrack . play () ;

23 }

24

25 // Zastaven Ã­ cyklu vy Å¾ aduje zm Ä› nu prom Ä› nn Ã© mIsRecording na hodnotu false

26 while ( mIsRecording ) { // Ukon Ä eno nap Å™ Ã­ klad po kliknut Ã­ na tla Ä Ã­ tko STOP

27

// ÄŒtenÃ­ zvukovÃ½ch dat z vyrovnÃ¡vacÃ­ pamÄ›ti tÅ™Ã­dy AudioRecord

28

int numRead = mAudioRecord.read(rawData , 0, BUFFER_SIZE);

29

30

// Pokud je tÅ™Ã­da AudioTrack ve stavu pÅ™ehrÃ¡vÃ¡nÃ­

31

if (mAudioTrack.getPlayState() == AudioTrack.PLAYSTATE_PLAYING) {

32

if (numRead > 0) {

33

for (int i = 0; i < numRead; ++i) {

34

// Multiplikace amplitudy (mGain - hodnota z GUI)

35

playData[i] = (short)Math.min((int)(rawData[i] * mGain),

( int ) Short . MAX_VALUE );

36

}

37

}

38

// ZÃ¡pis zvukovÃ½ch dat do vyrovnÃ¡vacÃ­ pamÄ›ti tÅ™Ã­dy AudioTrack

39

mAudioTrack.write(playData , 0, rawData.length);

40

}

41 }

42

43 // Ukon Ä en Ã­ p Å™ ehr Ã¡ v Ã¡ n Ã­ a nastaven Ã­ hlasitosti m Ã© di Ã­ na p Å¯ vodn Ã­ Ãº rove Åˆ

44 mAudioTrack . stop () ;

45 mAudioManager . se t St re am V ol um e ( AudioManager . STREAM_MUSIC , mOrigionalVolume , 0) ;

VÃ½pis 4.13: UkÃ¡zka se tÅ™Ã­dou AudioTrack

4.6.2 ZpracovÃ¡nÃ­ zvukovÃ½ch dat
AnalogovÃ½ audio signÃ¡l pÅ™evedenÃ½ pomocÃ­ lineÃ¡rnÃ­ PCM na signÃ¡l digitÃ¡lnÃ­ je zapisovÃ¡n pÅ™Ã­mo do souborovÃ©ho systÃ©mu. Kvalita pÅ™evodu z analogovÃ©ho signÃ¡lu na

54

digitÃ¡lnÃ­ je dÃ¡na vzorkovacÃ­ frekvencÃ­ a bitovou hloubkou. VzorkovacÃ­ frekvence urÄuje, kolik vzorkÅ¯ je zÃ­skÃ¡no ze spojitÃ©ho (analogovÃ©ho) signÃ¡lu pÅ™i jeho pÅ™evodu na signÃ¡l diskrÃ©tnÃ­ (digitÃ¡lnÃ­) za jednu sekundu - tato fÃ¡ze se nazÃ½vÃ¡ vzorkovÃ¡nÃ­. BitovÃ¡ hloubka potÃ© urÄuje, v jakÃ©m rozsahu lze hodnotu vzorku vyjÃ¡dÅ™it - tato fÃ¡ze se nazÃ½vÃ¡ kvantovÃ¡nÃ­.[47]
Na zÃ¡kladÄ› informacÃ­ z CDD musÃ­ pro zÃ¡znam syrovÃ©ho audio signÃ¡lu veÅ¡kerÃ¡ zaÅ™Ã­zenÃ­ podporovat formÃ¡t PCM o bitovÃ© hloubce 16 bitÅ¯ a alespoÅˆ jeden audio kanÃ¡l - mono. Na vÃ½bÄ›r je ovÅ¡em vÃ­ce vzorkovacÃ­ch frekvencÃ­ - 8 000 Hz, 11 025 Hz, 16 000 Hz a 44 100 Hz. VzorkovÃ¡nÃ­ tÄ›mito frekvencemi je provedeno pÅ™Ã­mo konkrÃ©tnÃ­m analogovÄ› digitÃ¡lnÃ­m pÅ™evodnÃ­kem (ADC - Analog-Digital Converter), jenÅ¾ zahrnuje i odpovÃ­dajÃ­cÃ­ antialiasingovÃ½ filtr. Viz CDD 4.3.[2]
V sekci 3.4.1, je uvedeno, Å¾e minimÃ¡lnÃ­ vzorkovacÃ­ frekvence FKG signÃ¡lu je 800 Hz, jinak dojde k poruÅ¡enÃ­ vzorkovacÃ­ho teorÃ©mu a tÃ­m k neobnovitelnÃ© ztrÃ¡tÄ› dat. Na tomto zÃ¡kladÄ› lze tedy vyuÅ¾Ã­t jakoukoliv z vÃ½Å¡e uvedenÃ½ch vzorkovacÃ­ch frekvencÃ­. OvÅ¡em pro ÃºÄely snÃ­mÃ¡nÃ­ FKG signÃ¡lu je nejlepÅ¡Ã­ volbou nejniÅ¾Å¡Ã­ vzorkovacÃ­ frekvence, a to pouze s ohledem na niÅ¾Å¡Ã­ poÄet vzorkÅ¯ ke zpracovÃ¡nÃ­.
FormÃ¡t PCM a WAV
Jak jiÅ¾ bylo zmÃ­nÄ›no vÃ½Å¡e, zvukovÃ¡ data jsou Ätena z vyrovnÃ¡vacÃ­ pamÄ›ti vytvoÅ™enÃ© instancÃ­ tÅ™Ã­dy AudioRecord. Ta jsou uklÃ¡dÃ¡na ve formÃ¡tu PCM, kterÃ½ je po synchronizaci audio a video zÃ¡znamu pÅ™eveden na formÃ¡t WAV. DÅ¯vodem je fakt Å¾e formÃ¡t PCM neobsahuje hlaviÄku - jednÃ¡ se pouze o nekomprimovanÃ½ bitovÃ½ tok zvukovÃ½ch dat. OvÅ¡em bez informacÃ­ o parametrech zÃ­skÃ¡nÃ­ zvukovÃ½ch dat nenÃ­ moÅ¾nÃ© takovÃ½to zÃ¡znam pÅ™ehrÃ¡t ani zpracovat. Proto je nutnÃ© pÅ™evÃ©st formÃ¡t PCM na WAV. FormÃ¡t WAV je obal (kontejner) pro uloÅ¾enÃ­ bitovÃ©ho toku komprimovanÃ½ch Äi nekomprimovanÃ½ch zvukovÃ½ch dat. Tento formÃ¡t jiÅ¾ obsahuje hlaviÄku, ve kterÃ© jsou uvedeny potÅ™ebnÃ© informace o zpÅ¯sobu kÃ³dovÃ¡nÃ­, poÄtu bitÅ¯ na vzorek, vzorkovacÃ­ frekvenci, poÄtu kanÃ¡lÅ¯ apod. DÃ­ky tomu je moÅ¾nÃ© soubor pÅ™ehrÃ¡t Äi zpracovat na vÄ›tÅ¡inÄ› zaÅ™Ã­zenÃ­ pÅ™i zachovÃ¡nÃ­ pÅ¯vodnÃ­ch dat ve formÃ¡tu PCM.[10, 47]
4.7 Synchronizace zÃ¡znamÅ¯
NahrÃ¡vÃ¡nÃ­ audio i video zÃ¡znamu bÄ›Å¾Ã­ souÄasnÄ› - kaÅ¾dÃ© ve svÃ©m vlÃ¡knÄ›. OvÅ¡em doba pÅ™Ã­pravy na nahrÃ¡vÃ¡nÃ­ audio a video zÃ¡znamu se vÃ½raznÄ› liÅ¡Ã­. Toto zpoÅ¾dÄ›nÃ­ je nutnÃ© velmi pÅ™esnÄ› korigovat. Odchylka vÄ›tÅ¡Ã­ neÅ¾ Â±50 ms zpÅ¯sobÃ­, Å¾e zdravÃ©mu uÅ¾ivateli (systolickÃ½ tlak 120 mmHg) bude diagnostikovÃ¡na hypertenze (+50 ms) Äi hypotenze (-50 ms).
55

4.7.1 ÄŒasovÃ© zÃ¡kladny
V systÃ©mu Android jsou dostupnÃ© tÅ™i rozdÃ­lnÃ© ÄasovÃ© zÃ¡kladny (hodiny). Tyto ÄasovÃ© zÃ¡klady by mezi sebou nemÄ›li bÃ½t porovnÃ¡vÃ¡ny.[54]
PrvnÃ­ ÄasovÃ¡ zÃ¡kladna reprezentovÃ¡na metodou currentTimeMillis() tÅ™Ã­dy System je vyjÃ¡dÅ™enÃ­ standardnÃ­ho Äasu a data v jednotkÃ¡ch milisekund. Tento Äas by mÄ›l bÃ½t pouÅ¾it pouze ve spojenÃ­ s Äasem reÃ¡lnÃ©ho svÄ›ta. NapÅ™Ã­klad ÄasovÃ½ Ãºdaj 18. 5. 2018 12:30:30 na tÃ©to ÄasovÃ© zÃ¡kladnÄ› odpovÃ­dÃ¡ hodnotÄ› 1526646630000 ms. Tato ÄasovÃ¡ zÃ¡kladna je pouÅ¾ita pro pojmenovÃ¡nÃ­ souborÅ¯, kterÃ© jsou vÃ½stupem tÃ©to aplikace.[54]
DalÅ¡Ã­ ÄasovÃ© zÃ¡klady jiÅ¾ nevyjadÅ™ujÃ­ standardnÃ­ Äas. PomocÃ­ tÄ›chto ÄasovÃ½ch zÃ¡kladen lze mÄ›Å™it pouze uplynulou dobu - hodnoty vrÃ¡cenÃ© tÄ›mito ÄasovÃ½mi zÃ¡kladnami jsou smysluplnÃ© pouze tehdy, je-li vypoÄÃ­tÃ¡n rozdÃ­l mezi dvÄ›ma zaznamenanÃ½mi hodnotami na tomtÃ©Å¾ systÃ©mu (zaÅ™Ã­zenÃ­). JednotlivÃ© metody vÅ¾dy vracejÃ­ hodnotu, jeÅ¾ reprezentuje uplynulou dobu od spuÅ¡tÄ›nÃ­ systÃ©mu. RozdÃ­l v nÃ¡sledujÃ­cÃ­ch ÄasovÃ½ch zÃ¡kladnÃ¡ch je primÃ¡rnÄ› urÄen tÃ­m, zdali je mÄ›Å™enÃ­ uplynulÃ©ho Äasu od spuÅ¡tÄ›nÃ­ systÃ©mu zastaveno, pokud systÃ©m vstoupÃ­ do hlubokÃ©ho spÃ¡nku Äi nikoliv.[54]
DruhÃ¡ ze tÅ™Ã­ ÄasovÃ½ch zÃ¡kladen, mÄ›Å™Ã­ uplynulÃ½ Äas od spuÅ¡tÄ›nÃ­ systÃ©mu bez zapoÄÃ­tÃ¡nÃ­ Äasu strÃ¡venÃ©ho v hlubokÃ©m spÃ¡nku. Ta je primÃ¡rnÄ› reprezentovÃ¡na metodou uptimeMillis() tÅ™Ã­dy SystemClock, jeÅ¾ vracÃ­ tuto hodnotu v milisekundÃ¡ch. Tuto Äasovou zÃ¡kladnu vyuÅ¾Ã­vajÃ­ i jinÃ© metody pro mÄ›Å™enÃ­ Äasu, jako je napÅ™Ã­klad metoda nanotime() tÅ™Ã­dy System. Ta totiÅ¾ vracÃ­ velmi pÅ™esnou hodnotu Äasu virtuÃ¡lnÃ­ho stroje, na kterÃ©m bÄ›Å¾Ã­ operaÄnÃ­ systÃ©m Android, v nanosekundÃ¡ch.[53, 54]
PoslednÃ­, tÅ™etÃ­, ÄasovÃ¡ zÃ¡kladna mÄ›Å™Ã­ uplynulÃ½ Äas od spuÅ¡tÄ›nÃ­ systÃ©mu, pÅ™iÄemÅ¾ je zapoÄÃ­tÃ¡na i doba strÃ¡venÃ¡ v hlubokÃ©m spÃ¡nku. Tato ÄasovÃ¡ zÃ¡kladna je primÃ¡rnÄ› reprezentovÃ¡na metodou elapsedRealtime() tÅ™Ã­dy SystemClock, jeÅ¾ vracÃ­ hodnotu v milisekundÃ¡ch. PÅ™Ã­padnÄ› metodou elapsedRealtimeNanos(), kterÃ¡ vracÃ­ pÅ™esnÄ›jÅ¡Ã­ hodnotu v nanosekundÃ¡ch.[54]
PochopenÃ­ vÃ½Å¡e uvedenÃ½ch ÄasovÃ½ch zÃ¡kladen systÃ©mu Android je dÅ¯leÅ¾itÃ© pro prÃ¡ci s ÄasovÃ½mi znÃ¡mkami, jejichÅ¾ hodnoty jsou obvykle vztaÅ¾eny k nÄ›kterÃ© z ÄasovÃ½ch zÃ¡kladen. I v tomto pÅ™Ã­padÄ› ovÅ¡em existujÃ­ vÃ½jimky, kdy si konkrÃ©tnÃ­ HW udrÅ¾uje vlastnÃ­ Äasovou zÃ¡kladnu.[54]
4.7.2 Synchronizace poÄÃ¡tkÅ¯
Abychom byli schopni synchronizovat oba zÃ¡znamy je nutnÃ© zaznamenat poÄÃ¡tek snÃ­mÃ¡nÃ­ kaÅ¾dÃ©ho z nich. Princip synchronizace audio a video zÃ¡znamu je vyobrazen na obrÃ¡zku 4.6. U videozÃ¡znamu je poÄÃ¡tkem ÄasovÃ¡ znÃ¡mka prvnÃ­ho zaznamenanÃ©ho snÃ­mku pomocÃ­ metody getTimestamp() tÅ™Ã­dy Image. U audio zÃ¡znamu
56

nejsme bohuÅ¾el schopni zaznamenat Äas akvizice prvnÃ­ho vzorku. OvÅ¡em pomocÃ­ metody getTimestamp() tÅ™Ã­dy AudioRecord jsme schopni zÃ­skat Äas akvizice n-tÃ©ho vzorku. Na zÃ¡kladÄ› tÄ›chto hodnot jsme schopni zÃ¡znamy vzÃ¡jemnÄ› synchronizovat dle vztahu 4.2.[53]

â–³í µí±› =. í µí±“í µí±í µí±¢í µí±‘í µí±–í µí±œ Â· (í µí±¡í µí±£í µí±–í µí±‘í µí±’í µí±œ âˆ’ í µí±¡í µí±í µí±¢í µí±‘í µí±–í µí±œ(í µí±›)) Â· 10âˆ’9 + í µí±›

(4.2)

Kde í µí±¡í µí±£í µí±–í µí±‘í µí±’í µí±œ odpovÃ­dÃ¡ Äasu, kdy byl zÃ­skÃ¡n prvnÃ­ snÃ­mek videozÃ¡znamu, í µí±¡í µí±í µí±¢í µí±‘í µí±–í µí±œ(í µí±›) odpovÃ­dÃ¡ Äasu, kdy byl zÃ­skÃ¡n n-tÃ½ vzorek audiozÃ¡znamu, í µí±› je pozice audio vzorku, 10âˆ’9 je pÅ™evod nanosekund na sekundy, í µí±“í µí±í µí±¢í µí±‘í µí±–í µí±œ je vzorkovacÃ­ frekvence audio zÃ¡znamu a â–³í µí±› udÃ¡vÃ¡ zpoÅ¾dÄ›nÃ­ mezi audio a video zÃ¡znamem ve vzorcÃ­ch audiozÃ¡znamu. PÅ™Ã­klad vÃ½poÄtu na reÃ¡lnÃ½ch datech zÃ­skanÃ½ch v mÃ³du ladÄ›nÃ­.

â–³ í µí±› =. 8 000 í µí°»í µí±§ Â· (322 486 861 253 416 í µí±›í µí±  âˆ’ âˆ’ 322 486 033 698 339 í µí±›í µí± ) Â· 10âˆ’9 + 1 120 =. 7 740

zaÄÃ¡tek nahrÃ¡vÃ¡nÃ­

prvnÃ­ audio vzorek

n-tÃ½ audio vzorek

zpoÅ¾dÄ›nÃ­ videa

prvnÃ­ video snÃ­mek

zpoÅ¾dÄ›nÃ­ audia

audio-video zpoÅ¾dÄ›nÃ­

video zÃ¡znam
audio zÃ¡znam Äas [ns]

Obr. 4.6: Synchronizace audio a video zÃ¡znamu
ObÄ› ÄasovÃ© znÃ¡mky jsou vztaÅ¾enÃ© k ÄasovÃ© zÃ¡kladnÄ› mÄ›Å™Ã­cÃ­ uplynulÃ½ Äas od startu systÃ©mu vÄetnÄ› Äasu strÃ¡venÃ©ho v hlubokÃ©m spÃ¡nku.
Metoda getTimestamp(), pro zÃ­skÃ¡nÃ­ ÄasovÃ© znÃ¡mky n-tÃ©ho vzorku audiozÃ¡znamu, s parametrem AudioTimestamp.TIMEBASE_BOOTTIME vracÃ­ hodnotu na zÃ¡kladÄ› metody elapsedRealtimeNanos() tÅ™Ã­dy SystemClock.[54]
Zdroj ÄasovÃ© znÃ¡mky metody getTimestamp() tÅ™Ã­dy Image zÃ¡visÃ­ na zdroji, kterÃ½ obrÃ¡zek poskytuje. V pÅ™Ã­padÄ› tÃ©to aplikace je poskytovatelem instance tÅ™Ã­dy CameraDevice, jeÅ¾ reprezentuje konkrÃ©tnÃ­ fotoaparÃ¡t. ÄŒasovÃ© znÃ¡mky poskytnutÃ© senzorem fotoaparÃ¡tu ovÅ¡em nemusÃ­ bÃ½t zaloÅ¾eny na ÄasovÃ© zÃ¡kladnÄ›, kterou lze porovnÃ¡vat s

57

vÃ½Å¡e uvedenÃ½mi ÄasovÃ½mi zÃ¡kladnami. Informaci o ÄasovÃ© zÃ¡kladnÄ› senzoru lze zjistit pomocÃ­ instance tÅ™Ã­dy CameraCharacteristics konkrÃ©tnÃ­ho fotoaparÃ¡tu (obdobnÄ› jako pÅ™i zÃ­skÃ¡vÃ¡nÃ­ informace o pÅ™Ã­tomnosti pÅ™isvÄ›tlovacÃ­ diody uvedenÃ© v ukÃ¡zce 4.2) za pomoci parametru SENSOR_INFO_TIMESTAMP_SOURCE. Informace nabÃ½vÃ¡ dvou stavÅ¯ UNKNOWN (0) a REALTIME (1).[19]
V pÅ™Ã­padÄ› stavu UNKNOWN nenÃ­ moÅ¾nÃ© porovnat ÄasovÃ© znÃ¡mky, kterÃ½mi byly oznaÄeny jednotlivÃ© snÃ­mky, s jinÃ½mi subsystÃ©my - s ÄasovÃ½mi znÃ¡mkami audiozÃ¡znamu. V tomto pÅ™Ã­padÄ› nelze audio a videozÃ¡znam synchronizovat s dostateÄnou pÅ™esnostÃ­, kterÃ¡ je vyÅ¾adovÃ¡na pro sprÃ¡vnÃ½ vÃ½poÄet hodnoty krevnÃ­ho tlaku. Tento stav se vyskytuje bohuÅ¾el mnohem ÄastÄ›ji, neÅ¾li stav REALTIME.[19]
Stavu REALTIME odpovÃ­dÃ¡ pouÅ¾itÃ­ stejnÃ© ÄasovÃ© zÃ¡kladny jako v pÅ™Ã­padÄ› metody elapsedRealtimeNanos() tÅ™Ã­dy SystemClock. DÃ­ky tomu je moÅ¾nÃ© porovnat ÄasovÃ© znÃ¡mky mezi obÄ›ma zÃ¡znamy.[19, 54]

4.7.3 PÅ™esnost senzorÅ¯
I pÅ™es fakt, Å¾e senzor fotoaparÃ¡tu pouÅ¾itÃ©ho zaÅ™Ã­zenÃ­ reprezentuje Äasovou zÃ¡kladu spoleÄnou s metodou elapsedRealtimeNanos() nebylo moÅ¾nÃ© signÃ¡ly pÅ™esnÄ› synchronizovat.
ProblÃ©mem se ukÃ¡zala bÃ½ti nedostateÄnÃ¡ pÅ™esnost ÄasovÃ½ch znÃ¡mek produkovanÃ½ch konkrÃ©tnÃ­mi senzory. V CDD verze 7.0 v sekci 7.3. Sensors je uvedeno nÃ¡sledujÃ­cÃ­.[2]
â€¢ VÅ¡echny senzory by mÄ›ly poskytovat Äas akvizice v nanosekundÃ¡ch synchronizovanÃ½ s Äasovou zÃ¡kladnou metody elapsedRealtimeNano() tÅ™Ã­dy SystemClock. Chyba tÃ©to synchronizace by mÄ›la bÃ½t niÅ¾Å¡Ã­ neÅ¾ 100 milisekund.
â€¢ VÅ¡echny senzory musÃ­, pÅ™i aktivnÃ­m zÃ¡znamu, poskytnout data do stanovenÃ© maximÃ¡lnÃ­ doby danÃ© vztahem 4.3. V pÅ™Ã­padÄ› senzorÅ¯ s poÅ¾adovanou minimÃ¡lnÃ­ dobou je maximÃ¡lnÃ­ ÄekacÃ­ doba dÃ¡na vztahem 4.4.
â€¢ VÅ¡echny senzory musÃ­ poskytnout prvnÃ­ vzorek signÃ¡lu do maximÃ¡lnÃ­ doby danÃ© vztahem 4.5 od doby aktivace senzorus. DÃ¡le je pÅ™ijatelnÃ©, aby tento vzorek mÄ›l nulovou pÅ™esnost.

í µí±™í µí±í µí±¡í µí±’í µí±›í µí±í µí±’[í µí±ší µí± ] = 100 í µí±ší µí±  + 2 Â· í µí±¡

(4.3)

í µí±™í µí±í µí±¡í µí±’í µí±›í µí±í µí±’[í µí±ší µí± ] = 5 í µí±ší µí±  + 2 Â· í µí±¡

(4.4)

í µí±™í µí±í µí±¡í µí±’í µí±›í µí±í µí±’[í µí±ší µí± ] = 400 í µí±ší µí±  + 2 Â· í µí±¡

(4.5)

Kde í µí±™í µí±í µí±¡í µí±’í µí±›í µí±í µí±’ je maximÃ¡lnÃ­ ÄekacÃ­ doba, do kterÃ© musÃ­ bÃ½t poskytnut vzorek a í µí±¡ je doba potÅ™ebnÃ¡ na akvizici tohoto vzorku.[2]

58

ZpoÅ¾dÄ›nÃ­ v rozsahu desÃ­tek aÅ¾ stovek milisekund nenÃ­ pro synchronizaci pÅ™Ã­pustnÃ©. Z toho dÅ¯vodu byla snaha toto zpoÅ¾dÄ›nÃ­ korigovat. PrvotnÃ­m pokusem bylo stanovenÃ­ konstanty, pomocÃ­ nÃ­Å¾ by bylo zpoÅ¾dÄ›nÃ­ odstranÄ›no. OvÅ¡em pÅ™i mÄ›Å™enÃ­ zpoÅ¾dÄ›nÃ­ mezi jednotlivÃ½mi zÃ¡znamy bylo zjiÅ¡tÄ›no, Å¾e hodnota je pÅ™Ã­liÅ¡ variabilnÃ­. Rozsah dodateÄnÃ©ho zpoÅ¾dÄ›nÃ­ (po synchronizaci poÄÃ¡tkÅ¯ - viz 4.7.2) se pohyboval v rozsahu 200â€“600 ms, a proto nebylo moÅ¾nÃ© toto zpoÅ¾dÄ›nÃ­ korigovat za pomoci konstanty. Byly provedeny i dalÅ¡Ã­ pokusy o korekci zpoÅ¾dÄ›nÃ­, jenÅ¾ mÄ›Å™ily uplynulou dobu pÅ™ed i pÅ™i akvizici v rÅ¯znÃ½ch ÄÃ¡stech aplikace. BohuÅ¾el nebyl nalezen Å¾Ã¡dnÃ½ zpÅ¯sob, jak signÃ¡ly vzÃ¡jemnÄ› synchronizovat s pÅ™esnostÃ­ v rÃ¡mci jednotek milisekund Äi mÃ©nÄ›.
Z toho dÅ¯vodu je nutnÃ© vytvoÅ™it v obou signÃ¡lech synchronizaÄnÃ­ znaÄky za pomoci vnÄ›jÅ¡Ã­ho podnÄ›tu. TÃ­mto podnÄ›tem mÅ¯Å¾e bÃ½t napÅ™Ã­klad poklepÃ¡nÃ­ prstu pÅ™es objektiv fotoaparÃ¡tu, coÅ¾ zpÅ¯sobÃ­ jeho krÃ¡tkodobÃ© zakrytÃ­ a zÃ¡roveÅˆ generovÃ¡nÃ­ vibracÃ­, jeÅ¾ jsou zaznamenÃ¡ny mikrofonem. SouÄasnÄ› tak vznikne v obou signÃ¡lech vÃ½kyv, dle kterÃ©ho lze signÃ¡ly synchronizovat bez ohledu na ÄasovÃ© znÃ¡mky. Tato metoda synchronizace je pÅ™evzata z [26].
4.8 HlavnÃ­ spouÅ¡tÄ›cÃ­ aktivita
Po spuÅ¡tÄ›nÃ­ aplikace je otevÅ™ena hlavnÃ­ spouÅ¡tÄ›cÃ­ aktivita nesoucÃ­ nÃ¡zev MainActivity. Aplikace obsahuje pouze tuto aktivitu - pouze tuto obrazovku. ÃšÄelem tÃ©to aktivity je zprostÅ™edkovat GUI pro interakci s uÅ¾ivatelem a vytvoÅ™it funkÄnÃ­ celek s vÃ½Å¡e uvedenÃ½mi tÅ™Ã­dami.
PÅ™ed pouÅ¾itÃ­m aplikace je nutnÃ© zkontrolovat, zdali mÃ¡ aplikace pÅ™idÄ›lena dostateÄnÃ¡ oprÃ¡vnÄ›nÃ­. Pokud nÄ›kterÃ© z oprÃ¡vnÄ›nÃ­ chybÃ­, je uÅ¾ivatel poÅ¾Ã¡dÃ¡n o jeho pÅ™idÄ›lenÃ­. Tato skuteÄnost je vyobrazena na obrÃ¡zku 4.7. V pÅ™Ã­padÄ› neudÄ›lenÃ­ nÄ›kterÃ©ho z oprÃ¡vnÄ›nÃ­ je aplikace bezpodmÃ­neÄnÄ› ukonÄena.
GUI tvoÅ™Ã­ zÃ¡kladnÃ­ komponenty, vyjma grafÅ¯, nabÃ­zenÃ© systÃ©mem Android. VykreslenÃ­ grafÅ¯ je zajiÅ¡tÄ›no pomocÃ­ knihovny GraphView. JednÃ¡ se o open source knihovnu umoÅ¾ÅˆujÃ­cÃ­ vytvÃ¡Å™et bodovÃ©, spojnicovÃ© Äi sloupcovÃ© grafy. HlavnÃ­ vÃ½hodou je ovÅ¡em moÅ¾nost vytvoÅ™enÃ­ Å¾ivÃ©ho grafu - data je moÅ¾nÃ© mÄ›nit za bÄ›hu, takÅ¾e lze vykreslovat zmÄ›ny v reÃ¡lnÃ©m Äase. U vÄ›tÅ¡iny vyzkouÅ¡enÃ½ch knihoven nebyla tato moÅ¾nost dostupnÃ¡ - dochÃ¡zelo k pÅ™ekreslovÃ¡nÃ­ celÃ©ho grafu.
SnÃ­mek obrazovky vytvoÅ™enÃ½ po spuÅ¡tÄ›nÃ­ aplikace a snÃ­mek obrazovky po ukonÄenÃ­ nahrÃ¡vÃ¡nÃ­ je vyobrazen na obrÃ¡zku 4.8. GUI obsahuje pouze prvky nutnÃ© k poskytnutÃ­ zpÄ›tnÃ© vazby a Å™Ã­zenÃ­ akvizice dat. V pravÃ©m hornÃ­m rohu se nachÃ¡zÃ­ tlaÄÃ­tko umoÅ¾ÅˆujÃ­cÃ­ zahÃ¡jenÃ­ a ukonÄenÃ­ akvizice dat. Toto mÃ­sto je ideÃ¡lnÃ­ pro ovlÃ¡dÃ¡nÃ­ aplikace pouze jednou rukou. V hornÃ­ polovinÄ› obrazovky jsou vykreslovÃ¡na jiÅ¾ zpracovanÃ¡ obrazovÃ¡ data tÅ™Ã­dy ImageReader. JednÃ¡ se o prÅ¯mÄ›rnou jasovou hodnotu
59

Obr. 4.7: Å½Ã¡dost o pÅ™idÄ›lenÃ­ oprÃ¡vnÄ›nÃ­ po spuÅ¡tÄ›nÃ­ aplikace
ÄervenÃ© sloÅ¾ky snÃ­mku poÅ™Ã­zenÃ©ho z koneÄku prstu - PPG zÃ¡znam. V dolnÃ­ polovinÄ› obrazovky jsou vykreslovÃ¡na zvukovÃ¡ data tÅ™Ã­dy AudioRecord. JednÃ¡ se o zÃ¡znam srdeÄnÃ­ch ozev nasnÃ­manÃ½ch pomocÃ­ mikrofonu pÅ™iloÅ¾enÃ©ho na kÅ¯Å¾i v mitrÃ¡lnÃ­ oblasti - FKG zÃ¡znam. JelikoÅ¾ se vykreslovÃ¡nÃ­ 8 000 vzorkÅ¯ kaÅ¾dou sekundu (vzorkovacÃ­ frekvence audio signÃ¡lu) ukÃ¡zalo jako nepraktickÃ© (zamrzÃ¡nÃ­ GUI) je vykreslovÃ¡n kaÅ¾dÃ½ dvaatÅ™icÃ¡tÃ½ vzorek. Nad grafem se nachÃ¡zÃ­ posuvnÃ­k, jenÅ¾ urÄuje a umoÅ¾Åˆuje dodateÄnÃ© zesÃ­lenÃ­ pÅ™ehrÃ¡vanÃ©ho audio signÃ¡lu skrze pÅ™ipojenÃ© pÅ™Ã­sluÅ¡enstvÃ­.
Po ukonÄenÃ­ akvizice dat je vypoÄÃ­tÃ¡no zpoÅ¾dÄ›nÃ­ video signÃ¡lu, kterÃ© je korigovÃ¡no. VÃ½stupem mÄ›Å™enÃ­ jsou dva soubory - audio ve formÃ¡tu *.wav a video ve formÃ¡tu *.mp4. Oba soubory se nachÃ¡zejÃ­ v internÃ­ pamÄ›ti telefonu ve sloÅ¾ce \Android\data\cz.vutbr.bpdataacquisition\files. Tyto soubory je nutnÃ© dÃ¡le zpracovat v prostÅ™ednÃ­ MATLAB.
4.9 TestovÃ¡nÃ­ aplikace
Aplikace byla po Äas vÃ½voje intenzivnÄ› testovÃ¡na a modifikovÃ¡na. PÅ™i testovÃ¡nÃ­ byly ovÅ¡em odhaleny i nedostatky, kterÃ© nebylo moÅ¾nÃ© kompenzovat. Tyto nedostatky se vztahujÃ­ k metodÄ› mÄ›Å™enÃ­ krevnÃ­ho tlaku pomocÃ­ mobilnÃ­ho telefonu, operaÄnÃ­mu systÃ©mu Android, konkrÃ©tnÃ­mu zaÅ™Ã­zenÃ­ Äi kombinaci vÅ¡ech uvedenÃ½ch.
PrvnÃ­m z nedostatkÅ¯ je energetickÃ¡ a vÃ½poÄetnÃ­ nÃ¡roÄnost. ZpracovÃ¡nÃ­ zvukovÃ½ch
60

Obr. 4.8: GUI aplikace - po spuÅ¡tÄ›nÃ­ (vlevo), po ukonÄenÃ­ nahrÃ¡vÃ¡nÃ­ (vpravo)
a obrazovÃ½ch dat znaÄnÄ› vytÄ›Å¾uje vÅ¡echny dostupnÃ© vÃ½poÄetnÃ­ jednotky. ZejmÃ©na zpracovÃ¡nÃ­ obrazovÃ½ch dat (pÅ™evod formÃ¡tu YUV_420_888 ) vyÅ¾aduje kooperaci CPU a GPU. TakovÃ©to zatÃ­Å¾enÃ­ vÃ½poÄetnÃ­ch jednotek zpÅ¯sobÃ­ vyÅ¡Å¡Ã­ spotÅ™ebu elektrickÃ© energie a zahÅ™Ã­vÃ¡nÃ­ zaÅ™Ã­zenÃ­, dÃ­ky ÄemuÅ¾ se uÅ¾ivateli potÃ­ dlanÄ›, coÅ¾ sniÅ¾uje komfort tÃ©to metody. Komfort dÃ¡le sniÅ¾uje nepÅ™Ã­jemnÄ› se zahÅ™Ã­vajÃ­cÃ­ LED, na kterÃ© je nutnÃ© mÃ­t pÅ™i mÄ›Å™enÃ­ pÅ™iloÅ¾enÃ½ koneÄek prstu. PÅ™i delÅ¡Ã­ akvizici dat (vÃ­ce neÅ¾ 3 minuty) Äi vÃ­ce po sobÄ› jdoucÃ­ch mÄ›Å™enÃ­ch se LED zahÅ™eje natolik, Å¾e je nutnÃ© mÄ›Å™enÃ­ pÅ™eruÅ¡it, jinak by mohlo dojÃ­t k popÃ¡lenÃ­ pÅ™iloÅ¾enÃ©ho prstu. LED je takÃ© vÃ½znamnÃ½m konzumentem elektrickÃ© energie. Aplikace za 30 minut bÄ›hu, ze kterÃ½ch bylo 20 minut nahrÃ¡vÃ¡no (vÃ­ce krÃ¡tkÃ½ch zÃ¡znamÅ¯) spotÅ™ebovala 325 mAh. PouÅ¾itÃ© zaÅ™Ã­zenÃ­ mÃ¡ kapacitu baterie 3 000 mAh. Bylo tedy spotÅ™ebovÃ¡no pÅ™ibliÅ¾nÄ› 11 % elektrickÃ© energie uloÅ¾enÃ© v baterii. Informace o spotÅ™ebÄ› elektrickÃ© energie jednotlivÃ½ch aplikacÃ­ Äi HW lze obvykle zjistit v nastavenÃ­ zaÅ™Ã­zenÃ­, sekce ÃºdrÅ¾ba, baterie, vyuÅ¾itÃ­ baterie.
DruhÃ½ nedostatek se vztahuje ke konkrÃ©tnÃ­mu zaÅ™Ã­zenÃ­. PouÅ¾itÃ© zaÅ™Ã­zenÃ­, Samsung Galaxy S7, mÃ¡ na spodnÃ­ bradÄ› tÅ™i tlaÄÃ­tka - domÅ¯, zpÄ›t a pÅ™epnout. TlaÄÃ­tka zpÄ›t a pÅ™epnout jsou dotykovÃ¡ (kapacitnÃ­). TlaÄÃ­tko domÅ¯ je mechanickÃ©. Tato skuteÄnost je vyobrazena na obrÃ¡zku 4.9. DotykovÃ¡ tlaÄÃ­tka jsou velmi citlivÃ¡, a tak pÅ™i mÄ›Å™enÃ­ obÄas dochÃ¡zÃ­ k dotyku kÅ¯Å¾e s nÄ›kterÃ½m z tÄ›chto tlaÄÃ­tek. To zpÅ¯sobÃ­ vyvolÃ¡nÃ­ udÃ¡losti, jeÅ¾ je k tlaÄÃ­tku pÅ™iÅ™azena. Z pohledu vÃ½voje aplikace, lze modifikovat
61

pouze udÃ¡lost tlaÄÃ­tka zpÄ›t - zabrÃ¡nit ukonÄenÃ­ aplikace. UdÃ¡losti tlaÄÃ­tek domÅ¯ a pÅ™epnout nelze v rÃ¡mci aplikace obslouÅ¾it, a to z dÅ¯vodu, aby se zabrÃ¡nilo Å¡kodlivÃ©mu SW v blokovÃ¡nÃ­ zaÅ™Ã­zenÃ­ (aplikace, kterou nelze ukonÄit) - tato funkce je blokovÃ¡na systÃ©mem. V pÅ™Ã­padÄ› dotyku tlaÄÃ­tka pÅ™epnout tedy nelze jeho udÃ¡lost modifikovat. OvÅ¡em dotyk tohoto tlaÄÃ­tka zpÅ¯sobÃ­ otevÅ™enÃ­ obrazovky s aktuÃ¡lnÄ› spuÅ¡tÄ›nÃ½mi aplikacemi. JelikoÅ¾ uÅ¾ivatel opouÅ¡tÃ­ aktuÃ¡lnÃ­ aktivitu (obrazovku), je nutnÃ© ji pozastavit. OpuÅ¡tÄ›nÃ­ aktivity zpÅ¯sobÃ­ zavolÃ¡nÃ­ metody onPause(), ve kterÃ© aktivitu opÄ›t obnovÃ­me - pÅ™esnuneme proces do popÅ™edÃ­. TÃ©to funkÄnosti je vyuÅ¾ito pouze pÅ™i nahrÃ¡vanÃ­. Pro udÃ¡lost tlaÄÃ­tka domÅ¯ bohuÅ¾el neexistuje Å¾Ã¡dnÃ© pÅ™ijatelnÃ© Å™eÅ¡enÃ­. NaÅ¡tÄ›stÃ­ k mechanickÃ½m tlaÄÃ­tkÅ¯m se tento nedostatek nevztahuje, a proto v naÅ¡em pÅ™Ã­padÄ› byl tento problÃ©m vyÅ™eÅ¡en. Toto ovÅ¡em nemusÃ­ platit pro jinÃ¡ zaÅ™Ã­zenÃ­.[55]
TÅ™etÃ­m nedostatkem je nevhodnÃ© umÃ­stÄ›nÃ­ vstupu pro pÅ™ipojenÃ­ drÃ¡tovÃ½ch sluchÃ¡tek. V pÅ™Ã­padÄ› pouÅ¾itÃ©ho zaÅ™Ã­zenÃ­ se vstup pro pÅ™ipojenÃ­ sluchÃ¡tek s 3,5 mm Jack konektorem nachÃ¡zÃ­ ve spodnÃ­ bradÄ› telefonu. Na tomto mÃ­stÄ› se taktÃ©Å¾ nachÃ¡zÃ­ hlavnÃ­ mikrofon. TakovÃ©to umÃ­stÄ›nÃ­ mikrofonu je pro mobilnÃ­ telefony typickÃ©. PÅ™i mÄ›Å™enÃ­ je nutnÃ© mikrofon pÅ™itlaÄit na kÅ¯Å¾i v mitrÃ¡lnÃ­ oblasti. Pokud jsou ovÅ¡em k zaÅ™Ã­zenÃ­ pÅ™ipojena drÃ¡tovÃ¡ sluchÃ¡tka s pÅ™Ã­mÃ½m konektorem nenÃ­ to moÅ¾nÃ©. S drÃ¡tovÃ½mi sluchÃ¡tky se zahnutÃ½m konektorem lze mÄ›Å™it, ale komfort uÅ¾ivatele je snÃ­Å¾en. PorovnÃ¡nÃ­ tÄ›chto dvou typÅ¯ konektorÅ¯ je vyobrazeno na obrÃ¡zku 4.9. KvÅ¯li tomuto nedostatku a novodobÃ½m zaÅ™Ã­zenÃ­m, kterÃ½m byl tento vstup odejmutÃ½, byla implementovÃ¡na moÅ¾nost pÅ™ipojenÃ­ zvukovÃ©ho pÅ™Ã­sluÅ¡enstvÃ­ pÅ™es bluetooth.
Obr. 4.9: PÅ™ipojenÃ­ sluchÃ¡tek pÅ™es 3,5 mm Jack konektor. ZahnutÃ½ typ konektoru (vlevo), pÅ™Ã­mÃ½ typ konektoru (vpravo). TlaÄÃ­tka zaÅ™Ã­zenÃ­ (oba obrÃ¡zky) - dotykovÃ© tlaÄÃ­tko pÅ™epnout (levÃ© tlaÄÃ­tko), mechanickÃ© tlaÄÃ­tko domÅ¯ (prostÅ™ednÃ­ tlaÄÃ­tko), dotykovÃ© tlaÄÃ­tko zpÄ›t (pravÃ© tlaÄÃ­tko).
62

5 ZpracovÃ¡nÃ­ dat
ZÃ¡znamy zÃ­skanÃ© pomocÃ­ aplikace, popsanÃ© v pÅ™edchozÃ­ kapitole, jsou zpracovÃ¡ny v prostÅ™edÃ­ MATLAB. VÃ½stupem aplikace jsou dva soubory. PrvnÃ­ soubor je videozÃ¡znam ve formÃ¡tu MP4, ze kterÃ©ho bude zÃ­skÃ¡n PPG signÃ¡l. DruhÃ½ soubor je audiozÃ¡znam ve formÃ¡tu WAV, ze kterÃ©ho bude zÃ­skÃ¡n FKG signÃ¡l. Oba soubory si v hlaviÄce nesou informace o jejich akvizici - tzv. metadata, proto nenÃ­ potÅ™ebnÃ© zadÃ¡vat informace manuÃ¡lnÄ›.
5.1 PÅ™edzpracovÃ¡nÃ­ signÃ¡lÅ¯
PÅ™ed vÃ½poÄtem hodnoty krevnÃ­ho tlaku je nutnÃ© nejprve zÃ­skat pÅ™Ã­sluÅ¡nÃ© signÃ¡ly v poÅ¾adovanÃ© kvalitÄ› tak, aby bylo moÅ¾nÃ© naleznout zÃ¡jmovÃ© body v tÄ›chto signÃ¡lech. TÄ›mito zÃ¡jmovÃ½mi body jsou obÄ› srdeÄnÃ­ ozvy z FKG signÃ¡lu a maximum plusnÃ­ vlny v PPG signÃ¡lu.
5.1.1 PPG signÃ¡l
PPG signÃ¡l je extrahovÃ¡n z videozÃ¡znamu pomocÃ­ funkce VideoReader(), jejÃ­mÅ¾ vstupem je cesta k souboru. Tato funkce vracÃ­ objekt, kterÃ½ poskytuje informace o akvizici videozÃ¡znamu (vzorkovacÃ­ frekvence, rozmÄ›ry videozÃ¡znamu apod.). DÃ©le umoÅ¾Åˆuje ÄÃ­st video po jednotlivÃ½ch snÃ­mcÃ­ch. Tyto snÃ­mky jsou automaticky pÅ™evedeny z formÃ¡tu YUV na formÃ¡t RGB, coÅ¾ znaÄnÄ› usnadÅˆuje jejich zpracovÃ¡nÃ­. KaÅ¾dÃ½ snÃ­mek je reprezentovÃ¡n tÅ™Ã­dimenzionÃ¡lnÃ­ maticÃ­, kde poÄet Å™Ã¡dkÅ¯ a sloupcÅ¯ odpovÃ­dÃ¡ rozmÄ›ru snÃ­mku a dimenze reprezentuje jednotlivÃ© sloÅ¾ky barevnÃ©ho modelu RGB.
Pro zÃ­skÃ¡nÃ­ PPG signÃ¡lu je dÅ¯leÅ¾itÃ¡ pouze prvnÃ­ dimenze, jeÅ¾ reprezentuje Äervenou sloÅ¾ku barevnÃ©ho modelu RGB. Jeden vzorek PPG signÃ¡lu je potÃ© zÃ­skÃ¡n jako prÅ¯mÄ›r jasovÃ½ch hodnot ÄervenÃ© sloÅ¾ky konkrÃ©tnÃ­ho snÃ­mku. OstatnÃ­ barevnÃ© sloÅ¾ky neobsahujÃ­ informaci o prÅ¯chodu pulsnÃ­ vlny koneÄkem prstu a jsou tedy redundantnÃ­.
Aby bylo moÅ¾nÃ© PPG signÃ¡l dobÅ™e zpracovat, je nutnÃ© ze signÃ¡lu odstranit pohybovÃ© artefakty. Z tohoto dÅ¯vodu je signÃ¡l filtrovÃ¡n filtrem typu hornÃ­ propust s meznÃ­ meznÃ­ frekvencÃ­ 0,8 Hz. Tato meznÃ­ frekvence byla stanovena empiricky, jelikoÅ¾ meznÃ­ frekvence 0,5 Hz, uvedenÃ¡ v [26], nebyla dostaÄujÃ­cÃ­. OdstranÄ›nÃ­ pohybovÃ½ch artefaktÅ¯ je dÅ¯leÅ¾itÃ© pro nÃ¡slednou detekci maxim jednotlivÃ½ch pulsnÃ­ch vln. SignÃ¡l pÅ™ed a po filtraci je vyobrazen na obrÃ¡zku 5.1.
63

60 58 56 54 52 50
0
1
0.5
0
-0.5
-1 0

5

10

15

SignÃ¡l PPG - po filtracÃ­

5

10

15

NormalizovanÃ¡ amplituda [-]

Obr. 5.1: Filtrace PPG signÃ¡lu filtrem typu hornÃ­ propust s meznÃ­ frekvencÃ­ 0,8 Hz pro odstranÄ›nÃ­ pohybovÃ½ch artefaktÅ¯.
5.1.2 FKG signÃ¡l
FKG signÃ¡l je extrahovÃ¡n z audiozÃ¡znamu za pomocÃ­ funkce audioread(), jejÃ­mÅ¾ vstupem je cesta k souboru. VÃ½stup tÃ©to funkce je pole vzorkÅ¯ jednotlivÃ½ch kanÃ¡lÅ¯ a vzorkovacÃ­ frekvence.
AudiozÃ¡znam zÃ­skanÃ½ prostÅ™ednictvÃ­m aplikace, popsanÃ© v pÅ™edchozÃ­ kapitole, obsahuje pouze jeden kanÃ¡l. VzorkovacÃ­ frekvence extrahovanÃ©ho audiozÃ¡znamu je 8 kHz. To je nejniÅ¾Å¡Ã­ moÅ¾nÃ¡ vzorkovacÃ­ frekvence, jeÅ¾ mÅ¯Å¾e bÃ½t zaznamenÃ¡na na operaÄnÃ­m systÃ©mu Android verze 7.0. I pÅ™es to, Å¾e se jednÃ¡ o nejniÅ¾Å¡Ã­ vzorkovacÃ­ frekvenci, je pro zpracovÃ¡nÃ­ FKG signÃ¡lu stÃ¡le redundantnÃ­. Z toho dÅ¯vodu je vhodnÃ© snÃ­Å¾it vzorkovacÃ­ frekvenci z 8 kHz na 1 kHz.
DalÅ¡Ã­m krokem je odstranÄ›nÃ­ neÅ¾Ã¡doucÃ­ch sloÅ¾ek signÃ¡lu. Toho je docÃ­leno pouÅ¾itÃ­m IIR filtru typu pÃ¡smovÃ¡ propust s dolnÃ­ meznÃ­ frekvencÃ­ 20 Hz a hornÃ­ meznÃ­ frekvencÃ­ 250 Hz. KrÃ¡tkÃ½ Ãºsek FKG signÃ¡lu po filtraci tÃ­mto filtrem je vyobrazen na obrÃ¡zku 5.2. [26]
64

Po tÃ©to filtraci je signÃ¡l normalizovÃ¡n v rozsahu od -1 do 1. DÃ¡le je zÃ­skÃ¡na energie signÃ¡lu umocnÄ›nÃ­m kaÅ¾dÃ©ho vzorku druhou mocninou. PoslednÃ­m krokem pÅ™edzpracovÃ¡nÃ­ je zÃ­skÃ¡nÃ­ obÃ¡lky signÃ¡lu pomocÃ­ IIR filtru typu dolnÃ­ propust s meznÃ­ frekvencÃ­ 20 Hz. VÃ½slednÃ¡ obÃ¡lka FKG signÃ¡lu je vyobrazena na obrÃ¡zku 5.2.[26]

NormalizovanÃ¡ amplituda [-]

SignÃ¡l FKG - po filtraci 1

0.5

0

-0.5

-1

0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

SignÃ¡l FKG - obÃ¡lka 1

0.8

0.6

0.4

0.2

0

0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

NormalizovanÃ¡ amplituda [-]

Obr. 5.2: SignÃ¡l FKG po filtraci a obÃ¡lka tohoto signÃ¡lu
5.2 Synchronizace zÃ¡znamÅ¯
I pÅ™es to, Å¾e oba zÃ¡znamy byly jiÅ¾ synchronizovÃ¡ny v aplikaci, je zpoÅ¾dÄ›nÃ­ mezi nimi stÃ¡le vÃ½raznÃ©. DÅ¯vodem je nepÅ™esnost senzorÅ¯, kterÃ½mi jsou poskytnuty ÄasovÃ© znÃ¡mky, jejichÅ¾ ÄasovÃ© zÃ¡kladny si neodpovÃ­dajÃ­. Z toho dÅ¯vodu nelze korigovat zpoÅ¾dÄ›nÃ­ s pÅ™esnostÃ­ v rÃ¡mci jednotek milisekund Äi mÃ©nÄ›. Tato problematika je podrobnÄ› rozebrÃ¡na v sekci 4.7.3. V tÃ©to sekci je takÃ© popsÃ¡n postup pro vytvoÅ™enÃ­ synchronizaÄnÃ­ch znaÄek v obou zÃ¡znamech poklepu prstu, kterÃ© jsou pro tuto synchronizaci dÅ¯leÅ¾itÃ©.
65

PotÃ©, co byly signÃ¡ly pÅ™edzpracovÃ¡ny, je uÅ¾ivatel nucen vybrat Ãºsek signÃ¡lu, ve kterÃ©m se nalÃ©zÃ¡ synchronizaÄnÃ­ znaÄka. V tomto Ãºseku PPG signÃ¡lu a obÃ¡lky FKG signÃ¡lu jsou hledÃ¡ny indexy maximÃ¡lnÃ­ch hodnot. Na zÃ¡kladÄ› indexÅ¯ je zjiÅ¡tÄ›na ÄasovÃ¡ hodnota vzorkÅ¯, pomocÃ­ kterÃ© je vypoÄÃ­tÃ¡no zpoÅ¾dÄ›nÃ­. Z FKG signÃ¡lu a jeho obÃ¡lky je potÃ© odstranÄ›n pÅ™Ã­sluÅ¡nÃ½ poÄet vzorkÅ¯. DÃ­ky tomu jsou signÃ¡ly velmi pÅ™esnÄ› synchronizovÃ¡ny (v jednotkÃ¡ch milisekund). Tento postup synchronizace se ukÃ¡zal jako velmi pÅ™esnÃ½. UkÃ¡zka synchronizace PPG a FKG zÃ¡znamu na zÃ¡kladÄ› synchronizaÄnÃ­ch znaÄek je uvedena ve vÃ½pise 5.1.
Pokud jsou oba zÃ¡znamy pÅ™esnÄ› synchronizovÃ¡ny, lze zaÄÃ­t hledat jednotlivÃ© zÃ¡jmovÃ© body, na zÃ¡kladÄ› kterÃ½ch budou stanoveny parametry PTT a ET.
1 % Hodnoty ÄasÅ¯ pro jednotlivÃ© vzorky (osa x) 2 vt = linspace(0, length(PPG) / videoFrameRate , length(PPG)); 3 et = linspace(0, length(ENV) / audioSampleRate , length(ENV)); 4 5 % Ãšsek signÃ¡lu se synchronizaÄnÃ­ znaÄkou 6 ppgSyncArea = PPG((syncFrom * videoFrameRate) : (syncTo * videoFrameRate)); 7 envSyncArea = ENV((syncFrom * audioSampleRate) : (syncTo * audioSampleRate)); 8 9 % NalezenÃ­ indexÅ¯ maximÃ¡lnÃ­ hodnot 10 [~ , ppgSyncPos ] = max ( ppgSyncArea ) ; % PPG sign Ã¡ l 11 [~ , envSyncPos ] = max ( envSyncArea ) ; % Ob Ã¡ lka FKG sign Ã¡ lu 12 13 % P Å™ epo Ä et index Å¯ z Ãº seku se synchroniza Ä n Ã­ zna Ä kou na idexy v cel Ã© m sig Ã¡ lu 14 ppgSyncIdx = syncFrom * videoFrameRate + ppgSyncPos - 1; 15 envSyncIdx = syncFrom * audioSampleRate + envSyncPos - 1; 16 17 % Zji Å¡ t Ä› n Ã­ Ä asov Ã© hodnoty pro konkr Ã© tn Ã­ indexy 18 ppgSyncTime = vt ( ppgSyncIdx ) ; 19 envSyncTime = et ( envSyncIdx ) ; 20 21 % V Ã½ po Ä et zpo Å¾ d Ä› n Ã­ 22 delay = round (( envSyncTime - ppgSyncTime ) * audioSampleRate ) ; 23 24 % Odstran Ä› n Ã­ po Ä tu vzork Å¯ , jen Å¾ odpov Ã­ daj Ã­ c Ã­ zpo Å¾ d Ä› n Ã­ 25 PCG = PCG ( delay + 1 : end ) ; 26 ENV = ENV ( delay + 1 : end ) ;
VÃ½pis 5.1: VÃ½poÄet zpoÅ¾dÄ›nÃ­ a synchronizace PPG a FKG signÃ¡lu
5.3 Detekce vrcholÅ¯
PÅ™ed samotnou detekcÃ­ vrcholÅ¯ je nutnÃ© zvolit Ãºsek zÃ¡znamu, ve kterÃ©m se nachÃ¡zejÃ­ zÃ¡jmovÃ© body. UÅ¾ivatel je automaticky vyzvÃ¡n, aby tento Ãºsek v grafu pÅ™edzpracovanÃ½ch signÃ¡lÅ¯ vytyÄil.
66

5.3.1 PulsnÃ­ vlna
V PPG signÃ¡lu jsou hledÃ¡ny vrcholy pulsnÃ­ch vln. Vektor pozic vrcholÅ¯ je nalezen pomocÃ­ funkce findpeaks(). Tu lze optimalizovat zadÃ¡nÃ­m parametru minimÃ¡lnÃ­ vÃ½Å¡ky vrcholu â€“ MinPeakHeight a parametru minimÃ¡lnÃ­ vzdÃ¡lenosti vrcholÅ¯ â€“ MinPeakDistance. MinimÃ¡lnÃ­ vÃ½Å¡ka vrcholu byla empiricky stanovena jako 25 % maxima z PPG signÃ¡lu. Aby nedochÃ¡zelo k detekci dvou a vÃ­ce vrcholÅ¯ v rÃ¡mci jednÃ© pulsnÃ­ vlny, je nastavena minimÃ¡lnÃ­ vzdÃ¡lenost mezi vrcholy. Ta je dÃ¡na dobou trvÃ¡nÃ­ jednoho srdeÄnÃ­ho cyklu pro maximÃ¡lnÃ­ tepovou frekvenci, kterou lze nastavit.
Detekce vrcholÅ¯ v PPG signÃ¡lu pomocÃ­ funkce findpeaks() je velmi pÅ™esnÃ¡. VÃ½hodou tohoto postupu je detekce i vrcholÅ¯ s niÅ¾Å¡Ã­ amplitudou, kterÃ© by pÅ™i prahovÃ© detekci byly ignorovÃ¡ny. VÃ½raznÃ½ rozdÃ­l amplitudy jednotlivÃ½ch pulsovÃ½ch vln v PPG signÃ¡lu je moÅ¾nÃ© vidÄ›t na obrÃ¡zku 5.1.

5.3.2 PrvnÃ­ a druhÃ¡ srdeÄnÃ­ ozva

ZÃ¡jmovÃ½mi body FKG signÃ¡lu jsou prvnÃ­ a druhÃ¡ srdeÄnÃ­ ozva. PÅ™i detekci S1 je vyuÅ¾ito faktu, Å¾e se vrchol tÃ©to srdeÄnÃ­ ozvy musÃ­ nachÃ¡zet pÅ™ed vrcholem korespondujÃ­cÃ­ pulsnÃ­ vlny v PPG signÃ¡lu a zÃ¡roveÅˆ se musÃ­ nachÃ¡zet za vrcholem pÅ™edchozÃ­ pulsnÃ­ vlny. V oblasti mezi dvÄ›ma S1 se potÃ© nachÃ¡zÃ­ S2.
PrvnÃ­ verze algoritmu pracovala na principu hledÃ¡nÃ­ maxima v obÃ¡lce FKG signÃ¡lu prÃ¡vÄ› mezi korespondujÃ­cÃ­m a pÅ™edchozÃ­m vrcholem pulsnÃ­ vlny v PPG signÃ¡lu. Tento algoritmus se ovÅ¡em ukÃ¡zal jako nevyhovujÃ­cÃ­. Mezi mÄ›Å™enÃ½mi subjekty se totiÅ¾ vykytovaly jedinci, u nichÅ¾ byla amplituda S2 vyÅ¡Å¡Ã­ neÅ¾ amplituda S1. To zpÅ¯sobilo nekorektnÃ­ detekci S1 a nÃ¡slednÄ› S2.
DruhÃ¡ verze algoritmu jiÅ¾ pÅ™edpoklÃ¡dÃ¡ urÄitÃ½ rozsah PTT. JinÃ½mi slovy, pokud bude S1 pÅ™Ã­liÅ¡ blÃ­zko korespondujÃ­cÃ­mu vrcholu pulsnÃ­ vlny, bude vypoÄÃ­tanÃ½ systolickÃ½ tlak pÅ™Ã­liÅ¡ vysokÃ½. V opaÄnÃ©m pÅ™Ã­padÄ› bude vypoÄÃ­tanÃ½ systolickÃ½ tlak pÅ™Ã­liÅ¡ nÃ­zkÃ½. Rozsah minimÃ¡lnÃ­ho a maximÃ¡lnÃ­ho systolickÃ©ho tlaku, ve kterÃ©m algoritmus pracuje, byl empiricky stanoven v rozmezÃ­ 80â€“180 mmHg. MinimÃ¡lnÃ­ a maximÃ¡lnÃ­ vzdÃ¡lenost PTT pak lze vypoÄÃ­tat dle vztahu 5.1, kde í µí±í µí±†í µí±ší µí±–í µí±› a í µí±í µí±†í µí±ší µí±í µí±¥ udÃ¡vajÃ­ rozsah minimÃ¡lnÃ­ho a maximÃ¡lnÃ­ tlaku, í µí± je konstanta z rovnice pÅ™Ã­mky ve smÄ›rnicovÃ©m tvaru 3.3 a hodnota âˆ’0, 425 je smÄ›rnice í µí±˜ tÃ©to pÅ™Ã­mky - viz 3.3.1.

í µí±ƒ í µí±‡ í µí±‡í µí±ší µí±–í µí±›

[í µí±ší µí± ]

=

âˆ’ í µí±í µí±†í µí±ší µí±í µí±¥ âˆ’ 0, 425

í µí±

í µí±ƒ í µí±‡ í µí±‡í µí±ší µí±í µí±¥

[í µí±ší µí± ]

=

âˆ’ í µí±í µí±†í µí±ší µí±–í µí±› âˆ’ 0, 425

í µí±

(5.1)

Vrchol S1 je pak hledÃ¡n pÅ™ed vrcholem pulsnÃ­ vlny ve vzdÃ¡lenosti vÄ›tÅ¡Ã­, neÅ¾

í µí±ƒ í µí±‡ í µí±‡í µí±ší µí±–í µí±› a zÃ¡roveÅˆ menÅ¡Ã­, neÅ¾ í µí±ƒ í µí±‡ í µí±‡í µí±ší µí±í µí±¥. DÃ­ky tomuto postupu jiÅ¾ nenÃ­ vyÅ¾adovÃ¡no

67

aby S1 mÄ›la vÄ›tÅ¡Ã­ amplitudu neÅ¾ S2, coÅ¾ umoÅ¾Åˆuje snÃ­mat FKG signÃ¡l i z jinÃ½ch oblastÃ­ vyobrazenÃ½ch na obrÃ¡zku 3.3, neÅ¾ pouze z oblasti nad mitrÃ¡lnÃ­ chlopnÃ­.
Aby bylo moÅ¾nÃ© detekovat S2 mezi dvÄ›ma S1, je nutnÃ© S1 patÅ™iÄnÄ› ohraniÄit. Doba trvÃ¡nÃ­ S1 je ze vÅ¡ech srdeÄnÃ­ch ozev nejdelÅ¡Ã­. PÅ™i ohraniÄenÃ­ S1 vychÃ¡zÃ­me z fyziologickÃ© doby trvÃ¡nÃ­ tÃ©to ozvy, jeÅ¾ mÅ¯Å¾e nabÃ½vat aÅ¾ 150 ms. Na zÃ¡kladÄ› tÄ›chto informacÃ­ je pÅ™ed a za vrcholem S1 definovÃ¡na hranice ve vzdÃ¡lenosti 75 ms od vrcholu. V oblasti za hranicÃ­ za S1, korespondujÃ­cÃ­ s S2, a pÅ™ednÃ­ hranicÃ­ nÃ¡sledujÃ­cÃ­ S1, je nalezena S2 jako maximum v tÃ©to oblasti.[30]

NormalizovanÃ¡ amplituda [-]

PPG signÃ¡l 1

0.5

0

-0.5

-1

0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

FKG signÃ¡l 1

0.5

0

-0.5

-1

0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

FKG obÃ¡lka 1

0.5

0

0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

Obr. 5.3: Detekce zÃ¡jmovÃ½ch bodÅ¯ v PPG a FKG signÃ¡lu (zelenÃ© body). ÄŒervenÃ© ohraniÄenÃ­ v FKG signÃ¡lu a obÃ¡lce FKG signÃ¡lu znaÄÃ­ S1.

68

KorektnÄ› provedenÃ¡ detekce zÃ¡jmovÃ½ch bodÅ¯ je vyobrazena na obrÃ¡zku 5.3. Po detekci zÃ¡jmovÃ½ch bodÅ¯ jiÅ¾ lze bez vÄ›tÅ¡Ã­ch obtÃ­Å¾Ã­ch stanovit hodnotu systolickÃ©ho a diastolickÃ©ho tlaku dle postupu uvedenÃ©ho v sekci 3.3. UkÃ¡zka stanovenÃ­ hodnoty krevnÃ­ho tlaku je uvedena ve vÃ½pisu 5.2.
1 % VÃ½poÄet tepovÃ© frekvence 2 HR = ((length(ppgPeaks)+1) * 60) / (signalTo -signalFrom); 3 4 % VÃ½poÄet PTT 5 PTT = ((peaks - S1) / audioSampleRate) * 1000; 6 7 % VÃ½poÄet systolickÃ©ho tlaku 8 Ps = -0.425 * PTT + q; 9 10 % V Ã½ po Ä et doby vypuzovac Ã­ f Ã¡ ze srde Ä n Ã­ ho cyklu 11 ET = (( S2 - S1 ) / a ud i oS am pl e Ra te ) * 1000; 12 13 % V Ã½ po Ä et povrchu t Ä› la 14 BSA = 0.007184 * user . weight ^(0.425) * user . height ^(0.725) ; 15 16 % V Ã½ po Ä et systolick Ã© ho objemu 17 SV = -6.6+ 0.25 * ( ET - 35) - 0.62 * HR + 40.4 * BSA - 0.51 * user . age ; 18 19 % V Ã½ po Ä et pulsov Ã© ho tlaku 20 Pp = SV ./ ((0.013 * user . weight -0.007 * user . age - 0.004 * HR ) + 1.307) ; 21 22 % V Ã½ po Ä et diastolick Ã© ho tlaku 23 Pd = Ps - Pp ;
VÃ½pis 5.2: VÃ½poÄet hodnoty krevnÃ­ho tlaku
69

6 VyhodnocenÃ­ dat

I pÅ™es to, Å¾e aplikace, vytvoÅ™enÃ¡ speciÃ¡lnÄ› pro akvizici dat, signifikantnÄ› zvÃ½Å¡ila ÃºspÄ›Å¡nost zÃ­skÃ¡vÃ¡nÃ­ zÃ¡znamÅ¯ z chytrÃ©ho telefonu, bylo zÃ­skÃ¡no pouze 15 relevantnÃ­ch zÃ¡znamÅ¯ od ÄtyÅ™ uÅ¾ivatelÅ¯. VÃ­ce neÅ¾ 85 % zÃ¡znamÅ¯ bylo odstranÄ›no z dÅ¯vodu nedokonalÃ© synchronizace, na kterou je tato metoda pÅ™Ã­liÅ¡ citlivÃ¡. Informace o mÄ›Å™enÃ½ch uÅ¾ivatelÃ­ch jsou uvedeny v tabulce 6.1.

Tab. 6.1: Informace o vyÅ¡etÅ™ovanÃ½ch uÅ¾ivatelÃ­ch

UÅ¾ivatel Ä. Hmotnost [kg] VÃ½Å¡ka [cm] VÄ›k BSA [í µí±š2]

1

94

179

24

2,13

2

87

182

24

2,09

3

93

171

24

2,05

4

83

168

24

1,93

KaÅ¾dÃ½ uÅ¾ivatel podstoupil nÄ›kolik mÄ›Å™enÃ­. VÃ½sledky tÄ›chto mÄ›Å™enÃ­ jsou uvedeny v tabulce 6.2. PÅ™i kaÅ¾dÃ©m mÄ›Å™enÃ­ byla zaznamenÃ¡na i referenÄnÃ­ hodnota krevnÃ­ho tlaku pomocÃ­ auskulataÄnÃ­ metody.

Tab. 6.2: VÃ½sledky jednotlivÃ½ch mÄ›Å™enÃ­

UÅ¾ivatel Ä.
1 1 1 1 1 1 2 2 2 2 3 3 3 4 4

í µí±í µí±†í µí±Ÿí µí±’í µí±“ [mmHg] 144 144 146 144 140 132 122 120 124 122 142 140 144 112 120

í µí±í µí±† [mmHg]
140 149 145 143 141 134 119 130 131 116 135 140 159 106 111

í µí±í µí°·í µí±Ÿí µí±’í µí±“ [mmHg] 88 88 90 88 88 80 70 72 72 72 92 90 90 68 70

í µí±í µí°· [mmHg]
95 115 105 106 106 95 78 89 89 71 95 98 116 69 72

PÅ™Ã­ vÃ½poÄtu hodnoty krevnÃ­ho tlaku, pomocÃ­ metody Å¡Ã­Å™enÃ­ pulsnÃ­ vlny, nedostÃ¡vÃ¡me pouze jedinou hodnotu. Hodnota systolickÃ©ho i diastolickÃ©ho tlaku je vypoÄ-

70

tena pÅ™i kaÅ¾dÃ©m srdeÄnÃ­m cyklu. VÃ½slednÃ½, vypoÄÃ­tanÃ½, tlak uvedenÃ½ v tabulce 6.2 je tedy mediÃ¡n vÅ¡ech namÄ›Å™enÃ½ch hodnot v rÃ¡mci jednoho zÃ¡znamu.
Na hladinÄ› vÃ½znamnosti í µí»¼ = 0, 01 jsme otestovali, zdali se hodnoty namÄ›Å™enÃ© auskultaÄnÃ­ metodou vÃ½raznÄ› liÅ¡Ã­ (í µí°»1) od hodnot vypoÄÃ­tanÃ½ch Äi nikoliv (í µí°»0). JelikoÅ¾ se jednÃ¡ o pÃ¡rovÃ¡ data, byl pouÅ¾it StudentÅ¯v pÃ¡rovÃ½ t-test.
VÃ½slednÃ¡ p hodnota pÃ¡rovÃ©ho t-testu pro hodnoty diastolickÃ©ho tlaku je 0, 00006627. JelikoÅ¾ je p hodnota podstatnÄ› menÅ¡Ã­ neÅ¾ 0, 01 zamÃ­tÃ¡me í µí°»0 a pÅ™ijÃ­mÃ¡me í µí°»1. Hodnoty diastolickÃ©ho tlaku namÄ›Å™enÃ© auskulataÄnÃ­ metodou se statisticky vÃ½raznÄ› liÅ¡Ã­ od hodnot vypoÄÃ­tanÃ½ch.
VÃ½slednÃ¡ p hodnota pÃ¡rovÃ©ho t-testu pro hodnoty systolickÃ©ho tlaku je 0, 88399358. JelikoÅ¾ je p hodnota podstatnÄ› vÄ›tÅ¡Ã­ neÅ¾ 0, 01 pÅ™ijÃ­mÃ¡me í µí°»0 a zamÃ­tÃ¡me í µí°»1. Hodnoty systolickÃ©ho tlaku namÄ›Å™enÃ© auskulataÄnÃ­ metodou se statisticky neliÅ¡Ã­ od hodnot vypoÄÃ­tanÃ½ch. VÃ½sledek pÃ¡rovÃ©ho t-testu pro hodnoty systolickÃ©ho tlaku je taktÃ©Å¾ podpoÅ™en korelaÄnÃ­m koeficientem o hodnotÄ› 0,9067.
Obr. 6.1: KorelaÄnÃ­ diagram mezi í µí±í µí±†í µí±Ÿí µí±’í µí±“ a í µí±í µí±†
71

7 ZÃ¡vÄ›r
V ÃºvodnÃ­ ÄÃ¡sti prÃ¡ce je definovÃ¡n pojem krevnÃ­ tlak. Je popsÃ¡n jeho vznik a vztah k obÄ›hovÃ© soustavÄ›. DÃ¡le jsou uvedeny fyziologickÃ© hodnoty krevnÃ­ho tlaku a jejich rozsah. Velmi podrobnÄ› jsou rozebrÃ¡ny metody neinvazivnÃ­ho mÄ›Å™enÃ­ krevnÃ­ho tlaku.
DalÅ¡Ã­ kapitola je reÅ¡erÅ¡e zamÄ›Å™enÃ¡ na operaÄnÃ­ systÃ©m Android. SeznÃ¡menÃ­ se s tÃ­mto operaÄnÃ­m systÃ©mem a vÃ½vojem aplikacÃ­ je velmi dÅ¯leÅ¾itÃ© pro vytvoÅ™enÃ­ vlastnÃ­ aplikace urÄenÃ© k akvizici dat pro vÃ½poÄet hodnoty krevnÃ­ho tlaku. V rÃ¡mci tÃ©to kapitoly je takÃ© popsÃ¡na historie vÃ½voje, jednotlivÃ© verze, architektura a vÃ½vojovÃ¡ prostÅ™edÃ­.
V tÅ™etÃ­ kapitole jsou rozebrÃ¡ny novÃ© zpÅ¯soby mÄ›Å™enÃ­ krevnÃ­ho tlaku, zejmÃ©na pomocÃ­ senzorÅ¯ chytrÃ©ho telefonu. JednÃ¡ se pÅ™edevÅ¡Ã­m o experimentÃ¡lnÃ­ metody, kterÃ© nejsou v bÄ›Å¾nÃ© praxi prozatÃ­m vyuÅ¾Ã­vÃ¡ny. HlavnÃ­ metodou tÃ©to kapitoly je metoda vÃ½poÄtu hodnoty krevnÃ­ho tlaku na zÃ¡kladÄ› vÃ½poÄtu doby pÅ™enosu pulsu (PTT) mezi dvÄ›ma mÃ­sty v arteriÃ¡lnÃ­m Å™eÄiÅ¡ti. Toho je docÃ­leno snÃ­mÃ¡nÃ­m prvnÃ­ho mÃ­sta pomocÃ­ mikrofonu a druhÃ©ho pomocÃ­ fotoaparÃ¡tu s pÅ™isvÄ›tloacÃ­ diodou. PrvnÃ­ mÃ­sto nÃ¡leÅ¾Ã­ oblasti srdce a jeho snÃ­mÃ¡nÃ­m tedy zÃ­skÃ¡vÃ¡me FKG signÃ¡l. DruhÃ½m mÃ­stem je koneÄek prstu, jenÅ¾ je prosvÄ›covÃ¡n pomocÃ­ LED. ÄŒÃ¡st emitovanÃ©ho svÄ›tla je rozptÃ½lena, ÄÃ¡st odraÅ¾ena a ÄÃ¡st absorbovÃ¡na Å¾ivou tkÃ¡nÃ­. DÃ­ky tomu je moÅ¾nÃ© zachytit prÅ¯chod pulsnÃ­ vlny koneÄkem prstu na zÃ¡kladÄ› zmÄ›ny intenzity svÄ›tla dopadajÃ­cÃ­ho na snÃ­maÄ fotoaparÃ¡tu. TÃ­m je zÃ­skÃ¡n PPG signÃ¡l. OvÅ¡em snÃ­mÃ¡nÃ­ tÄ›chto signÃ¡lÅ¯ bez zpÄ›tnÃ© vazby je znaÄnÄ› nÃ¡roÄnÃ©.
Z dÅ¯vodu problematickÃ©ho snÃ­mÃ¡nÃ­ PPG a FKG signÃ¡l byla vytvoÅ™ena aplikace na platformÄ› Android. PrimÃ¡rnÃ­ ÃºÄele tÃ©to aplikace je poskytnout uÅ¾ivateli zpÄ›tnou vazbu o zaznamenÃ¡vanÃ½ch signÃ¡lech. ZpÄ›tnÃ¡ vazba PPG signÃ¡lu je vyobrazena jako graf na displeji telefonu. ZpÄ›tnÃ¡ vazba FKG signÃ¡lu je v audio-vizuÃ¡lnÃ­ podobÄ›. UÅ¾ivateli je zobrazen graf na displeji telefonu a zÃ¡roveÅˆ jsou pÅ™ehrÃ¡vÃ¡ny zvuky srdeÄnÃ­ch ozev ve sluchÃ¡tkÃ¡ch pÅ™ipojenÃ½ch pÅ™es Bluetooth Äi audio konektor. DÃ­ky tomu uÅ¾ivatel umÃ­stÃ­ senzory na sprÃ¡vnÃ¡ mÃ­sta vhodnÃ¡ ke snÃ­mÃ¡nÃ­. Tato zpÄ›tnÃ¡ vazba signifikantnÄ› zvÃ½Å¡ila ÃºspÄ›Å¡nost akvizice dat. Aby bylo moÅ¾nÃ© tuto zpÄ›tnou vazbu poskytnou, je nutnÃ© snÃ­manÃ© signÃ¡ly zpracovat. Aplikace zaznamenÃ¡vÃ¡ zvukovÃ¡ a obrazovÃ¡ data, kterÃ¡ jsou po ukonÄenÃ­ akvizice k dispozici. ZÃ¡znamy zÃ­skanÃ© prostÅ™ednictvÃ­m tÃ©to aplikace jsou dÃ¡le zpracovÃ¡ny a vyhodnoceny v prostÅ™edÃ­ Matlab.
PÅ™i vÃ½voji aplikace se bohuÅ¾el objevily problÃ©my se synchronizacÃ­ signÃ¡lÅ¯, kterÃ© se nepodaÅ™ilo vyÅ™eÅ¡it do takovÃ© mÃ­ry, aby je bylo moÅ¾nÃ© zanedbat. PouÅ¾itÃ¡ metoda, pro stanovenÃ­ hodnoty krevnÃ­ho tlaku, je totiÅ¾ na tÃ©to synchronizaci znaÄnÄ› zÃ¡vislÃ¡. Odchylka vÄ›tÅ¡Ã­ neÅ¾ Â±50 ms zpÅ¯sobÃ­, Å¾e zdravÃ©mu uÅ¾ivateli bude diagnostikovÃ¡na hypertenze Äi hypotenze.
Zdrojem zpoÅ¾dÄ›nÃ­ se ukÃ¡zala bÃ½ti ÄasovÃ¡ nepÅ™esnost senzorÅ¯. U ÄasovÃ½ch znÃ¡mek,
72

kterÃ© jsou pouÅ¾itÃ© k synchronizaci je povolenÃ¡ odchylka 100 ms od ÄasovÃ© zÃ¡kladny, ke kterÃ© jsou pÅ™idruÅ¾eny. DÃ¡le je zde latence po spuÅ¡tÄ›nÃ­ senzoru, kterÃ¡ mÅ¯Å¾e nabÃ½vat vÃ­ce neÅ¾ 400 ms (rovnice 4.5). V neposlednÃ­ Å™adÄ› je zde tolerovanÃ© zpoÅ¾dÄ›nÃ­ 100 ms pÅ™i akvizici dat. VÅ¡echna vÃ½Å¡e uvedenÃ¡ zpoÅ¾dÄ›nÃ­ jsou variabilnÃ­ a proto je nelze korigovat.
VytvoÅ™enÃ­ synchronizaÄnÃ­ znaÄky, v obou signÃ¡lech, pomocÃ­ vnÄ›jÅ¡Ã­ho podmÄ›tu (poklepÃ¡nÃ­ na fotoaparÃ¡t - generuje zvuk i zmÄ›nu jasu) a jejÃ­ nÃ¡slednÃ¡ synchronizace se ukÃ¡zala jako nejvÃ­ce pÅ™esnÃ¡ (oproti vyzkouÅ¡enÃ½m metodÃ¡m), ale ne dostateÄnÄ› pro potÅ™eby algoritmu na vÃ½poÄet hodnoty krevnÃ­ho tlaku.
I pÅ™es tyto problÃ©my se ale podaÅ™ilo namÄ›Å™it alespoÅˆ 15 zÃ¡znamÅ¯ u ÄtyÅ™ech rÅ¯znÃ½ch osob, kterÃ© byly synchronizovÃ¡ny s dostateÄnou pÅ™esnostÃ­. Tyto zÃ¡znamy byly vyhodnoceny pomocÃ­ skriptu v prostÅ™edÃ­ Matlab, jehoÅ¾ vÃ½stupem je hodnota krevnÃ­ho tlaku. PÅ™i porovnÃ¡nÃ­ s referenÄnÃ­mi hodnotami, zÃ­skanÃ½mi pomocÃ­ auskulataÄnÃ­ metody, byla u hodnot systolickÃ©ho tlaku zjiÅ¡tÄ›na statisticky vÃ½znamnÃ¡ shoda. Hodnoty diastolickÃ©ho tlaku se naopak od referenÄnÃ­ch statistiky vÃ½raznÄ› liÅ¡Ã­.
73

Literatura
[1] ALLEN, Grant. Android 4: prÅ¯vodce programovÃ¡nÃ­m mobilnÃ­ch aplikacÃ­. Brno: Computer Press, 2013. ISBN 978-80-251-3782-6.
[2] Android Compatibility Definition Document. Android Open Source Project [online]. 2017 [cit. 2018-05-10]. DostupnÃ© z: <https://source.android.com/com patibility/cdd>.
[3] Android hardware camera2. Android Developers [online]. 2018 [cit. 2018-0501]. DostupnÃ© z: <developer.android.com/reference/android/hardware/c amera2/package-summary>.
[4] Android, the worldâ€™s most popular mobile platform. Android Developers [online]. [cit. 2017-11-22]. DostupnÃ© z: <https://developer.android.com/abou t/android.html>.
[5] Android Studio. ZdrojÃ¡k [online]. 2013 [cit. 2017-11-27]. DostupnÃ© z: <https:// www.zdrojak.cz/clanky/android-studio-nove-vyvojove-prostredi/>.
[6] Android HdrViewfinder Sample. GitHub - Google Samples [online]. 2018 [cit. 2018-05-11]. DostupnÃ© z: <https://github.com/googlesamples/android-H drViewfinder>.
[7] An Introduction to Renderscript. Microsoft Docs [online]. 2018 [cit. 2018-0511]. DostupnÃ© z: <https://docs.microsoft.com/en-us/xamarin/android/p latform/renderscript>.
[8] Application Fundamentals. Android Developers [online]. 2017 [cit. 2017-1127]. DostupnÃ© z: <https://developer.android.com/guide/components/fun damentals.html>.
[9] AudioDeviceInfo. Android Developers [online]. 2018 [cit. 2018-05-10]. DostupnÃ© z: <https://developer.android.com/reference/android/media/ AudioDeviceInfo>.
[10] AudioFormat. Android Developers [online]. 2018 [cit. 2018-05-14]. DostupnÃ© z: <https://developer.android.com/reference/android/media/ AudioFormat>.
[11] AudioManager. Android Developers [online]. 2018 [cit. 2018-05-10]. DostupnÃ© z: <https://developer.android.com/reference/android/media/ AudioManager>.
74

[12] AudioRecord. Android Developers [online]. 2018 [cit. 2018-05-10]. DostupnÃ© z: <https://developer.android.com/reference/android/media/ AudioRecord>.
[13] AudioTrack. Android Developers [online]. 2018 [cit. 2018-05-10]. DostupnÃ© z: <https://developer.android.com/reference/android/media/ AudioTrack.html>.
[14] Better performance through threading. Android Developers [online]. 2018 [cit. 2018-04-30]. DostupnÃ© z: <https://developer.android.com/topic/perfor mance/threads>.
[15] Bitmap. Android Developers [online]. 2018 [cit. 2018-05-05]. DostupnÃ© z: <ht tps://developer.android.com/reference/android/graphics/Bitmap>.
[16] CameraCaptureSessionStateCallback. Android Developers [online]. 2018 [cit. 2018-05-01]. DostupnÃ© z: <developer.android.com/reference/android/ha rdware/camera2/CameraCaptureSession.StateCallback>.
[17] CameraDevice. Android Developers [online]. 2018 [cit. 2018-05-01]. DostupnÃ© z: <developer.android.com/reference/android/hardware/camera2/Came raDevice>.
[18] CameraDeviceStateCallback. Android Developers [online]. 2018 [cit. 2018-0501]. DostupnÃ© z: <developer.android.com/reference/android/hardware/c amera2/CameraDevice.StateCallback>.
[19] CameraCharacteristics. Android Developers [online]. 2018 [cit. 2018-05-01]. DostupnÃ© z: <developer.android.com/reference/android/hardware/cam era2/CameraCharacteristics>.
[20] CameraManager. Android Developers [online]. 2018 [cit. 2018-05-01]. DostupnÃ© z: <developer.android.com/reference/android/hardware/camera2/Came raManager>.
[21] CaptureRequest. Android Developers [online]. 2018 [cit. 2018-05-03]. DostupnÃ© z: <https://developer.android.com/reference/android/hardwa re/camera2/CaptureRequest>.
[22] CaptureRequest.Builder. Android Developers [online]. 2018 [cit. 2018-05-03]. DostupnÃ© z: <https://developer.android.com/reference/android/hard ware/camera2/CaptureRequest.Builder>.
75

[23] Color. Android Developers [online]. 2018 [cit. 2018-05-05]. DostupnÃ© z: <https: //developer.android.com/reference/android/graphics/Color>.
[24] Dashboards. Android Develoers [online]. 2017 [cit. 2017-11-22]. DostupnÃ© z: <ht tps://developer.android.com/about/dashboards/index.html>.
[25] Detecting camera features with Camera2. Google developers - Medium [online]. 2016 [cit. 2018-05-01]. DostupnÃ© z: <medium.com/google-developers/detec ting-camera-features-with-camera2-61675bb7d1bf>.
[26] DIAS JUNIOR, A., S. MURALI, F. RINCON a D. ATIENZA. Methods for reliable estimation of pulse transit time and blood pressure variations using smartphone sensors. Microprocessors and Microsystems. 2016, 46, 84-95. ISSN 01419331.
[27] FABIÃN, Vratislav. NeinvazivnÃ­ mÄ›Å™enÃ­ krevnÃ­ho tlaku: ZaloÅ¾enÃ© na oscilometrickÃ©m principu. Praha, 2012. DisertaÄnÃ­ prÃ¡ce. ÄŒeskÃ© vysokÃ© uÄenÃ­ technickÃ© v Praze.
[28] FOO, Jong Yong Abdiel, Chu Sing LIM a Ping WANG. Evaluation of blood pressure changes using vascular transit time. Physiological Measurement [online]. 2006, 27(8), 685-694 [cit. 2017-12-28]. DOI: 10.1088/0967-3334/27/8/003. ISSN 0967-3334. DostupnÃ© z: <http://stacks.iop.org/0967-3334/27/i=8/ a=003?key=crossref.c2de29a3f7d7f06b3b3393f81756f7cd>.
[29] FONTANA, Josef et al. Funkce bunÄ›k a lidskÃ©ho tÄ›la [online]. MultimediÃ¡lnÃ­ skripta. 2015 [cit. 2017-12-31]. <DostupnÃ©z:http://fblt.cz/>.
[30] GANONG, William F. PÅ™ehled lÃ©kaÅ™skÃ© fysiologie. JinoÄany: H & H, 1995. ISBN 80-85787-36-9.
[31] GESCHE, Heiko, Detlef GROSSKURTH, Gert KÃœCHLER a Andreas PATZAK. Continuous blood pressure measurement by using the pulse transit time: comparison to a cuff-based method. European Journal of Applied Physiology [online]. 2012, 112(1), 309-315 [cit. 2017-12-28]. DOI: 10.1007/s00421011-1983-3. ISSN 1439-6319. DostupnÃ© z: <http://link.springer.com/10. 1007/s00421-011-1983-3>.
[32] How to get and set pixel value in Java. DYclassroom [online]. c2014-2018 [cit. 2018-05-05]. DostupnÃ© z: <https://www.dyclassroom.com/image-processi ng-project/how-to-get-and-set-pixel-value-in-java>.
76

[33] CHANDRASEKARAN, V., R. DANTU, S. JONNADA, S. THIYAGARAJA a K. P. SUBBU. Cuffless Differential Blood Pressure Estimation Using Smart Phones. IEEE Transactions on Biomedical Engineering. 2013, 60(4), 1080-1089. ISSN 0018-9294.
[34] CHMELAÅ˜, Milan. LÃ©kaÅ™skÃ¡ pÅ™Ã­strojovÃ¡ technika I. Brno: AkademickÃ© nakladatelstvÃ­ CERM, 1995. UÄebnÃ­ texty vysokÃ½ch Å¡kol. ISBN 80-85867-63-X.
[35] Chroma Subsampling. Rtings [online]. 2017 [cit. 2018-05-06]. DostupnÃ© z: <ht tps://www.rtings.com/tv/learn/chroma-subsampling>.
[36] ImageFormat. Android Developers [online]. 2018 [cit. 2018-05-05]. DostupnÃ© z: <https://developer.android.com/reference/android/graphi cs/ImageFormat>.
[37] ImageReader. Android Developers [online]. 2018 [cit. 2018-05-01]. DostupnÃ© z: <developer.android.com/reference/android/media/ImageReader>.
[38] iPhone Microphone Frequency Response Comparison. Faber Acoustical [online]. 2009 [cit. 2018-01-02]. DostupnÃ© z: <https://blog.faberacoustical.com /2009/ios/iphone/iphone-microphone-frequency-response-comparis on>.
[39] Jak Å¡el Äas s operaÄnÃ­m systÃ©mem android. Android Tip [online]. 2015 [cit. 201711-22]. DostupnÃ© z: <http://www.androidtip.cz/jak-sel-cas-s-operacni m-systemem-android/>.
[40] JUNIOR, Alair Dias, Srinivasan MURALI, Francisco RINCON a David ATIENZA. Estimation of Blood Pressure and Pulse Transit Time Using Your Smartphone. In: 2015 Euromicro Conference on Digital System Design [online]. IEEE, 2015, 2015, s. 173-180 [cit. 2018-05-18]. DOI: 10.1109/DSD.2015.90. ISBN 978-1-4673-8035-5. DostupnÃ© z: <http://ieeexplore.ieee.org/docu ment/7302267/>.
[41] KOLÃÅ˜, Radim. LÃ©kaÅ™skÃ¡ diagnostickÃ¡ technika. Brno, 2006. ElektronickÃ¡ skripta. VUT Brno.
[42] KrevnÃ­ tlak dle vÄ›ku. TlakomÄ›ry [online]. [cit. 2017-12-23]. DostupnÃ© z: <https://www.tlakomery.cz/krevni-tlak-dle-veku-jake-jsou-opti malni-hodnoty>.
[43] LACKO, Ä½uboslav. VÃ½voj aplikacÃ­ pro Android. Brno: Computer Press, 2015. ISBN 978-80-251-4347-6.
77

[44] MediaRecorder. Android Developers [online]. 2018 [cit. 2018-05-01]. DostupnÃ© z: <developer.android.com/reference/android/media/MediaRecorder>.
[45] Meet Android Studio. Android Developers [online]. 2017 [cit. 2017-11-27]. DostupnÃ© z: <https://developer.android.com/studio/intro/index.html>.
[46] NÄšMCOVÃ, Helena. MÄ›Å™enÃ­ krevnÃ­ho tlaku. MedicÃ­na pro praxi [online]. 2007, (1), 7-12 [cit. 2017-12-29]. <DostupnÃ©z:https://www.medicinapropraxi.cz/ pdfs/med/2007/01/02.pdf>.
[47] Pulse-code modulation. In: Wikipedia: the free encyclopedia [online]. San Francisco (CA): Wikimedia Foundation, 2018 [cit. 2018-05-15]. DostupnÃ© z: <https: //en.wikipedia.org/wiki/Pulse-code_modulation>.
[48] Renderscript Computation. Android Developers [online]. 2016 [cit. 2018-0511]. DostupnÃ© z: <https://stuff.mit.edu/afs/sipb/project/android/doc s/guide/topics/renderscript/compute.html>.
[49] RenderScript Overview. Android Developers [online]. 2018 [cit. 2018-05-01]. DostupnÃ© z: <developer.android.com/guide/topics/renderscript/comp ute>.
[50] ROKYTA, Richard. Fyziologie pro bakalÃ¡Å™skÃ¡ studia v medicÃ­nÄ›, pÅ™Ã­rodovÄ›dnÃ½ch a tÄ›lovÃ½chovnÃ½ch oborech. Praha: ISV, 2000. LÃ©kaÅ™stvÃ­. ISBN 80-858-6645-5.
[51] Samsung Galaxy S7. GSMArena [online]. c2000-2018 [cit. 2018-05-19]. DostupnÃ© z: <https://www.gsmarena.com/samsung_galaxy_s7-7821.php>.
[52] Surface. Android Developers [online]. 2018 [cit. 2018-05-01]. DostupnÃ© z: <de veloper.android.com/reference/android/view/Surface>.
[53] System. Android Developers [online]. 2018 [cit. 2018-05-15]. DostupnÃ© z: <ht tps://developer.android.com/reference/java/lang/System>.
[54] SystemClock. Android Developers [online]. 2018 [cit. 2018-05-15]. DostupnÃ© z: <https://developer.android.com/reference/android/os/Sys temClock.html>.
[55] The Activity Lifecycle. Android Developers [online]. 2017 [cit. 2017-11-27]. DostupnÃ© z: <https://developer.android.com/guide/components/activ ities/activity-lifecycle.html>.
[56] TROJAN, Stanislav. LÃ©kaÅ™skÃ¡ fyziologie. Vyd. 4., pÅ™eprac. a dopl. Praha: Grada, 2003. ISBN 80-247-0512-5.
78

Seznam symbolÅ¯, veliÄin a zkratek

ACD API CDD CPU DPS GPU GUI HW IDE NDK OOP PCG PCM PPG PTT SDK SW TK

AnalogovÄ› digitÃ¡lnÃ­ pÅ™evodnÃ­k - Analog-Digital Converter AplikaÄnÃ­ programovacÃ­ rozhranÃ­ - Application Programming Interface Dokument definice kompatibility - Compatibility Definition Document CentrÃ¡lnÃ­ procesorovÃ¡ jednotka - Central Processing Unit DigitÃ¡lnÃ­ signÃ¡lnÃ­ procesor - Digital Signal Processor GrafickÃ½ procesor - Graphic Processing Unit GrafickÃ© uÅ¾ivatelskÃ© rozhranÃ­ - Graphical User Interface TechnickÃ© vybavenÃ­ - Hardware IntegrovanÃ© vÃ½vojovÃ© prostÅ™edÃ­ - Integrated Development Environment NÃ¡stroje pro nativnÃ­ vÃ½voj v jazyce C Äi C++ - Native Development Kit ObjektovÄ› orientovanÃ© programovÃ¡nÃ­ - Object-Oriented Programming Fonokardiograf - Phonocardiogram PulznÄ› kÃ³dovÃ¡ modulace - Pulse Code Modulation Fotopletysmograf - Photopletysmograph ÄŒas pÅ™enosu pulzu - Pulse Transit Time NÃ¡stroje pro vÃ½voj software - Software Development Kit ProgramovÃ© vybavenÃ­ - Software Tlak krve, krevnÃ­ tlak

79

Obsah pÅ™iloÅ¾enÃ©ho CD
Na pÅ™iloÅ¾enÃ©m CD lze nalÃ©zt kÃ³dy vyvÃ­jenÃ© Android aplikace, skript na vÃ½poÄet hodnoty krevnÃ­ho tlaku v Matlabu a namÄ›Å™enÃ¡ data.
/ Android aplikace.........................nejdÅ¯leÅ¾itÄ›jÅ¡Ã­ zdrojovÃ© kÃ³dy aplikace java res rs bpdataacquisition.apk..................................instalaÄnÃ­ soubor Android projekt......................projekt vyexportovanÃ½ z Android Studia Matlab Data. ...................................................... namÄ›Å™enÃ¡ data NesynchronizovÃ¡no User01 User02 User03 User04 BloodPressureEstimation.m..............skript pro vÃ½poÄet krevnÃ­ho tlaku android-7.0-cdd.pdf. ................... dokument kompatibility pro verzi 7.0 DP-VaÅ™eÄka.pdf....................................................tato prÃ¡ce
80

