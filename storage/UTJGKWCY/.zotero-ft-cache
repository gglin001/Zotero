1

2 3

A novel application for the detection of an irregular pulse

4 5

using an iPhone 4S in patients with atrial ﬁbrillation

6
7 David D. McManus, MD,ScM,FACC,FHRS,*†y Jinseok Lee, PhD,‡ Oscar Maitas, MD,† Nada Esa, MD,* 8 Rahul Pidikiti, MD,* Alex Carlucci, BS,* Josephine Harrington, BS,* Eric Mick, PhD,† Ki H. Chon, PhDy

9 10 From the *Cardiac Electrophysiology Section, Cardiovascular Medicine Division, Department of Medicine, 11 University of Massachusetts Medical School, Worcester, Massachusetts, yDepartment of Quantitative Health Sciences, 12 University of Massachusetts Medical School, Worcester, Massachusetts, zDepartment of Biomedical Engineering, Wonkwang 13 University School of Medicine, Iksan, Jeonbuk, Korea and yDepartment of Biomedical Engineering, Worcester Polytechnic 14 Institute, Worcester, Massachusetts.

15

16 BACKGROUND Atrial ﬁbrillation (AF) is common and associated 17 with adverse health outcomes. Timely detection of AF can be 18 challenging using traditional diagnostic tools. Smartphone use is 19 increasing and may provide an inexpensive and user-friendly means

including heart rate and blood pressure (beta coefﬁcients per SD
increment in RMSDD/mean and ShE were À0.20 and À0.35; P o .001). An algorithm combining the 2 statistical methods demonstrated excellent sensitivity (0.962), speciﬁcity (0.975),

20 to diagnose AF.

and accuracy (0.968) for beat-to-beat discrimination of an

21

22

OBJECTIVE To test the hypothesis that a smartphone-based application could detect an irregular pulse from AF.

23

24 METHODS Seventy-six adults with persistent AF were consented for

25 participation in our study. We obtained pulsatile time series recordings

26 before and after cardioversion using an iPhone 4S camera. A novel

27 smartphone application conducted real-time pulse analysis using 2

28 29

statistical methods: root mean square of successive RR difference (RMSSD/mean) and Shannon entropy (ShE). We examined the sensitivity, speciﬁcity, and predictive accuracy of both algorithms

30 using the 12-lead electrocardiogram as the gold standard.

31

32 RESULTS RMSDD/mean and ShE were higher in participants in AF 33 than in those with sinus rhythm. The 2 methods were inversely 34 related to AF in regression models adjusting for key factors

irregular pulse during AF from sinus rhythm.
CONCLUSIONS In a prospectively recruited cohort of 76 participants undergoing cardioversion for AF, we found that a novel algorithm analyzing signals recorded using an iPhone 4S accurately distinguished pulse recordings during AF from sinus rhythm. Data are needed to explore the performance and acceptability of smartphone-based applications for AF detection.
KEYWORDS: Atrial ﬁbrillation; Smartphone; Detection; Technology
ABBREVIATIONS: AF ¼ atrial ﬁbrillation; ECG ¼ electrocardiogram; NSR ¼ normal sinus rhythm; RMSSD ¼ root mean square of successive RR difference; ShE ¼ Shannon entropy
(Heart Rhythm 2013;0:1–5) I 2013 Elsevier Inc. All rights reserved.

35

36

37

38 Introduction

39 Atrial ﬁbrillation (AF) is the most commonly diagnosed 40 dysrhythmia, affecting approximately 3 million Americans.1,2 41 AF negatively affects quality of life and survival, placing 42 those with dysrhythmia at an increased risk for stroke and 43 heart failure.3,4 Although the 12-lead electrocardiogram 44 (ECG) remains the gold-standard diagnostic test for AF,5 a 45 major challenge in the diagnosis of this arrhythmia is its 46

47

This work was funded in part by the Ofﬁce of Naval Research work unit

48 N00014-12-1-0171. Dr McManus’s time was funded by National Institutes

49 of Health through grants 1U01HL105268-01 and KL2RR031981.

50 Dr McManus, Dr Lee, and Dr Chon have ownership stake in DxMe, Inc.

51 Dr Chon has a patent on the algorithm described in the article. Address

52

reprint requests and correspondence: Dr David D. McManus, Cardiology Division, University of Massachusetts Medical School, Worcester, MA

53 01655. E-mail address: mcmanusd@ummhc.org.

54

The ﬁrst 2 authors contributed equally to this article.

55

56

57 paroxysmal nature, particularly in its early stages.6 Recent 58

studies have shown that more frequent monitoring can 59 improve AF detection,7 but contemporary monitoring tech- 60

nologies used for AF detection in clinical practice are costly 61

and sometimes burdensome. Given these difﬁculties, a recent 62

National Health, Heart, Lung, and Blood Institute expert panel 63

has emphasized the pressing need to develop new methods 64

for accurate AF detection and monitoring.8

65

On the basis of previously published data from our 66 laboratory and elsewhere,9–11 we hypothesized that an 67

irregular pulse could be identiﬁed using recordings from an 68

iPhone 4S camera combined with an accurate and real-time 69 realizable AF detection algorithm.12 In this original investi- 70

gation, we report the beat-to-beat and overall detection 71

capabilities of our novel algorithm running on an iPhone 72

4S in a prospectively recruited cohort of patients with 73

persistent AF.

1547-5271/$-see front matter B 2013 Elsevier Inc. All rights reserved.

http://dx.doi.org/10.1016/j.hrthm.2012.12.001

2

Heart Rhythm, Vol 0, No 0, Month 2013

Figure 1 A prototype of the pulse waveform analysis application running on an iPhone 4S. From left to right: iPhone 4S camera; ﬁngertip applied to iPhone 4S camera; a representative recording from a patient in atrial ﬁbrillation; a representative recording from a patient in normal sinus rhythm.

Methods Study sample
Seventy-six adults with AF were identiﬁed from a roster of patients scheduled to undergo elective cardioversion for AF at the University of Massachusetts Medical Center’s Cardiac Electrophysiology Laboratory. After obtaining informed consent, baseline clinical, demographic, laboratory, and electrophysiologic variables, as well as postprocedure heart rate and blood pressure, were abstracted from participants’ medical records by trained study staff. Subjects with AF on their preprocedure 12-lead ECG placed an iPhone 4S camera directly on their right index or second ﬁnger for 2 minutes while the AF detection application was run. After cardioversion, participants who were successfully converted to normal sinus rhythm (NSR) (based on postprocedure 12-lead ECG or telemetry recordings) had the iPhone 4S reapplied to their right index or second ﬁnger. Pulse signal recordings were obtained with patients while they were in a supine position and breathing spontaneously. Trained physicians reviewed all 12-lead ECG or telemetry data to determine heart rhythm using standard criteria.5 In cases where reviewers disagreed about the electrocardiographic diagnosis, a third reader was consulted. This study was approved by the institutional review boards of the University of Massachusetts Medical School and Worcester Polytechnic Institute.
Signal processing Our application acquired pulsatile signals by illuminating the ﬁngertip using the standard iPhone lamp and recording video signal (30 frames/s) for 2 minutes (Figure 1). The signal was processed by averaging 50 Â 50 green band pixels per frame.12 We interpolated the pulsatile signal to 30 Hz using a cubic spline algorithm followed by peak detection. As described in prior work, we use a peak detection algorithm that uses a ﬁlter bank with estimates of heart rate, variable cutoff frequencies, rank-order nonlinear ﬁlters, and decision logic as well as motion noise correction.13 The time required for computational processing on the iPhone 4S was approximately 25 ms per 64-beat segment.
Approaches to pulse waveform analysis The rapid and disorganized electrical activity that characterizes AF generates a random sequence of heart beat intervals with increased beat-to-beat variability. Our

approach to irregular pulse detection combines 2 statistical

techniques to exploit these characteristics (Figure 2). A root

mean square of successive difference (RMSSD) of RR

intervals is used to quantify RR variability, and Shannon entropy (ShE) is used to characterize its complexity.14 In

order to adjust for the effect of heart rate on RR variability,

we normalized RMSSD to the mean RR time series value.

Normalized

RMSSD

¼

v u u tﬃﬃﬃ1ﬃﬃﬃﬃﬃﬃX ﬃlﬃÀﬃﬃ1ﬃﬃﬃ½ﬃﬃaﬃﬃðﬃﬃjﬃﬃþﬃﬃﬃﬃ1ﬃﬃÞﬃﬃÀﬃﬃﬃﬃaﬃﬃðﬃﬃjﬃÞﬃﬃﬃ2ﬃ lÀ1 j ¼ 1

Pl
j

1
¼1

aðjÞ

where l is the length of RR intervals and a(j) is the jth RR interval in the segment with length l, where j ¼ 1, 2, y, l. The normalized RMSSD is expected to be higher in a segment recorded from a patient with an irregular pulse due to AF since AF is associated with higher variability of

Figure 2 A ﬂowchart of the pulse waveform analysis algorithm. RMSSD/ mean ¼ root mean square of successive RR difference.

McManus et al Automated Detection of Atrial Fibrillation Using a Smartphone

3
Figure 3 Representative pulse recordings, RR intervals, and resultant statistical values, obtained using an iPhone 4S from a patient in atrial ﬁbrillation (A, C, E) and normal sinus rhythm (B, D, F). RMSSD/mean ¼ root mean square of successive RR difference; ShE ¼ Shannon entropy.

RR intervals than is NSR. ShE provides a quantitative measure of uncertainty for a random variable in the following:

SE

¼

À

XN
i¼1

pðiÞ

logðpÀðiÁÞÞ

log

1 N

;

NðiÞ pðiÞ ¼
l

where N is the number of bins and N(i) is the number of beats in the i-th bin. We used N ¼ 16, which provided the best accuracy.14,15 ShE provides a quantitative measure of uncertainty for a random variable.9 Speciﬁcally, ShE quantiﬁes the likelihood that runs of patterns exhibiting regularity over some duration of data also exhibit similar regular patterns over the next incremental duration of data. ShE is therefore expected to be higher in the setting of AF since patients with AF have pulses that exhibit greater RR interval irregularity when compared with pulse waveforms recorded from patients in NSR.
Based on the 2 statistical techniques, the classiﬁcation of the RR interval segment of length l ¼ 64 is given by a simple logical AND condition in the following:

IfðNormalized RMSSD 4 THRMSDDÞ AND ðShE 4 THShEÞ; then classify the segment as IRREGULAR;

else classify the statement as REGULAR:

where THRMSSD and THShE are the threshold values of RMSSD/mean and ShE, respectively (Figure 3).

To derive threshold values of RMSSD/mean and ShE, we used the MIT-BIH AF and MIT-BIH NSR databases.14 The MIT-BIH AF database contains approximately 500,000 AF beats, and the number of NSR is approximately 700,000 and 1,700,000 beats from MIT-BIH AF and MIT-BIH NSR databases, respectively. We downsampled the MIT-BIH AF and NSR RR time series to 30 Hz to match the sampling rate of an iPhone 4S. Each ECG recording is approximately 10 hours in duration. The MIT-BIH NSR database contains 18 ECG recordings, and the duration of each ECG data is approximately 24 hours. We found the threshold values of 0.115 for RMSSD/ mean and 0.55 for ShE, as these values corresponded to the largest area under receiver operating characteristic curves.14
Data analysis We compared the characteristics of participants by AF status (precardioversion AF and postcardioversion NSR) using analysis of variance or relevant nonparametric test for continuous variables and w2 tests for categorical variables. We calculated the test characteristics for the automated smartphone-based AF detection algorithms (RMSSD/mean and ShE) individually and in combination when compared with the expert reviewer diagnosis (criterion standard) of NSR and AF based on 12-lead ECG, using 0.115 and 0.55 as the threshold values of RMSSD/mean and ShE, respectively.

4

Table 1 Baseline characteristics of the study sample

Baseline characteristics

Total (N ¼ 76)

Age (y) mean (SD) Male, n (%) White, n (%) Body mass index (kg/m2), mean (SD) Medical characteristics, n (%)
Hypertension Hyperlipidemia Current smoking Diabetes mellitus Coronary artery disease Congestive heart failure Sleep apnea Coronary artery bypass Prior cardioversion Stroke Treatment characteristics, n (%) Beta-blocker Calcium channel blocker Statin Antiarrhythmic drug
Class I Class III Digoxin Procedural characteristics, mean (SD) Number of shock Joules delivered, mean (SD)

65.3 (11.6) 59 (77) 73 (96)
31.0 (8.3)
54 (71) 47 (62)
6 (8) 21 (28) 22 (29) 16 (21) 12 (16)
8 (11) 20 (27)
9 (12)
47 (62) 15 (20) 42 (56) 19 (31)
5 (7) 18 (24)
4 (5)
1.1 (0.4) 226 (86)

Exact binomial 95% conﬁdence intervals were calculated for sensitivity, speciﬁcity, and accuracy for each method.
Since we were also interested in improving the detection algorithms by investigating clinical and demographic factors related to potential misclassiﬁcation, we conducted regression modeling to examine the relation between key factors such as age, sex, heart rate, systolic blood pressure, and betablocker and calcium-channel blocker use with the 2 algorithms used in our application, RMSSD/mean and ShE. All analyses were conducted using Stata 11.0 (StataCorp LP, College Station, TX).

Results
The baseline characteristics of the 76 participants with AF included in our prospective clinical investigation are shown in Table 1. The mean age of the cohort was 65 years of age,

Table 2 Clinical and pulse recording characteristics before and after electrical cardioversion (AF, no AF)

Mean (SD)

Clinical and pulse recording

characteristics

AF

No AF

P

Systolic blood pressure (mm Hg) 131 (18) 112 (18) o.001

Diastolic blood pressure

81 (14) 68 (12) o.001

(mm Hg) Heart rate (beats/min) Respiration rate (breaths/min) RMSSD/mean* Shannon entropy

91 (22) 70 (16) o.001

19 (3)

16 (4) o.001

0.29 (0.09) 0.08 (0.08) o.001

0.80 (0.09) 0.45 (0.13) o.001

AF ¼ atrial ﬁbrillation. *RMSSD/mean ¼ root mean square of successive RR difference.

Heart Rhythm, Vol 0, No 0, Month 2013

Table 3 Beta coefﬁcients for statistical approaches in relation to atrial ﬁbrillation

Pulse recording characteristics
RMSSD/mean† Shannon entropy

Adjusted beta coefﬁcient*
À0.20 À0.38

95% conﬁdence interval
À0.23 to À0.16 À0.43 to À0.33

*Adjusted for age, sex, heart rate, respiratory rate, systolic blood pressure, and receipt of beta-blocker and calcium channel blocker. †RMSSD/mean ¼ root mean square of successive RR difference.

and 35% were women. There was a high burden of cardiovascular morbidity at study entry in the cohort.
Participants in AF had signiﬁcantly higher heart rates, respiratory rates, and systolic and diastolic blood pressures before cardioversion than they did after their successful cardioversion (Table 2). RMSSD/mean and ShE values were signiﬁcantly higher when participants were in AF than they were in NSR. In multivariate regression models adjusting for age, sex, heart rate, systolic blood pressure, respiratory rate, and receipt of beta or calcium-channel blockers, RMSSD/mean and ShE values remained associated with the presence of AF (Table 3).
Using the established threshold values of 0.115 for RMSSD/mean and 0.55 for ShE,14 we observed that RMSDD/mean, ShE, and the combination of RMSSD/mean and ShE exhibited excellent sensitivity, speciﬁcity, and diagnostic accuracy for the beat-to-beat detection of an irregular pulse in patients with AF (Table 4) when compared to the gold-standard diagnosis of AF by 12-lead ECG. A 2-step algorithm requiring that both threshold values of RMSDD/mean and ShE be exceeded had the best speciﬁcity and diagnostic accuracy. The algorithm combining RMSDD/ mean and ShE was 100% and 96.05% accurate for identifying (as irregular or regular) pulse recordings obtained from participants in AF and NSR, respectively.

Discussion
Several prior investigations have described the use of a smartphone to detect an irregular pulse during AF.9,11,14,16,17 In contradistinction to previously described systems, our application does not require additional hardware, instead rely on the iPhone 4S camera and lamp to obtain pulse recordings, and is not bedeviled by motion and noise artifacts.15–19 Two prior investigations from our group introduced the concept of using a camera to extract RR intervals and established threshold values for RMSDD/mean and ShE in a developmental cohort.9,11 In this larger clinical study involving a distinct and

Table 4 Test characteristics* for the detection of an irregular pulse in a sample of 76 patients with atrial ﬁbrillation

Algorithm

Sensitivity Speciﬁcity Accuracy

RMSSD/mean Shannon entropy RMSSD/mean þ Shannon
entropy

0.9818 0.9750 0.9619

0.9150 0.8218 0.9752

0.9533 0.9097 0.9676

*Test characteristics of statistical methods established using the threshold values of RMSSD/mean ¼ 0.115 and Shannon entropy ¼ 0.55. RMSSD ¼ root mean square of successive RR difference.

McManus et al Automated Detection of Atrial Fibrillation Using a Smartphone

5

better phenotyped cohort with AF, we report the sensitivity, speciﬁcity, and accuracy of a novel 2-phase real-time algorithm and show that the associations between RMSDD/mean and ShE with recordings obtained from patients in AF persist after adjustment for demographic and clinical characteristics.
Traditional methods of AF detection, such as ofﬁce-based electrocardiograpy and continuous ambulatory electrocardiographic monitoring, are confounded by the often paroxysmal and minimally symptomatic nature of the arrhythmia. Since AF is associated with increased morbidity and reduced survival, there is a great need for sensitive and accessible AF screening instruments. Although monitors with automated detection capabilities (eg, Medtronic REVEAL XT) are used to screen for AF, the cost, inconvenience, and technical limitations of these monitors have limited their widespread use.20,21 The ideal AF detection instrument would provide real-time realizable and accurate detection of AF in a sensitive and speciﬁc manner. Furthermore, the ideal screening instrument would be inexpensive, accessible, and easy to use for patients with, or at risk for, this serious arrhythmia.
Eighty percent of Americans who are older than 65 years currently use a mobile phone.22 Based on current trends, the penetration of smartphones is expected to surge to 67.1% by 2015.22 In light of the increasing accessibility of smartphones, a smartphone-based application for pulse analysis provides patients with, or at-risk for, AF with ready access to an inexpensive instrument for AF monitoring. Importantly, a large percentage of older individuals have reported a willingness to use their mobile phones for health management.22,23
Conclusions
In our moderately sized prospective cohort study involving 76 patients with AF undergoing cardioversion, we observed that 2 statistical methods (RMSDD/mean and ShE) were strongly related to AF and that a novel arrhythmia detection application combining these 2 statistical methods reliably distinguished an irregular pulse from AF from pulse waveforms obtained during NSR. Since our application is accurate and real-time realizable using hardware that already exists within a standard smartphone, we believe that this software could be effectively and inexpensively used to improve AF detection in the general population. Further data are needed to explore the acceptability and feasibility of smartphonebased applications for pulse waveform analysis in older, atrisk populations and in out-of-hospital settings.
Strengths and limitations We anticipate that some participants with very large, or very small, or calloused ﬁngertips may have difﬁculty transilluminating their ﬁngers sufﬁciently so as to allow for successful heart rhythm analysis. We conducted our study in a hospitalized and largely white cohort examined in a standardized, temperature, and light-controlled environment. It is possible that exposure to extreme temperatures or bright ambient light might affect the performance characteristics of our iPhone-based AF detection application. It is possible that patients with a high burden of

premature beats and/or atrial tachyarrhythmias with variable ventricular responses may be falsely detected as AF. We are developing an algorithm for testing in patients with a broader spectrum of arrhythmias and using a wider array of smartphones. Further testing of the performance and acceptability of our pulse waveform analysis application in large and ethnically diverse cohorts and in real-world scenarios is necessary.
References
1. Go AS, Hylek EM, Phillips KA, et al. Prevalence of diagnosed atrial ﬁbrillation in adults: national implications for rhythm management and stroke prevention. The anticoagulation and risk factors in atrial ﬁbrillation (ATRIA) study. JAMA 2001;285:2370–2375.
2. Magnani JW, Rienstra M, Lin H, et al. Atrial ﬁbrillation: current knowledge and future directions in epidemiology and genomics. Circulation 2011;124:1982–1993.
3. Wang TJ, Larson MG, Levy D, et al. Temporal relations of atrial ﬁbrillation and congestive heart failure and their joint inﬂuence on mortality: the Framingham Heart Study. Circulation 2003;107:2920–2925.
4. Wolf PA, Abbott RD, Kannel WB. Atrial ﬁbrillation as an independent risk factor for stroke: The Framingham Study. Stroke 1991;22:983–988.
5. Fuster V, Ryden LE, Asinger RW, et al. ACC/AHA/ESC guidelines for the management of patients with atrial ﬁbrillation: a report of the American College of Cardiology/American Heart Association task force on practice guidelines and the European Society of Cardiology committee for practice guidelines and policy conferences (committee to develop guidelines for the management of patients with atrial ﬁbrillation) developed in collaboration with the North American Society of Pacing and Electrophysiology. Eur Heart J 2001;22:1852–1923.
6. Humphries KH, Kerr CR, Connolly SJ, et al. New-onset atrial ﬁbrillation: sex differences in presentation, treatment, and outcome. Circulation 2001;103:2365–2370.
7. Defaye P, Dournaux F, Mouton E. Prevalence of supraventricular arrhythmias from the automated analysis of data stored in the ddd pacemakers of 617 patients: the AIDA study. The AIDA Multicenter Study Group. Automatic interpretation for diagnosis assistance. Pacing Clin Electrophysiol 1998;21:250–255.
8. Benjamin EJ, Chen PS, Bild DE, et al. Prevention of atrial ﬁbrillation: report from a National Heart, Lung, and Blood Institute workshop. Circulation 2009;119:606–618.
9. Lee J, McManus D, Chon K. Atrial ﬁbrillation detection using time-varying coherence function and Shannon entropy. Conf Proc IEEE Eng Med Biol Soc 2011;2011:4685–4688.
10. Lee J, McManus DD, Merchant S, Chon KH. Automatic motion and noise artifact detection in Holter ECG data using empirical mode decomposition and statistical approaches. IEEE Trans Biomed Eng 2012; 59:1499–1506.
11. Lee J, Reyes BA, McManus D, Maitas O, Chon KH. Atrial ﬁbrillation detection using an iphone 4s. IEEE Trans Biomed Eng 2012: epub ahead of print.
12. Scully CG, Lee J, Meyer J, et al. Physiological parameter monitoring from optical recordings with a mobile phone. IEEE Trans Biomed Eng 2012; 59: 303–306.
13. Aboy M, McNames J, Thong T, Tsunami D, Ellenby MS, Goldstein B. An automatic beat detection algorithm for pressure signals. IEEE Trans Biomed Eng 2005;52:1662–1670.
14. Dash S, Chon KH, Lu S, Raeder EA. Automatic real time detection of atrial ﬁbrillation. Ann Biomed Eng 2009;37:1701–1709.
15. Sankari Z, Adeli H. Heartsaver: a mobile cardiac monitoring system for autodetection of atrial ﬁbrillation, myocardial infarction, and atrio-ventricular block. Comput Biol Med 2011;41:211–220.
16. Gregoski MJ, Mueller M, Vertegel A, et al. Development and validation of a smartphone heart rate acquisition application for health promotion and wellness telehealth applications. Int J Telemed Appl 2012:1–7.
17. Tateno K, Glass L. Automatic detection of atrial ﬁbrillation using the coefﬁcient of variation and density histograms of RR and deltaRR intervals. Med Biol Eng Comput 2001;39:664–671.
18. Pawar T, Chaudhuri S, Duttagupta SP. Body movement activity recognition for ambulatory cardiac monitoring. IEEE Trans Biomed Eng 2007;54:874–882.
19. Petterson MT, Begnoche VL, Graybeal JM. The effect of motion on pulse oximetry and its clinical signiﬁcance. Anesth Analg 2007;105:S78–S84.
20. Sarkar S, Ritscher D, Mehra R. A detector for a chronic implantable atrial tachyarrhythmia monitor. IEEE Trans Biomed Eng 2008;55:1219–1224.
21. Barthelemy JC, Feasson-Gerard S, Garnier P, et al. Automatic cardiac event recorders reveal paroxysmal atrial ﬁbrillation after unexplained strokes or transient ischemic attacks. Ann Noninvasive Electrocardiol 2003;8:194–199.
22. Barrett L. Health and caregiving among the 50þ: ownership, use and interest in mobile technology. AARP Research and Strategy Analysis 2011.
23. Mobile healthcare opportunities, monitoring applications and mhealth strategies 2010–2014. Juniper Research 2011.

