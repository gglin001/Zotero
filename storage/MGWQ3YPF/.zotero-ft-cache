专题研究与综述
ＤＯＩ：１０．１９５５7/ｊ．ｃｎｋｉ．１００１－９９４４．２０１８．０９．００２

基于小波变换的 QＲＳ 波特征提取算法研究与实现
王 莉 1，郭晓东 1，惠延波 1，何宇宸 2
（1.河南工业大学 电气工程学院，郑州 450001.2.Wakefield School，Virginia USA）

摘 要 ：为 提 高 心 电 信 号QRS 波 的 检 测 精 度 ，研 究 实 现 了 一 种 基 于 小 波 变 换 的QRS 特 征 点 定 位算法。 该算法基于小波Mallat算法对心电信号去除基线漂移， 并采用峰值信噪比和均方 根误差对常用小波去噪效果进行评价；运用极大极小值过零点原理检测R波峰值，采用平 面几何法定位QS波峰值， 研究零基准原则定位QRS波起止点。 经过MIT-BIH Arrhythmia Database数据验证，算法的灵敏度达到99.85%，正检测率达到99.86%。 仿真与数据验证结果 均表明该算法的有效性，在心率异常等心脏疾病的诊断上具有一定的应用价值。 关 键 词 ：心 电 信 号 ；QRS 特 征 点 ；小 波 变 换 ；基 线 漂 移 ；定 位 算 法 中图分类号：TN911.6；R540.4+1 文献标志码：A 文章编号：1001-9944（2018）09-0006-04

Rｅｓｅａｒｃｈ ａｎｄ Iｍｐｌｅｍｅｎｔａｔｉｏｎ ｏｆ QRＳ Wａvｅ Ｆｅａｔｕｒｅ Ｅｘｔｒａｃｔｉｏｎ Ａｌｇｏｒｉｔｈｍ Bａｓｅｄ ｏｎ Wａvｅｌｅｔ Ｔｒａｎｓｆｏｒｍ

WＡＮG Ｌｉ１，GＵＯ Xｉａｏ-ｄｏｎｇ１，ＨＵＩ Yａｎ-ｂｏ１，ＨＥ Yｕ-ｃｈｅｎ２
（１．Ｓｃｈｏｏｌ ｏｆ Ｅｌｅｃｔｒｉｃａｌ Ｅｎｇｉｎｅｅｒｉｎｇ，Ｈｅｎａｎ Ｕｎｉvｅｒｓｉｔｙ ｏｆ Ｔｅｃｈｎｏｌｏｇｙ，Zｈｅｎｇｚｈｏｕ ４５０００１，Ｃｈｉｎａ；２．Wａｋｅｆｉｅｌｄ Ｓｃｈｏｏｌ，Ｖｉｒｇｉｎｉａ ＵＳＡ） Ａｂｓｔｒａｃｔ：Ｉｎ ｏｒｄｅｒ ｔｏ ｉｍｐｒｏvｅ ｔｈｅ ｄｅｔｅｃｔｉｏｎ ａｃｃｕｒａｃｙ ｏｆ QRＳ ｗａvｅ，ａ QRＳ ｆｅａｔｕｒｅ ｐｏｉｎｔ ｌｏｃａｔｉｏｎ ａｌｇｏｒｉｔｈｍ ｆｏｒ ＥＣG ｂａｓｅｄ ｏｎ ｗａvｅｌｅｔ ｔｒａｎｓｆｏｒｍ ｉｓ ｓｔｕｄｉｅｄ ａｎｄ ｉｍｐｌｅｍｅｎｔｅｄ．Ｔｈｅ ａｌｇｏｒｉｔｈｍ ｉｓ ｂａｓｅｄ ｏｎ ｗａvｅｌｅｔ ｄｅｃｏｍｐｏｓｉｔｉｏｎ ａｎｄ ｒｅｃｏｎｓｔｒｕｃｔｉｏｎ Ｍａｌｌａｔ ａｌｇｏｒｉｔｈｍ ｔｏ ｒｅｍｏvｅ ｔｈｅ ｂａｓｅｌｉｎｅ ｄｒｉｆｔ ｏｆ ｔｈｅ ＥＣG ｓｉｇｎａｌ，ａｎｄ ｕｓｅｓ ｐｅａｋ ｓｉｇｎａｌ-ｔｏ-ｎｏｉｓｅ ｒａｔｉｏ ａｎｄ ｒｏｏｔ ｍｅａｎ ｓqｕａｒｅ ｅｒｒｏｒ ｔｏ ｅvａｌｕａｔｅ ｔｈｅ ｄｅｎｏｉｓｉｎｇ ｅｆｆｅｃｔ ｏｆ ｔｈｅ ｃｏｍｍｏｎ ｗａvｅｌｅｔ；ｔｈｅ ｐｅａｋ vａｌｕｅ ｏｆ R ｗａvｅ ｉｓ ｄｅｔｅｃｔｅｄ ｂｙ ｔｈｅ ｍｉｎｉｍａｘ ｚｅｒｏ ｃｒｏｓｓｉｎｇ ｐｒｉｎｃｉｐｌｅ，ｔｈｅ ｕｓｅ ｏｆ ｐｌａｎｅ ｇｅｏｍｅｔｒｙ ｍｅｔｈｏｄ ｔｏ ｌｏｃａｔｅ ｔｈｅ ｐｅａｋ ｏｆ ｔｈｅ QＳ ｗａvｅ，ｓｔｕｄｙ ｔｈｅ ｚｅｒｏ ｒｅｆｅｒｅｎｃｅ ｐｒｉｎｃｉｐｌｅ ｔｏ ｌｏｃａｔｅ ｔｈｅ ｓｔａｒｔ ａｎｄ ｅｎｄ ｐｏｉｎｔｓ ｏｆ ｔｈｅ QRＳ ｗａvｅ． Ａｆｔｅｒ ＭＩＴ-ＢＩＨ Ａｒｒｈｙｔｈｍｉａ Ｄａｔａｂａｓｅ ｄａｔａ vａｌｉｄａｔｉｏｎ，ｔｈｅ ｓｅｎｓｉｔｉvｉｔｙ ｏｆ ｔｈｅ ａｌｇｏｒｉｔｈｍ ｒｅａｃｈｅｓ ９９．８５%，ａｎｄ ｔｈｅ ｐｏｓｉｔｉvｅ ｄｅｔｅｃｔｉｏｎ ｒａｔｅ ｒｅａｃｈｅｓ ９９．８６%． Ｔｈｅ ｒｅｓｕｌｔｓ ｏｆ ｓｉｍｕｌａｔｉｏｎ ａｎｄ ｄａｔａ vｅｒｉｆｉｃａｔｉｏｎ ｓｈｏｗ ｔｈａｔ ｔｈｅ ａｌｇｏｒｉｔｈｍ ｉｓ ｅｆｆｅｃｔｉvｅ ａｎｄ ｈａｓ ｃｅｒｔａｉｎ ａｐｐｌｉｃａｔｉｏｎ vａｌｕｅ ｉｎ ｔｈｅ ｄｉａｇｎｏｓｉｓ ｏｆ ｈｅａｒｔ ｄｉｓｅａｓｅｓ ｓｕｃｈ ａｓ ａｂｎｏｒｍａｌ ｈｅａｒｔ ｒａｔｅ． Kｅｙ wｏｒｄｓ：ｅｌｅｃｔｒｏｃａｒｄｉｏｇｒａｍ（ＥＣG） ｓｉｇｎａｌ；QRＳ ｆｅａｔｕｒｅ ｐｏｉｎｔｓ；ｗａvｅｌｅｔ ｔｒａｎｓｆｏｒｍ；ｂａｓｅｌｉｎｅ ｄｒｉｆｔ；ｆｅａｔｕｒｅ ｄｅｔｅｃｔｉｏｎ

心电信号包含大量体现心脏节律的信息，客观 反应了心脏的生理特征，是诊断心脏疾病的主要依 据。 心电图 ＥＣG 用于临床心脏病诊断，主要依赖医 师丰富的临床经验。 然而，心电图种类多、变化大，

医 师 在 长 时 间 诊 断 中 可 能 存 在 漏 检 、 错 检 的 情 况 [１]。 因此，从心电图提取特征信息，实现自动检测成为 研究热点。
一 个 典 型 的 心 电 信 号 由 Ｐ 波 、QRＳ 波 、Ｔ 波 构

收 稿 日 期 ：２０１８－０６－２１ ；修 订 日 期 ：２０１８－０８－０２ 基金项目：河南省科技厅自然科学项目（１５２１０２２１０２7０）；河南省科技攻关项目重点研发与 推 广 专 项 （１８２１０２２１００８９）；河 南
省 粮 食 光 电 探 测 与 控 制 重 点 实 验 室 开 发 课 题 （ＫＦＪＪ－２０１６－１０１） 作 者 简 介 ：王 莉 （１９7３— ），女 ，博 士 ，教 授 ，研 究 方 向 为 微 弱 光 电 信 号 检 测 技 术 、测 控 技 术 与 仪 器 仪 表 开 发 ；郭 晓 东 （１９９３ — ），
男，硕士，研究方向为信号处理。

6

Ａｕｔｏｍａｔｉｏｎ ＆ Ｉｎｓｔｒｕｍｅｎｔａｔｉｏｎ ２０18,33（9）

万方数据

成，心电信号特征点任一幅值和时间跨度均可被视 作一种特征。 近年来，研究心电信号特征提取的算 法不断涌现。 文献[２]提出一种基于 Ｐａｎ-Ｔｏｍｐｋｉｎｓ 方 法 和 小 波 变 换 的 组 合 算 法 ； 文 献[３] 提 出 一 种 基 于 卷 积神经网络的 QRＳ 检测方法；文献[４]提出一种基于 二次滤波器的 QRＳ 检测算法；文献[５]通过计算并比 较 R 波左侧或右侧相邻两点的斜率变化来判断 Q 波和 Ｓ 波；文献[６]采用基于自适应双阈值 ＡＤＴ 与回 溯重检机制的检测算法检测 QRＳ 波。 文中在对心电 信号去除干扰的基础上，采取一系列策略实现 QRＳ 波的准确定位，并基于灵敏度和正检测率准则对算 法的有效性进行评估。

１ 小波变换处理心电信号原理

１.１ 小波变换去噪原理

小波变换去噪可以通过小波变换快速算法实

现，即 Ｍａｌｌａｔ 算法。 已知小波函数 ψ（t）和尺度函数

φ（t），Ｍａｌｌａｔ 算法分解公式为

cj+１［k］= ∑ cj［n］h－［2k－n］=cj*h－［２k］ （１）
n∈z
dj+１［k］= ∑ cj［n］g －［2k－n］=cj*g －［２k］ （２）
n∈z

式中：h｛k｝为 φ（t）对应 的低通滤波 器 ；g｛k｝为 ψ（t）

对应的高通滤波器；ci，k，di，k 分别为第 i 层 的低通系 数、高通分解系数。

利用卷积的可交换性，重构公式为

cj［k］=cjˇ+１ *h［k］+djˇ+１ *g［k］，k∈Z

（３）

１.２ 小波变换检测信号突变点原理

设 f （t），ψ（t）∈L２（R），记

姨 姨 ψs（t

）=

１ s

ψ

t s

，s>０

（４）

则称

乙 姨 姨 （Wf

）（s，b）=

f

*ψs （b ） =

１ s

+∞
f （t）ψ
－∞

b－t s

ｄt

为 f （t）的小波变换。

根据小波变换的定义和卷积的性质，有

姨 姨 （１）
f *ψs = f *

s ｄθs ｄt

=s

ｄ ｄt

（ f *θs（t））

（５）

姨 姨 （２）
f *ψs = f *

s２

ｄ２θs ｄt２

=s２

ｄ２ ｄt２

（ f *θs（t））

（６）

式 （５ ） 和 式 （６ ） 表 示 ， f （t ） 的 小 波 变 换 （Wf ）

（１）
（s，t）= f *ψs （t） 与 f *θs（t） 的 一 阶 导 数 成 正 比 ， 且
（２）
（Wf ）（s，t）= f *ψs （t）与 f *θs（t）的二阶导数成正比。

自动化与仪表 ２０18,33（9）

专题研究与综述

结合 Ｌｉｐｓｃｈｉｔｚ 指数可知，当选取光滑函数 θ（t）

以后，信号 f （t）的突变点可以通过检测小波变换 ｆ

（１）

（２）

f *ψs （t）和 f *ψs （t）的模极大值得到。

２ 心电信号去噪
心电是微弱的生物电信号，在测量过程中极易 受到外界的干扰，常见干扰有基线不稳、肌电干扰 和工频干扰[7]。
对心电信号进行分析前必须对心电信号去噪 处理，传统的去噪方法中常使用高通滤波器或低通 滤波器，但是滤波器设计复杂，同时会使心电信号 丢失重要的信息，不利于后续研究。 自适应滤波器 也被用于心电信号去噪，但是该方法去噪效果并不 理想[８]。 小波变换在时频域上对心电信号进行分析， 最大程度地保留了心电信号的重要信息，故在此提 出一种采用小波变换有选择地抑制各层细节系数 对心电信号去噪。 ２.１ 去除基线漂移干扰
心电信号频率通常分布在 ０．０５～１００ Ｈｚ，基线漂 移频率不大于 ０．３ Ｈｚ[９]。ＭＩＴ-ＢＩＨ Ａｒｒｈｙｔｈｍｉａ Ｄａｔａｂａｓｅ 数据样本噪声来源主要是基线漂移，采用小波变换 去除基线漂移干扰，主要有以下 ３ 个步骤：
步骤 １ 确定小波分解层次，并进行分解计算。 ＭＩＴ-ＢＩＨ Ａｒｒｈｙｔｈｍｉａ Ｄａｔａｂａｓｅ 中的心电数据样 本采 样 频 率 为 ３６０ Ｈｚ，根 据 采 样 定 理 ，心 电 信 号 的 最高频率为 １８０ Ｈｚ， 对心电信号进行 ８ 层分解，可 以得到心电信号分解的近似系数 ａ８ 和一组细节系 数 ｄ１—ｄ８， 其中 ｄ８ 的频率范围为 ０～０．7０３１２５ Ｈｚ。 由基线漂移噪声的特点和小波分解系数频率分布 范围，选取小波分解尺度为 ８[１０]。 选取 ｄｂ５ 小波，对 心电信号 ８ 层分解的小波细节系数如图 １ 所示。 步骤 ２ 小波分解高频系数阈值量化。 基线漂移的 频率主要分 布在小波 细 节 系 数 ｄ８ 中， 考虑到心电信号中也包含有大量的高频信息， 可以在小波域上将 ｄ８ 细节系数所在下标小于 ４０% 的细节系数成分舍弃， 将 ｄ８ 细节系数所在下标大 于 ４０%的细节系数作为新的小波细节系数 ｄ８。 步骤 ３ 小波重构。 将小波近似系数 ａ８ 和新的小波细节系数 ｄ８ 及 ｄ１—ｄ7 进行逐级重构。 原始心电信号和重构的心电信号如图 ２ 所示， 由图可见，该方法保留了相对完整的信息，且波形

7

万方数据

专题研究与综述

０．０５

０．１

ｄ２

ｄ１

０

０

ｄ３

－０．０５０
１ ０ －１０ ５

５０００ １００００ （ａ）ｄ１
１０００ ２０００ （ｃ）ｄ３

１５０００ －０．１ ０
２ ０ ３０００ －２０ １０

ｄ４

２０００ ４０００ ６０００ （ｂ）ｄ２
５００ １０００ １５００ （ｄ）ｄ４

ｄ６

ｄ５

０

０

－５

－１０

０ ２００ ４００ ６００ ８００

０ １００ ２００ ３００ ４００

（ｅ）ｄ５ ５

（ｆ）ｄ６ ５

ｄ８

ｄ7

０

０

－５

－５

０ ５０ １００ １５０ ２００

０

５０

１００

（ｇ）ｄ7

（ｈ）ｄ８

图 １ 小波分解细节系数

Fig.１ WaveＩet decomposition detaiＩ coefficient

幅 值/ （ｍＶ ）

４ ２ ０ －２
５００ １０００ １５００ ２０００ ２５００ ３０００ t/ｓ
（ａ）原信号

幅 值/ （ｍＶ ）

４ ２ ０ －２
５００ １０００ １５００ ２０００ ２５００ ３０００ t/ｓ
（ｂ）去除基线漂移信号

图 ２ 原信号和去除基线漂移信号 Fig.２ ＯriginaＩ signaＩ and removing baseＩine drift signaＩ

比较平滑，对心电信号基线漂移去噪效果较好。

２.２ 不同小波函数消噪结果对比

选 用 峰 值 信 噪 比 ＰＳＮR 和 均 方 根 误 差 ＭＳＥ 评

价不同小波函数去噪效果。 ＰＳＮR 数值越大，ＭＳＥ 数

值越小， 则去噪后信号和原信号近似程度越好。

ＰＳＮR 和 ＭＳＥ 的定义为

移

A２

移

∑∑ PSNR=１０×ｌｇ移移 １
移MN

M i=１

N j=１

姨f （i，

j）－g（i，

j）

姨２

移移 移

（7）

MN

∑∑ MSE= １

姨f （i， j）－g（i， j） 姨２

MN i=１ j=１

（８）

式中： f （i， j）和 g（i， j）为 原 始 信 号 、去 噪 后 信 号 图

像；M，N 分别为它们的长、宽。

选取 ｄｂ４，ｄｂ５，ｄｂ６，ｓｙｍ４ 常用小 波对心电 信 号

去除基线漂移，去噪结果见表 １。 由表可知，ｄｂ５ 小

波 在 去 除 基 线 漂 移 中 ＰＳＮR 最 大 ， 达 到 １４．０５８３；

ＭＳＥ 最小，达到 ０．０３９３。 试验结果表明 ｄｂ５ 小波去

除基线漂移效果最好。

表 １ 常用小波消噪结果 Ｔab.１ CommonＩy used waveＩet denoising resuＩts

小波函数 ＰＳＮR ＭＳＥ

ｄｂ４ １３．９３５４ ０．０４０４

ｄｂ５ １４．０５８３ ０．０３９３

ｄｂ６ １３．7５３２ ０．０４２１

ｓｙｍ４ １３．６８３９ ０．０４２８

ＥＣG信 号 幅 值 /（ ｍＶ）

ｄ１

ｄ２

ｄ３

ｄ４

3 QＲＳ 特征点定位算法
在一个心电信号周期中，QRＳ 波是心电信号中 最突出、最重要的部分，它不仅是诊断心脏疾病的
重要依据，也是定位分析其它波形的基础。 本研究
经过大量的试 验对比，选取 对 ｄｂ 函数改进 的 ｓｙｍ４ 为基小波，在第 ４ 尺度上对心电信号进行特征提取。 3.１ Ｒ 波峰值定位
依据小波变换检测信号特征点原理，采用 ｓｙｍ４ 小波函数，对心电信号 ４ 层分解，原始心电信号和 各尺度心电信号如图 ３ 所示。 可以看出 R 波峰值点 和小波域上的极大极小值过零点相对应。
２ １ ０ ０．５ ０ －０．５ ２ ０ －２ ５ ０ －５ ５ ０ －５
５００ １０００ １５００ ２０００ ２５００ ３０００ t/ｓ
图 3 心电信号和 4 层分解小波系数 Fig.3 ＥCG signaＩ and 4-Ｉayer
decomposition waveＩet coefficients
R 波峰值定位算法步骤如下： 步 骤 １ 将 去 除 基 线 漂 移 的 心 电 信 号 X （n）作 ４ 层小波分解，得到小波变换系数矩阵 ｗｓｉｇ。 步骤 ２ 在小波变换域上， 寻找前 ３ ｓ 内的极 大值点 Ｍａｘ 和极小值点 Ｍｉｎ，然后分别求取前 １０ 个 极大值点和后 １０ 个极小值点的平均值， 以极大值 和 极小值平均 值差的 ０．４５ 作 为阈值寻找 整个信号 中的极大值点和极小值点，得到极大极小值对。
步骤 ３ 求取极大极小值对的过零点， 并记录 该点对应的值 R（i），初步认为 R（i）是 R 波峰值点。
步骤 ４ 对 R 波峰 值点校正，取 R（i）前后各 ５ 个采样点，求取 １０ 个采样点中的最大值，将该点作 为 R 波峰值点。

8

Ａｕｔｏｍａｔｉｏｎ ＆ Ｉｎｓｔｒｕｍｅｎｔａｔｉｏｎ ２０18,33（9）

万方数据

步骤 ５ 排除误检，计算 R 波间期平均值RRｍｅａｎ， 判断相邻 R 波时间间隔是否小于 ０．４RRｍｅａｎ。 如果 是，则去除 R 波幅值比较小的点。
步骤 ６ 排除漏检， 判断相邻 R 波时间间隔是 否大于 １．６RRｍｅａｎ。 如果是， 则阈值减小为原来的 １/２，在该时间段内重新 寻找正负极 大值对 ，判断 是 否存在过零点。 3.２ Q 波、Ｓ 波峰值定位
通过观察分析 QRＳ 波群持续时间内，R 波峰值 和 QＳ 波峰值之间的几何关系， 本研究采用平面几 何的方法定位 Q 波和 Ｓ 波峰值，具体算法如下：
①对信号进行连续小波变换，如果 R 波正向，在 R 波前 ２０ ｍｓ 内寻找第 １ 个极小值点。 反之，寻找到 第 １ 个极大值点，并把心电信号上对应点记为 n。
②在 n 点前极小的一段距离取一点， 记为 m。 连接点 m 和 R 峰值点 r，得到直线 mr。
③从点 m 开始到 r，依次计算各点到直线 mr 的 距离 d，则 d 最大的点即为 Q 波峰的位置。
从 R 波向后 ３０ ｍｓ 的时间内定位 Ｓ 波峰值，具 体过程与 Q 波峰值定位相似。 3.3 QＲＳ 波起止点定位
QRＳ 波的起点就是 Q 波的起点，终点就是 Ｓ 波 的终点。 经过试验分析，QRＳ 波的起点和终点分别 与其波形两侧的过零点近乎处于同一位置。 定位到 QＳ 波峰值点后， 分别向前向后搜索最靠近基线的 点，即可认为是 QRＳ 波的起点和终点。 3.4 QＲＳ 波特征点定位算法实现
对原始信号截取 ２０００ 个采样点， 在小波变换 域上实现 QRＳ 波峰值点和起止点定位，QRＳ 波特征 点定位结果如图 ４ 所示。 由图可见该算法实现了对 QRＳ 波的准确定位。

4 算法验证
随 机 选 取 ＭＩＴ-ＢＩＨ Ａｒｒｈｙｔｈｍｉａ Ｄａｔａｂａｓｅ 中 １６ 组样本对 QRＳ 波检测算法验证， 采用灵敏度 Ｓｅ 和 正检测率 Ｐ+两种准则评价算法的准确性，即

Se=

TP TP+FN

（９）

P+

=

TP TP+FP

（１０）

式中：TP 为 QRＳ 波的 正确检出数 ；FP 为 QRＳ 波 的 错误检出数；FN 为 QRＳ 波的漏检数。

自动化与仪表 ２０18,33（9）

专题研究与综述

幅值/（ｍＶ ）

４００ ３００ ２００ １００
０ －１００
０
４００ ３００ ２００ １００
０ －１００
０

５００

１０００

１５００

t/ｓ

（ ａ） 原 信 号

２０００

５００

１０００

１５００

t/ｓ

（ｂ）QRＳ 波定位

２０００

幅 值/ （ｍＶ ）

图 4 心电信号 QＲＳ 波特征点定位

Fig.4 Location of ＥCG QＲＳ wave feature points

１６ 组心电数组 QRＳ 波特征提取结果见表 ２。 由

表可知， 该算法对 QRＳ 波的检 测取得了较 好的结

果，算法的检测灵敏度达到 ９９．８５%，正检测率达 到

９９．８６%。

表 ２ QＲＳ 波定位结果

Ｔab.２ QＲＳ wave positioning resuＩts

样本号
１００ １０１ １０３ １０５ １０９ １１１ １１４ １１7 １２１ １２２ １２４ ２０１ ２０５ ２０９ ２１２ ２１５ 总计

总心拍数
２２7３ １８６５ ２０８４ ２５7２ ２５３４ ２１２7 １８7９ １５３５ １８６３ ２４7６ １６２０ １９６０ ２６５６ ３００５ ２7４８ ３３６８ ３６５６５

检出数 ＴＰ ２２7２ １８６２ ２０7８ ２５６３ ２５２２ ２１２５ １８7２ １５３５ １８５7 ２４６２ １６１１ １９５５ ２６５２ ２９９６ ２7３６ ３３６２
３６４６０

误检数 ＦＰ ０ １ ４ ３ 7 １ ４ ０ ２ １１ ２ ５ １ ２ 7 ０ ５０

漏检数 ＦＮ １ ２ ２ ６ ５ １ ３ ０ ４ ３ 7 ０ ３ 7 ５ ６ ５５

Ｓｅ/（%） P+ /（%）

９９．９６ ９９．８９ ９９．９ ９９．77 ９９．８ ９９．９５ ９９．８４ １００ ９９．7８ ９９．８８ ９９．５7 １００ ９９．８９ ９９．77 ９９．８２ ９９．８２ ９９．８５

１００ ９９．９５ ９９．８１ ９９．８８ ９９．7２ ９９．９５ ９９．7９ １００ ９９．８９ ９９．５６ ９９．８８ ９９．7４ ９９．９６ ９９．９３ ９９．7４ １００ ９９．８６

5 结语
通过小波分解重构快速算法去除心电信号基 线漂移，算法简单且去噪效果较好；选用峰值信噪 比和均方根误差评价 ４ 种常见小波函数在心电信 号 中 的 去 噪 效 果 ， 结 果 表 明 ｄｂ５ 小 波 去 噪 效 果 最 优； 依据小波变换域上的极大极小值过零点检测 R 波峰值， 并采用一系列策略排除了误检和漏检，实 现了 R 波的准确定位； 采用平面几何的方法定位 QＳ 波峰值； 该算法对 QRＳ 波特征提取灵敏度达到 ９９．８５%，正检测率达到 ９９．８６%。 （下转第 １４ 页）
9

万方数据

专题研究与综述

小于某个值时， 局部符合逻辑对 PＦＳ，ａvｇ 的改善作用 更大，λｉ /λｏ 超过该值时，对 PＦＤ，ａvｇ 的改善作用更大。 ３．２．３ λＳ/λＤ 的影响
保持输入模块 ＤＩ 总失效率不变， 通过调整 ＤＩ 安全失效率和危险失效率的比例， 改变单通道的 λＳ/λＤ 值，得到图 7 所示的曲线。 随着安全失效率占 通道失效率 的比例增加 P ， ＦＳ，ａvｇ 的变化 率 也 在 增 大 ， PＦＤ，ａvｇ 变化率减小。可以推测，局部符合逻辑对 PＦＤ，ａvｇ 和 PＦＳ，ａvｇ 的改善作用大小， 与参与局部符合的安全 失效率和危险失效率比例有关，占通道失效比例越 大的失效类型，局部符合逻辑对其改善作用越大。

［（A－B ）/A ］/ （% ）

３５

３０

２５

PＦＤ，ａvｇ

２０

PＦＳ，ａvｇ

１５

１０

５

１２３４５６7 λＳ /λＤ

图 7 λＳ/λD 对（A-B）/A 的影响 Fig.7 ＩnfＩuence of λＳ/λD on （A-B）/A

4 结语
综上所述，采用局部符合逻辑有利于改善反应 堆保护系统可靠性，对降低系统安全功能的拒动概 率和误动概率都有明显效果。 对于通道自诊断能力 差的系统而言，局部符合逻辑可以一定程度上弥补 低诊断覆盖率的不足， 使系统自诊断能力大大提 高。 当单通道输入部分的失效率低于输出部分，或

高出不多时，局部符合逻辑对误动概率的改善作用 更大； 而当输入部分的失效率明显高于输出部分 时，局部符合逻辑对拒动概率的改善作用更大。 对 安全和危险 ２ 种不同失效模式，局部符合逻辑对占 通道失效比例越高的失效改善作用越高。
局部符合逻辑对不同架构类型系统可靠性的改 善程度可能有所区别，但是，具有提高诊断能力、降 低拒动概率和误动概率的优点是确定的。 此外，在系 统设计过程中还需要评估采用局部符合逻辑可能引 起的通道独立性降低，增加通道间通信而引入的新 的失效，以及产品成本等问题。 因此，目前局部符合 逻辑技术更多的应用于安全系统或对可靠性要求高 的设备，也许在不远的将来能够推广到更多领域中。

参考文献：

[１] 中广核工程有限公司 ．压水堆核电厂核岛设计·核岛仪控系统设

计 [Ｍ]．北 京 ：原 子 能 出 版 社 ， ２０１０．

[２] 李 明 利 ，石 桂 连 ，唐 环 ．逻 辑 退 化 对 数 字 化 核 反 应 堆 保 护 系 统 可

靠 性 的 影 响 [Ｊ]．核 动 力 工 程 ， ２０１２， ３３（ ２）： ２１－２４．

[３] 张 庆 ，马 权 ，许 标 ，等 ．基 于 马 尔 可 夫 法 的 安 全 级 ＤＣＳ 功 能 安 全

分 析 [Ｊ]．仪 器 仪 表 用 户 ， ２０１６， ２３（ １０）： 77－８１， ２４．

[４] 郭海涛，阳宪惠 ．安全系统定量可靠性评估的 Ｍａｒｋｏv 模型 [Ｎ]．清

华 大 学 学 报 ：自 然 科 学 版 ， ２００８， ４８（ １）： １４９－１５２．

[５] 黄永成，胡立生．基于马尔可夫模型的核电站数字化仪控系统可

靠 性 分 析 [Ｊ]．自 动 化 应 用 ， ２０１５，（ ２）： ２０－２１．

[６] Gｏｂｌｅ W Ｍ．控制系统的安全评估与可靠性 [Ｍ]．白焰，董玲，杨国

田 ，译 ．北 京 ：中 国 电 力 出 版 社 ， ２００８．

[7] ＩＥＣ ６１５０８．Ｆｕｎｃｔｉｏｎａｌ ｓａｆｅｔｙ ｏｆ ｅｌｅｃｔｒｉｃａｌ/ｅｌｅｃｔｒｏｎｉｃ/ｐｒｏｇｒａｍｍａｂｌｅ

ｅｌｅｃｔｒｏｎｉｃ ｓａｆｅｔｙ-ｒｅｌａｔｅｄ ｓｙｓｔｅｍｓ[Ｓ]．Gｅｎｅvａ： Ｉｎｔｅｒｎａｔｉｏｎａｌ Ｅｌｅｃ-

ｔｒｏｔｅｃｈｎｉｃａｌ Ｃｏｍｍｉｓｓｉｏｎ，２０１０．

■

■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■

（上接第 ９ 页） 结果表明，该算法对于心电信号的预 处理和特征提取是有效的，对心电疾病的分类诊断 具有重要参考意义。
参考文献： [１] 王吉鸣，吕颖莹，包涛，等．动态心电监测系统介绍及关键技术水
平 分 析 [Ｊ]．中 国 医 疗 设 备 ．２０１６，３１（１０）：7１－7４． [２] Ａｌａvｉ Ｓ，Ｓａａｄａｔｍａｎｄ-Ｔａｒｚｊａｎ Ｍ．Ａ ｎｅｗ ｃｏｍｂｉｎａｔｏｒｉａｌ ａｌｇｏｒｉｔｈｍ
ｆｏｒ QRＳ ｄｅｔｅｃｔｉｏｎ [Ｃ]//Ｉｎｔｅｒｎａｔｉｏｎａｌ Ｅｃｏｎｆｅｒｅｎｃｅ ｏｎ Ｃｏｍｐｕｔｅｒ ａｎｄ Ｋｎｏｗｌｅｄｇｅ Ｅｎｇｉｎｅｅｒｉｎｇ． ＩＥＥＥ，２０１３：３９６－３９９． [３] Šａｒｌｉｊａ Ｍ，Ｊｕｒｉšｉ ｃ▲ Ｆ，Ｐｏｐｏvｉ ｃ▲ Ｓ． Ａ ｃｏｎvｏ ｌｕｔｉｏｎａｌ ｎｅｕｒａｌ ｎｅｔｗｏｒｋ ｂａｓｅｄ ａｐｐｒｏａｃｈ ｔｏ QRＳ ｄｅｔｅｃｔｉｏｎ[Ｃ]//Ｉｎｔｅｒｎａｔｉｏｎａｌ Ｓｙｍｐｏｓｉｕｍ ｏｎ Ｉｍａｇｅ ａｎｄ Ｓｉｇｎａｌ Ｐｒｏｃｅｓｓｉｎｇ ａｎｄ Ａｎａｌｙｓｉｓ． ＩＥＥＥ，２０１7：１２１－１２５． [４] Ｐｈｕｋｐａｔｔａｒａｎｏｎｔ Ｐ ． QRＳ ｄｅｔｅｃｔｉｏｎ ａｌｇｏｒｉｔｈｍ ｂａｓｅｄ ｏｎ ｔｈｅ

qｕａｄｒａｔｉｃ ｆｉｌｔｅｒ[Ｍ]．[ｓ．ｌ．]：Ｐｅｒｇａｍｏｎ Ｐｒｅｓｓ Ｉｎｃ，２０１５．

[５] 吴 建 ，李 康 ，庞 宇 ，等 ．基 于 斜 率 突 变 的 QRＳ 波 检 测 [Ｊ]．重 庆 邮 电

大 学 学 报 ：自 然 科 学 版 ．２０１５， ２7（ ２）： ２４１－２４４．

[６] 张毅，谭刚，罗元 ．基于 ＡＤＴ 与回溯重检的 QRＳ 波实时检测算法

[Ｊ]．华 中 科 技 大 学 学 报 ：自 然 科 学 版 ．２０１３， ４１（ Ｓ１）： ３7５－３7８．

[7] 刘 珊 ，李 艳 萍 ，胡 欣 宇 ．基 于 小 波 变 换 的 新 阈 值 法 心 电 信 号 去 噪

的 研 究 [Ｊ]．科 学 技 术 与 工 程 ．２０１４， １４（ ４）： ２３６－２４０．

[８] Ｓｃｈｗａｒｔｚ W R，Ｍｅｎｏｔｔｉ Ｄ．ＥＣG-ｂａｓｅｄ ｈｅａｒｔｂｅａｔ ｃｌａｓｓｉｆｉｃａｔｉｏｎ ｆｏｒ

ａｒｒｈｙｔｈｍｉａ ｄｅｔｅｃｔｉｏｎ[Ｊ]．Ｃｏｍｐｕｔ Ｍｅｔｈｏｄｓ Ｐｒｏｇｒａｍｓ Ｂｉｏｍｅｄ，２０１６，

１２7（Ｃ）：１４４－１６４．

[９] 白 鹏 飞 ，王 利 ，易 子 川 ，等 ．一 种 心 电 图 Ｔ 波 提 取 算 法 [Ｊ]．现 代 电

子 技 术 ．２０１３， ３7（ 7）： ５7－５９．

[１０] Wｕ Ｄ，Ｂａｉ Z． Ａｎ ｉｍｐｒｏvｅｄ ｍｅｔｈｏｄ ｆｏｒ ＥＣG ｓｉｇｎａｌ ｆｅａｔｕｒｅ

ｐｏｉｎｔ ｄｅｔｅｃｔｉｏｎ ｂａｓｅｄ ｏｎ ｗａvｅｌｅｔ ｔｒａｎｓｆｏｒｍ[Ｃ]//Ｉｎｄｕｓｔｒｉａｌ Ｅｌｅｃ-

ｔｒｏｎｉｃｓ ａｎｄ Ａｐｐｌｉｃａｔｉｏｎｓ． ＩＥＥＥ，２０１２：１８３６－１８４１．

■

14

Ａｕｔｏｍａｔｉｏｎ ＆ Ｉｎｓｔｒｕｍｅｎｔａｔｉｏｎ ２０18,33（9）

万方数据

