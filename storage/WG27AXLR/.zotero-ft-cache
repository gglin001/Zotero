Comparison of Heart Rate Variability from PPG with That from ECG
Wan-Hua Lin1,2, Dan Wu1,2, Chunyue Li1,2, Heye Zhang1,2, and Yuan-Ting Zhang2,3,*
1 Institutes of Biomedical and Health Engineering, Shenzhen Institutes of Advanced Technology, Chinese Academy of Sciences
2 Key Laboratory for Health Informatics of the Chinese Academy of Sciences (HICAS) 3 Joint Research Centre for Biomedical Engineering,
Department of Electronic Engineering, Chinese University of Hong Kong

Abstract— Because it is more convenient to measure photoplethysmography (PPG) than ECG, PPG is supposed as a surrogate of ECG for heart rate variability (HRV) analysis. In this study, we measured the spectrum of pulse rate variability (PRV) from PPG and its square coherence spectrum with HRV from ECG before and after exercise. The results showed that the spectrum of PRV corresponds almost well with HRV, especially for the healthy subjects at rest. However, stimuli conditions such as exercise will decrease the correlation, especially for the high frequency (HF) component. It indicates that whether PRV can be used as an alternative to HRV depends on the applications and conditions.
Keywords— Pulse rate variability, heart rate variability, spectrum, squared coherence spectrum.
I. INTRODUCTION*
The oscillations of cardiovascular parameters are widely used for evaluating the regulation between autonomic nervous system (ANS) and cardiovascular system, and are expected to provide information for the prediction and prevention of cardiovascular disease [1]. An example widely used is the heart rate variability (HRV). It is usually measured by spectral analysis of the R-R interval from ECG signal. The low frequency (LF) component of HRV reflect the sympathetic activities of ANS while the high frequency (HF) component reflect the parasympathetic (vagal) activities, which are corresponding to the respiratory rhythm [1]. A heartbeat will generate a corresponding PPG pulse at peripheral position. Compared to ECG monitoring which needs to attach several electrodes on the body, PPG monitoring at peripheral position is much more convenient. The sensors can be embedded in the phone camera, ring, glass, chair, or bed sheet for unobtrusive measurement. Therefore, PPG was proposed as a surrogate of ECG for the analysis of HRV [2, 3, 4]. In this study, we will measure the pulse rate variability (PRV) by spectral analysis of the peak-peak interval from PPG signal and its coherence with HRV from ECG before and after exercise, to examine whether PPG can be used as an alternative signal for ECG for the analysis of HRV.
* Corresponding author.

II. METHODOLOGY
A. Experiment Protocol
Eight young healthy subjects were recruited in the experiment. At the beginning of the test, ECG and PPG were collected simultaneously for 5 min while the subjects were sitting quietly on a chair. Then, the subjects were directed to run on a treadmill at the speed of 9 km/h for 3 min. After exercise, the ECG and PPG were collected simultaneously for 5 min again. ECG and PPG were collected from the subject’s fingers using a system developed by the Joint Research Centre for Biomedical Engineering, Department of Electronic Engineering, Chinese University of Hong Kong. The sampling rate of the signals is 1kHz.
B. Data Analysis
The R-R interval (RRI) was calculated as the time interval of two successive R peaks of the ECG signal. The peakto-peak interval (PPI) was calculated as the time interval of two successive peak of the first derivative of PPG signal, as shown in Fig.1. PRV and HRV were measured as the power spectrum distribution (PSD) of the PPI-t and RRI-t series, respectively.
RRI

PPI

ECG

First derivative of PPG
Fig. 1: Definition of RRI and PPI.
a) Peak detection: The R peaks from ECG and the peaks from PPG were detected using the combination of Wavelet and Amplitude methods which were with quite high noise tolerance. The detection results were also double checked by manual. The segments of original data with strong noise resulting in detection failure of peaks were removed.

I. Lacković et al. (eds.), The International Conference on Health Informatics, IFMBE Proceedings 42,

213

DOI: 10.1007/978-3-319-03005-0_54, © Springer International Publishing Switzerland 2014

214

W.-H. Lin et al.

b) PSD of PRV: PPI series were first interpolated using the cubic spline to arrive at a unified sampling rate of 2.5 Hz. DC was removed by subtracting the mean value of the series. A high-pass filter with cutoff frequency of 0.03Hz was then adopted to eliminate the very slow trends. Finally, the spectrum of PRV was estimated by means of the fast Fourier transform (FFT) with a widow length of 256. The time lengths of the PPI series analyzed were 1 min, 3 min and 5min respectively to reveal the effect of recording length on the PSD of PRV.
c) Comparison of PRV and HRV: PSD of PRV and HRV were calculated before and after exercise. The time length of the PPI and RRI series analyzed was 5 min. Squared coherence spectrum between PRV and HRV was also calculated before and after exercise. The squared coherence spectrum Cxy(f) is a measure for evaluating how well a signal corresponds to another signal at each frequency. The Cxy(f) has values between 0 and 1, and the higher value indicates the higher correlation. The Cxy(f) of two series x and y is defined as the equation followed [5]:

(f) =

| ( )| () ()

(1)

where, Pxx(f) and Pyy(f) are the PSD of x and y, and Pxy(f) = X*(f)Y(f) is the cross PSD of x and y (*indicates the complex conjugate).
The coherence strengths between PRV and HRV at the LF and HF components were evaluated by calculating the mean squared coherence spectra at frequencies of the corresponding band. In this study, the LF band was defined as the frequencies between 0.04 and 0.15 Hz, while the HF band was between 0.15 and 0.4Hz, as described in [1]. The mean squared coherence spectra between PRV and HRV at LF and HF bands were respectively calculated for each of
the subject before and after exercise. After that, mean±SD of the mean squared coherence spectra were calculated for the 8 subjects.

III. RESULTS
Fig.2 shows a typical example of PSD of the PRV when time lengths of the PPI series analyzed increased from 1 min to 5min. It can be seen that time length of 1min is too short to reach a stable PSD with other time lengths (3min and 5min), while the PSD with time length of 3 min and 5min are almost the same. It indicates that PPI series with time lengths between 3 min and 5 min are suitable for analyzing the PSD of PRV.

PSD(ms2/Hz) PSD(ms2/Hz) PSD(ms2/Hz)

(A)PSD of PRV 2500

2000

1500

1000

500

0

0

0.5

Frequency(Hz)

(B)PSD of PRV 15000

10000

5000

0

0

0.5

Frequency(Hz)

(C)PSD of PRV 15000

10000

5000

0

0

0.5

Frequency(Hz)

Fig. 2: The effect of recording length on the PSD of the PRV. The record-
ing lengths of PPI-t series analyzed in (A), (B), (C) are 1min, 3min, and 5 min respectively. PRV indicates pulse rate variability; PSD, power spec-
trum distribution.

Fig.3 shows a typical example (the same subject as in Fig.2) of PSD of the PRV and HRV before and after exercise (the upper panel). The squared coherence spectrum between the same PRV and HRV is shown at the bottom panel. It can be seen that PRV corresponds well with HRV before exercise. However, the coherence strength turns a little lower at HF (0.15-0.4Hz) after exercise, while the LF (0.04-0.15Hz) component remains in high coherence.

PSD(ms2/Hz)

x 104 (A)PSD of PRV and HRV 2

PRV

1.5

HRV

1

0.5

PSD(ms2/Hz)

3000 2000

(B)PSD of PRV and HRV
PRV HRV

1000

0 0 0.1 0.2 0.3 0.4 Frequency(Hz)
(C)Coherence between PRV and HRV 1

0 0 0.1 0.2 0.3 0.4 Frequency(Hz)
(D)Coherence between PRV and HRV 1

Magnitude(dB)

Magnitude(dB)

0.5

0.5

0 0 0.1 0.2 0.3 0.4 Frequency(Hz)

0 0 0.1 0.2 0.3 0.4 Frequency(Hz)

Fig. 3: The PSD of the PRV and HRV and the squared coherence spectrum between PRV and HRV at each frequency. (A) (C): before exercise; (B) (D): after exercise. PRV indicates pulse rate variability; HRV, heart rate variability; PSD, power spectrum distribution.

Mean squared coherence spectra between PRV and HRV at LF component before and after exercise in 8 subjects are
0.9825±0.0329, 0.9805±0.021, respectively. The values are 0.9251±0.0596, 0.8538±0.1464 for HF component. As shown in Fig.4, it indicates that PRV and HRV correspond well in LF than in HF, the correlation turns lower in HF after exercise.

IFMBE Proceedings Vol. 42

