重庆大学硕士学位论文
心率变异性在汽车司机驾驶疲劳监测中应用 的研究
硕士研究生：刘 灵 指 导 教 师：邓小燕 教 授 学科、专业：生物医学工程
重庆大学生物工程学院
二 OO 七年四月

Master Dissertation of Chongqing University
Study on Application of Heart Rate Variability in Vehicle Driver Fatigue
Detecting
Master Candidate: Liu Ling Supervisor: Prof. Deng Xiaoyan Major: Biomedical Engineering
College of Bioengineering Chongqing University
April 2007

摘要
汽车司机的疲劳驾驶已经是引起交通事故的重要原因之一，目前，科学家 已经研究了多种驾驶疲劳监测的方法，如通过驾驶员的生理特征或个体特征， 通过车辆的行驶状态等。其中，利用心率变异性(Heart Rate Variability，HRV)信号 来监测汽车司机的疲劳状态是一种无创、方便、快捷的方法。本论文通过分析 HRV 的时域特性、频域特性及非线性特性，探讨了 HRV 指标在疲劳驾驶监测中应用的 可行性与适用程度，为疲劳驾驶监测的研究提供一些新的手段和方向。
本文首先采集了 20 组模拟驾驶时的心电数据，对心电信号进行重采样、低通 滤波后，利用阈值法进行 R 波检测，最后得到精度较高的 RR 间期序列，即 HRV 信号。在总结和研究了时域、频域及非线性分析方法的基本原理后，比较了三种 方法的参数优缺点，选定三种分析方法各自的参数指标：(1) 时域指标：MEAN(RR 间期均值)，SDNN(RR 间期标准差)，rMSSD(相邻 RR 间期差值的均方根，反映 HRV 的快速变化)；(2) 频域指标：LF(低频功率)，HF(高频功率)；(3) 非线性指标： D2 (关联维数)，LE (Lyapunov 指数)。在 MATLAB 软件平台上，研究驾驶过程中的 HRV 信号各种指标的变化情况，得出了以下结论，随着疲劳程度的加深：(1) MEAN、rMSSD 没有显著变化(P>0.05)，SDNN 显著增大(P<0.05)，反映 HRV 的总 和增大；(2) LF 显著上升(P<0.05)，HF 显著下降(P<0.05)，反映交感神经活动增强， 迷走神经活动减弱；(3) 关联维数与 Lyapunov 指数都显著下降(P<0.05)，反映了产 生 HRV 信号的非线性心脏系统的复杂性和混沌程度降低，说明需要更少过去值或 随机影响起作用。这些指标的变化趋势表明 HRV 可以作为评价驾驶疲劳的一种手 段，它不仅可以正确反映驾驶员是否疲劳，而且可以大致判断驾驶疲劳的程度。
根据结论可以得出通过 HRV 判断汽车司机驾驶疲劳的评价标准，对 HRV 信 号进行三种方法的综合分析，结合了线性分析与非线性分析的优点，使得疲劳评 价更加准确，是一种十分有研究价值的手段。HRV 在汽车司机的疲劳监测中的应 用有广阔的实际应用与研究前景。
关键词：心率变异性，驾驶疲劳，时域分析，频域分析，非线性分析
I

ABSTRACT
Fatigue driving of vehicle drivers has been one of the factors that lead to traffic accidents. There're many methods to detect the driving fatigue, such as the way by the physiological or individual characteristics, and the way by the running status of vehicle. Among all these techniques, it's a noninvasive, convenient and rapid way to detect the fatigue state of vehicle driver using HRV (Heart Rate Variability) signals. The paper analyzed the time domain, frequency domain and non-linear specialities, and discussed the feasibility and application of the HRV indexes in the fatigue driving monitoring. The paper provided some new means and measures of the research on the fatigue driving monitoring of vehicle drivers.
The paper collected 20 groups of electrocardiosignal during simulative driving firstly. Then the electrocardiosignal was resampled and passed the low-pass filter. After detecting R-wave using the threshold method, a high precision RR interval sequence, namely HRV signal was obtained. Summarizing and studying the postulate of time domain, frequency domain and non-linear analysis methods, and comparing the merits and faults of these three means, the individual parameters were chosen: (1) Time domain index: MEAN (average of RR interval), SDNN (standard deviation of RR interval), rMSSD (root-mean-square of difference-value of adjacent RR interval); (2) Frequency domain: LF (low-frequency power), HF (high-frequency power); (3) Non-linear index: D2 (correlation dimension), LE (Lyapunov exponent).
The variation of each HRV signal index during driving was studied by the MATLAB software. Hereby it comes the conclusion as follows, along with the deepening of fatigue degree: (1) MEAN and rMSSD remained almost the same (P>0.05), while SDNN observably increased (P<0.05). It shows that the sum of HRV enlarged. (2) LF observably increased and HF observably dropped (P<0.05). It indicates that the function of sympathetic nerve boosted, while pneumogastric nerve wakened. (3) Correlation dimension and Lyapunov exponent declined obviously (P<0.05). It implies that the complexity and chaos degree falls, and it needs less past value or random effect to function. All the changing trend of these indexes shows that HRV can be a means for driving fatigue evaluating. HRV can not only estimate whether the driver is fatigue, but also judge the driving fatigue degree approximately.
According to the conclusion, the estimate standard of vehicle driver’s driving
II

fatigue by HRV can be gained. This means use these three methods at the same time, make use of merits of linear and non-linear analysis. It makes the fatigue evaluation more exact and so it’s a valuable technique. Study of HRV in the application of the monitoring of vehicle driver’s fatigue has wide practice application and study foreground. Keywords： Heart rate variability (HRV), driving fatigue, time domain analysis,
frequency domain analysis, non-linear analysis
III

目录
中文摘要...................................................................................................................................... Ⅰ 英文摘要...................................................................................................................................... Ⅱ 1 绪论 .............................................................................................................................................. 1
1.1 问题的提出及研究意义 .......................................................................................................... 1 1.1.1 问题的提出 ....................................................................................................................... 1 1.1.2 研究的意义 ....................................................................................................................... 1
1.2 国内外研究现状 ...................................................................................................................... 2 1.2.1 通过监测司机的生理信号评价司机的疲劳状态............................................................ 2 1.2.2 通过监测司机的个体特征评价司机的疲劳状态............................................................ 2 1.2.3 通过监测车辆的参数评价司机的疲劳状态.................................................................... 3 1.2.4 国际上近期研制的驾驶疲劳监测装置............................................................................ 4
1.3 本课题研究的目的和研究内容 ...................................................................................................4 1.3.1 本课题的研究目的 ........................................................................................................... 4 1.3.2 本课题的主要研究内容 ................................................................................................... 5
2 心率变异性的生理学基础 .............................................................................................. 6
2.1 心率变异性的概念 .................................................................................................................. 6 2.2 心率变异性的生理基础 .......................................................................................................... 6
2.2.1 自主神经系统对心率的调节 ........................................................................................... 6 2.2.2 自主神经失衡与心率变异性的变化................................................................................ 7 2.3 心率变异性的应用 .................................................................................................................. 7 2.3.1 心率变异性在健康人群中的应用.................................................................................... 7 2.3.2 心率变异性在医学领域中的应用.................................................................................... 9
3 心率变异性信号的采集 ................................................................................................ 11
3.1 心率变异性信号采集系统结构 ............................................................................................ 11 3.2 ECG 数据的采集 ................................................................................................................... 11
3.2.1 心电信号基础知识 ......................................................................................................... 11 3.2.2 心电信号的采集 .............................................................................................................. 12 3.3 ECG 数据的预处理 ............................................................................................................... 13 3.3.1 心电信号的重采样 ......................................................................................................... 13 3.3.2 低通滤波预处理 ............................................................................................................. 13 3.4 R 波检测与 HRV 信号 .......................................................................................................... 15
IV

3.4.1 差分阈值法 ...................................................................................................................... 16

3.4.2 模板幅频匹配法 .............................................................................................................. 20

3.4.3 小波检测法 ...................................................................................................................... 20
4 心率变异性信号的分析 ................................................................................................ 22

4.1 心率变异性信号的时域分析 ................................................................................................ 22

4.2 心率变异性信号的频域分析 ................................................................................................ 24

4.2.1 心率变异性的频域分析方法 ......................................................................................... 24

4.2.2 AR 谱估计法 .................................................................................................................... 27

4.2.3 心率变异性的频域分析指标 ......................................................................................... 29

4.3 心率变异性信号的非线性分析 ............................................................................................ 30

4.3.1 非线性分析的基本概念 ................................................................................................. 30

4.3.2 HRV 混沌行为的生理机制 ............................................................................................. 31

4.3.3 状态空间的重构 ............................................................................................................. 31

4.3.4 HRV 的非线性分析参数 ................................................................................................. 32
5 研究结果 ................................................................................................................................ 37

5.1 实验方法 ................................................................................................................................ 37

5.2 实验结果与分析 .................................................................................................................... 37
6 结论与展望 ............................................................................................................................ 45

6.1 主要结论 ................................................................................................................................ 45

6.2 后续研究工作的展望 ............................................................................................................ 45

致

谢...................................................................................................................................... 47

参考文献...................................................................................................................................... 48

附

录...................................................................................................................................... 53

V

1 绪论
1.1 问题的提出及研究意义
1.1.1 问题的提出
疲劳是由于人们长时间工作而导致工作能力暂时下降的规律性生理现象，在 疲劳产生的初期，由于意志的力量，人还能够强迫自己仍按原有意图进行操作， 但工作状态会受到很大的影响，特别是在道路交通状态发生突然变化等情况下， 处于疲劳状态下的驾驶员，容易发生交通事故。
据统计，我国因疲劳驾车而造成的交通事故占总起数的 20％左右，占特大交 通事故的 40％以上，占交通事故死亡率的 83％；美国国家工具交通安全管理局保 守估计，每年因疲劳驾驶导致的车祸至少有 10 万起；法国国家警察总署事故报告 表明，因疲劳驾驶导致的意外占人身伤害事故的 14.9%、死亡事故的 20.6%；2001 年，在美国进行的一项调查发现，有 53%的被调查者曾在驾驶时打过瞌睡；2003 年，赛诺菲—圣德拉堡发起的驾车者警觉度测试和问卷调查结果显示，516 名驾驶 者中，24%感觉有疲劳驾驶，10%调查当天驾车时打过瞌睡，50%回忆在驾车时打 过瞌睡[1,2,3]。
统计数据显示，驾驶员疲劳已和酒后驾驶一样，成为交通事故的主要隐患， 所不同的是，酒后驾驶很容易被检测出来，而驾驶疲劳则具有相当的隐蔽性，因 此，运用车载多传感器实时获取并监视驾驶行为与驾驶员生理信息，利用这些信 息判断车辆行驶的交全性，并采用相应报警和防护措施，以减少由于驾驶疲劳而 导致的道路交通事故已经成为国内外专家和学者研究的热点，也是智能运输系统 研究的一个重要领域。但是目前的疲劳检测仪器由于技术上的限制，还存在成本 高、不利于实时监测等缺点，没有进行商品化生产。
1.1.2 研究的意义
利用心率变异性(HRV)信号来监测汽车驾驶员的疲劳状态是一种无创、快捷的 方法。本课题在学术研究与实际应用方面，① 研究了心率变异性的时域、频域特 性与驾驶疲劳程度的关系。② 心率变异性的非线性分析是目前一种新的分析方 法，心率波动呈现显著的非线性动力特性。心率、血压、呼吸运动是由几个中枢 神经系统调节、控制的，这些系统间的相互作用会产生非周期时间过程，但这些 呈现随机性的时间过程却有着良好的确定性动力系统特性。利用心率变异性的非 线性特征对驾驶疲劳程度进行分级。③ 将心率变异性的三种分析方法结合起来， 可以进行更准确的监测。
1

1.2 国内外研究现状
研究人员对疲劳驾驶的监测方法和装置进行了深入的研究，发现了多种与驾 驶疲劳有关的，目前，主要有几下三类：
1.2.1 通过监测司机的生理信号评价司机的疲劳状态
① 脑电信号(EEG)。研究者发现，脑电波的主导节律可以反映人体的疲劳程 度。开始作静态施力活动时，α节律减少或消失，β节律加强。随着时间的延长， 疲劳发展，出现θ波δ波，表明大脑皮层受到抑制。施力活动结束后，随疲劳的消 除，慢波渐渐消失，β节律也逐渐减少，α节律随之恢复。澳大利亚的Saroj KL Lal 和Ashley Craig[2]对35名非专业驾驶员进行试验，以他们在清醒状态下的平均EEG 活动为基准，分析得出了他们在清醒、接近疲劳、疲劳、极度疲劳和从疲劳中警 醒这5个不同阶段脑电图的变化特点。我国浙江大学的王炳浩等[3]用KT98-2000A动 态脑电仪描记了健康的驾驶员驾车行驶时的动态脑电波，并同静止条件下，睁眼 坐在椅子上得到的清醒状态和瞌睡状态的脑电波进行对比，得到了判断驾驶员是 否处于疲劳状态的依据。
脑电信号一直被誉为监测疲劳的“金标准”，但需要在头上粘贴电极，并且脑电 信号容易受外界因素的干扰且个体间的生理反映差距较大，价格过高，因此还没 有投入实际运用。作为对比方法，它为我们提供了测量的标准。
② 心电信号(ECG)。心电指标包括心率指标和心率变异性指标，是判断驾驶 疲劳的一项重要的生理指标。Lee, D. H.与 Park, K. S[4]将附加任务分为两种：重体 力负荷轻度精神负荷及重精神负荷轻度体力负荷，以减少互相之间的影响，并采 用了多变量回归分析方法。结果表明，精神负荷的增加会使 HRV 信号降低，但对 HR 信号的影响不明显；随体力负荷的增加，HRV 降低的同时，HR 信号也显著提 高。上海交通大学的杨渝书等[5]采集 16 名被测试者在实验室模拟驾驶操作 90 分钟 的心电信号，并对实验开始和结束时的 15 分钟时段心电信号的 7 项时频域指标进 行分析，发现有 4 项心电时频域指标与疲劳程度明显相关。
③ 肌电信号(EMG)。脑力疲劳的测量可用诱发电位的方法，在肌肉表面固定 好表面电极，肌电信号经表面电极传至肌电图记录仪。可以看出，肌电图的频率 随着疲劳的产生和疲劳程度的加深呈现下降趋势，而肌电图的幅值增大则表明疲 劳程度增大[6]。
1.2.2 通过监测司机的个体特征评价司机的疲劳状态
① 瞳孔测量计。瞳孔测量计是实时地测量眼睛的瞳孔尺寸变化的装置，根据 瞳孔的变化关系来评测疲劳度。Circadian Technologies，Inc.的Anneke Heitmann等 [7]通过实验分别测量了人在清醒和瞌睡时瞳孔直径大小，得出人在清醒时瞳孔直径 保持相对稳定，而在瞌睡时瞳孔缩小的结论，并以此作为判断驾驶疲劳的评价标
2

准。瞳孔测量计可测量瞳孔直径随时间的变化，因此，睁闭眼的参数也容易得到。 ② 眼动信号。目前大部分研究驾驶疲劳的机构都采用 PERCLOS(Percent
Eyelid Closure，眼睛闭合时间占特定时间的百分率)作为生理疲劳程度的测量指标。 眼动信号的记录与分析应用较多的是有关视觉负荷及视觉疲劳的研究。人在疲劳 瞌睡时，眼睑的眨动一般较频繁，眼睛闭合时间也较长。
2000 年 1 月明尼苏达大学的 Nikolaos P 与 Papaniko lopoulos[8,9]成功开发了一 套驾驶员眼睛的追踪和定位系统，通过安置在车内的一个 CCD(电子耦合组件)摄 像头监视驾驶员的脸部，通过追踪多幅正面及侧面脸部特征图像来监控驾驶员是 否疲劳驾驶。在国内也有多家研究单位开展了驾驶疲劳的研究，如吉林大学的王 荣本与北京农业大学郑培等[10]，利用机器视觉的方法对驾驶员的眼睛特征进行实 时跟踪从而判断驾驶员的精神状态。
③ 头部位移传感器。其主要是通过监视驾驶员在行驶过程中头部的位移情况 来判断其是否在打瞌睡。由 ASCI(Advanced Safety Concepts Inc.)研制开发的头部位 置传感器(Head Position Sensor)可精确测量驾驶员头部位置。该装置是设计安装在 驾驶员座位上面的一个电容传感器阵列，每个传感器都能输出驾驶员头部距离传 感器的位置，利用三角函数就可以计算出头在 X，Y，Z 三维空间中的位置，也能 够实时跟踪头部的位置，同时利用各个时间段头部位置的变化特征，可以判断出 司机是否在打瞌睡[11]。
④ 监测司机驾车动作的稳定性和协调性。上海交通大学的石坚等[12]通过传感 器测量驾驶员驾驶时方向盘、踏板等的运动参数来判别驾驶员的安全因素，发现 方向盘的操纵情况与驾驶员的疲劳程度具有一定的联系，通过模糊神经网络方法 对驾驶员疲劳程度进行辨识和分析。
1.2.3 通过监测车辆的参数评价司机的疲劳状态
① 监测方向盘运动。由于当驾驶员感到疲劳时，反应变慢，操作方向盘的动 作也会减缓。美国 Electronic Safety Products 公司开发的方向盘监视装置 S.A.M. (steering attention monitor)是一种监测方向盘非正常运动的传感器装置，适用于各 种车辆。方向盘正常运动时传感器装置不报警，若方向盘持续 4s 不运动，S.A.M. 就会发出报警声，直到方向盘继续正常运动为止。S.A.M.被固定在车内录音机旁， 方向盘下面的杆上装有一条磁性带，用以监测方向盘的运动[13]。
② 监测车辆行驶方向。驾驶员疲劳驾驶时，由于注意力分散、反应迟钝，车 辆可能偏离车道。美国Ellison Research Labs实验室研制的DAS2000型路面警告系 统(The DAS2000 Road Alert System)就是一种设置在高速公路上用计算机控制的红 外线监测装置，当车辆偏离道路中线时，会向驾驶员发出警告；此外，也有研究 者在车辆的前端安装摄像头，用来测量车辆离开白线的时间和程度，并向驾驶员
3

报警[14]。缺点是要求白线清晰，夜间测量容易失败。
1.2.4 国际上近期研制的驾驶疲劳监测装置
除了上述三类监测方法，国际上还推出了几种研制成功的驾驶疲劳监测装置， 其中已经有成型的产品推向市场。
① 英国Loughborough大学睡眠研究中心的科学家研制了一项名为“疲劳司机 警报系统(ASTiD)” 的新型电子设备。该系统将一些常见因素作为参考系数，如由 于司机睡眠造成的交通事故高发期、车辆行驶状况及司机持续驾驶的时长等。一 旦司机昏昏欲睡，声音和图像警示器将对他们提出警告[15]。
② 澳大利亚墨尔本奥斯汀医院的睡眠专家马克·霍华德[16]带领一个科研小组 研制了一种疲劳警示器，可以尽早对司机提出疲劳警告。这种眼睛式的警示器里 安装了红外线传感器，能测量眼睑的活动和眨眼的速度，然后在司机还没意识到 自己已经疲劳的时候对他们提出警告。
③ 瑞典汽车厂商沃尔沃推出了一项“驾驶员警示系统”[17]，系统能够不断监测 车辆的行驶过程，并且判断车辆是处于有效控制状态还是处于失控状态。沃尔沃 的这款警示器设计也存在一定不足，因为它要参照公路上的各种线来辨别车辆的 行使状态，所以一旦路面状况不好，比如下雪、大雾等天气，还有路面有损伤等 情况，该疲劳驾驶警示器的误报率就会很高。
④ 日本一家公司研制出一种通过化验唾液测量人体疲劳程度的手持式仪器 [18]，将人的一点唾液放在芯片上，再将芯片粘贴到仪器上,一分钟之内便可检查出 你的疲劳程度。这种仪器可以检测出唾液中淀粉酶的含量，人处在身心压力下， 这种酶的含量就会增加。这种疲劳测量仪的重量仅为190克,可随身携带。
⑤ 瑞士的一家汽车设计公司则专门针对疲劳驾驶推出了一种驾驶室[19]。这辆 驾驶室采用了最新的“灵敏表面技术”以及各种先进的发光薄膜材料、传感器等，驾 驶员需要在手腕上佩戴一个生物统计测量表，以测量其脉搏变化，而安装在车上 摄像头将监测汽车的速度，变线频率以及和前车的距离，所有这些传感监控数据 都将汇总到车载电脑中，电脑对驾驶员的精神状态做出快速评估，并迅速启动应 对程序。
1.3 本课题研究的目的和研究内容
1.3.1 本课题的研究目的
建立以心率变异性为指标的驾驶疲劳分级系统。本文进行了疲劳测试系统的 编程，可用于疲劳检测仪器，随时监控驾驶员的疲劳程度，以减少由于疲劳驾驶 引起的交通事故，另外也将本检测仪应用于运动员及其他易疲劳人群的疲劳检测， 帮助人们掌握自己的疲劳状况，针对性的采取应对措施。
4

1.3.2 本课题的主要研究内容
① 信号的采集与处理：本系统采用了心率变异性作为疲劳分级的指标，对采 集到的信号心电信号进行处理，提取心率变异性信号。
② 信号的分析：对处理后的心率变异性进行时域、频域及非线性分析。心率 变异性的时域指标有：meanRR(RR 间期均值)、SDNN(RR 间期标准差)、rMSSD(相 邻 RR 间期差值的均方根)；心率变异性的时域指标有：TP(总功率)、LF(低频功率)、 HF(高频功率)；心率变异性的非线性分析指标有：关联维数、Lyapunov 指数。
③ 统计分析：将所有样本的指标进行统计分析，并综合分析心率变异性与疲 劳的关系，根据分析结果进行合理的疲劳分级。
④ 编制程序：本系统采用 MATLAB 语言进行编程、分析，MATLAB 的功能 强大，带有世界一流的函数库和工具包，具有强大的计算功能，编程效率高。
5

2 心率变异性的生理学基础
2.1 心率变异性的概念
心率变异性(Heart Rate Variability, HRV)是指逐次心跳间期之间的微小差异，由 此计算出的单一数值即包括交感和副交感两种影响，它反映了心脏自主神经系统 (Autonomic Nervous System, ANS)及呼吸调控功能。心脏正常活动有赖于交感神经 (SNS)和副交感神经(PNS)的冲动输入的平衡，SNS 活动增强及副交感活动减弱， 可引起心律失常。HRV 减小只不过是副交感影响相对或绝对减少的一种简单反映。 故 HRV 是研究 SNS 及 PNS 之间平衡状态的一种简单、有益的检测方法[20]。
在正常情况下，心律受起搏传导系统所控制，窦房结是心脏的最高起搏点， 它的活动受到植物性神经系统的调节。交感神经末梢释放出去甲肾上腺素，兴奋 心肌细胞膜的 β 肾上腺素能受体，增加内向 isi 和 if 离子流(主要由 Ca2+和 Na2+携 带)，使舒张期除极速率加快，自律性增高，心率增快。迷走神经末梢释放乙酞胆 碱，作用于心肌细胞膜的 M 胆碱能受体，提高 K+通道的通透性，促进外向 ik 离 子流，使窦房结细胞过度极化和舒张期除极速率减慢，自律性降低，心率减慢[21]。
2.2 心率变异性的生理基础
2.2.1 自主神经系统对心率的调节
心脏的自律性是心脏起搏组织的固有特性，但心率和节律在很大程度上受着 自主神经系统(ANS)的调控。迷走神经通过释放乙酰胆碱实现副交感神经(PPS)对 心率的影响。首先乙酰胆碱与覃毒碱乙酰胆碱受体结合，通过使细胞膜对钾离子 的通透性增加等一系列生物电活动而实现其效应。另外，乙酞胆碱也抑制超极化 激活的“起搏”电流 If。“Ik 衰减”学说认为，Ik 为引起舒张期去极化的一种时间依存 性整流内向电流。起搏细胞的去极化则起源于迟发整流离子流的缓慢失活。相反， “If 激活”学说提出，动作电位结束之后，If 提供的缓慢激动的内向电流超过衰减的 Ik，由此而发生缓慢性舒张期去极化。
交感神经(SPS)是通过释放肾上腺素和去甲肾上腺素影响心率的。交感神经兴 奋释放的甲肾上腺素，首先激活 β 肾上腺素能受体，然后 cAMP 生成，ICaL 和 If 增强，加速舒张期缓慢去极化。在静息状态下，心动周期的变化主要依赖于迷走 神经的调控作用，刺激交感神经使心率变化较为缓慢，心率明显增加需 20 秒或更 长时间，刺激迷走神经使心率变化较快，心率减慢在 1 至数个心搏中完成[22]。这 使迷走神经在心率控制中起主要作用。同时实验中还观察到，中止刺激交感神经 时，其作用逐渐消退，而中止刺激迷走神经后，反应突然消失。这是由于其神经
6

递质各自被降解的方式和速度不同，由此不难理解，迷走神经兴奋时，HRV 增大， 迷走神经功能受损时，HRV 减小[23]。SPS 与迷走神经自始至终保持着相互作用。 因为窦房结内富含乙酰胆碱醋酶，后者能迅速裂解乙酰胆碱，所以迷走神经的活 性仅能维持短暂的时间，PPS 对心率的调控作用比 SPS 更为显著，可能为以下两 个独立机制：其一，胆碱能神经活动减少 SPS 兴奋和去甲肾上腺素的释放量；其 二，胆碱能神经衰减肾上腺素能神经的反应程度[24]。
HRV 反映了窦性心率不齐的程度，它的产生主要是由于神经体液因素对心血 管系统精细调节的结果，反映神经体液因素与窦房结相互作用的平衡关系，体现 神经调节变化程度，而不代表神经紧张性(tone)。如临床研究发现安装有心脏起搏 器的患者 HRV 消失，表现为心率完全脱离了自主神经与体液调节[25]。早先研究认 为 HRV 主要与三个生理因素有关：呼吸、血压和温度控制。自主神经系统按日常 生理活动调节心血管功能，使心率昼夜不断变化。肾素-血管紧张素及其他体液因 素按新陈代谢的需要调节心血管功能，使心率的变化呈现更长周期的规律性。
2.2.2 自主神经失衡与心率变异性的变化
在生理条件下，总体心率变异性的大小与心脏交感神经、迷走神经张力平衡 的改变一致。在心脏自主神经对窦性心律调节作用强、心率快慢范围大时，总体 心率变异值增大，反之则其值变小[26]。但是，某些病理条件下，心脏自主神经系 统平衡变化与心率变异性的改变并不完全一致。应用抗胆碱能药物完全阻滞迷走 神经，使迷走神经几乎失去对心脏的调节作用，心率基本保持稳定，其快慢变化 几乎消失，心率变异性各项值几乎全部趋向于零[27]。在血压极度升高的状态下， 迷走神经极度兴奋几乎达到饱和状态，窦性心律减慢到某一水平趋于稳定的状态 而心率变异性各项值也同样趋于零。急性下壁心肌梗塞时，心脏交感、迷走神经 同时兴奋，窦性心率可无明显变化或因迷走神经作用占优势而减慢，心率变异性 则可以出现多样化的改变。目前对心率变异性现象和其生理基础的认识，主要在 动物实验和对健康志愿者的观察中获得。心脏自主神经对的窦性心率的调节过程 中，病理条件下心率变异性成分改变的生理学基础则可能更加复杂多变，至今仍 未完全明了[28]。因而，病理条件下的心率变异性改变不应简单以对生理条件下变 化的理解来判断其实际意义。
2.3 心率变异性的应用
2.3.1 心率变异性在健康人群中的应用
将 HRV 应用于健康人群，有研究表明，长期和短期的吸烟、过量饮酒、肥胖 都可能引起 HRV 的改变，交感神经活性增加，迷走神活动性降低，这种改变可 能与心血管疾病的发生有关[29,30]。
7

① 用于精神负荷的测量 在加载精神负荷时，HRV 将减少；精神负荷越大，HRV 越低。因此 HRV 就 被看作是精神负荷量的一项指标。但并非 HRV 所有频率成分都对精神负荷同样地 敏感，事实上只有 0.1Hz 左右的低频部分对精神负荷最敏感[31]。廖旺才等的研究 结果表明，加载精神负荷后受试者的 HRV 的 3 个非线性参数都有不同程度的降低。 进一步分析还发现分解后的 HRV 的 3 个非线性参数和受试者的心理生理储备有一 定的相关性，有可能做为衡量心理储备的 1 项指标[32]。但刘旭峰等对焦虑特质与 HRV 及心率的相关性进行过研究，结果表明，用生理指标对焦虑进行评价，指标 的敏感性缺乏 [33]。 ② 用于海军及航空航天医学领域 核潜艇潜航时其内部环境存在诸如：核辐射、高温、密闭、隔离、空间狭小、 噪声大、工作时间长、潜航不分昼夜等因素，加上航行时艇员处于职业应激状态， 极易疲劳，心理健康水平降低，均可能会影响交感、副交感神经对心脏的调节以 及体液因素，从而使 HRV 出现变化。徐公国等[34]对某潜艇部分艇员的心率变异 性进行了分析，探讨潜航对它的影响大小。据调查结果，航行前、航行中、返航 后艇员 HRV 时域分析指标虽有些改变，但经统计学分析差异无显著性，表明了 20~30d(昼夜)潜航对艇员心脏交感、副交感神经调节无明显影响。 HRV 的测定对评价飞行员和航天员自主神经功能的均衡性有重要意义，作为 评价这一功能的指标，HRV 被广泛用于飞行员的选拔和飞行劳动负荷强度的评价。 在航天飞行中由于航天员要经受许多特因因素的作用如超重、失重，这时人体的 生理机能出现一系列与之适应的变化，这其中心血管方面的研究又是引人注目的 一个方面。随着 HRV 在该领域的应用研究的深入，人们可能发现一些潜在的循环 系统自主神经的机理变化以对抗或减轻特因作用。 ③ 用于评价各种有害因素对人体的影响 有研究证实，手传振动会引起静息状态和深呼吸状态的 HRV 降低，提示振 动作业工人迷走神经受损，振动职业的危害可能造成植物神经的紊乱。局部振动 引起植物神经功能紊乱(表现为交感神经功能亢进、副交感神经功能下降)，但局部 振动对血压影响的实验研究和调查结果却不一致。交感神经功能亢进、迷走神经 功能抑制在高血压的发病机制中占有重要地位，表现为 HRV 的减小[35]。 李福敏等观察分析了客运机车乘务员工作过程中的心率变异性(HRV)。结果说 明铁路提速对机车乘务员的交感神经有轻度影响，对迷走神经影响不大，也就是 说提速对机车乘务员的神经紧张性和均衡性影响不明显。从检查结果看，HRV 可 以明确的、客观的反映出机车乘务员在不同状态下的心率变异情况，所以从检查 结果和记录过程不受主观感觉影响、无创性以及不影响乘务员工作来看，HRV 作
8

为检查铁路机车乘务员神经负荷的指标方法，有一定的适应性[36]。 研究表明，二硫化碳可通过抑制单胺氧化酶的活性，使儿茶酚胺代谢紊乱。
儿茶酚胺代谢紊乱又致使机体内环境遭到破坏，自主神经功能紊乱在二硫化碳作 业工人是完全有可能的。有研究标明，随着工龄的延长，接触二硫化碳的工人的 心率变异性降低，交感神经亢进和迷走神经功能降低[37]。
2.3.2 心率变异性在医学领域中的应用
① 急性心肌硬塞与心脏猝死：HRV 分析可作为一种无创性测量急性心肌梗塞 患者心交感、迷走神经活动水平及其均衡性变化的有效方法，对急性心肌梗塞、 心脏猝死发生机理的研究及临床治疗、监护、预后评价均具有临床意义。目前认 为，HRV 降低是急性心梗后死亡危险的预测指标：SDNN<50ms 及 HRV 三角指数 <5，HRV 指数降低较多，SDNN<100ms 及 HRV 三角指数<20，HRV 适度降低。当 病人 SDNN<50ms 或 HRV 三角指数<15 时很危险[38]。
② 高血压病：有足够的流行病学证据支持自主神经系统在高血压发展和血压 调节中起重要作用[39]。从弗雷明翰队列研究[40]和其它的病例对照研究表明高血压 患者 HRV 异常。Guzzetti 等[41]研究表明，原发性高血压心率功率谱低频峰功率谱 密度明显增高，高频峰功率谱密度明显降低，心率功率谱变化与高血压的程度显 著正相关。1994 年 Langewitz 等[42]应用病例对照研究了 41 名临界高血压病人，34 名高血压病人及 54 名正常人，发现高血压时副交感神经活动减弱。
③ 糖尿病：Spallone 等分析发现糖尿病合并自主神经病变者其白天 LF、夜间 HF 成分均减少，HF 昼夜变化减少,HFLF 比值昼夜变化亦减少。周建华等研究发 现糖尿病合并自主神经病变与不合并者相比 HRV 显著降低，且敏感性较高， SDNN<30ms 作为糖尿病合并自主神经病变的指标，敏感性是 80.0%，特异性 84.2%。宋滇平[43]等研究表明糖尿病患者 HRV 减少，心脏自主神经系统失衡，交 感神经张力增高，副交感神经活动相对降低，相关分析显示糖尿病患者的糖化血 红蛋白浓度和周围神经平均传导速度与其 HRV 之间存在关联。
④ 分析某些治疗的疗效：Hogue 等分析了 40 例择期性冠脉搭桥(CABG)病人 围术期 HRV 的改变，发现排除心肌缺血、药物、心功能改变等因素的影响，在麻 醉诱导后，HRV 的三项指标(LF、HF 及 TP)较术前显著降低；术后 CABG 病人的 HRV 持续降低，直到第五天。术后 HRV 的持续降低可能影响病人的预后。HRV 测量可作为术后心功能紊乱的早期诊断手段。
⑤ 其它方面的应用：Hayano 等[44]应用心率谱研究发现，长期吸烟可导致心脏 交感神经活性增加、副交感神经活性降低，是冠心病的一个危险因素。Fallen 等[45] 对心脏移植病人的心率功率谱进行了分析，发现心脏移植病人的 HRV 明显减小或 消失，一旦出现排斥反应，HRV 将明显增加，认为心率功率谱是判定移植心脏神
9

经调节状态的唯一方法。Farrazz 等[46]观察妊娠 36 周时子宫内胎儿的心率功率谱与 成人相似，在呼吸暂停时心率功谱高频组分消失，认为心率功率谱在胎儿发育及 产程监测中起重要作用。此外，HRV 分析对脑死亡的判断、脑外伤病人的术前、 术后评估及监测等也有重要应用价值。
10

3 心率变异性信号的采集

3.1 心率变异性信号采集系统结构
本系统通过对采集的心电数据的分析处理，包括预处理(低通滤波)、R 波的检 测、HRV 分析，得到时域、频域、非线性指标的变化趋势，进而对疲劳等级分级， 把分析结果通过二极管和蜂鸣器实时反馈给分析对象，实现对分析对象的提醒和 报警工作。软件处理部分用 MATLAB 编写。系统结构框图见图 3.1：

HRV RR
R
ECG

疲

数 据 采 集

预 处 理

波 检 测

间 期 序 列

分 析

劳 的 分 级

图 3.1 心率变异性的采集及分析流程 Fig 3.1 Collection and analysis route of HRV
3.2 ECG 数据的采集
3.2.1 心电信号基础知识
心脏在每个心动周期中，由起搏点、心房、心室相继兴奋，伴随着生物电的 变化，通过心电描记器从体表引出多种形式的电位变化的图形(简称 ECG)。心电图 是心脏兴奋的发生、传播及恢复过程的客观指标。用标准导联引出的心电图各波， 由荷兰生理学家 W．艾因特霍芬命名 P，Q，R，S，T 波，U 波是以后发现命名的 [47]。如图 3.1 所示为典型心电图及其各波形、时间段或间期。

图 3.2 心电信号波形 Fig 3.2 Waveform of ECG
11

3.2.2 心电信号的采集
① 样本：为避免年龄与疾病等外部条件对心率变异性的影响[48]，选取 20 个 样本参加实验，年龄在 22~30 岁之间，平均 25.6±2.8 岁，所有样本均身体健康并 且没有接受药物处理。
② 实验过程：采用赛车游戏模拟驾驶，实验中，样本手握方向盘，眼睛注视 前面的显示器，实验样本需要全神贯注的驾驶 120min。所有样本在实验前需要充 足的休息，在实验前 24 小时内避免剧烈运动及情绪激动，不饮含咖啡因、酒精的 饮料，近 2 周内未服用任何影响血压、心率的药物，实验时间为上午 8:00～12:00 点之间[49]。

图 3.3 RM6240 生理信号采集处理系统 Fig 3.6 RM6240 Multiple-channel collection and treating system of physiological signal
采用成都仪器厂研制的 RM6240 多通道生理信号采集处理系统(见图 3.3)来记 录模拟驾驶过程中的心率信号。由于监测的需要，采用的是加压导联，将四个电 极分别放在四肢上，对样本的心率信号进行采样，采样速率为 1000Hz，采集时间 为 1min，采集时间间隔为 15min。实验前后样本对自身的疲等级进行主观评估， 主观疲劳等级调查表如表 3.1 所示。

表 3.1 疲劳等级评价表

Table 3.1 Subjective fatigue rating

等级

主观疲劳描述

1

一点也不疲劳

2

有一些疲劳

3

比较疲劳

4

极度疲劳

12

3.3 ECG 数据的预处理
3.3.1 心电信号的重采样
由于本系统感兴趣的频率段频率成分较低，根据奈魁斯特(Nyquist)采样定理， 用两倍于一个正弦波的频率进行采样就能完全真实地还原该波形，因此选用 250Hz 的采样频率就已足够，需对原始信号重新采样，即将最初采集的心电数据经过重 新采样后再进行数据处理。
3.3.2 低通滤波预处理
本系统采用 Parks-McClellan 优化等波纹 FIR 滤波器对重新采样的心电信号进 行低通滤波，可以通过 MATLAB 自带的最优化法中的 remez 函数直接生成滤波器， 此滤波器能使实际频率响应拟合频率响应达到最优[50]。
① Parks-McClellan 算法：Parks 和 McClellan[51]提供了利用 Remez 交换算法导 出的迭代算法。它假设已知滤波器长度 M(或 L)和比率 δ1/δ2。如果选择了权函数， 也正确地选择了阶数 M，并且设 δ=δ2，这时，就可得到解。显然，δ 和 M 是相关 的，M 越大，δ 越小。滤波器技术指标中给出了 δ1、δ2、ωp 和 ωs，因此需要设定 M 的值。凯泽提出了—个简单的公式来逼近 M：

Mˆ = − 20 log 10 δ 1δ 2 − 13 + 1； ∆ f = ω s − ω p

14 .6 ∆ f

2π

(3.1)

Parks—McClellan 算法首先猜设(L+2)个极值频率{ ωi }，估计这些频率上的最

大误差，接着按(3.3)给定的各点，拟合一个 L 阶多项式(3.2)。然后在一个较细的

网格上确定局部极大误羌及其极值频率{ ωi }，由这些新频率点拟合出一个新的 L

阶多项式，重复以上过程。一直进行至找到最优集{ ωi }和全局最大误差 δ 为止。

此迭代过程保证是收敛的，从而得到多项式 P(ω)。根据(3.2)求出系数 β(n)，最后

算出系数 a(n)和脉冲响应 h(n)。
L
P (ω ) = ∑ β ( n ) cos n ω n=0

(3.2)

E(ωi

)

=

−E(ωi−1

)

=

±

max
S

E(ω)

∆ ± δ，∀ω0 < ω1 < " < ωL+1 ∈ S

(3.3)

由于 M 是近似的，最大误差 δ 可能不等于 δ2。如果出现这种情况，需要增加 M(若 δ>δ2)或减小 M(若 δ<δ2)，再次用 remez 算法确定一个新的 δ。重复此过程至 δ≤δ2。这样就得到了等波动滤波器，它满足前面讨论的三个要求。在 MATLAB 中， Parks—McClellan 算法的形式为 remez 函数。

13

② 心电信号的能量主要集中在 0.5～45Hz，其中 QRS 复合波的能量大部分 集中在 3～40Hz。本系统的低通滤波器的要求是：通带边界频率为 40Hz；采样频 率为 250Hz；通带波纹尽量小，至少小于 3dB；阻带衰减尽可能大，至少大于 30dB。 设计滤波器的幅频响应如图 3.4 所示：

(a) 滤波器的幅度响应 (a) Magnitude response of filter

(b) 滤波器的相位响应 (b) Phase response of ftlter

(c) 滤波器的系统函数 (c) System response of filter
图 3.4 滤波器幅频特性 Fig. 3.4 Magnitude and phase response of the filter
如图 3.5 所示为 ECG 信号通过滤波器前后的频谱图：
14

图 3.5 ECG 信号频谱图 （上图为滤波前 ECG 信号频谱图，下图为滤波后 ECG 信号频谱图）
Fig. 3.5 Frequency content of ECG signal (Upper is frequency content of ECG signal before filtration,
blow is frequency content of ECG signal after filtration)
3.4 R 波检测与 HRV 信号
HRV 可通过测量心电图中连续出现的正常 QRS 波群同期之间的变化(即连续 RR 间期的变化)来分析。由于反映窦性心律的心律周期其实是 PP 间期，因此，进 行 HRV 分析应测量连续出现的正常 PP 间期之间的变异数。但因 P 波不如 R 波尖 锐，PP 间期难以准确检测，而在一般情况下，PP 间期与 RR 间期相等。因此，实 际测定时均以 RR 间期代替 PP 间期。要想得到正确的 HRV 数据，就要获得逐次 心跳。因此，准确测量 R 波波峰发生的时刻是 HRV 信号采集的关键。
目前，R 波检测的方法繁多，诸如：差分阈值法[52]，模板匹配法[53]，小波变 换法[54]和神经网络法[55]等。差分阈值法算法简单，处理速度快，易于工程实现； 模板匹配法原理简单，但对高频噪声和基线漂移很敏感；小波变换法具有良好的 时频局域化特性，检测准确度高，但计算量较大，不适于实时处理；神经网络法 能够实现很好的判别效果，但训练时间较长，实际上很难应用。上述方法各有优 缺点，比较起来差分阈值法比较折衷，再加上预处理后检测效果较好，因此本系 统采用的是差分阈值法。下面对本系统所用的自适应差分阈值法的算法进行详细 讲解，并对另两种方法进行简单介绍。
15

3.4.1 差分阈值法
差分阈值法是一种快速算法，适合于对实时性要求较高的心电自动监护仪。 大多 Holter 系统用此算法来检测 QRS 特征波。其基本原理是：由于 QRS 特征波 是心电信号波形变化最为剧烈的地方，其对应波形的上升斜率或下降斜率与其他 波形的斜率相比显著不同，通过检测心电信号序列对时间的导数即斜率的变化来 定位 QRS 复合波的位置。通常在 R 波的上升沿和下降沿是心电波形斜率变化最大 的区域，中间出现的一阶导数过零点，二阶导数极值点为 R 点所在的位置。通过 对滤波后的信号应用一阶差分或二阶差分并与由实验获得的阈值相结合，确定出 QRS 特征波的起始点，再利用窗口和幅度阈值来确定 QRS 特征波的顶点。由于 R 波的波形变化率在一个心电波形周期中是最陡的，而基线漂移等干扰对差分值的 影响小，因此采用差分阈值法具有较强的抗干扰能力，可以提高 R 波的检出率。
使用差分阈值法的关键是要确定合理的检测阈值。但是 R 波的形态和幅值会 因检测对象的不同而有很大差异，故而很难找到一个适合众多检测对象的统一的 检测阈值。针对这一问题，通常采用简单的自学习算法[56]来建立检测阈值。然而 即使是同一个人，其正常心电波形态随时间也会发生变化心电信号的幅值、形态 等都会发生变化，R 波的差分也会随之变化。针对这一情况，应该使检测阈值能够 适应信号的变化，因此该文用自适应差分阈值法检测 R 波。具体算法步骤如下：
心电数据
差分运算
滑动窗积分
计算阈值和盲区
N
检测 R 波
Y 记录 R 波位置
图 3.6 R 波检测流程 Fig. 3.6 Detecting route of R-wave
16

① 差分：利用 R 波峰值的特点通过差分运算在 R 波波峰处形成一个极小点。

采样频率为 250Hz 的 ECG 的信号为 x(n)，差分公式如下：

y(n) = ABS(δ1 + δ 2 + δ 3 + δ 4)

(3.4)

式中，δk = x(n + k) − x(n − k)，k = 1,2,3,4 。

差分公式用 Z 函数来表示：

H (z)

=

1+

Z

−1

+

Z

−2

+

Z −3

− Z −5 Z −4

−

Z −6

−

Z −7

−

Z −8

差分器幅频响应如图 3.7 所示。

(3.5)

图 3.7 差分器幅频响应 Fig. 3.7 Magnitude and phase response of difference
从图中可以看出，选择上面的差分器处理数据，可以消除 50Hz 的工频噪声。 在心电图中，R 峰是一个明显的尖峰，而其他部分相对较为平坦对心电数据差分能 够使 R 峰更加突出；同时差分器相当于高通滤波器，可以消除基线漂移的影响而 基线漂移是心电分析中经常出现而且又对分析结果影响很大的一种干扰。T 波或是 干扰可以在幅度上接近 R 波，它们在差分后产生一个和 R 波差分幅度接近的峰， 在这样的情况下，就无法通过阈值检测与 R 波相区别，我们通过滑动窗积分来解 决这一问题。
② 滑动窗口积分：根据 R 波长度特点，以 R 波长度为窗长度进行滑动窗积分， 突出 R 波。差分后信号为 y(n)，滑动积分公式如下：
z(n) = [ y(n − N ) + y(n − (N −1)) + " (3.6)
+ y(n + (N − 2)) + y(n + (N −1))]/(2N ) 2N 等于 R 波长度约 40ms 乘以抽样率，本系统的心电信号采样率是 1000Hz， 则 N=5。 差分后可能有干扰的差分和 R 峰差分幅度接近；但是在积分后，干扰积分的 幅度被大大抑制了，其幅度小于 R 峰积分幅度的一半。所以可以很明显地区分 QRS
17

波和干扰。积分公式的选择也保证了最大值为止也基本对应了 R 峰位置。 图 3.8 是经过差分和积分运算后的心电波形：

图 3.8 心电数据的差分和积分 Fig. 3.8 Difference and integral of ECG digitals

③动态阈值：为了适应最近的 R 波幅度变化而自动调整阈值大小以便加快 R

波检出速度的方法称为动态阈值甄别。在动态阈值的调整过程中，当前 R 波检测

的阈值决定于此前 8 个 R 波检测阈值。如果在这个阈值下找不到 R 波，则逐步降

低阈值，以适应 R 波比较矮小的情况，同时规定一个最小阈值，当检测阈值低于

最小阈值后，就认为找不到 R 波。

设前 8 个 R 波的检测阈值分别为 Th(n)，n= -1, -2, -3, -4, -5, -6, -7, -8。那么当

前检测阈值调整为：

∑ Th(0)

=

7 64

⎡ ⎢⎣

−8 −1

Th(n)⎥⎦⎤

+

1 8

×

Max(Th(n))

(3.7)

④ 动态盲区：在检测到一个 R 波之后，通常可以自动跳过的一段数据，称为

盲区。这是因为 R 波间距存在一定规律。设置盲区节省了数据处理时间。盲区大

小应根据 RR 间期动态调整，以保证在一定的 RR 间期变化范围内不造成 R 波的漏

失。盲区的计算是在 R 波检出后，使用当前心率和采样率进行比较来确定一个调

整系数，然后盲区初值乘以调整系数，从而确定盲区大小。

18

盲区初始值根据采样率及最大、最小心率确定。算法假设样本的最大心率是

为 300/min，最小心率是 30/min，最大和最小心率的设定留有很大余量，概括了所

有的病人情况。最小盲区 MinBlind、最大盲区 MaxBlind、初始盲区 Blind 的大小

由以下公式确定：

Minblind = Freq / 300 = Freq

(3.8)

60 5

Maxblind = Freq / 30 = Freq × 2

(3.9)

60

Blind初始值 = Freq 2

(3.10)

其中 Freq 是采样频率(Hz)，心率单位是 R 波个数每分钟。最大盲区是指从当 前 R 波位置后的 MaxBlind 个采样点，这限定下一个 R 波检测的最大查找范围。如 果找不到 R 波，就认为当前 R 波之后 MaxBlind 个采样点内没有 R 波。最小盲区 是指在当前 R 波位置之后 MinBlind 个采样点，在最小盲区内是不可能有下一个 R 波。
如果在跳过盲区后变换阈值寻找 R 波失败，有可能是前一次计算出来的盲区 过大，就需要变换盲区再找 R 波。此算法采用取当前盲区的 (4-n) / 4 代替当前盲 区，n(n<4)为重试次数，当 Blind 调整到小于最小盲区后，就可以认为当前 R 波不 存在。如果检测过程中在较长时间中没有检测到 R 波，那么盲区的大小应保持原 有的大小。
图 3.9 为检测到的 R 波序列与 R-R 间期序列。对 20 个样本的所有心电数据进 行 R 波检测，该方法的准确率为 98.9%。

(a) R 波序列

(b) R-R 间期序列

(a) R-wave sequence

(b) R-R interphase sequence

图 3.9 R 波序列与 R-R 间期序列

Fig.3.9 R-wave sequence & R-R interphase sequence

19

3.4.2 模板幅频匹配法
通常的模板匹配法的实现方法是先建立一个 QRS 模板信号，然后被检信号与 其进行对齐，并比较。对齐是该算法的一个关键步骤，通常是利用求两信号间的 最大互相关系数进行信号对齐。这种模板匹配算法存在着对信号波形差异不敏感 的问题。
后来有改进算法采用估计模板信号的自相关函数和模板与被检信号的互相关 函数之间的相似度以及消除两相关函数最大值之间的时间延迟来完成模板的匹配 过程。首先是建立模板：包括使用一个可变宽度的时间窗从原始记录中挑选模板 信号，并求出其自相关函数。在预处理时，对每一段信号计算它与模板信号的互 相关。信号间的对齐是通过求每一互相关最大值与模板自相关最大值之间的时间 延迟来估计信号间的时间延迟，并用该延迟值调整被检信号相对于模板信号的位 置。在对齐完成后重新计算互相关，并计算出自相关与互相关函数间的差值函数。 该差值函数反映当前信号与 QRS 模板信号在各时间点上的形状差异。将差值函数 的最大值与自相关函数的最大值之比定义为差值系数 δ，它代表模板波与当前被检 波之间存在的最大形状差异。最后两信号间的相似程度由相似系数 γ=1－δ 估计。 在一定范围内当 γ 大于给定阈值时，说明被检信号为 QRS 复合波。
3.4.3 小波检测法
QRS 复合波、P 波和 T 波等是心电信号中典型的奇异部分。鉴于小波优良的 信号奇异点检测性能，基于小波变换来检测的心电特征波收到很多研究人员的关 注，许多基于小波的心电检测算法被提出，归纳起来，主要有：小波阈值检测法； 小波结合神经网络法；小波结合数学形态学法等。但目前基于小波的心电特征波 检测均没有很好的解决特征波的起始点和终止点的问题，也就不可能准确提取它 们的宽度信息和其他更深入的信息。下面分别对各种小波检测法的原理进行说明， 并浅析它们各自的优缺点。
① 小波阈值检测法。小波阈值法是根据心电信号经小波变换后，心电特征波 在某些尺度上对应有相对明显的模极大值对，通过设置合适的阈值来判断模极大 值对，进而检测出对应的特征波。小波阈值法通常根据模极大值对的起点和终点 作为 QRS 复合波的起点和终点来确定 QRS 复合波的宽度，以模极大值对的过零点 作为 R 波的峰点。这种方法可以较好的定位 QRS 复合波峰点，但对于 QRS 复合 波的起点和终点的准确定位还有待改进，并且对于低频低幅的 P 波和 T 波，仅仅 用小波阈值法很难实现准确检测。
② 小波结合神经网络法。神经网络具有很强的自适应学习能力、鲁帮性和容 错能力，基于神经网络白化匹配滤波器的 QRS 复合波检测，正确率可以达到 99.2%。 但其计算过于复杂，实时性较低。基于小波和神经网络相结合的方法是：先用小
20

波分析提取心电图概貌信息，然后用这些信息作为神经网络的输入，对心电信号 特征波进行识别和分类，它使得神经网络的输入点大大减少，提高了神经网络的 识别速度。实验显示对 QRS 复合波具有很好的检测能力，但对于 P、T 波的检测 效果仍不理想，同样也存在波形宽度检测效果不好的问题。
③ 小波结合数学形态学法。数学形态学是利用数学方法对图像进行描述和分 类的工具。采用数学形态学检测心电信号时，针对 ECG 信号中各个主波和子波的 不同时限长度、不同的振幅，通过选取适当的结构元素序列，分别对原始的 ECG 信号进行开运算及闭运算，可将目标波群突出显示出来，而其他的非目标波群位 置则被映射成平坦信号区域，因此通过检测心电信号形态学运算后的峰谷位置， 可有效地定位目标波群在原始 ECG 上的位置。小波变换由于和信号的频域变化紧 密相连，在遇到一些覆盖了小波滤波器的通带高幅伪差信号时，就容易产生误判。 而数学形态学检测方法刚好弥补了小波变换这一缺点。它充分利用了原始 ECG 信 号的幅度特征，通过开运算和闭运算将信号在振幅上的差别放大，但对信号在频 域上的差异却几乎无法进行辨别。因此，将小波变换和数学形态法相结合，可以 有效地提高 ECG 特征波的检测效率。
小波结合数学形态学可以更好的确认检测的正确性，降低误检率。但是它同 样也没有有效的提供检测特征波起始点的方法。对于 QRS 复合波起点和终点的准 确检测仍然没有较好的方法，对 P 波和 T 波的检测也同样没有解决这个问题。
21

4 心率变异性信号的分析

4.1 心率变异性信号的时域分析

时域分析是测量 HRV 最简单的传统方法，是对采集的按时间顺序排列的 RR

间期数值，1996 年，Marek[57]等综述了两种主要的方法：统计学方法和几何图形

法的基础上。

① 统计法：HRV 时域统计方法是通过计算正常 RR 间期序列的统计指标来评

价，HRV 时域分析指标有：

1) MEAN：全程记录中相邻 RR 间期的平均值，反映了心率变异的平均水平。

∑ MEAN = N RR i i=1 N

(4.1)

2) SDNN：正常 RR 间期的标准差。SDNN＜100ms 为中度降低，SDNN＜50ms

为明显降低。若 SDNN＜50ms 则认为心率变异程度低；若 SDNN≥100ms，则心率

变异程度高。

SDNN =

N
∑(RRi − RR)2
i=1
N

(4.2)

3) SDNN Index：RR 间期标准差的平均值(每 5minRR 间期标准差的平均值)，

反应了 HRV 中缓慢变化的成分。

4) SDANN：RR 平均值的标准差，去除了 HR 中快速变化成分，反应了 HRV

中缓慢变化的成分。即将全程按 5min 分成连续的时间段，算出每 5min 的平均值

再求其标准差。正常参考值为 127±35ms。若 SDANN≤50ms，则 HRV 低；若

SDANN≥100ms 则心率变异程度高。 5) SDSD：相邻 RR 间期差值的标准差。

SDSD =

N
∑[(RRi − RRi+1 ) − (RR − RRi+1 )]2
i =1
N

(4.3)

6) rMSSD：相邻 RR 间期差值的均方根。计算相邻心动周期的变异，反映 HRV

的快速变化。

rMSSD =

N
∑ (RRi − RRi−1 )2
i =1
N −1

(4.4)

22

7) NN50：相邻 RR 间期差大于 50ms 的心搏数。 8) pNN50：NN50 占总 RR 间期数的百分比，描述心动周期的逐搏变异，HRV 中快速变化的成分。

pNN 50

=

NN 50 TotalNN

×100

(4.5)

9) CV：变异系数(coefficient of variation)，是一种离散指标，是标准差与均值

之比。

CV = SDNN ×100%

(4.6)

MEAN

本系统的分析对象是短时 HRV 信号，因此选择了 MEAN，SDNN，rMSSD 这

三个心率变异性的时域分析指标。

② 几何图形法：HRV 时域几何图形法是对 RR 间期的分布进行分析，从而给

出 RR 间期的变异度，主要包括 RR 间期直方图和 RR 间期差值直方图。

1)RR 间期直方图：是以 RR 间期为横坐标、各 RR 间期的拍数为纵坐标描记

的，其基本形状分为单峰、闭合双峰和开放双峰 3 种基本形状。正常人，尤其是

HRV 大的人其 RR 间期直方图低而宽，多呈开放型多峰形状；而严重的冠心病，

尤其是心肌梗死，充血性心力衰竭等导致 HRV 降低时，RR 间期直方图高且窄，

多呈单峰形状。由于 RR 间期采样时间间隔不同时，RR 间期直方图的形状差异较

大，由其形状计算出来的 HRV 时域指标如 SDNN、心率变异指数(HRV index)即某

时间内 RR 间期的总数与占比例最大的 RR 间期的数目比也会有较大差异[58]。

2)RR 间期差值直方图：即以 RR 间期差值为横坐标、各 RR 间期差值的拍数

为纵坐标描记的，代表了心动周期快速变化的大小。通常采用 MSD、rMSSD、pNN50

等指标来衡量直方图的形状，这些指标都只能反映 RR 间期及心率快速变化(即频

域分析中的高频成分)的大小。

指标名称 HRV三角指数
TINN St.George指数
差异指数

表 4.1 HRV 几何图形法常用指标

Table 4.1 Index of geometry graphics analysis of HRV

单位

定义

正常参考值范围

全部NN间期的直方图(计算机采样间隔为1/128s) 中，NN间期总数除以占比例最大的NN间期数

37±15 (<20为中度降低， <15为明显降低)

全部NN间期的直方图中以峰值为高的近似三角 ms
形的底边宽度

NN间期总数除以直方图中占比例最大的NN间期

数乘以2

相邻NN间期差值的直方图中不同标高(如100和 ms
1000)的宽度的差值

23

由于本系统是用于心率变异性的实时监测，需要做出肯定的疲劳评价，几何 图形法只能做定性分析，使用几何图形法不能对测得的心电信号与已知的疲劳标 准进行准确的比较，因此没有采用时域的几何图形分析方法。

4.2 心率变异性信号的频域分析
4.2.1 心率变异性的频域分析方法

HRV 分析的时域分析方法由于计算简单、指标意义直观而被临床医学广泛接

受，但这种方法不能刻画 HRV 的动态过程，难以进一步区分心脏的交感神经和迷

走神经的活动水平及其均衡性的变化，因此有较大的局限性。频域分析方法弥补

了时域分析的不足，提高了 HRV 分析的敏感性和特异性。频域分析法可将复杂的

心率波动信号按不同频段来描述能量的分布情况，把各种生理因素的作用适量分

离开进行分析，具有灵敏和准确的特点。HRV 的谱分析主要包括古典谱估计法或

现代谱估计法对 RR 间期序列进行谱估计。

① 古典谱估计法：HRV 古典谱估计法有自相关方法和周期图方法。经典谱估

计法的主要优点是：使用的算法简单(通过快速傅里叶变换实现)；运算速度快；可

以很好地反映波谷，适用于长记录或信噪比小的数据。主要缺点是谱线不是很光

滑。

1)自相关方法(间接法)：通过对自相关函数估计 Rˆ xx (m) 进行傅立叶变化求得功 率谱估计的方法即为 BT 谱估计法(BT 法)。

根据维纳-辛钦定理，首先估计采样数据 x(n)的自相关函数 Rˆ xx (m) ，然后求

Rˆ xx (m) 的傅立叶变换，即可得到 x(n)的功率谱。

M
∑ PˆBT ( f ) = T w(k ) Rˆ xx (k )e − j 2πfkT k=−n

(4.7)

式中，w(k)是滞后窗，M≤N-1。当 M=N-1 时，自相关方法与周期图方法的谱

估计结果相同。

2)周期图方法(直接法)：周期图法可直接用 FFT 算法求得 X(ejω)，从而得到信

号的功率谱估计，而不必先估计自相关函数。

谱估计 Sˆ AR (e jω ) 称为周期图，其中 X(ejω)为有限长度实序列 x(n) (0≤n≤N-1)的 傅里叶变换。

Sˆ AR (e jω )

=

1 N

X(e jω ) 2

(4.8)

由于周期图谱估计不是功率谱的一致估计，而且 N 增大时起伏更剧烈，因此 要加以改进。在改进的周期图方法中，Welch 法应用较为广泛。Welch 法是把 N 点

24

数据信 x(n)分成 N/L 段 χi(n)，每段长度为 L。Xi(k)为 χi(n)的傅里叶变换，功率谱

的估计值为：

∑ SˆχWelch (k ) =

1 KU

K
Pi (k)
i =1

(4.9)

其中， Pi (k) =

1 M

Xi (k)2

。可以证明

Welch

法谱估计是渐近无偏估计，且当

k → ∞ 时为一致估计。

Rompelman[59]等用一组三角函数改进了傅立叶变换法，补偿了由窗函数带来

的截断效应，并在计算机上得以成功应用。确定合适的窗函数对分析结果的影响

较大，一般有知形窗、海明窗、海宁窗及布莱克曼窗等。Pinna[60]等用传递函数法

对 HRV 谱估计的可靠性做了研究，认为信号记录长度不小于 420s，并且频谱窗函

数宽度等于 0.03Hz 是 HRV 短时分析的最优前提条件。

② 现代谱估计法：从方法学角度可分为参数模型法和非参数模型法。参数模

型有 AR 模型，MA 模型，ARMA 模型，AR 模型可用自相关法、Burg 法、协方差

法和最大似然估计法求解，MA 模型可用高阶的 AR 模型来近似，ARMA 模型可

用转变的 Yule-Walker 方程来求解；非参数模型法包括方差方法(Capon 最大似然估

计)和 MUSIC(多分量)方法。参数模型谱估计法的主要优点是：谱线光滑、易辨认；

分辨率高。其主要缺点是：建模过程复杂，模型阶数不易确定，要求数据是平稳

序列。

参数模型法的主要思路是：

a. 假定所研究的过程 x(n)是由一个输入序列 u(n)激励的线性系统 H(z)的输出；

b. 由已知的 x(n)，或其自相关函数 ψxx(m)来估计 H(z)的参数； c. 由 H(z)的参数来估计 x(n)的功率谱。

为了保证 H(z)是一个稳定且是最小相位的系统，A(z)和 B(z)的零点都在单位

圆内。假定 u(n)是一个方差为 σ2 的白噪声序列，由随机信号通过线性系统的理论

可知，输出序列 x(n)的功率谱为：

Px (e jω )

=

σ2 B(e jω )B∗ (e jω ) A(e jω ) A∗ (e jω )

=

σ2 B(e jω ) A(e jω ) 2

2

(4.10)

这样，如果激励白噪声的方差 σ2 及模型的参数 a1,a2,…,ap 和 b1,b2,…,bq 已知， 那么由式(4.10)可求出序列 x(n)的功率谱。
1)如果 b1,b2,…,bq 全为零，那么有：

25

p
x(n) = −∑ ak x(n − k) + u(n) k =1

H(z) = 1 =

1

∑ A( z )

p
1+ ak z −k

k =1

Px (e jω ) =

σ2
p

2

∑ 1 + ak e− jωk

k =1

(4.11)

此三式给出的模型称为自回归(auto-regressive)模型，简称 AR 模型，它是一个

全极点的模型，易反映功率谱中的峰值。自回归的含义是：该模型现在的输出是

现在的输入和过去 p 个输出的加权和。

2)如果 a1,a2,…,ap 全为零，那么有：

q

q

∑ ∑ x(n) = − bk u(n − k) = u(n) + bk u(n − k)，b0 = 1

k =0

k =1

q
∑ H (z) = B(z) = 1 + bk z −k k =1

(4.12)

p

2

∑ Px (e jω ) = σ2 1 + bk e− jωk

k =1

此三式给出的模型称为移动平均(moving-average)模型，简称 MA 模型，它是 一个全零点的模型，易反映功率谱中的谷值。
3)若 b1,b2,…,bq 和 a1,a2,…,ap 都不全为零，则得到的模型称为自回归移动平均模 型，简称 ARMA 模型。显然，ARMA 模型是一个既有极点又有零点的模型，易于 反映功率谱中的峰值和谷值。
1973 年 Hyndman 和 Monh 首次提出积分脉冲频率调制(IPFM)模型，即将连续 时间信号通过采样、加窗转换为一组调制序列，通常以脉冲链形式表示，并对窦 房结进行了功能性描述。IPFM 模型能够恢复隐藏在观察序列之中的调制信号，因 此对于分析许多生理信号如神经脉冲链和心脏收缩等产生的信号非常有效。 DeBoer[61]通过实验比较了古典谱估计方法和基于 IPFM 模型的功率谱分析方法， 后者把从 IPFM 模型推导得到的矩阵等式，应用在低于平均心率一半的序列，能够 得到精确的谱估计，同时可以得到一些真实的频率成分，一定程度上也克服了 HRV 古典频谱分析方法的局限性。Mateo[62]指出许多频谱分析法都是通过心搏期或心率

26

信号来进行的，他依据 IPFM 模型提出了一种新的时域 HRV 信号即心跳时刻(HT) 信号，这种信号能无偏差地恢复调制信号的频谱，为分析心血管系统的神经调节 功能提供了可靠的工具。
频谱分析方法的生理意义比较明确，提供了自主神经系统调节功能的定量分 析工具，对某些心血管疾病的早期诊断、病中监护和预后估计等有重要价值。但 对很多心血管疾病的诊断和预测却无能为力，对一些疾病特异性不强，必须依靠 其它手段获取参数，这可能和功率谱只是反映 HRV 的一段时间的概貌，信息量太 少有关，而且功率谱分析建立在平稳模型的基础上，不能够反映 HRV 的动态特征 和细节。HRV 计算技术和非线性动力学的发展为揭示心率变异性分析提供了新方 法。
4.2.2 AR 谱估计法
综合分析各种谱分析方法的优缺点，由于本系统采集的数据不长，用 FFT 方 法不精确，因此选择了 AR 谱估计法，下面对该分析方法及运算过程做详细介绍。
AR 谱估计法也称为最大熵谱估计法，实质上是一种自适应方法，没有固定的 窗函数而是采用参数估计形式，利用模型对数据段以外区域进行预测外推。利用 这种方法来处理平稳随机过程具有许多优点：它比传统的谱估计法具有更高的频 率分辨力；它消除了由于时域数据的暗中加窗而引起的频域谱中的旁瓣泄露现象； 对于短的数据记录仍能得到高分辨力的平滑谱。常用 Marple 算法[63]来实现 AR 模 型系数的计算，另外，Levinson-Dubin 算法和 Burg 算法[64]也较常用。1992 年，Burr 等[65]建立 AR 模型处理 HRV 信号，然后进行了谱分解，取得了较好的效果，得到 的频谱曲线光滑，能够分辨十分靠近的波峰，可以很好地反映波峰。AR 模型法是 对心率信号建立参数模型，通过传递函数参数的不同来反映信号的特性。AR 模型 法需求数据短，分辨率高，而且谱线光滑，这是它的主要优点。由于本系统采集 的心电信号只有 1 分钟，得到的心率变异性数据短，因此采用 AR 模型估计法更准 确。
① 自回归(AR)模型的建立 AR 模型实际上是一个系数按最小均方误差原则估计出的模型，它是个全极点 模型，其传递函数、随机序列 x(n)的 AR 模型、AR 模型估计的功率谱见式(4.11)。 要确定 AR 模型，首先应解出系数 ak(k=1,2,…,p)、预测方差 σ2 及模型阶次 p。 ② AR 模型参数的确定 通过分析各种方法的优缺点，本系统采用 Burg 算法来确定 AR 模型的参数。 Burg 算法是直接利用信号本身在有限时间内所观测到的数据样本点 X(n)， (n=0,1,…,N-1)同时再利用后向预测误差 eb(n)，此时前面所指的预测误差就称为前 向预测误差记为 ef(n)。
27

p
eb(n) = X (n − p) − Xˆ (n − p) = ∑ bk × X (n − p + k) k =0
p
ef (n) = X (n) − Xˆ (n) = ∑ ak × X (n − k) k =0

(4.13) (4.14)

其中 b0=1。 采用了前后向预测算法后，由于它对数据段以外的部分未加任何约束，不存在

数据截断产生的边缘效应。因此对数据较短或不很平稳的情况，也往往能得到较

好的效果。可以证明如果信号是平稳的，为使预测误差的均方误差最小，必要条

件是前向预测系数对应相等于后向预测系数 bk=ak。总的预测误差能量为：

∑ ∑ ep

=

E[e2 (n)] =

1 N −1 (ef
2 k=p

k) 2

+

1 N −1 (ef
2k=p

k) 2

(4.15)

仍然利用 Levinson-Dubin 递推算法求出前后向预测误差的递推式： ef p (n) = ef p−1 (n − 1) + a p × eb p−1(n)

ebp (n) = ebp−1 (n − 1) + a p × ef p−1(n)

(4.16)

将式(4.16)代入式(4.15)，则总预测误差能量就是反射系数 ap 的函数。因此为使

总的误差能量最小，只需要对

ap

求导，令其等于零，即

∂e ∂a

p p

= 0 ，得：

N −1

∑ − 2 ef p−1 (n) × ebp−1 (n − 1)

a p = N −1 n= p

N −1

∑ ∑ [ef p−1 (n)]2 + [ebp−1 (n)]2

n= p

n= p

(4.17)

可见反射系数 ap 反映了在总噪声功率 ep 一定的条件下，由 p-1 阶模型预测 p 阶的误差大小；另外，由式(4.17)求出的 ap 恒有 ap≤1，保证了所有 AR 模型的极点 都在单位圆内，模型是稳定的。

③ AR 模型阶次 p 的选择

AR 模型的阶次 p 一般事先是不知道的，需要事先选定一个稍大的值，在递推

的过程中确定。在使用 Levinson-Durbin 递推算法时，可以给出由低阶到高阶的每

一组参数，且模型的最小预测误差功率 emin(相当于白噪声序列的方差 σ2)是递减的。 直观上讲，当预测误差功率 e 达到指定的希望值，或是不再发生变化时，这时的

阶次即是正确阶次。

最终预测误差准则：

28

FPE

(r)

=

er

N N

+ (r + 1) − (r + 1)

(4.18)

信息论准则：

AIC(r) = N ln(er ) + 2r

(4.19)

式中，N 为有限长序列 x(n)的长度，当阶次 r 由增加时，FPE(r)和 AIC(r)都将 在某一个 r 处取得最小值。将此时的 r 定为最合适的阶次 p。在实际运用时发现， 当数据较短时，它们给出的阶次偏低，且二者给出的结果基本上是一致的。
4.2.3 心率变异性的频域分析指标
频域方法或谱分析方法的原理是将随机变化的 RR 间期或瞬时心率信号分解 为多种不同能量的频率成份进行分析，可以同时评估心脏交感和迷走神经活动水 平。该方法是将一段比较平稳的 RR 间期或瞬时心率变异信号进行快速傅立叶变换 (FFT)或自回归参数模型法(AR)运算后，得到以频率(Hz)为横坐标，功率谱密度 (Power Spectral Density，PSD，S2/Hz)为纵坐标的功率谱图(如图 4.1)进行分析。
研究表明：人的心率变异功率谱范围一般在 0～0.5Hz。它可出现三个谱峰： 1)第一峰在 0.03Hz(0.02～0.10Hz)左右，为低频段峰，与外周血管舒张、体温调节 及肾素-血管紧张素系统活动等多种因素影响有关；2)第二峰在 0.10Hz(0.10～ 0.15Hz)左右，为中频段峰，与血压反射性调节有关；3)第三峰在 0.25Hz(0.15～ 0.40Hz)左右，属高频段峰，与呼吸周期引起的心率变化有关。各频段下的面积可 作为功率谱能量的测定值，其大小与 HRV 成正比，此法进一步提供了自主神经在 各频段对心率的调制。

图 4.1 正常心率变异功率谱图 Fig 4.1 Power Spectral of Normal HRV
临床实际应用中，则常以 0.15Hz 为界分为低频成份(<0.15Hz，LF)及高频成 份(>0.15Hz，HF)[66]。LF 成份主要代表交感神经或受交感神经与迷走神经的双重
29

影响；HF 成份则仅反映迷走神经活性；LF 成份与 HF 成份能量的比值(LF/HF)， 可以用来反映交感和迷走神经活动均衡性[67]。表 4.2 所示，为 HRV 频域分析常用 指标的频段范围及正常参考值。

表 4.2 HRV 频域分析常用指标

Table 4.2 Index of frequency domain analysis of HRV

指标

频段

总功率(TP)
极低频功率(VLF)
低频功率(LF)
高频功率(HF) LF 的标化(LFnorm)* HF 的标化(HFnorm)*

≤0.4Hz ≤0.04Hz 0.04～0.15Hz 0.15～0.4Hz

LF/HF

注：* 为排除总功率对 LF 和 HF 数值的影响，在短时程分析中应分别进行标 化后再行比较，计算方法：LF(或 HF)norm=100×LF(或 HF)/(总功率-VLF)。

4.3 心率变异性信号的非线性分析
由于 HRV 信号是非常平稳的，因此用功率谱方法处理 HRV 长数据就不适合 了；另外 HRV 信号本身是非线性，用功率谱分析方法是无法反映 HRV 非线性本 质的。随着非线性科学和计算机技术的发展，使得用非线性动力学方法解决 HRV 信号非线性特性的提取成为可能。从理论上讲，由于心脏搏动受多种因素调控， 加之影响的多种生理和病理因素常常具有突变性，非线性方法相对于线性方法来 说可能会更好地反映出心脏自身自主神经调节的综合效应，因而也拥有着更为广 阔的临床应用前景[68]。但鉴于其背景知识的复杂性和抽象性，目前的研究水平尚 十分有限，急待深入开展。尤其是进一步探索和发掘非线性方法在信号处理中的 有效应用路线，这已经成为该领域中迫切需要解决的研究课题。
4.3.1 非线性分析的基本概念
近年来心脏的动力学问题颇受医学界关注。经过数学、生物医学工程、生理 和医学工作者的共同探讨，现广泛认为心脏是一个复杂的非线性动力学系统，正 常心脏运动具有混沌(chaos)的动力学规律[69]。这是认识概念上的一个更新和飞跃。
混沌运动是一种特殊的运动形式，它只出现在非线性系统中。混沌指的是在 确定性系统中出现的无规则性或不规则性，是无序之中的有序。混沌运动即不同 于周期性运动，又有别于随机性运动，而是介于这两者之间的复杂的动态过程。

30

4.3.2 HRV 混沌行为的生理机制

HRV混沌行为的生理机制目前尚不十分清楚。心脏解剖结构在几何形态上具

有二分叉的自相似性或类分形特征，这与心动周期时间历程上的混沌过程可能有

关，例如：(1) 冠状动脉和静脉网络是类分形的结构。(2)心脏中有一个类分形的连

接纤维网络----腱索，它将二尖瓣，三类瓣与肌肉连接。(3)某些心脏肌肉的分支模

式是明显的类分形结构。(4)His-PurKingje传导系统具有二分叉的类分形结构，这

种非线性的结构使心脏具有了非线性的电学和力学特性[70]。目前普遍认为HRV中

的混沌现象取决于血液动力学、电生理、体液及自主神经调控之间复杂的相互影

响[71]。心搏的混沌是为了更好地适应不断变化的外界环境，而心博一旦失去其不

规则的混沌运动，则意味着病理状态[69]。

4.3.3 状态空间的重构

状态空间重构是对时间序列进行非线性动力学研究的第一步，它的合理与精

确性将直接影响分析结果。利用时间序列进行空间重构的一个基本方法是时间坐

标延时模型。

① 理论概述

时间坐标延时模型是由Takens[72]首先提出，后又在TimSauer的“Embedology”[73]

一文中得到了更为广泛的发展。这一方法的理论基础是嵌入理论中的一系列定理。

A是一个光滑可微流形，如果A到F(A)是一个光滑的一对一映射，且具有光滑

的逆映射，则称该映射是A的一个嵌入。

假设φ是流形M上的流，T是正实数，h是从M到R上的光滑映射。延时坐标映

射F定义如下： F (h, φ,T )：M → R n

F (h, φ,T )(x) = (h(x), h(φ−T (x)),", h(φ−(n−1)r(x))) (4.20)

Whitney证明了从m维紧的光滑流形M到R2d+1上的光滑映射F是M上的一个微分

同胚。Takens进一步证明了当在系统吸引子的轨迹周期不等于或坐标延时两倍于坐

标延时的情况下，延时坐标映射给出了m维光滑流形的一个嵌入。

② R-R间期序列的空间重构

设R-R间期时间序列{x1,x2,…,xn}，其中xi=x(ti)，ti= t0+i∆t，i=1,2,…,n。∆t是两 次相邻采样点的时间间隔，一般为等距采样。适当的选取延时时间τ(τ=k∆t，k是整

数)，通过如下方法构造Nm个m维矢量Xi：

X1=( x1, x1+τ, x1+2τ, …, x1+(m-1)τ )

X2=( x2, x2+τ, x2+2τ, …, x2+(m-1)τ ) ……

Xi=( xi, xi+τ, xi+2τ, …, xi+(m-1)τ ) ……

(4.21)

31

其中，i=1,2, …Nm，Nm=N-(m-1)τ，是相空间中的总点数，τ是时间延迟，m是嵌入 维数。 ③ 延时τ的选择：
重构过程的首要问题是确定τ值。Takens定理认为：在给定无限多的、无任何 噪声干扰的准确数据时，可以任意选择τ值。但事实上这种要求对于任何实验值都 是不合理的，现实状况只能以有限的精度测得有限数目的数据。因此，重构的相 位图像特性取决于τ值的选择。如果τ值过小，那么xi+τ值将会非常接近于xi值，相位 图像将会在对角线附近被严重削弱；反之，如果τ值过大，那么就会出现相位图像 发生集合变形的问题。
选择τ值一般有三种方法：第一种方法是根据得到的相位图像能够最优化地充 满状态空间[74]，基于一种图形化的和十分主观的过程，对τ只能给出一个相对粗略 的估计值；第二种方法是根据数据自相关函数的第一个局部最小值位置[75]，仅仅 评估了信息数据中的线性关系；第三种方法是取数据平均互信息中的第一个最小 值[76]，也就是互信息法，由于不仅评估了信息数据中的线性关系，还对非线性信 号结构进行了审查，应用效果是这三种方法中最好的。
4.3.4 HRV 的非线性分析参数
用非线性方法分析HRV，是HRV分析的一种新方法。HRV的非线性参数有相 图(散点图)及定量描述混沌的参数：分维数、李雅普诺夫指数、测度熵、复杂度、 预测度。非线性参数的计算均涉及十分复杂的数学问题。故下面只介绍几个常用 的非线形参数的概念及临床意义。
① 散点图：即HRV信号的相空间轨迹图。以相邻两个窦性心动周期的前一个 R-R间期长度RRi(ms)为横坐标，以后一个心搏的R-R间期RRi+1(ms)为纵坐标，在图 上画出一定时间段内(24h)所有心动周期的点，如图4.2。
图4.2 Lorenz散点图 Fig. 4.2 Lorenz scattergraph
对散点图的分析有定性和定量两种分析方法。
32

1)定性分析：正常人如慧星状，较密集的点主要分布于45度角直线附近，表示

相邻的R-R间期大致相等，反映交感神经的活性[77]。沿该直线方向上的长度代表24

小时心率的总体变异度，垂直于该直线方向上的稀疏散点，表示相邻R-R间距差异

大，即窦性心律不齐，反映迷定神经活性，代表HRV的瞬时改变。在不正常情况

下会出现鱼雷状、扇状等异常图。

2)定量分析：

a. VAI(矢量角度数指示)，衡量RR间期散点图在45°线两边散开程度的指标：

N
∑ θi − 45
VAI = i=1 N

(4.22)

其中，N是散点个数，θi是散点图上第i个数据点与坐标原点的连线和横轴所夹的角 度。

b. VLI(矢量长度指数)，衡量长度方向散开的指标：

VLI =

N
∑ (li − L)
i =1
N

(4.23)

其中，N是散点个数，li是散点图上第i个数据点与坐标原点连线的长度， L 是所有 数据点离原点的平均长度。

② 分形维数：用来描述混沌系统自由度信息，表征HRV信号系统分形特征的

参数。数据的分形维数可以反映交感神经和迷走神经对心脏的调节过程。当交感

神经活动增强，而迷走神经活动减弱时，分形维数值减小。在HRV分析的实际应

用中，常采用由HRV的功率谱导出的分形维数[78]基本思路是：由于HRV的功率谱

满足幂律关系：

S

x

(ω)

=

σ

2 x

ω γ (满足此式的信号称作自仿射信号或分形信号)，则

其分形维数可表示为： D = 2 − (γ −1) 2 ，而γ可以通过双对数坐标功率谱图的极低

频段用最小二乘法拟合求得。

分形维数有多种定义，其中Grassberger和Procaccia在1983年提出了一种易于从

实验数据提取分维数即关联维数的算法，该方法为研究生理信号的动力学特征提

供了有力的工具。关联维数的计算是在相空间中进行的，因此，要利用采集到的

HRV时间序列{xk|k=1,2,…,N}，由时间延迟法重构m维相空间，得到一组空间矢量：
{ } X i = xi , xi+P, xi+2P ,", xi+(m−1)P

i = 1,2,", M ， X i ∈ R m

(4.24)

时间延迟τ =∆τP(∆τ为HRV采样间隔，P为正整数)；m≥2d+1，d为系统自变量个数；

33

M小于N，并与N有相同的数量级。计算式(4.24)的相关积分：

∑ [ ] C(r)

=

1 M2

M
H
i, j=1

r

−

Xi

−

Xi

i≠ j

(4.25)

凡是距离小于给定正数r的矢量，称为有关联的矢量，这里的H是Heaviside函数：

H

(x)

=

⎧0， x ⎩⎨1，x

≤0 >0

(4.26)

r的值取的适当，C(r)会随着r的增大而呈指数倍的迅速增加，关联维数定义为：

D2

=

− lim r→0

ln C(r) ln r

(4.27)

在计算中随着嵌入维数m变化，双对数lnC(r)~lnr图曲线束中，互相平行的直线段的

斜率，就是关联维数D2。

③ Lyapunov指数(LE)：LE是反映非线性系统动力学稳定性的参数。如果一个

序列是随机的，那么至少可以找到一个大于0的Lyaponov指数。LE越大，系统的混

沌程度就越大[79]。LE的定义为：

λ1

=

1 τ

lg

mi (τ)

(4.28)

mi(τ)是HRV序列的特征值，τ是时间延迟。 HRV分析系统在计算Lyapunov指数时，常采用wolf的算法。该算法要求相当
长的时间序列数据，一旦时间序列过短，该算法实际失效，不再适用。而有些算

法仅采样10分钟就进行分析，显然不够可靠。因此本系统采用了一种Lyapunov指 数的快速算法，该算法适用于小数据集，实现起来快速、简便。该算法如下：

1)利用相空间重构法由HRV信号重构动力学系统的状态空间。重构出的状态 空间的轨道可以表述为矩阵X，其中矩阵的每一排都是一个相空间矢量，即： X=(X1,X2,…,XM)T，此处，Xi为系统在离散时间i时的状态。对于一个N点的HRV时 间序列{X1,X2,…,XN}，有式(4.21)的空间重构，所以，X是一个M×m的矩阵，常数 m、M、J和N有如下关系：

M=N-(m-1)J

(4.29)

嵌入维数由关联维数算法求得。实际上，本系统所采用的Lyapunov算法的性能很

好，在m小于关联维数的情况下，仍然能够保持比较精确的结果。对于重构延迟τ，

为了取得一个较好的近似，本文将当自相关函数下降到其初值的1-1/e倍时的延迟

作为τ的值，这个求τ的过程由快速傅立叶变换(FFT)可以很好地完成。

2)算法找出轨道上各点的与之距离最近的邻点。距离最近的邻点Xj是指所有的

34

邻点中到参考点Xj的距离最小的点，即：

d j (0)

=

min xj

X

j

−

X

ˆj

(4.30)

此处，dj(0)是第j个点到最近邻点的初始距离，‖‖表示欧几里德范数。在确定最

小距离邻点之前，采取一个附加的限制，即最近邻点必须满足这样一个条件:最近

邻点到它的参考点的距离大于HRV时间序列的平均周期：

j − ˆj > mean − period

(4.31)

通过上述条件，可以判断哪些邻点不需要加以考虑，只有满足条件的邻点，

才被算法判断其到参考点的距离，以确定是否是最近邻点。这样，就可以将每一

对参考点和它有最近邻点之间的距离考虑为两个相邻轨道的初始距离。最大

Lyapunov指数就是相邻轨道距离发散的平均速率。因此，可以假设第j对参考点和

它的最邻近点的距离以最大Lyapunov指数的速率在不断的发散：

d

j

(i)

≈

C

e λ1 (i∆t )
j

(4.32)

此处，dj(i)是第j对参考点和它的最近邻点在经过离散时间i后的距离，∆t是时间序

列的采样周期，Cj是相邻轨道间的初始距离。将上式两边同时取对数，有：

ln d j (i) ≈ ln C j + λi (i∆t)

(4.33)

这个等式代表着一个近似平等的直线集(j=1,2,…,M)。将这个直线集中的所有直线

作平均处理，可以得到一条平均直线，那么，这条平均线的斜率就是我们所求的

最大Lyapunov指数，平均线按下式计算：

Y( i )

=

1 ∆t

ln d j (i)

(4.34)

〈〉表示在j的所有取值上进行平均。所以可以很容易通过最小平方拟和法来

求得该平均线的斜率，从而精确地最大计算Lyapunov指数。

④ 熵：熵是指复杂系统产生信息的速率，是动力系统复杂程度的度量。熵为

零表示系统是有规则的，熵无穷大，则是完全随机的，而混沌信号的测度熵是一

个有限的正数[80]。

1)近似熵(ApEn)：近似熵分析是Pincus[81]在1991年提出的一个适合于对较短数

据进行分析的指标。近似熵的计算公式如下：

ApEn(N , m, r) = Φ m (r) − Φ m−1 (r)

(4.23)

N −m+1

∑ 其中， Φ m (r) =

lg Cim (r)

i =1
N −m+1

，C

m i

=

N

Np −m

+

1

，

Np

是

满

足

式

：

X (i) −

X ( j)

≤r，

35

j=1,2,3,…N-m+1的点的数目。

近似熵的优点如下：a.它所需要的数据较短，约100~5000个数据点就可以得到

稳定的近似熵；b.有较强的抗干扰能力，尤其对偶尔产生的瞬时干扰具有良好的屏

蔽作用；c.可以用于检测确定性成分和随机成分组成的混合信号；d.近似熵包含了

时间顺序信息，比时域指标包含更多的信息，通过近似熵分析可以反应心血管的

调节模式。

2)测度熵(K)：测度熵是用来衡量信息增长速率或是信息流动速率的。测度熵

的定义为：

K

=

lim lim
ε→0 l→∞

t2

1 − t1

I ε [t1, t1 ]

∑ I ε = − p{i1,i2 ,",in }ln p{i1, i2 ,", in }

l

(4.24)

其中，p{i1,i2,…,in}是将空间划分成边长为ε的n维立方体，且把t1和t2的时间划分n 份后，集合中的点落在这些网络的联合概率。
⑤ 复杂度：复杂度反映了一个时间序列随其长度的增加出现新模式的速率， 在HRV分析中可以表现R-R序列接近随机的程度[82]。根据Kolmogrov的理论，复杂 性可以认为是产生某给定“0，1”序列的最少的计算机程序的比特数，但这是没有一 般算法的，通常采用的是Lempel和Ziv提出的算法。根据Lempel和Ziv的算法，完全 随机的序列，复杂度是1，而有规律的周期运动其复杂度则趋向于0。由此可见， 复杂度越接近于1，则说明其相应的时间序列越复杂，反之，越规则。HRV序列的 复杂度，反应了ECG序列的信息量的大小，表现了心脏受交感神经和迷走神经相 互调节的有序程度。
⑥ 预测度：预测度可以用来分析R-R间期序列，周期性、混沌性、随机性的 程度。非线性动力学及神经网络理论证明：有规律的周期性时间序列单步和多步 都是可预测的，随机的无规律的时间序列单步和多步都是不可预测的，而混沌的 时间序列则单步可预测，随预测步数的增加，逐渐变为不可预测。健康人单步可 预测，多步不可预测，AMI病人单步、多步都不可预测[83]。

36

5 研究结果
5.1 实验方法
本系统采集了20个样本在模拟驾驶时的心电数据，共每个样本进行2H的模拟 驾驶，采样间隔为15min，每次采样时间为1min，即每个样本共有9组心电信号； 在每次测量心电的时候，还会同时询问样本的主观疲劳程度。本文选用MATLAB 软件，使用MATLAB语言编程，对采集的所有心电数据进行重采样、低通滤波的 预处理，检测R波、计算RR间期，得到HRV数据，然后对HRV数据进行时域、频 域及非线性分析，计算MEAN(RR间期均值)、SDNN(RR间期标准差)、rMSSD(相 邻RR间期差值的均方根)，LF(低频功率)、HF(高频功率)，D2 (关联维数)、 LE(Lyapunov指数)，再根据样本的主观疲劳程度，分析驾驶过程中指标的变化趋势。 利用SPSS软件对实验结果进行统计分析。在实验过程中，所有样本都从一点不疲 劳慢慢发展到极度疲劳，因为分析各项指标，也就是分析随着疲劳程度的加深， 指标的变化趋势。
5.2 实验结果与分析
① 根据样本的主观疲劳程度，通常：15min以前，感到一点也不疲劳； 15-45min，感到有一些疲劳；45-90min，感到比较疲劳；90min后感到极度疲劳。 有个别样本，会在15-30min时，就感到比较疲劳，后来在45-60min时，就感到极度 疲劳。
② 首先，本文对20个样本的HRV数据作了时域分析，得到了MEAN(单位： ms)、SDNN(单位：ms)、rMSSD(单位：ms)三个时域指标在模拟驾驶过程中的变 化情况，表5.1所示为其中20个样本的SDNN值。经过t检验，MEAN、rMSSD在驾 驶前后没有显著变化(P>0.05)，因此没有列出样本的MEAN、rMSSD的所有值。

表5.1 20个样本的时域分析指标(SDNN)

Table 5.1 Index of time domain analysis of 20 samples (SDNN)

时间

0

15

30

45

60

75

90

105

120

样本

min

min

min

min

min

min

min

min

min

1

125

128

131

135

140

152

156

159

161

2

67

68

72

71

75

82

84

88

89

3

113

115

119

123

126

129

140

143

141

4

154

152

157

160

175

178

180

182

185

37

5

138

140

145

146

160

159

162

164

164

6

83

84

88

87

96

102

105

106

106

7

124

126

125

130

133

140

148

152

155

8

130

127

125

128

129

135

139

141

141

9

77

84

84

87

90

99

103

105

106

10

103

106

106

110

125

129

131

139

143

11

134

135

137

139

138

140

144

142

142

12

89

89

93

99

97

99

107

110

113

13

99

102

103

109

121

126

123

125

125

14

137

137

139

145

150

158

160

161

162

15

122

125

127

139

143

147

152

153

153

16

133

136

137

137

139

142

143

146

146

17

128

129

136

134

138

149

150

151

155

18

116

118

123

127

128

127

139

140

141

19

87

89

88

94

96

99

97

105

109

20

147

152

155

167

168

171

173

172

170

根据表5.1，作出20个样本的SDNN变化曲线，如图5.1所示：

SDNN

20个样本的SDNN变化曲线图 3000
2500 2000
1500
1000 500
0 0 15 30 45 60 75 90 105 120 Time/min
图5.1 20个样本的SDNN变化曲线 Fig. 5.1 Curve of SDNN of 20 samples

系列20 系列19 系列18 系列17 系列16 系列15 系列14 系列13 系列12 系列11 系列10 系列9 系列8 系列7 系列6 系列5 系列4 系列3 系列2 系列1

对20个样本的SDNN进行统计后，用X ± S表示(表5.2，图5.2)。经过t检验，发 现SDNN显著升高(P<0.05)。对SDNN的变化曲线图计算各个测量时间点的斜率，

38

发现：SDNN指标在0-30min之内，稳步上升；45min和60min时，增长得最快，表 示疲劳程度在这段时间内突然加深；在60min后，斜率不断下降，说明疲劳程度的 加深减缓，驾驶员已经到达非常疲劳的程度，因此斜率反而开始下降。

表5.2 SDNN指标统计 Table 5.2 Statistics of SDNN index

时间

SDNN (X ± S) / ms

斜率(k)

0 min

115.30 ± 24.60

0

15 min

117.10 ± 24.14

1.83

30 min

119.50 ± 24.60

2.46

45 min

123.35 ± 25.60

3.88

60 min

128.35 ± 26.51

4.97

75 min

133.15 ± 26.07

4.73

90 min

136.80 ± 26.15

3.63

105 min

139.20 ± 25.21

2.37

120 min

140.35 ± 25.05

1.14

SDNN

SDNN变化曲线图
145 140 135 130 125 120 115 110
0 15 30 45 60 75 90 105 120 Time/min
图5.2 SDNN变化曲线 Fig. 5.2 Curve of SDNN
③ 然后，本文采用AR模型法，对20个样本的HRV数据作了频域分析，得到 了LF(单位：ms2)、HF(单位：ms2)在实验过程中的变化情况。表5.3 (a)、(b)分别是 20个样本的LF、HF数据。

39

表5.3 20个样本的频域分析指标

Table 5.3 Index of frequency domain analysis of 20 samples

时间 样本
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20

0 min
1470 1066 1307 1745 1558 1240 1499 1610 1123 1280 1609 1439 1373 1639 1527 1674 1420 1371 1146 1824

15 min
1489 1065 1317 1752 1570 1254 1454 1630 1143 1287 1601 1452 1399 1644 1538 1683 1435 1360 1152 1833

30 min
1502 1076 1330 1757 1585 1266 1457 1643 1165 1299 1620 1464 1401 1657 1535 1677 1422 1398 1169 1845

(a) LF (ms2)

45

60

min min

1521 1094 1371 1780 1606 1271 1471 1652 1230 1321 1630 1521 1437 1673 1559 1692 1458 1454 1203 1927

1557 1127 1400 1863 1703 1355 1540 1648 1254 1350 1666 1598 1520 1782 1573 1739 1476 1476 1249 1933

75 min
1636 1205 1491 1896 1680 1383 1599 1665 1289 1430 1728 1633 1556 1824 1662 1764 1552 1499 1267 1947

90 min
1701 1233 1529 1930 1699 1412 1638 1703 1310 1501 1755 1643 1563 1842 1671 1802 1584 1503 1283 1957

105 min
1735 1240 1544 1954 1720 1236 1650 1733 1337 1530 1763 1655 1572 1885 1693 1805 1590 1535 1300 1972

120 min
1755 1249 1530 1957 1725 1244 1666 1754 1337 1556 1761 1653 1579 1873 1710 1820 1593 1544 1320 1963

(b) HF (ms2)

时间

0

15

30

45

60

75

90

105

120

样本

min

min

min

min

min

min

min

min

min

1

1215

1209

1100

992

961

905

827

763

746

2

762

760

753

732

694

611

517

504

483

3

1063

1055

1053

1022

1004

926

873

858

863

4

1461

1470

1448

1419

1342

1302

1255

1243

1233

5

1318

1310

1302

1239

1185

1147

1129

1145

1138

6

938

921

918

863

801

754

726

601

618

7

1244

1240

1233

1206

1158

1087

1016

981

973

8

1150

1148

1167

1149

1106

1045

994

962

955

9

882

872

853

862

848

825

761

726

720

10

1001

995

983

968

939

864

795

741

726

11

1374

1357

1332

1329

1266

1213

1165

1137

1129

12

903

901

912

885

871

810

763

758

740

13

995

1003

983

967

936

881

830

802

809

14

1367

1361

1359

1326

1285

1238

1180

1174

1159

15

1252

1237

1210

1148

1105

1074

1057

1038

1031

16

1343

1340

1351

1338

1301

1237

1196

1158

1137

17

1288

1270

1237

1204

1128

1069

1026

994

983

18

1176

1169

1161

1138

1093

1026

954

906

878

19

897

903

900

883

849

784

721

682

653

20

1437

1472

1479

1452

1404

1365

1318

1276

1264

根据表5.3做出20个样本的频域指标的变化曲线图：

40

LF/ms2

20个样本的LF变化曲线图 35000 30000 25000 20000 15000 10000
5000 0 0 15 30 45 60 75 90 105 120 Time/min
(a) LF

25000

20个样本的HF变化曲线图

20000

15000

10000

5000

0 0 15 30 45 60 75 90 105 120 Time/min
(b) HF

系列20 系列19 系列18 系列17 系列16 系列15 系列14 系列13 系列12 系列11 系列10 系列9 系列8 系列7 系列6 系列5 系列4 系列3 系列2 系列1
系列20 系列19 系列18 系列17 系列16 系列15 系列14 系列13 系列12 系列11 系列10 系列9 系列8 系列7 系列6 系列5 系列4 系列3 系列2 系列1

HF/ms2

图5.3 20个样本的频域指标变化曲线 Fig. 5.3 Curve of frequency domain index of 20 samples

对20个样本的LF、HF进行统计后，用X ± S表示(表5.4，图5.4)。经过t检验的 统计分析，实验过程中，随着疲劳程度的加深，LF显著增大(P<0.05)，反映交感神 经活动增强，HF显著减小(P<0.05)，说明迷走神经活动减弱。计算LF及HF变化曲 线图各个测量点的斜率，得到以下结论：(1) 30min之前，LF的增长很缓慢；45-60min 内，LF曲线斜率极速增大，说明疲劳程度很快加深了；75min后，斜率逐渐降低， 说明样本已经达到极度疲劳，疲劳程度趋于稳定。(2) 30min前，HF斜率变化缓慢， HF逐渐降低；在45min和75min时，HF各有一次快速下降；在75min后，斜率降低， 到120min时，疲劳程度几乎不再加深。

41

人体心脏受交感和迷走神经双重支配。在安静的条件下，迷走神经兴奋性占 优，相反，人们在疲劳、激动、紧张的状态下，交感神经兴奋性占优。本文的研 究结果表示，随着实验的进行，低频成分值越来越高，高频成分值越来越低，其 中伴随小幅波动。这说明，实验样本在实验后的交感神经兴奋性处于一个很高的 水平，而迷走神经兴奋性处于较低的水平。证明了高频成分可反映交感神经兴奋 性，低频成分可反映迷走神经兴奋性。

时间
0 min 15 min 30 min 45 min 60 min 75 min 90 min 105 min 120 min

表5.4 频域指标统计 Table 5.4 Statistics of frequency domain index

LF (X ± S) / ms2

斜率(k)

HF (X ± S) / ms2

1446.00 ± 209.91

0

1153.30 ± 209.12

1452.90 ± 209.44

0.46

1149.65 ± 211.33

1463.40 ± 206.81

0.73

1136.70 ± 210.11

1493.55 ± 207.50

2.01

1106.10 ± 208.63

1540.45 ± 211.68

3.13

1063.80 ± 199.07

1585.30 ± 202.61

2.99

1008.15 ± 204.65

1612.95 ± 202.07

1.84

955.15 ± 213.17

1622.45 ± 217.93

0.63

922.45 ± 222.98

1629.45 ± 215.37

0.47

911.90 ± 222.64

斜率(k) 0
-0.24 -0.86 -2.04 -2.82 -3.71 -3.52 -2.18 -0.71

LF/ms2

LF变化曲线图 1650
1600 1550
1500 1450
1400 0 15 30 45 60 75 90 105 120 Time/min
(a) LF

42

HF/ms2

HF变化曲线图

1200

1150

1100

1050

1000

950

900 0

15 30 45 60 75 90 105 120 Time/min

(b) HF

图5.4 频域指标变化曲线 Fig. 5.4 Curve of frequency domain index

④ 最后，本文对20个样本进行了非线性分析，得到了D2与LE的变化情况。根 据分析、比较，可以确定嵌入维数m=18和阈值k=0.1。

样本

指标

1 2 3 4 5 6 7 8 9 10 11 12 13 14

表5.5 20个样本的非线性分析指标

Table 5.5 Index of non-linear analysis of 20 samples

关联维数 (D2)

实验前

实验后

Lyapunov指数 (LE)

实验前

实验后

1.77

1.04

0.28

0.19

1.43

0.92

0.16

0.17

1.59

0.96

0.18

0.14

1.65

1.15

0.23

0.19

1.40

1.01

0.21

0.15

1.89

2.01

0.33

0.31

1.53

0.99

0.26

0.16

1.21

0.64

0.17

0.11

1.46

0.93

0.30

0.25

1.80

1.33

0.25

0.17

1.36

0.89

0.28

0.17

1.33

1.01

0.22

0.12

1.27

0.77

0.15

0.11

1.30

0.82

0.17

0.10

43

15

1.29

0.94

0.20

0.10

16

1.81

0.90

0.28

0.19

17

1.66

1.71

0.22

0.11

18

1.66

1.02

0.21

0.17

19

1.32

0.36

0.15

0.18

20

1.49

0.84

0.26

0.19

对20个样本的非线性指标作统计分析后，用X ± S表示(表5.5)。经过t检验分析， 驾驶前后，D2与LE均显著下降(P<0.05)，反映了产生HRV信号的非线性心脏系统的 复杂性和混沌程度降低，说明需要更少过去值或随机影响起作用。
分形维数是描述吸引子所需信息量多少的重要参数，可以反映不同的运动形 式，维数越大，说明正常心律所含的信息量较大。本文研究结果表明，实验后， 维数降低了，说明疲劳状态下，心律的信息量也减少了。Lyapunov指数也是反映 混沌状态的重要参数，是心脏活动的总体状态特征，Lyapunov指数越大，系统的 混沌性越强，心脏在异常时比健康时的混沌程度要低。实验后，Lyapunov指数也 降低了，说明随着疲劳程度的加深，心脏活动的混沌程度也降低了。

指标 X±S

表5.5 非线性指标统计

Table 5.5 Statistics of non-linear index

关联维数 (D2)

实验前

实验后

Lyapunov指数 (LE)

实验前

实验后

1.5110 ± 0.2065

1.0120 ± 0.3512

0.2255 ± 0.0531

0.1640 ± 0.0521

综合分析所有指标，样本的主观疲劳程度与指标所表示的疲劳程度相符，可 以说明 HRV 可以作为判断驾驶疲劳程度的一种有效手段，各种分析指标都可以较 好的反应驾驶时的疲劳程度。

44

6 结论与展望
6.1 主要结论
本文在总结和研究了时域、频域及非线性分析方法的基本原理后，通过分析 HRV 的时域特性、频域特性及非线性特性，探讨了 HRV 指标在疲劳驾驶监测中应 用的可行性与适用程度，为疲劳驾驶监测的研究提供一些新的手段和方向。本文 主要结论如下：
① 采集了 20 组模拟驾驶时的心电数据，对心电信号进行重采样、低通滤波 后，利用阈值法进行 R 波检测，最后得到精度较高的 RR 间期序列，即 HRV 信号。
② 比较了时域、频域及非线性分析方法的参数优缺点，选定三种分析方法各 自的参数指标：(1) 时域指标：MEAN(RR 间期均值)，SDNN(RR 间期标准差)， rMSSD(相邻 RR 间期差值的均方根，反映 HRV 的快速变化)；(2) 频域指标：LF(低 频功率)，HF(高频功率)；(3) 非线性指标：D2 (关联维数)，LE (Lyapunov 指数)。
③ 在 MATLAB 软件平台上，研究驾驶过程中的 HRV 信号各种指标的变化情 况，得出了以下结论，随着疲劳程度的加深：(1) MEAN、rMSSD 没有显著变化 (P>0.05)，SDNN 显著增大(P<0.05)，反映 HRV 的总和增大；(2) LF 显著上升 (P<0.05)，HF 显著下降(P<0.05)，反映交感神经活动增强，迷走神经活动减弱；(3) 关联维数与 Lyapunov 指数都显著下降(P<0.05)，反映了产生 HRV 信号的非线性心 脏系统的复杂性和混沌程度降低，说明需要更少过去值或随机影响起作用。这些 指标的变化趋势表明 HRV 可以作为评价驾驶疲劳的一种手段，它不仅可以正确反 映驾驶员是否疲劳，而且可以大致判断驾驶疲劳的程度。
6.2 后续研究工作的展望
由于本课题是作者自己立的课题，受到研究经费与实验条件的限制，因此在 采取数据等一系列实验研究中存在一些不足，这在后续研究工作中可以进行改进 与提高。
① 本课题所采集的样本数量并不大，只有 20 人，这在一定程度上限制了研 究结果的普遍性。在后续研究中，要扩大样本的数量及范围，使样本的覆盖面更 广。
② 研究中，仅仅采用了游戏软件模拟了驾驶，这与真实的驾驶还是存在一定 差异，本文研究的更多的是心理上疲劳，在一定程度上，还缺乏体力疲劳。如果 以后实验条件允许，可以进行真实状态下的疲劳驾驶的模拟，这样得到的实验数 据将更接近真实情况。
45

③ 人体心率变异性信号收到诸多外界因素的影响，因此无法得到一个对所有 人都能适用的统一的疲劳判断阈值，建议分析更多的样本，从而找到疲劳阈值的 规律，制定出能够根据个人心率变异性的判断阈值，对每个汽车司机的疲劳状态 的判断具有独特性，更符合个体特征。
④ 目前，心率变异性的非线性分析技术还没有时域与频域分析技术成熟，非 线性分析的指标也还没有统一的标准，本文仅仅对心率变异性的非线性分析做了 一个初步的研究，这还需要在以后的工作中加强。
综上所述，利用心率变异性(Heart Rate Variability，HRV)信号来监测汽车司机 的疲劳状态是一种无创、方便、快捷的方法。根据结论可以得出通过 HRV 判断汽 车司机驾驶疲劳的评价标准，对 HRV 信号进行三种方法的综合分析，结合了线性 分析与非线性分析的优点，使得疲劳评价更加准确，是一种十分有研究价值的手 段。HRV 在汽车司机的疲劳监测中的应用有广阔的实际应用与研究前景。
46

致谢
本文的研究工作是在我的导师邓小燕教授的精心指导和悉心关怀下完成的，值 此论文完成之际，谨向邓老师表示衷心的感谢！感谢他三年来在学习、工作及科 研上对我的悉心指导和谆谆教诲。盛谢他在实脸没计、实施及论文撰写等方面给 我精心的指导与帮助。邓老师渊博的学识以及他严谨的治学态度和诲人不倦的精 神永远是我奋斗的目标及学习的榜样。
在三年的学习生活中，还得到了许多领导和老师的热情关心和帮助，在此表示 感谢。
在日常学习和生活中，同门杨庆华，曾伟，毕彦平，门吉英，韩露，张洪波， 刘万前，徐颖，李娜，管章伟等给了我很大的帮助，在此表示感谢。
感谢我的师姐万小萍，本科同学郭玮珍，赵昕，黄茜等对我研究工作与生活上 的帮助。
感谢刘春在各方面给我的帮助，让我能专心的完成我的论文。 感谢我的奶奶和父母，是他们培养了我百折不饶的意志、奋发进取的精神！ 最后，还有衷心的感谢在百忙中评阅论文和参加答辩的各位专家、教授！感谢 重庆大学，给我学习进步的机会。感谢生物工程学院老师们的辛勤培养。 感谢所有帮助过我的人们！
刘灵 二 00 七年四月 于重庆
47

参考文献
[1] 识别疲劳驾驶的信号. http://www.trendsmag.com/article/article_detail0.jsp?id=40074 [2] Saroj KL Lal, Ashley Craig. Physiological indicators of driver fatigue. 2000 Road Safety
Research, Policing & Education Conference, 2000.11 [3] 王炳浩，魏建勤，吴永红. 汽车驾驶员瞌睡状态脑电波特征的初步探索. 汽车工程，
2004,26(1):70-73 [4] Lee, D. H. and Park, K. S. Multivariate analysis of mental and physical load components in
sinus arrhythmia scores. Ergonomics, 1980,33(1):35 [5] 杨渝书，姚振强，李增勇等. 心电图时频域指标在驾驶疲劳评价中的有效性研究. 机械设
计与制造，2002,(5):94-9 [6] Katsis C.D., Ntouvas N.E., Bafas C.G.. Assessment of muscle fatigue during driving using
surface EMG. Proceedings of the IASTED International Conference on Biomedical Engineering, 2004:259-262 [7] Anneke Heitmann, Rainer Guttkuhn, Acacia Aguirre etc. Technologies for the monitoring and prevention of driver fatigue. Proceedings of the First International Driving Symposium on Human Factor in Driver Assessment, Training and Vehicle Design, 2001.8 [8] Laurence H, Nick M. Review of fatigue detection and prediction technologies. http:∥www. nrtc.gov.au, 2001.1 [9] Driver Fatigue: Concepts, measurement and crash countermeasures. http:∥www.general. monash.edu.au.muarcrptsumescr72.htm, 1997 [10] 王荣本，郭克友，储江伟等. 适用驾驶员疲劳状态监测的人眼定位方法研究. 公路交通科 技，2003,20(5):111-114 [11] Philip W Kithil, Roger D. Jones, John Mac Cuishi. Development of driver alertness detection system using overhead capacitive sensor array. SAE Technical Paper Series 982292, SAE International,1998.2 [12] 石坚，吴远鹏，卓斌等. 汽车驾驶员主动安全性因素的辨识与分析. 上海交通大学学报， 2000,34(4):441-444 [13] S.A.M.G-3-steering attention monitor. http://www.zzzzalert.com/passsambroch.htm [14] Gerry E. Warning system for fatigued drivers nearing reality with new eye data. Science Daily Magazine,1999,(7):25-30 [15] Wake-up call for sleepy drivers. http://www.uk.cn/bj/index.asp?menu_id =347&artid=757 [16] Sleep device. http://abcasiapacific.com/nexus/leadingedge/s1559684.htm
48

[17] World breakthrough from Volvo Cars alerts tired and unconcentrated drivers. http://www. volvocars.com/corporation/NewsEvents/News/news.htm?item=%7B2EA9E5DF-05DB-4B55-8 808-D1230910E159%7D
[18] 唾液“测量”疲劳度. http://tech.sina.com.cn/d/2005-12-07/1751785484.shtml [19] 睡眠的奥秘. http://www.cctv.com/program/kjbl/20050511/100202.shtml [20] 陆葆仁，庄永忠. 心率变异性测定的临床意义. 海军医高专学报，1994,16(3):213-215 [21] 陈 灏 珠 . 心 率 变 异 性 的 测 定 及 其 临 床 意 义 . Journal of Clinical Electrocardiology,
1994,3(4):168-172 [22] 胡人一等. 心率变异分析技术与应用. 国外医学内科分册，1992,19(3):136-139 [23] 伍卫等. 心率变异性的检测方法及其临床应用. 国外医学内科分册，1991,18(8):338-342 [24] 胡大一等. 心率变异性测量标准，生理释义与临床应用. 中国医疗器械信息，1998,4(1) [25] 陈运贞等. 检测心脏植物神经活性的定量方法. 心率功率谱分析. 中华心血管病杂志，
1992, 20 (2):101 [26] Eving. DT. Clin Cardio. 1991,14:683 [27] Malik Metal. Am J Cardiol. 1993,72:821-822 [28] H.V.Huikuri. J Inter Med. 1995,237:349-357 [29] Minami J, I shimitsu T, Matsuoka H,Hyperten wsion. l999,33(suppl 2):586-590 [30] Reed SF, Newlin DB. Exp clin Psychopha rmacol, 1999,7(4):484-492 [31] Di Rienzo M, Mancia G, Parati Getal(eds). Blood pressure and heart Variability-computer
analysis, modeling and clinical applications. Amsterdam:IOS Press,1993. [32] 廖旺才等. 精神负荷对心率变异性影响的非线性动力学分析. 航天医学与医学工程，
1996,9(2) [33] 刘旭峰等. 焦虑特质与心率变异性及心率的相关性. 中华航天航空医学杂志，2002,13(2) [34] 徐公国等. 核潜艇潜航时艇员的心率变异性. 中华航海医学与高气压医学杂志，2001,8(1) [35] 林立等. 振动、噪声对金矿凿岩作业工人心率变异性及其动脉血压的影响. 中华劳动卫生
职业病杂志，1994,17(2) [36] 李福敏等. 客运机车乘务员心率变异性探讨. 铁通劳动安全卫生与环保，1999,26(3) [37] 徐志强等. 二硫化碳作业工人的心率变异性分析. 中国行为医学科学，2001,10(2) [38] Kleiger RE, Miller JP, Bigger JT, et al. Decreased heart rate variability and its association with
increased mortality after acute myocardial infarction. Cardiology, 1987,59:256-262 [39] Julius S. Autonomic nervous system dysregulation in human hypertension. 1991,67:3-7 [40] Tusji H, Venditti FJ Jr, Manders ES, et al. Determinants of HRV in systemic hypertension. Am
J Cardiol, 1996,77:1073-1077 [41] Guzztti S, Dassi S, Pecis M, et al. Altered pattern of circadian neural control of heart period in
49

mild hypertension. J Hypertens, 1991,9:831-838 [42] Langeitz W, Ruddel H, Schachinger H. Reduced parasympathetic cardiac control in patients
with hypertension at rest and under mental stress. Am Heart J, 1994,127:122-128 [43] 宋滇平，和四宏，林建华等. 糖尿病患者心率变异性分析. 云南医药，1998,19(1):4-5 [44] Hayano J, Sakakibara Y, Yamada A, et al. Short and long term effects of cigarette smoking on
heart rate varibility. Am J Cardial, 1990,65(1):84-88 [45] Fallen EL, Sands KE, Appel ML, et al. Spectral analysis of heart rate variability following
human heart transplantation evidence for functional reinnervation. J Auton Nerv Syst, 1988,23:199-120 [46] Farrazzi E, Cahill S. Power spectral analysis of the heart rate of human fetus at 26 and 36 weeks of gestation. Clin Physiol Meas, 1989,10(13):57-59 [47] P. M. Mahoudeaux, et al. Simple microprocessor-based system for on-line ECG analysis. Med Biol. Eng., 19:497-500 [48] Duanping Liao, Ralph W B, Lloyd E, et al. Age, race, and sex differences in autonomic cardiac function measured by spectral analysis of heart rate variablity. The ARIC Study. Am J Cardiol, 1995,76:906-912 [49] Laurent Fauchier, Dominique Babuty, Marie Laurence Autret. Influence of duration and hour of recording on spectral measurements of heart rate variability. Journal of the Autonomic Nervous System, 1998,73:1-6 [50] 王林泓，杨浩. 心电信号处理中滤波器设计的研究. 北京生物医学工程，21(3):218-221 [51] T. W. Parks, J. H. McClellan. A program for the design of linear-phase finite impulse response digital filters. IEEE Transactions on Audio and Electroacoustics, 1972,8(20):195-199 [52] TIAN Yunqing, SUN Xiaojing, HAO Dongmei, eta. Research on automatic diagnosis system of electrocardiogram. Chinese Journal of Medical Instrumentation, 2001,25(4):204-206 [53] 谌雅琴，李刚，叶文宇等. 自适应相干模板法在心电图机中应用的一种改进算法. 信号处 理，2002,18(3):244-248 [54] SAXENA S C, KUMAR V, HAMDE S T. QRS detection using new wavelets. Journal of Medical Engineering & Technology, 2002,26(1):7-15 [55] 陈瑞中. 关于 ECG 信号处理与分析的研究. 广西师范大学，2000 [56] TIAN Yunqing, SUN Xiaojing, HAO Dongmei, et al. Research on automatic diagnosis system of electrocardiogram. Chinese Journal of Medical Instrumentation, 2001,25(4):204-206 [57] Marek M. Heart rate variability: standards of measurement, physiological interpretation, and clinical use. Circulation, 1996,93:1043-1065 [58] 王留义，吴淑伦. 无创伤性心血管诊断技术. 中国医药科技出版社，1996
50

[59] Rompelman O, Snijders JB, Spronsen CY. The measurement of heart rate variability spectra with the help of personal computer. IEEE Trans Biomed Eng, 1982,29:503-510
[60] Pinna GD, Maestri R. Reliability of transfer function estimates in cardiovascular variability analysis. Med Biol Eng Comput, 2001,39:338-347
[61] Deboer RW, Karemaker JM, Strackee J. Comparing spectra of a series of point events particularly for heart rate variability data. IEEE Trans Biomed Eng, 1984,31:384-387
[62] Mateo J, Laguna P. Improved heart rate variability signal analysis from the beat occurrence times according to the IPFM model. IEEE Trans Biomed Eng, 2000,47(8):985-996
[63] 明东，田锡惠，杨春梅等. 心率变异(HRV)信号的谱分析方法研究. 北京生物医学工程， 2001,20(4):252-255
[64] 吕 晓 琪 ， 蒋 大 宗 . 心 率 波 动 信 号 的 谱 分 析 及 其 应 用 . 生 物 医 学 工 程 学 杂 志 ， 1993,10(3),212-217
[65] Burr RL, Cowan MJ. Autoregressive spectral models of heart rate variability. J Electrocardiol, 1992,10(2):152
[66] Jean-Luc Elghozi, Arlette Girard, Dominique Laude, Autonomic Neuroscience: Basic and Clinical, 2001,90:116-121
[67] Task Force of the European Society of Cardiology and the North American Society of Pacing and Electrophysiology. Heart rate variability-standards of measurement, physiological interpretation and clinical use. Circulation, 1996,93(2):1043-1065
[68] Karrakchou M, Vibe RK, Vesin JM, et al. Improving cardiovascular monitoring through modem techniques. IEEE Eng Med Biol Mag, 1996,15(5):68-78
[69] Goldberger AL. Fractal mechanisms in the electrophysiology of the heart. Magazine IEEE Eng Med Bio, 1992,11(6):47-52
[70] 秦明新，史学涛，王跃民等. HRV 非线性动力学分析动物实验初步研究. 生物医学工程学 杂志，1999,16(1):32-35
[71] 曹林生，冯义柏，曾秋棠等. 临床心内科讲座. 人民卫生出版社，1999 年 [72] Takens F. Dynamical systems and turbulence. Lecture Notes in Mathematics, 1981,898 [73] Tim Sauer, James A, MartinCasdagli. Embedology. JStatPhys, 1991,65:579 [74] Buzug T, Reimers T, Pfister G. Optimal recon struction of strange attractors from purely
geometrical arguments. Euro Phys Lett, 1990,13(4):605-607 [75] Albano AM, Smilowitz L, Rapp PE, et al. Physics of Phase Space. Berlin: Springer,
1987:156-177 [76] Fraser AM, Swinny HL. Independent coordinates for strange attractors from mutual
information. Physical Review A, 1986,33(!0):1134-1140
51

[77] Woo MA, et al. Patterns of beat-to-beat heart rate variability in advanced heart failure. Am Heart J, 1992,123:704
[78] Schepers HE, Von Beek JHGM, Bassingthwaighte JB. Four methods to estimate the fractal dimension form selfaffine signals. IEEE Eng Med Biol, 1992,11(6):57-64
[79] Aasen T. Chaos theory applied to the caloric response of the vestibular system. Computers and Biomedical Research, 1993,26:556-567
[80] Kaplan DT, Furman MI, Pincus SM, et al. Aging and the complexity of cardiovascular dynamics. Biophysical Journal, 1991,59(4):945-949
[81] Pincus SM. Approximation entropy as a measure of system complexity. Proc Natl Acad Sci USA, 1991,88(7):2297-2313
[82] Guzzetti S, Signorini MG, Cogliati C, et al. Non-linear dynamics and chaotic indices in heart rate variability of normal subjects and heart transplanted patients. Cardiovascular Research, 1996,31(3):441
[83] 唐丽萍，阮炯，庄亚纯等. 心肌梗死后心率变异的非线性动态演变. 中国心脏起搏与心电 生理杂志，2001,15(3):180-182
52

附录
硕士期间发表论文情况
[1] 刘灵，邓小燕，徐颖. 汽车驾驶员驾驶疲劳监测方法与装置的研究现状. 医疗卫生装备， 2006,27(12):28-30
[2] 徐颖，邓小燕，刘灵. β-环糊精手性流动相添加剂法拆分佐匹克隆对映体. 药学进展，2006,9 [3] 王红兵，邓小燕，汤振宇，蒋红兵，刘灵. 低温对心肌细胞形态变化及细胞间相互作用影
响的实验初探. 医用生物力学，2006,21(4):267-271
53

