Home Search Collections Journals About Contact us My IOPscience
Relationships between heart-rate variability and pulse-rate variability obtained from videoPPG signal using ZCA
This content has been downloaded from IOPscience. Please scroll down to see the full text. 2016 Physiol. Meas. 37 1934 (http://iopscience.iop.org/0967-3334/37/11/1934) View the table of contents for this issue, or go to the journal homepage for more
Download details: IP Address: 207.162.240.147 This content was downloaded on 04/10/2016 at 10:23
Please note that terms and conditions apply.
You may also be interested in: Photoplethysmography PRV as a surrogate measurement of HRV E Gil, M Orini, R Bailón et al. Improved motion robustness of remote-PPG by using the blood volume pulse signature G de Haan and A van Leest Comparison between symbolic and spectral analyses of short-term heart rate variability in a subsample of the ELSA-Brasil study Eduardo Miranda Dantas, Rodrigo Varejão Andreão, Valdo José Dias da Silva et al. Interchangeability between heart rate and photoplethysmography variabilities during sympathetic stimulations K Charlot, J Cornolo, J V Brugniaux et al. A careful look at ECG sampling frequency and R-peak interpolation on short-term measures of heart rate variability Robert J Ellis, Bilei Zhu, Julian Koenig et al. Combining and benchmarking methods of foetal ECG extraction without maternal or scalp electrode data Joachim Behar, Julien Oster and Gari D Clifford

Institute of Physics and Engineering in Medicine Physiol. Meas. 37 (2016) 1934–1944

Physiological Measurement doi:10.1088/0967-3334/37/11/1934

Relationships between heart-rate variability and pulse-rate variability obtained from video-PPG signal using ZCA

Luca Iozzia, Luca Cerina and Luca Mainardi

Department of Electronics, Information and Bioengineering, Politecnico di Milano, via Golgi 39, 20133 Milano, Italy

E-mail: luca.iozzia@polimi.it

Received 24 May 2016, revised 31 July 2016 Accepted for publication 2 August 2016 Published 28 September 2016

Abstract In this paper, classical time– and frequency-domain variability indexes obtained by pulse rate variability (PRV) series extracted from videophotoplethysmography signals (vPPG) were compared with heart rate variability (HRV) parameters extracted from ECG signals. The study focuses on the analysis of the changes observed during a rest-to-stand manoeuvre (a mild sympathetic stimulus) performed on 60 young, normal subjects (age: 24 ± 3 years). The objective is to evaluate if video-derived PRV indexes may replace HRV in the assessment of autonomic responses to external stimulation.
Video recordings were performed with a GigE Sony XCG-C30C camera and analyzed offline to extract the vPPG signal. A new method based on zero-phase component analysis (ZCA) was employed in combination with a fully-automatic method for detection and tracking of region of interest (ROI) located on the forehead, the cheek and the nose.
Results show an overall agreement between time and frequency domain indexes computed on HRV and PRV series. However, some differences exist between resting and standing conditions. During rest, all the indexes computed on HRV and PRV series were not statistically significantly different (p  >  0.05), and showed high correlation (Pearson’s r  >  0.90). The agreement decreases during standing, especially for the high-frequency, respirationrelated parameters such as RMSSD (r  =  0.75), pNN50 (r  =  0.68) and HF power (r  =  0.76). Finally, the power in the LF band (n.u.) was observed to increase significantly during standing by both HRV (28 ± 14 versus 45 ± 16 (n.u.); rest versus standing) and PRV (26 ± 12 versus 30 ± 13(n.u.); rest versus standing) analysis, but such an increase was lower in PRV parameters than that observed by HRV indexes.
These results provide evidence that some differences exist between variability indexes extracted from HRV and video-derived PRV, mainly in the

0967-3334/16/111934+11$33.00  © 2016 Institute of Physics and Engineering in Medicine  Printed in the UK

1934

Physiol. Meas. 37 (2016) 1934

L Iozzia et al

HF band during standing. However, despite these differences video-derived PRV indexes were able to evince the autonomic responses expected by the sympathetic stimulation induced by the rest-to-stand manoeuvre.
Keywords: video-photoplethysmography, pulse rate variability, autonomic nervous system, computer vision, ZCA, heart rate variability
(Some figures may appear in colour only in the online journal)

1. Introduction
The measurement of cardiovascular parameters using contactless video-photoplethysmography (vPPG) signals has gained more and more attention in the last decade (Verkruysse et al 2008, Lewandowska et al 2011, Poh et al 2011, de Haan and Jeanne 2013, Sun et al 2013, Bousefsaf et al 2014, Tarassenko et al 2014, Zaunseder et al 2014, Blackford and Estepp 2015, Moreno et al 2015). Since the pioneering works by Poh et al (2011), a variety of solutions have been proposed to derive, from video of a subject’s face, physiological parameters such as heart-rate (Takano and Ohta 2007) and breathing rate (Poh et al 2011, Tarassenko et al 2014) or to extract the vPPG signal (McDuff et al 2014b), detect the pulse waves and to compute beat-to-beat variability parameters (Zaunseder et al 2014).
Recently, the agreement between pulse-rate variability (PRV) parameters (both in time and frequency domain) obtained from PPG and vPPG signals have been assessed in resting conditions in a limited group of subjects (Poh et al 2011, Sun et al 2013, McDuff et al 2014a). One paper employs PRV obtained by vPPG as a surrogate for HRV (Moreno et al 2015) under supine and sitting conditions. However, a still open question is whether PRV derived from vPPG can be considered a valid surrogate for HRV parameters extracted from the RR interval series and whether they are able to describe changes in autonomic nervous system (ANS) modulation during provocative tests. To the extent of our knowledge, no study has addressed this issue systematically.
The purpose of this study is therefore to compare PRV parameters obtained from vPPG with HRV parameters computed on RR series and to evaluate the ability of vPPG parameters in detecting autonomic nervous system (ANS) changes during mild sympathetic stimulation induced by a rest-to-stand protocol. The study will be conducted on a cohort of 60 healthy subjects.
The paper is organized as follows: section 2 describes the experimental setup, including video and ECG recordings, the algorithms used to extract the vPPG signal and the HRV and PRV series. Performances of the methods and the comparison between PRV and HRV param­ eters on the population are described in section 3. Finally, discussion is reported in section 4.

2.  Material and methods
2.1.  Video and ECG recordings
Video recordings were performed through a GigE Sony XCG-C30C camera, whose image sensor is 1/3’ color progressive scan with spatial resolution of 659 × 494 pixels. Videos were acquired with a frame-rate of 60 frames-per-second (fps) and 8-bit resolution. Data were saved in RGB, uncompressed, AVI raw format to be processed offline. The camera was equipped with 15 mm fixed focal length lenses (Tamron 25 HB), which were used to magnify the region occupied by the participant’s face. The camera was fixed on a tripod, which was equipped
1935

Physiol. Meas. 37 (2016) 1934

L Iozzia et al

with a mechanical arm to allow the manual adjustment of camera’s positions when moving from one phase of the experiment to another.
The ECG signal was recorded by the FlexComp Infiniti by Thought Technologies, Inc. Electrodes were located on the body surface as follows: the negative electrode was placed on the right shoulder, the positive electrode on the left side of the chest and the ground electrode on the left shoulder. ECG traces were sampled at 256 Hz.

2.2.  Experimental procedure
A group of 60 healthy volunteers (31 male and 29 female) of different ages (24 ± 3 mean  ±  SD, range 20–34) were recruited for this study. Participants had various skin types ranging from type II to type IV.
All the recordings were conducted indoors, with a changing mixture of sunlight passing through the window and artificial light provided by indoor illumination. All the participants received a complete explanation of the above procedure and signed a comprehensive, written informed consent. Subjects underwent a classical rest-to-stand manoeuvre, which is known to elicit sympathetic responses. During rest, the subjects were asked to lay on a bed facing the camera. The bed was positioned in front of the window to have direct sunlight on subject’s face. Participants were instructed not to move their head in order to reduce movement artifacts. After a time period of 2–3 min, needed to relax the subjects and to stabilize their cardiac frequency, video and ECG recording were started and continued for 5 min. Next, the subjects were asked to stand up, while the camera was manually moved to follow their face. During this period both video and ECG recording were suspended. When subjects had reached a stable position and the camera was properly aligned, ECG and video recordings were restarted for a period of five minutes.

2.3.  Extraction of vPPG signal
Videos were processed offline to derive the vPPG signal. Three regions of interests (ROI) were considered: forehead (ROI1), nose (ROI2) and cheek (ROI3). ROI detection and tracking were developed in OpenCV: detections were performed with the Viola–Jones face detection algorithm (Viola and Jones 2001) while ROI tracking was obtained with the Lucas–Kanade– Tomasi motion flow tracking algorithm (LKT) (Lucas and Kanade 1991).
Let us indicate as M the number of color channels ( M  =  3, the R, G and B channels), as N the number of ROIs ( N  =  3 namely forehead, nose and cheek ROIs) and as L the number of frames of video recording. In each ROI, a spatial average of pixel intensity was calculated for each frame, thus obtaining M × N time series of L. These time series were first detrended using the technique described in Tarvainen et al (2002), setting the smoothness parameter λ = 400. A Hamming bandpass filter with cut-off frequencies of f1  =  0.1, f2  =  8 Hz was then applied to remove the high frequency components, mainly correlated with artificial light, and the low frequency components, associated with slow subject movements.
After this preprocessing, the vPPG signal was extracted using three methods: (i) the chrominance model; (ii) the zero-phase component analysis (ZCA) method and (iii) a method based on the combination of chrominance model and ICA (ChromICA). These will be briefly described in the following sections.
2.3.1.  Chrominance model.  According to deHaan’s work (2013), it is possible to maximize the pulsating component
of the reflected light and minimize extraneous noise by an appropriate weighting of R, G and B components:
1936

Physiol. Meas. 37 (2016) 1934

L Iozzia et al

S = c1R + c2G + c3B (1)

( ) ( ) where

c1 =

3

1−

α 2

,

c2 = −2

1+

α 2

,

c3 =

3α 2

are

the

linear

coefficients

and

α=

σ(X ) σ(Y )

is

the normalization factor that takes into account different amplitudes of the two chrominance

signals X and Y.

2.3.2. ZCA method.  The ZCA method can be seen as a variant of principal component analysis (PCA). Let X be an L × M matrix having the R, G and B channels in its columns and the L points in its rows. Let us also assume that the covariance C = XTX has eigenvectors in the columns of E matrix and the eigenvalues on the diagonal of Σ, so that C = EΣET. We are interested to find a matrix W so that the transformation:
Y = WX (2)
will produce a set of new variables Y which are uncorrelated and have unit variance (i.e. Y TY = I). In the PCA approach, the whitening matrix is:
W PCA = Σ−1/2ET. (3)
This transformation first rotates the variables using the eigenvectors in the matrix E. This results in orthogonal components characterized by different variances. To achieve whitened data, the rotated variables are scaled by the square root of the eigenvalues Σ−1/2. Because of the rotation, the decorrelated channels will be shuffled with respect to the order of the input data. However, since the pulse information is mainly contained in the G channel (as shown by Verkruysse et al (2008)), a method that could avoid the shuffle of the channels would facilitate the selection of the channel containing the main videoPPG information. One possible solution is represented by zero phase component analysis (ZCA). In ZCA the following transformation matrix is used:
W ZCA = EΣ−1/2ET. (4)
In this case the second rotation given by E rotates the data back to the original coordinate system. Therefore the term zero phase indicates the forward-backward projection of the data to the original space.
The ZCA is also called Mahalanobis transformation and, according to Kessy et al (2015), among the whitening methods, it is the unique method that, by maximizing the cross-­ covariance Φ between the original data X and whitened data Y, can minimize the squared total of their distance (defined as Mahalanobis distance):
d (X, Y) = (X − Y)TΦ−1(X − Y) . (5)

2.3.3.  ChromICA method.  Among the population a bulk of subjects moved their heads excessively while standing. In these cases the Chrom method lacked robustness to recover the pulse cardiac information. We therefore decided to combine the Chrom method—useful to exploit the BVP signal, and ICA—better to separate the motion artifact from the desired signal.
For each frame the ROI tracking gives the position x-y of each region. After detrending and band-pass filtering the time series, two signals associated with the ROIs movement are available. Together with the chrominance signal a matrix of 3 × Ndata was created for each ROI and ICA decomposition, based on the joint approximate diagonalization of eigenmatrices (JADE) algorithm (Cardoso 1999), was applied to separate the motion artifact from the pulse signal. However, since ICA decomposition does not preserve the order of output channels the ZCA decorrelation has been implemented in the JADE algorithm.
1937

Physiol. Meas. 37 (2016) 1934

L Iozzia et al

Each method was applied to a window of 5 s to account for nonstationarity noise such as motion artifacts and abrupt changes in reflecting light. Within each epoch, a coarse estimate of pulse rate fc was obtained by the power spectral density (PSD) of the windowed signal. The estimate of pulse rate can be erroneous at times, so a record of the history of pulse rates over past epochs was maintained. If the current fc was off by more than 20%, its value was substituted with the median of previous pulse rate estimates.
We thereby obtained three vPPG signals, one from each of the ROI analysed. Among them, the selection of the target vPPG signal was achieved by calculating the power spectral density (PSD) on the entire signal and by measuring the SNR using the following formula:
S NR = 10 ∗ log10⎛⎝⎜⎜⎜ ∫0.f11 PvPPG∫i(f1ff2)PdvfP+PG∫i(ff24)PdvfPPGi( f ) df ⎞⎠⎟⎟⎟ (6)
where PvPPGi( f ) (with i ∈ {1, 2, …, NROI}) is the PSD of ith vPPG signals, f1 = fp − 0.15, f2 = fp + 0.15 and where fp is the pulse frequency (measured in Hz). The signal with the highest SNR was selected as target vPPG signal. Finally, vPPG signal was interpolated using cubic splines and resampled at 256 Hz, to match the temporal resolution of the ECG signal.

2.4.  Extraction of RR and PP series
The detection of pulse waves (P) in vPPG was performed on the first derivative of the signal by applying the algorithm proposed by Tarvainen et al (2002). Since the detection of the peak was done on the derivative of the vPPG signal, the position of each pulse is located at the maximum of first derivative, i.e. along the rising edge of the cardiac pulse (defined as anachrotic phase). The PP series were extracted as the series of time differences between two consecutive P positions. To correct possible mis-detected pulses, the adaptive filtering algorithm proposed by Wessel et al (2000) was applied on PP series.
The detection of R peaks in the ECG was automatically performed by applying the method of Afonso et al (1999). The R detections were then visually inspected and the misdetected/ erroneous beats were corrected using home-made interactive software. Finally, the RR interval series were extracted as the series of time difference between two consecutive R positions. The correctness of R detections and RR series is needed because they will represent the gold standard for the comparison of vPPG methods.

2.5.  Quantification of HRV parameters
Analysis of HRV was performed in both time and frequency domain using classical timeinvariant, linear methods as described in Task Force of the European Society of Cardiology, the North American Society of Pacing and Electrophysiology (1996). In time-domain, we computed the mean of normal-to-normal intervals (NN), the standard deviation of all NN intervals (SDNN), the square root of the mean of the sum of the squares of differences of adjacent NN (RMSSD) and the proportion of NNs that differ by more than 50 ms.
In frequency domain, the corrected PP and RR series were resampled at 2 Hz and the PSD of Heart Rate Variability (HRV) and Pulse Rate Variability (PRV) was computed by Welch power spectral density estimate in order to analyze ANS parasympathetic and sympathetic activity. According to Task Force of the European Society of Cardiology, the North American Society of Pacing and Electrophysiology (1996), the spectrum of these signals is characterized by three main spectral components: the very low frequency (VLF) component in the
1938

Physiol. Meas. 37 (2016) 1934

L Iozzia et al

frequency band [0.003–0.04] Hz, the low frequency (LF) component in the [0.04–0.15] Hz band and the high frequency (HF) component in the [0.15–0.4] Hz band. Although there is controversy over the physiological meaning of each component, it is generally assumed that the LF corresponds to sympathetic and parasympathetic modulation, while the HF is associated to parasympathetic modulation. Finally, the ratio between LF and HF measures the sympatho/vagal balance responsible for heart rate modulation. The quantitative evaluation of the power associated to the LF, HF components has been conducted by determining the area under the PSD of RR/PP intervals. In this study, the LF and HF components are presented in normalized units.

3. Results
Two subjects out of 60 were excluded from the analysis: in detail, one subject was moving excessively during the standing session, while for the second one the standing session was not acquired for technical problems. We therefore present the results for 58 subjects. Results will be divided in two sections: one is dedicated to the comparison of methods performance and the second regards the comparison between HRV and PRV parameters.

3.1.  Performances of the methods
Figure 1 shows the average SNR (computed by equation (6)) of vPPG signal extracted with the three considered methods (Chrom, ZCA, ChromICA) in the ROIs of interest. During rest (figure 1(a)), the averaged SNR is almost equivalent for Chrom and ZCA methods, while it is slightly worse when ChromICA is used, especially for ROI1 (forehead). During standing (figure 1(b)), the SNR is lower than in resting conditions, thus leading to a more problematic extraction of vPPG signal in standing conditions. Comparing the methods, the ZCA method has a slightly better performance in all the three ROIs, while the ChromICA has always the worse performance.
Pulse detection performances are reported in table 1 in terms of sensitivity, positive prediction and accuracy. Very excellent performances are observable during rest, but all the methods share a performance drop passing from rest to standing session. However, the lowest reduction of performance is experienced when vPPG is obtained using the ZCA method.
We finally compared the methods in terms of computational load (calculated in the proprietary commercial software Matlab running on Macbook Air, Processor Intel i5), measured as the computation time needed to process the RGB signals and to extract the vPPG signal. Table 2 reports the averaged computational load for all the methods. As the Chrom method is based on an a priori model and only needs the calculation of the coefficients c1, c2, c3 of equation (1), this method is faster than ChromICA and ZCA, which have to separate the sources by heuristic approaches.
According to the above results, the ZCA method was shown to be a good compromise between robustness and speed. Therefore vPPG signal extracted by this method was selected for the subsequent variability analysis.

3.2.  Comparison between PRV and HRV parameters In figure 2 the correlations calculated over all the population between ECG and vPPG regarding temporal parameters are reported. During rest session the Pearson correlation remains high (r  >  0.90) for all parameters. In the standing session the mean heart rate and the SDNN
1939

Physiol. Meas. 37 (2016) 1934

L Iozzia et al

Figure 1.  Comparison of SNR obtained for all subjects and different facial regions (ROI1, ROI2, ROI3). (a) Rest session; (b) standing session.

Table 1.  Mean beat detection accuracy according to Se,   +  P and Acc over all subjects for rest and standing conditions.

Sensitivity

Positive prediction Accuracy

At rest Chrom ZCA ChromICA Standing Chrom ZCA ChromICA

0.989 ± 0.010 0.996 ± 0.006 0.988 ± 0.010
0.969 ± 0.080 0.986 ± 0.039 0.966 ± 0.079

0.988 ± 0.029 0.992 ± 0.015 0.972 ± 0.026
0.941 ± 0.175 0.974 ± 0.083 0.928 ± 0.143

0.979 ± 0.036 0.988 ± 0.019 0.961 ± 0.032
0.927 ± 0.180 0.961 ± 0.093 0.911 ± 0.149

Note: All values are expressed in mean  ±  std.

Table 2.  Mean computational load calculated for the three different methods Chrom, ZCA and ChromICA needed to process 5 s windowed signal.

Method

Computational load

Chrom ZCA ChromICA

2.78 ± 0.46 3.21 ± 0.76 5.42 ± 1.54

Note: Expressed in ms.

maintained high correlation, while RMSSD and pNN50 values are distributed in a wider cloud, therefore the correlation falls. A confirmation of worse RMSSD results during standing session is shown in the table 3, where the RMSSD estimated on PP series in standing sessions is higher both in mean and standard deviation compared to the RMSSD estimated on RR series.
In figure 3 the correlations over all the population between ECG and vPPG of spectral parameters LF, HF and LF/HF are reported. During the rest session there is a strong correspondence between PRV and HRV spectral parameters (r  >  0.9). However in the standing position there is an evident drop of correlations in LF, HF and LF/HF. In table 3 it is possible
1940

Physiol. Meas. 37 (2016) 1934

L Iozzia et al

Figure 2.  Scatter plots comparing the temporal measurements of ((a)–(e)) heart rate (HR), ((b)–(f )) SDNN, ((c)–(g)) RMSSD, ((d)–(h)) pNN50, for the ECG and vPPG signal. Upper row: rest session; lower row: standing session.

Table 3.  Comparison of temporal and frequency parameters between the ECG sensor and the video camera considering rest-to-stand session.

ECG

vPPG

Rest

Stand

Rest

Stand

HR(Hz) SDNN(ms) RMSSD(ms) pNN50(%) LF(%) HF(%) LF/HF

1.15 ± 0.18 52 ± 24 24 ± 8 6±6 28 ± 14 64 ± 13% 0.51 ± 0.38

1.37 ± 0.20b 56 ± 19 18 ± 7b 3 ± 4b 45 ± 16b 47 ± 14b 1.17 ± 0.79b

1.15 ± 0.18 50 ± 17 24 ± 8 6±6 26 ± 12 61 ± 11 0.49 ± 0.34

1, 37 ± 0, 21b 54 ± 17 24 ± 10 6±7 30 ± 13a
50 ± 10b 0.70 ± 0.51b

a p-value  <  0.05, b p value  <  0.01.

to notice that during standing sessions there is a negative bias of the mean of LF and an overestimation of the mean of HF component estimated from PP series compared to LF and HF calculated from RR series. Therefore the sympatho/vagal balance expressed by the LF/HF ratio is clearly underestimated, and a bias of 0.5 is expressed between the vPPG system and the ECG. Although the sympatho/vagal balance value obtained by vPPG is underestimated, table 3 shows that there is a statistically significant difference in the LF/HF between rest and standing sessions, detectable by both HRV and PRV.

4. Discussions
A few scientific articles have investigated the PRV obtained by vPPG signal (Poh et al 2011, Sun et al 2013, McDuff et al 2014a). However none of them have tested how vPPG-derived autonomic indexes are modified during autonomic stimulation and validated the vPPG-derived PRV as a good surrogate of HRV.

1941

Physiol. Meas. 37 (2016) 1934

L Iozzia et al

Figure 3.  Scatter plots comparing the spectral measurements of ((a)–(d)) LF, ((b)–(e)) HF, ((c)–(f )) LF/HF ratio, for the ECG and vPPG signal. Upper row: rest session; lower row: standing session.
The extraction of PRV parameters from vPPG is not novel. Poh et al (2011) were the first to implement a fully automated method to extract from vPPG signal the spectral parameters of PRV as LF, HF and LF/HF ratio, even if the time recording was quite short (1 min only) for an effective computation of spectral parameters (Task Force of the European Society of Cardiology, the North American Society of Pacing and Electrophysiology 1996); in addition, the analysis was performed on subjects in the resting state, only.
McDuff et al (2014a) improved on the previous work, studying the sympathetic activation during a session of rest/stress tasks. The results in terms of spectral parameters (LF,HF and LF/HF ratio) showed a good correlation (r  >  0.86) between the vPPG system and the contact PPG sensor. Although the article demonstrated the feasibility of vPPG technology to monitor stress conditions, some limitations arose: the PRV analysis was limited to frequency domain only; the use of ICA method implied the implementation of a heuristic approach for the selection of the output channel that can fail when strong periodic subject movements are present.
Similar comparisons between PRV and video-PRV have been performed in other works (Sun et al 2013, Bousefsaf et al 2014), but this comparison is not exhaustive as it is known that PRV and HRV may differ (Schäfer and Vagedes 2013), especially during sympathetic stimulation. Only one previous work Moreno et al (2015) studied the temporal and spectral analysis comparing the HRV obtained by ECG chest strap and the PRV obtained by the vPPG system during supine and sitting sessions. However, the subjects acquired in supine position were different from those recorded in sitting position and thus no evaluation of the capability of the PRV to describe autonomic changes in the same subject was achieved. Moreover no automatic method was developed to identify the ROI (done manually) and a controlled illumination of the environment was performed in order to reduce artificial light interference.
To the extent of our knowledge, this work is the only one to investigate the vPPG derived parameters as a surrogate for HRV. Our results show that during rest session both short-term (RMSSD, pNN50, HF) and long-term variability parameters (LF,SD) are in good agreement (correlation r  >  0.91). However during standing sessions the concordance deteriorated, especially in all short-term variability parameters, and the LF/HF ratio exhibits positive bias. This
1942

Physiol. Meas. 37 (2016) 1934

L Iozzia et al

deterioration does not affect the capability to detect autonomic changes in LF and HF comp­ onents passing from rest to standing.
Temporal parameters pNN50 and RMSSD evinced the largest differences: if pNN50 and RMSSD calculated in ECG are significantly different passing from rest to standing, the same is not observable in vPPG. The difference in pNN50 and RMSSD can be explained by the lower sampling frequency of video recording (60 Hz), which generates a smooth vPPG signal and induces jitter in vPPG fiducial point detection in the range of (±1/60 ≈ ± 17). This certainly affects PRV interval measurements.
Even if this problem can be overcome in future work by using higher video sampling rate, it is important to observe these disagreements are also detected using contact PPG recordings as reported in the review by Schäfer and Vagedes (2013) on the accuracy of PRV as an estimate of HRV. Studies conducted using rest-to-stand or rest-to-tilt protocols (Carrasco et al 1998, Lu et al 2008, Charlot et al 2009) showed an increased bias during sympathetic stimulus, especially in short-term variability parameters, like RMSSD, pNN50. This difference can be explained by pulse-transit time (PTT) variability (Gil et al 2010), which strongly modulates high-frequency components of PRV. PTT influences seem to be predominant during standing.
From a methodological point of view, we have investigated a new method for the extraction of vPPG signals on short time segments (5 s) with potential for real-time acquisition. The method is based on ZCA, a variant of PCA. The advantage of using the ZCA method is twofold: firstly, ZCA, by projecting data back to the original space, avoids searching for pulse signals among the detected components (required for PCA or ICA approaches); secondly ZCA is not affected by flipping (i.e. inversion of the sign from one segment to the consecutive ones) as may happen in ICA. Our approach has proven to be robust in comparison with Chrom and ChromICA. We observed that vPPG reconstructed by ZCA has a slightly better SNR than those reconstructed by the Chrom method, especially in the most critical situation (i.e. during standing). In addition, the location of pulse waves was superior in terms of both sensitivity and specificity using our approach. Conversely, the Chrom method was the best in terms of computational burden.
The overall conclusion is that vPPG variability parameters can be considered as a good surrogate for HRV parameters in the supine position, while more caution should be paid during standing, where the agreement deteriorates due to both to methodological (increased motion noises) and physiological reasons (i.e. PTT). Nevertheless, we showed that the PRV extracted by vPPG is able to highlight the mild autonomic activation induced by standing and thus PRV parameters derived from vPPG can be used to assess autonomic responses.

References

Afonso V X, Tompkins W J, Nguyen T Q and Luo S 1999 ECG beat detection using filter banks IEEE
Trans. Biomed. Eng. 46 192–202 Blackford E B and Estepp J R 2015 Effects of frame rate and image resolution on pulse rate measured
using multiple camera imaging photoplethysmography Proc. SPIE 947 94172D1–4 Bousefsaf F, Maaoui C and Pruski A 2014 Remote detection of mental workload changes using cardiac
parameters assessed with a low-cost webcam Comput. Biol. Med. 53 154–63 Cardoso J F 1999 High-order contrasts for independent component analysis Neural Comput. 11 157–92 Carrasco S, Gonzalez R, Jimenez J, Roman R, Medina V and Azpiroz J 1998 Comparison of the heart
rate variability parameters obtained from the electrocardiogram and the blood pressure wave
J. Med. Eng. Technol. 22 195–205 Charlot K, Cornolo J, Brugniaux J V, Richalet J P and Pichon A 2009 Interchangeability between heart
rate and photoplethysmography variabilities during sympathetic stimulations Physiol. Meas.
30 1357–69

1943

Physiol. Meas. 37 (2016) 1934

L Iozzia et al

de Haan G and Jeanne V 2013 Robust pulse rate from chrominance-based rppg IEEE Trans. Biomed.
Eng. 60 2878–86 Gil E, Orini M, Bailón R, Vergara J M, Mainardi L T and Laguna P 2010 Photoplethysmography pulse
rate variability as a surrogate measurement of heart rate variability during non-stationary conditions
Physiol. Meas. 31 1271–90 Kessy A, Lewin A and Strimmer K 2015 Optimal whitening and decorrelation Stat. ME pp 1–14 Lewandowska M, Rumiński J, Kocejo T and Nowak J 2011 Measuring pulse rate with a webcam—a
noncontact method for evaluating cardiac activity Proc. of the Federated Conf. on Computer
Science and Information Systems vol 22 pp 405–10 Lu S, Zhao H, Ju K, Shin K, Lee M, Shelley K and Chon K H 2008 Can photoplethysmography
variability serve as an alternative approach to obtain heart rate variability information? J. Clin.
Monit. Comput. 22 23–9 Lucas B D and Kanade T 1991 Detection and tracking of point features Technical Report MU-CS-91-
132, Carnegie Mellon University
McDuff D, Gontarek S and Picard R W 2014a Improvements in remote cardiopulmonary measurement
using a five band digital camera IEEE Trans. Biomed. Eng. 61 2593–601 McDuff D, Gontarek S and Picard R W 2014b Remote detection of photoplethysmographic systolic and
diastolic peaks using a digital camera IEEE Trans. Biomed. Eng. 61 2948–54 Moreno J, Ramos-Castro2 J, Movellan J, Parrado E, Rodas G and Capdevila L 2015 Facial video-based
photoplethysmography to detect HRV at rest Sports Med. 36 1–7 Poh M-Z, McDuff D and Picard R W 2011 Advancements in noncontact, multiparameter physiological
measurements using a webcam IEEE Trans. Biomed. Eng. 58 7–11 Schäfer A and Vagedes J 2013 How accurate is pulse rate variability as an estimate of heart rate variability?
A review on studies comparing photoplethysmographic technology with an electrocardiogram Int.
J. Cardiol. 166 15–29 Sun Y, Hu S, Azorin-Peris V, Kalawsky R and Greenwald S 2013 Noncontact imaging
photoplethysmography to effectively access pulse rate variability J. Biomed. Opt. 18 1205–13 Takano C and Ohta Y 2007 Heart rate measurement based on a time-lapse image Med. Eng. Phys.
29 853–7 Tarassenko L, Villarroel M, Guazzi A, Jorge J, Clifton D A and Pugh C 2014 Non-contact video-
based vital sign monitoring using ambient light and auto-regressive models Inst. Phys. Eng. Med.
35 807–31 Tarvainen M P, Ranta-Aho P O and Karjalainen P A 2002 An advanced detrending method with
application to HRV analysis IEEE Trans. Biomed. Eng. 49 172–5 Task Force of the European Society of Cardiology, the North American Society of Pacing and
Electrophysiology 1996 Heart rate variability Eur. Heart J. 17 354–81 Verkruysse W, Svaasand L O and Nelson J S 2008 Remote plethysmographic imaging using ambient
light Opt. Express 16 21434–45 Viola P and Jones M 2001 Rapid object detection using a boosted cascade of simple features Proc. of
IEEE Conf. on Computer Vision and Pattern Recognition p 511
Wessel N, Voss A, Malberg H, Ziehmann Ch, Voss H U, Schirdewan A, Meyerfeldt U and Kurths J
2000 Nonlinear analysis of complex phenomena in cardiological data Herzschrittmacherther.
Elektrophys. 11 159–73 Zaunseder S, Heinke A, Trumpp A and Malberg H 2014 Heart beat detection and analysis from videos
IEEE Int. Conf. Electronics and Nanotechnology 24 286–90

1944

