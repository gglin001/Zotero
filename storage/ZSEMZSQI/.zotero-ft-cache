The Accuracy of Atrial Fibrillation Detection from Wrist Photoplethysmography. A Study on Post-Operative Patients
Adrian Tarniceriu1, Jarkko Harju2, Zeinab Rezaei Youseﬁ3, Antti Vehkaoja3, Jakub Parak3, IEEE Student Member, Arvi Yli-Hankala2, and Ilkka Korhonen3, IEEE Senior Member

Abstract— Atrial ﬁbrillation (AF) is the most common type of cardiac arrhythmia. Although not life-threatening itself, AF signiﬁcantly increases the risk of stroke and myocardial infarction. Current tools available for screening and monitoring of AF are inadequate and an unobtrusive alternative, suitable for long-term use, is needed. This paper evaluates an atrial ﬁbrillation detection algorithm based on wrist photoplethysmographic (PPG) signals. 29 patients recovering from surgery in the post-anesthesia care unit were monitored. 15 patients had sinus rhythm (SR, 67.5 ± 10.7 years old, 7 female) and 14 patients had AF (74.8 ± 8.3 years old, 8 female) during the recordings. Inter-beat intervals (IBI) were estimated from PPG signals. As IBI estimation is highly sensitive to motion or other types of noise, acceleration signals and PPG waveforms were used to automatically detect and discard unreliable IBI. AF was detected from windows of 20 consecutive IBI with 98.45 ± 6.89% sensitivity and 99.13 ± 1.79% speciﬁcity for 76.34 ± 19.54% of the time. For the remaining time, no decision was taken due to the lack of reliable IBI. The results show that wrist PPG is suitable for long term monitoring and AF screening. In addition, this technique provides a more comfortable alternative to ECG devices.
I. INTRODUCTION
Atrial ﬁbrillation (AF) is the most common type of cardiac arrhythmia, affecting more than 10% of the population above 75 years old [1]. Even if AF may display symptoms such as heart palpitations, shortness of breath, or lightheadedness [2], it is asymptomatic in at least one third of the cases [3]. However, AF is associated with increased risk of myocardial infarction [4], heart failure [5], and stroke [6]. As a result, timely and reliable detection of AF is an essential part of both treatment and pre-emptive therapy.
The common techniques for AF diagnosis are based on ECG, and can be either in-hospital or ambulatory monitoring, such as 24/48 hour Holter monitors, or event recorders triggered automatically or by the user when AF symptoms are noticed. However, these methods suffer from several drawbacks. For paroxysmal AF, the arrhythmia episodes are irregular and might not occur during the measurement period (24/48 hour Holter monitoring only detect AF in 30% to 60% of the cases [7]). If worn for longer durations, the electrodes can easily become uncomfortable and possibly cause skin
1A. Tarniceriu is with PulseOn SA, Neuchaˆtel, Switzerland adrian.tarniceriu@pulseon.com
2J. Harju and A. Yli-Hankala are with the Tampere University Hospital, Tampere, Finland
3Z. Rezaei Youseﬁ, A. Vehkaoja, J. Parak and I. Korhonen are with BioMediTech Institute and the Faculty of Biomedical Sciences and Engineering, Tampere University of Technology, Tampere, Finland, and with PulseOn Oy, Espoo, Finland

irritations. Monitoring tool obtrusiveness and high cost can also lead to low patient acceptance rate. Thus, alternative diagnosis tools are needed.
Photoplethysmography (PPG) can be used as an alternative method for ECG when estimating heart rate (HR) and heart rate variability (HRV) [8]. The skin is illuminated with a LED, and the amplitude of transmitted or reﬂected light is measured with a photodetector. This amplitude varies with the amount of blood in the capillaries, which, in turn, depends on the pumping actions of the heart. As a result, we can accurately estimate HR [9], [10] and, in the absence of motion, inter-beat intervals (IBI) [11], [12] from PPG signals.
AF detection from PPG signals has not been extensively studied, but there is increasing interest in this domain. Proposed methods investigate the possibility of extracting IBI from PPG signals, usually ﬁnger or wrist-based, and taking the decision based on IBI series statistics. Commonly used features are IBI dispersion, sample entropy [13], [14], distribution histograms [15], or successive IBI probabilities [16]. Others analyze the PPG signal power spectrum distribution [17] or PPG waveform similarities [18] to discriminate between AF and sinus rhythm (SR) cases.
This paper evaluates a real-time AF detection algorithm designed for long-term monitoring. It is based on processing IBI extracted from wrist PPG signals. As PPG signals are highly sensitive to motion, varying ambient light, or other interferences, and IBI estimation is not reliable in such situations [19], a method to automatically screen out poor quality data is included in the proposed solution. When proven accurate, this technology would highly beneﬁt the AF monitoring ﬁeld: it provides a comfortable alternative to ECG devices, it is suitable for long-term or continuous monitoring, and it is expected to be signiﬁcantly cheaper than ECG devices.
II. MATERIALS AND METHODS
A. Subjects
The study group consists of 30 subjects that had undergone surgery immediately prior to the recording and were recovering from the effects of anesthetics. The subjects were classiﬁed in two groups, having either continuous SR or continuous AF, with the group being decided at the beginning of the measurement, based on the current rhythm. One patient in the AF group initially had AF, which was reversed to SR soon after the beginning of the measurement. Therefore, it was discarded from the ﬁnal analysis. The SR group consists of 15 subjects, 8 male, 7 female, 67.5 ± 10.7 years old. The

Fig. 1. PulseOn OHR tracker placed on the wrist
AF group consists of 14 subjects, 6 male, 8 female, 74.8±8.3 years old.
The study protocol, devices, and documentation were approved by the local ethical review board of Pirkanmaa Hospital District (R17024), the Finnish National Supervisory Authority of Health and Welfare, and the hospital technical department. The test subjects gave their written consent to participate and had the right to withdraw at any time. The experimental procedures comply with the principles of the Helsinki Declaration of 1975, as revised in 2000.
B. Data Acquisition
Wrist PPG signals were recorded with an optical heart rate (OHR) monitor made by PulseOn Ltd. (www.pulseon.ﬁ), presented in Figure 1. The device was worn as instructed by the manufacturer, about one ﬁnger width from the wrist bone and tightened by the person in charge of data collection, to ensure optimal skin contact for the whole recording. IBI were extracted from the PPG signals using the PulseOn algorithms.
The ECG signals, used for reference, were measured with the GE CarescapeTM B850 monitor (GE Healthcare Ltd., www.gehealthcare.com). The RR intervals (RRI) were obtained from the ECG signals using the Kubios HRV software, version 2.2 (Kubios Ltd., www.kubios.com). The ECG waveforms were also visually inspected to ensure that no R-waves were missed, to correct any R-wave detection errors, and to ensure that the whole measurement was either SR or AF.
The recordings took place in the post-anesthesia care unit of the Tampere University Hospital. The subjects were lying down in bed during the whole duration of the measurement, but could move their hands. The average duration of each recording is approximatively 1.5 hours. In total, there were 23.52 hours of data recorded for the SR group and 21.96 hours for the AF group.
C. Methods
In Figures 2 and 3, we present two examples of ECG and PPG waveforms, and the corresponding RRI and IBI values for the SR and AF cases, respectively, in the absence of noise. We notice the absence of the P-wave in the ECG signals for

the AF set, but there is no visible morphological difference in the PPG signal. However, the variation of the IBI values is clearly higher for the AF set, fact which will be considered by the used algorithm.
The algorithm runs in real-time and its block scheme is presented in Figure 4. The input signals are PPG and accelerometer data recorded by the OHR device. The main processing blocks are:
• IBI extraction: Estimates the IBI from the raw PPG signals. The accuracy of this method has been validated for both SR and AF subjects of different ages and health conditions in [12], [20]. In the absence of motion, the IBI estimation error relative to the ECG reference is below 1% for SR subjects, and 1.58% for AF subjects. This accuracy is suitable for both HRV analysis and to differentiate between AF and SR.
• Beat validation: As IBI estimation is not reliable in the presence of noise, it is important to screen out such data. This is done by using both the acceleration signals and the morphology of the PPG signal. A mask is associated to each computed IBI value, indicating whether it is
Fig. 2. Example of ECG and PPG waveforms and the corresponding RRI and IBI during sinus rhythm
Fig. 3. Example of ECG and PPG waveforms and the corresponding RRI and IBI during atrial ﬁbrillation

Fig. 4. AF detection algorithm block scheme

Fig. 5. Example of beat reliability and AF/SR detection

reliable (mask = 0) or not (mask = 1). Ectopic beats are also identiﬁed by this block. • AF detection: The AF detection algorithm is based on a Markov model approach, similar to the work of Moody and Mark [21]. It operates on sliding windows of 20 consecutive IBI and returns the most likely condition, SR (output > 0) or AF (output < 0). If less than half of the beats from the window are reliable, then the output is set as undetermined, due to the insufﬁcient number of reliably detected IBI (output = 0).
Figure 5 illustrates how the proposed method works. In the 160 - 165 s interval, motion, depicted as variations in the 3D acceleration signal, generates artefacts in the PPG signal. In these situations, IBI estimation is inaccurate, as seen in the comparison with the ECG reference. The beat validation block detects this and marks the beats as unreliable (the IBI mask from the lower panel is set to > 0). Afterwards, when the movement stops, the PPG signal quality increases and the IBI are considered reliable (the IBI mask is set to 0). Unreliable input beats cause the output of the AF/SR decision block to be set to 0, or undetermined. When the beats are reliable again, the decision is set to SR (> 0). Note that the AF/SR decision appears to be delayed because at least 10 beats out of the last 20 should be reliable for a SR or AF decision to be taken.
The performance of the proposed algorithm is evaluated in terms of sensitivity (percentage of AF data classiﬁed as AF) and speciﬁcity (percentage of SR data classiﬁed as SR). To understand the importance of correctly identifying reliable beats, we compute the statistics in three cases: for the ECG RRI intervals, for all PPG IBI (i.e., all detected beats are considered reliable), and for the proposed method.
III. RESULTS AND DISCUSSION
The rhythm classiﬁcation results are shown in Table I. AF detection was achieved with 98.45±6.89% (μ±σ) sensitivity and 99.13±1.79% speciﬁcity. This is comparable to or better

than what has been reported in previous studies, using either ECG or PPG signals [22].
The importance of using only reliably estimated beats is visible in the speciﬁcity values: 99.93 ± 0.16% for RRI, 99.13 ± 1.79% for the proposed method, and only 87.23 ± 11.13% when considering all IBI. It might seem surprising that the sensitivity is the lowest for the ECG data, which is the gold standard method. But the overall statistics were highly affected by the results of one patient. For this case, the rhythm was classiﬁed as AF and analyzed as such based on the absence of P-waves in the ECG waveform. However, in contrast to other measurements, this recording included long periods of stationary IBI, similar to the SR cases. Ignoring this recording, the sensitivity values become 99.68 ± 0.50%, 99.53 ± 0.57%, and 99.72 ± 0.33% for the RRI, all IBI, and proposed method, respectively.
The price to be paid for the improved performance of the proposed method compared to considering all the beats is that some of the data is discarded. 79.55 ± 17.23% of the total amount of data were classiﬁed as SR or AF for the SR group and 73.12 ± 21.08% for the AF group. However, discarding some data and not providing an output is naturally preferred to having a wrong decision due to inaccurate data.
The results presented so far were obtained on sets containing either continuous SR or continuous AF data. However, the algorithm can also detect isolated AF episodes, as in the example from Figure 6. The two occurring AF episodes, after 1000 s and close to 5000 s, are both correctly identiﬁed. There are other periods when the estimated IBI are irregular,

TABLE I AF/SR CLASSIFICATION RESULTS

SR [%] AF [%] Classiﬁed data [%]

ECG RRI All IBI

SR 99.93 AF 2.80 SR 87.23 AF 1.08

0.07 97.20 12.77 98.92

100

Proposed method

SR AF

99.13 1.55

0.87 98.45

79.55 73.12

Fig. 6. Algorithm output for one measurement containing both SR and AF episodes
with patterns similar to AF cases, but they are considered unreliable. On these occasions, the output is set to undetermined, and not falsely to AF.
IV. CONCLUSION
This study evaluated the accuracy of a real-time AF detection algorithm from wrist PPG and acceleration signals. The decision is taken based on the IBI values. The sensitivity of the proposed method is 98.45 ± 6.89% and the speciﬁcity 99.13 ± 1.79%. The results are based on measurements containing either SR or AF data. However, tests on measurements containing both SR and AF episodes, as in Figure 6, showed that AF episodes as short as 30 seconds can be detected.
Besides validating the AF detection algorithm, the method to distinguish between reliable and unreliable beats has also been validated. The speciﬁcity increases from 87.23 ± 11.13% when considering all IBI to 99.13 ± 1.79% when considering only reliable IBI. This is similar to the value obtained from the ECG signals.
To conclude, this study conﬁrms that, in the absence of motion, wrist PPG signals can be used to detect AF with accuracy comparable to ECG devices. Considering that the measuring device is unobtrusive and comfortable to wear, and that unreliable data is automatically detected, this technology represents an attractive option for continuous long-term monitoring.
REFERENCES
[1] S. S. Chugh, R. Havmoeller, K. Narayanan, D. Singh, M. Rienstra, E. J. Benjamin, R. F. Gillum, Y.-H. Kim, J. H. McAnulty, Z.-J. Zheng, M. H. Forouzanfar, M. Naghavi, G. A. Mensah, M. Ezzati, and C. J. Murray, “Worldwide epidemiology of atrial ﬁbrillation,” Circulation, vol. 129, no. 8, pp. 837–847, 2014.
[2] A. Houghton and D. Gray, Chamberlain’s Symptoms and Signs in Clinical Medicine 13th Edition, An Introduction to Medical Diagnosis. Taylor & Francis, 2010.
[3] J. S. Healey, S. J. Connolly, M. R. Gold, C. W. Israel, I. C. Van Gelder, A. Capucci, C. Lau, E. Fain, S. Yang, C. Bailleul, C. A. Morillo, M. Carlson, E. Themeles, E. S. Kaufman, and S. H. Hohnloser, “Subclinical atrial ﬁbrillation and the risk of stroke,” New England Journal of Medicine, vol. 366, no. 2, pp. 120–129, 2012.

[4] E. Z. Soliman, M. M. Safford, P. Muntner, Y. Khodneva, F. Z. Dawood, N. A. Zakai, E. L. Thacker, S. Judd, V. J. Howard, G. Howard, D. M. Herrington, and M. Cushman, “Atrial ﬁbrillation and the risk of myocardial infarction,” JAMA Internal Medicine, vol. 174, no. 1, pp. 107–114, 2014.
[5] E. Anter, M. Jessup, and D. J. Callans, “Atrial ﬁbrillation and heart failure. Treatment considerations for a dual epidemic,” Circulation, vol. 119, no. 18, pp. 2516–2525, 2009.
[6] P. A. Wolf, R. D. Abbott, and W. B. Kannel, “Atrial ﬁbrillation as an independent risk factor for stroke: the Framingham study,” Stroke, vol. 22, no. 8, pp. 983–988, 1991.
[7] S. Z. Rosero, V. Kutyifa, B. Olshansky, and W. Zareba, “Ambulatory ECG monitoring in atrial ﬁbrillation management,” Progress in Cardiovascular Diseases, vol. 56, no. 2, pp. 143 – 152, 2013.
[8] M. Lemay, M. Bertschi, J. Sola, P. Renevey, J. Parak, and I. Korhonen, Application of Optical Heart Rate Monitoring. Elsevier; Imprint: Academic Press, 2014, pp. 105–129.
[9] J. Parak and I. Korhonen, “Evaluation of wearable consumer heart rate monitors based on photopletysmography,” in 36th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), Aug 2014, pp. 3670–3673.
[10] R. Delgado-Gonzalo, J. Parak, A. Tarniceriu, P. Renevey, M. Bertschi, and I. Korhonen, “Evaluation of accuracy and reliability of PulseOn optical heart rate monitoring device,” in 37th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), Aug 2015, pp. 430–433.
[11] P. Renevey, J. Sola, P. Theurillat, M. Bertschi, J. Krauss, D. Andries, and C. Sartori, “Validation of a wrist monitor for accurate estimation of RR intervals during sleep,” in 35th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), July 2013, pp. 5493–5496.
[12] J. Parak, A. Tarniceriu, P. Renevey, M. Bertschi, R. Delgado-Gonzalo, and I. Korhonen, “Evaluation of the beat-to-beat detection accuracy of PulseOn wearable optical heart rate monitor,” in 37th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), Aug 2015, pp. 8099–8102.
[13] J. Lee, B. A. Reyes, D. D. McManus, O. Maitas, and K. H. Chon, “Atrial ﬁbrillation detection using an iPhone 4S,” IEEE Transactions on Biomedical Engineering, vol. 60, no. 1, pp. 203–206, Jan 2013.
[14] S. Nemati, M. M. Ghassemi, V. Ambai, N. Isakadze, O. Levantsevych, A. Shah, and G. D. Clifford, “Monitoring and detecting atrial ﬁbrillation using wearable technology,” in 38th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), Aug 2016, pp. 3394–3397.
[15] E. Petrucci, V. Balian, G. Filippini, and L. T. Mainardi, “Atrial ﬁbrillation detection algorithms for very long term ECG monitoring,” in Computers in Cardiology, 2005, Sept 2005, pp. 623–626.
[16] A. G. Bonomi, F. Schipper, L. M. Eerikinen, J. Margarito, R. M. Aarts, S. Babaeizadeh, H. M. de Morree, and L. Dekker, “Atrial ﬁbrillation detection using photo-plethysmography and acceleration data at the wrist,” in Computing in Cardiology Conference (CinC), Sept 2016, pp. 277–280.
[17] S. Fallet, M. Lemay, P. Renevey, C. Leupi, E. Pruvot, and J. M. Vesin, “An adaptive organization index to characterize atrial ﬁbrillation using wrist-type photoplethysmographic signals,” in Computing in Cardiology Conference (CinC), Sept 2016, pp. 337–340.
[18] P.-H. Chan, C.-K. Wong, Y. C. Poh, L. Pun, W. W.-C. Leung, Y.-F. Wong, M. M.-Y. Wong, M.-Z. Poh, D. W.-S. Chu, and C.-W. Siu, “Diagnostic performance of a smartphone-based photoplethysmographic application for atrial ﬁbrillation screening in a primary care setting,” Journal of the American Heart Association, vol. 5, no. 7, 2016.
[19] A. Schafer and J. Vagedes, “How accurate is pulse rate variability as an estimate of heart rate variability?: A review on studies comparing photoplethysmographic technology with an electrocardiogram,” International Journal of Cardiology, vol. 166, no. 1, pp. 15 – 29, 2013.
[20] A. Tarniceriu, J. Harju, A. Vehkaoja, J. Parak, R. Delgado-Gonzalo, P. Renevey, A. Yli-Hankala, and I. Korhonen, “Detection of beat-tobeat intervals from wrist photoplethysmography in patients with sinus rhythm and atrial ﬁbrillation after surgery,” ArXiv e-prints, Nov. 2017.
[21] G. B. Moody and R. G. Mark, “A new method for detecting atrial ﬁbrillation using R-R intervals,” Computers in Cardiology, pp. 227– 230, 1983.
[22] N. Larburu, T. Lopetegi, and I. Romero, “Comparative study of algorithms for atrial ﬁbrillation detection,” in Computing in Cardiology, Sept 2011, pp. 265–268.

