ｌ　

维普资讯 http://www.cqvip.com

第 １２卷 ２期　 １９９３年 ６月　

ｆ，，占　
包头 钢铁 学　
Ｊｏｕｒｎａｌ　ｏｆ　Ｂａｏｔｏｕ　Ｕ ｎ　Ｌｖｅｒｓｉｔｙ　ｏｆ　ｉｒｏｎ　ａｎｄ　Ｓｔｅｅｌ　Ｔｅｃｈｎｏｌｏｇ　

Ｖｏ１．１２　 Ｎｏ．２　 Ｊｕｎｅ　ｌ９９３　

心率波动信号的获取 ’　

，ｊ　／ 　／　

，　

吕 晓琪 　

，　 ———— 一

　

天　Ｐ－￣７２￣＂　４　

（基 础 电子教 研室 ）　

摘 要 本文 介 绍 了从心 电图 （ＥＣＧ）信号 中提 取 心率 波 动信 号 （ＨＲＶ）的 一种 方 法 。即首 先 对　

ＥＣＧ进行 峰值 检测 ，然 后确 定 Ｒ－ Ｒ间 隔 ，最 后经 线性 内插得 到 ＨＲＶ 信号 。　

一

　

茎中：圈竺分　娄鲁号塑　ＴＮ忸　９１ｃ１Ｇ　 翌；　至业丝州Ｒｖ　 能　

７２　

、　 ，　

．

引 言　 所 谓 心 率 波 动 信 号 ＨＲＶ（Ｈｅａｒｔ　Ｒａｔｅ　Ｖａｒｉａｔｉｏｎ）即通 过 心 电 图 ＥＣＧ 的 ＱＲＳ波检 出 心 动　
周期所得到的关于心动瞬时频率的信号 。有关 医学研 究认 为 ，关于心血管系统的许多信号 ，诸　 如血压 、ＥＣＧ 等都是一个准周 期信号 ，即它的周期在某个值 附近 波动。这种波动在某种程度 上　 反 映 了交 感 和 副 交 感 神 经 对 于 心 率 的控 制作 用 ，同时 也 反 映 了呼 吸 对 心 率 的 影 响 。对 此 信 号 施　 以一定的分析方法 ，将会得到一些信息 。从生理和病理意义上讲 ，这些信 息将为说 明一些生理　 机 制提 供 帮 助 ，并 能 为 医生 在 诸 如 心 血 管 方 面 的 诊 断 提 供 有 说 服 力 的 依 据 。　
１ 工 作 原 理　 由 ＥＣＧ 得 到 ＨＲＶ 信 号 大 致需 要 这 样 两 个 步 骤 ，ｌｌ９首 先 由 ＥＣＧ 检 出 ＱＲＳ波群 得 到 一 个　 Ｒ— Ｒ 间隔 的序 列 ，然 后 经 内插 得 到 ＨＲＶ 信号 。　 １．１ 系 统 框 图 及 其 配置　

÷　 一 　 一匮　÷］　

图 一囝 一　

如 图所 示 图 中虚 线 框 内 的三 个 部分 ：前 置 放 大 、采 样 保 持 、接 口及 数 据 采 集 板 为 作 者 自制　 的 硬 件 电路 ，将 此 电路 与 作 为 主 处 理 机 ＩＢＭ－ ＰＣ 的 扩 展 槽 相 联 ，就 构 成 了本 系 统 的 硬 件 部　 分 ；软 件部分使 用 了汇 编和 ＦＯＲＴＲＡＮ 两种语 言 ，除数 据采集 程序使用汇 编之 外 ，其 余处理　

－ 本 丈 １的 ３年 ５月 ２】 日收 到　

· ６１ ·　

程 序 皆采 用 ＦＯＲＴＲＡＮ 语 言 。　 １．２　 ＥＣＧ 信 号 及 其 特 性　

维普资讯 http://www.cqvip.com

图 １ 心电 信号　

图 ２ 低 频干 扰‘　

如 图 １所示为一典 型的心 电信号　其 中 Ｐ波是 心房 除极波 ，由于心房是心脏活动的起始位　

置 ，因此 Ｐ渡 在 ＥＣＧ 诊 断 中是 十分 重 要 的 。另 一 可 作 为 ＥＣＧ 特 征 的 由 Ｑ、Ｒ、Ｓ所 组 成 的 波 群　

称 为 ＱＲＳ渡 ，它是 心 室 除极 及 部 分 心 房 复 极 时 的综 合 波 群 ，它 有 一 个 陡 峭 的 Ｒ 波 ，Ｑ 和 ｓ是　

Ｒ 前后的 两个 负 向波 ，由于 心室 是心脏 工作 的重 要部 位 ，心 室病 变 直接 影 响心脏 的功 能 ，故　 ＱＲＳ渡群在临床上有着十分重要的意义 。紧接着在后 面出现的是心 室复极波 Ｔ 波 。同其它生　

理 信号 一样 ，心 电信号是极其微小的 ，体表心 电的幅值 一般 在 ｌｍｖ左右 。其 中以 ＱＲＳ波 群最　

为 突 出 且其 脉 宽 较 窄 ，正 常 人 的 ＱＲＳ波 宽在 ０．Ｏ６～Ｏ．１ｓ之 间　 。　

１．３　 ＨＲＶ 信 号 的获 得　 分 二步 进 行 ，先 由 ＥＣＧ检 出 ＱＲＳ波 群 而 得 到 一 个 Ｒ—Ｒ 间 隔 的序 列 ，然 后 通 过 内插 得 到　

ＨＲＶ 信 号 。　 １．３．１　 ＱＲＳ波 群 的 检 出及 其 参 数 确 定　 通 常 ，我 们面 对 的 是 一 个 在 相 当 水 平 的 噪 声 背 景 下 的 ＥＣＧ。一般 来 讲 ，这 些 干 扰 可 能 是 生　

理 上的（肌 电等）、机械上的 （电极和病人之 间的运动 伪迹 ），以及 工频 ５０ＨＺ干扰 。因此我们将　 要检测 的信号是 一个 包含有 ＥＣＧ、基线漂移 、尖脉 冲和 ５０ＨＺ的一个 混合 信号 。　

这 样 ，就 对 ＱＲＳ检 测 器 提 出如 下 要 求 ：　

（ａ）能检测正常 和病理情 况下的 ＱＲＳ波 ｝　

－　

（ｂ）能检 测 正 极 性 或 负极 性 的 ＱＲＳ波 ；　 ．　

（ｃ）使高 、低频噪声及 ５０ＨＺ对其影响最小化 ；　

（ｄ）与 ＥＣＧ 信 号 的 大 小无 关 ；　 （ｅ）对 Ｔ 波 和 Ｐ波 不 敏 感 。　 一 个 ＱＲＳ检 测 器 可 以划 分 成 两 个 部 分 ：即 予 处理 和 判 定规 则 。　

考虑到 ＥＣＧ 信号的特点及后面判定规则的适用情况 ，予处理采用了一个可变宽度的平滑　

窗 口 ，即 一 低 通 滤 波 器 。　 接 下来详细介绍本 文所采用的检测方法 。此方 法基 于极大极 小理 论 ，需要的运 算次数较　

少 。利用区域极值来 求峰值 幅度 ，然后结合波宽参数来识 别 ＱＲＳ复波 。　

令 Ｚ（Ｎ）代 表采 样得 到 的 ＥＣＧ信号 。为 了得到极 值 ，采用三 点滑动 窗 ＴＰＳＷ （Ｔｈｒｅｅ·　 ｈ ｉｎｔ　 ｎｄｏｗ）来识 别 ，并 定 义如 下 极 值 标准 ：　

·６２ ·　

＿　
ｊ　

维普资讯 http://www.cqvip.com

里　

＜ ｉ＞ 极 大 值 　 Ｚ（ｎ一 １）≤ Ｚ（ｎ）＞ Ｚ（ｎ＋ １）　 ＜ ｉｉ＞ 极 小 值　 Ｚ（ｎ　 １）＞ Ｚ（ｎ）≤ Ｚ（ｎ一 １）　
由图 １所示 ，ＱＲＳ复波 由三个基础极值组成 。很 明显 ＱＲ和 ＲＳ区段是 ＥＣＧ信号最 陡峭　 的部 分 。所 以 曾经 有 人 （Ｆｒｏｄｅｎ　１　９８０）利用 微分 方法 求取 变 化 最 大 点 来 检 测 ＱＲＳ波 ，但 是 由于　 这 种 方法 对 于 高频 率 噪声 太 敏 感 ，故需 要 很 多 的 计 算 来 克 服 ，致 使 检 测 速 度 太 慢 。　
本 文 采用 的检 测 标 准 是 ：　 ＜ ｉ＞ 幅度 标 准 ：由极 大 值 和 极 小值 之 差求 得 的 幅值 要 大 于 某 一 门槛 值 。　 ＜ ｉｉ＞ 波 宽 标 准 ：从极 大 值 到 极 小值 之 间 的 间 隔应 落 在 某 个 范 围之 内 。　 当以 上 两 条 同 时被 满 足 时 ，则 确 认 为 一个 ＱＲＳ波 。此标 准在 ＥＣＧ 信 号 的 信 噪 比很 高 ，即　 ＥＣＧ 信 号 很 干 净 时 ，效 果 非 常好 。但 在 实 践 中 ，我 们 所得 到 的信 号 往 往 是 被 噪 声 污 染 了 的 。下　 面 分 两 种 情 况 介 绍 在 不 同 噪声 污 染 下 的检 测实 施情 况 。　 ａ）低频 干 扰　 如 图 ２所 示 为低 频 噪 声 污 染 后 的 ＥＣＧ 信号 （如 电极 或 病 人 移 动 造 成 的 伪迹 ）。用 前 述 的标　 准 来 判 别 仍 能得 到 满 意 的 结果 。因 为在 幅 度 和 波 宽 的求 取 中 与 ＥＣＧ 的基 线 均 未 发 生关 系 ，故　 基线 的 漂 移 不影 响 ＱＲＳ波 的检 出 。　 ｂ）高 频 干 扰　 此 处的高 频是 相对 于 ＥＣＧ 而言 的，如 ＥＭＧ、工频 ５０ＨＺ等 。在这 种情况 下 势必影 响 到　 ＱＲＳ的前 后 沿 ，如 图 ３所 示　 这 样 前 述 的 方 法 不 再 适 用 ，为此 我 们采 用 累积 幅 度 标 准 。下 面 以　 一 个 被 高 频 信 号 污 染 的下 降沿 为例 ，说 明 此 标 准 的 具 体 实 现　

图 ３　 Ｒ　 ｓ下 降沿 的极值 序列　
如 图 ３所 示 ，定 义 累积 幅值 如下 ：　

Ａ （ｋ）一 　～ （ｋ）－ ｙ　。　（ｋ）　

ｋ一 ０　

Ａ （ｋ）＝ Ａ （ｋ— １）一 　一 （ｋ一 １）一　 ．　（ｋ）　

ｋ≠ ０　

十’＾Ｈｔ　 · ６３ ·　

维普资讯 http://www.cqvip.com

（开　始　）　
ｊ　
置 初 值　
Ｊ　
读 入 文 件 名　
ｊ　
调数据读入子 程序　
ｌ　
显 示 输 入 信号 （窗 口）　

输 入 采 样 频 率　

由 Ｒ 蜂 位 置 求 出 Ｒ— Ｒ 间 隔　
Ｊ　
键 入 Ｒ— Ｒ 间隔 序 列 之 文 件 名　
Ｊ　
建 文 件 、存 盘 、关 闭文 件　
Ｊ　
屏 幕 说 明　

· ６４ ·　

图 ４　 Ｒ　 Ｒ 序列 硷 出程序　

叠　

维普资讯 http://www.cqvip.com

Ａ（ｋ）值一 直累加到 满足幅度 、波宽标 准 ，这样就使得 被高频干扰 的 ＱＲＳ渡 能够 被检测 。　

对 图 ３而言 ，这 里 Ａ（ｋ）代 表 Ｒ波幅值 。为 了使累加一直在 同一 沿 （下 降沿 ）上进 行 ，要求在 累　

积 过 程 中必 须有 如 下 保 证 ：　

Ａ （ｋ）＞ Ａ （ｋ＋ １）　

ｋ一 １，２，３’．＿… ·　

即 每 一 对 极 大 极 小 值 都 应 比前 一 对 要 小 ，也 就 是 说 要 单 调 减 。 （上 升 沿 要 单 调 增 ）。　

在 检 测 运 算 中 ，幅 度 标 准 是 根 据 不 同输 入 自动 调 整 的 ，取 新 检 出 Ｒ 幅 度 的 １／４与 原 门 槛 　

３／４相 加做 为 下 次 判 断 的新 标 准 ，而 波 宽 则 是 根 据 前 面所 述 及 的 ＱＲＳ参 数 来 确 定 的 。　

另 外 ，为 了避 免 大 幅 度 Ｔ 波 的误 检 和 缩 短 执 行 时 间 ，在 每 一 次 检 到 ＱＲＳ渡 群 后 ，都 有 一　

个 ２００ｍｓ的 闭 限 期 ，即跳 过 这 一 段 数 据 ．而 ＳＴ 段 的 正 常 时 限 为 ５ｏ～ １５０ｍｓ，这 样 ２００ｍｓ的 闭　

眼 期 便避 免 了 Ｔ 波 对 ＱＲＳ波检 出 的 影 响 ，而 且 显 著 地 提 高 了检 出速 度 。依 上 述 方 法 操 作 后 得　

到 了 一 个 Ｒ 点 序 列 ，然后 可 以方 便 地 由此 序 列 求 两 两 之 差 而 得 到 Ｒ— Ｒ 间 隔 序 列 Ｒ— Ｒ（Ｉ），　

将 其 存人 数据 文件 Ｒ ＊．ＤＡＴ，其 程 序框 图如 图 ４所 示 。　

１．３．２　 ＨＲＶ 信号 的 获得　

ＥＣＧ 信 号 经 前 面 的程 序 处 理 之 后 将 得 到 一个 关 于 Ｒ— Ｒ 间 隔 的 序 列 Ｒ— Ｒ（Ｉ），其 中 Ｉ代　

表 顺 序 号 此 顺 序 号 是 依 检 出 先 后 排 列 的 ，但 此 序 列 并 不 能 严 格 地 同实 际 时 间对 应 起 来 ，因为　

Ｒ— Ｒ（Ｉ）所 对 应 的 实 际 时 间是 它 的 前 一 个 Ｒ— Ｒ（Ｉ一 １）之 后 再 经 过 了 一个 Ｒ— Ｒ 间 隔 ［即 Ｒ— 　

Ｒ（Ｉ）值］的时间 。所 以序 列 Ｒ—Ｒ（Ｉ）相 当于对一个 瞬时心动周 期变化 信号 Ｒ—Ｒ（ｔ）的不 等间　

． 隔 采 样 序 列 。　

圆　
且　 柳　
固　
亡　

图 ５　 ａ　ＥＣＧ信 号 ｖ（ｔ）　 ｂ　Ｒ—Ｒ（ｔ）信号 （ＨＲＶ）　 ｃ　Ｒ— Ｒ（Ｉ）信 号 　
为了对 Ｒ—Ｒ（＋）那 ＨＲＶ 信号进行 分析及进一步的后处理 ，就要求我 们能够提供一 个对　
·６５ ·　

维普资讯 http://www.cqvip.com

此 信 号 的 等 间隔 采 样 序 列 ，即 由 Ｒ— Ｒ（Ｉ）求 Ｒ— Ｒｔ（Ｉ）。要 达 到 这 一 目的 ，有 三 种 内插 方 式 可 供　

选 择 ：　 ＜ｉ＞线 性 内插 ：当 用 直 线 段 连 接 两 点 能 够 满 足 精 度 要 求 时 采 用 ；　

＜ｉｉ＞ 正 弦 内插 ：当 记 录波 形 中 仅读 出极 大值 和极 小值 时 ，采 用 正 弦 内插 为 宜 ；　 ＜ｉｉｉ＞多 项 式 内插 ：幂 次 不 同 可 满 足 不 同 精度 。　

这 里 ，我 们 要 处 理 的 心 周 序 列 Ｒ— Ｒ（Ｉ），其 值 为 Ｒ— Ｒ 间隔 ，对 于 一个 处 于 某 状 态 的 正 常　 人 而 言 ，其 波 动 只有 ５　 ～ １ｏ　 ，所 以 我 们 这 里 的　不 等 间 隔”事 实 上 很 接 近 于 等 间 隔 采 样 。为　

了 减 小 误 差 起 见 ，我 们 令 等 间隔 采 样 步 长 为 Ｅ［Ｒ－Ｒ（Ｉ）］，这 样 使 处 理 后 得 到 的等 间隔 采 样 序　

列 各 点 始终 落在 Ｒ— Ｒ（１）序 列 的对 应 样值 附近 ，由此 可 见应 选 用线 性 内 插 。经 内插 后 便 得 到 了　

·　

ＨＲＶ 信 号 的 等 间 隔采 样 序 列 Ｒ— Ｒｔ（Ｉ），其 实现 框 图如 图 ６所 示 。　 ２ 讨 论　

结 合 前 述 硬 件 基 础 及 软 件 配 置 ，可 以 在 一 般 心 电 图机 提 取 的 未 级 驱 动 信 号 的 基 础 上 给 出　

令 人 满 意 的 检 测 结 果 。　 表 】所示 是 系统 对 ｌ０例 ＥＣＧ 检 测 的结 果 。其 中 ＱＲＳ总 个 数 为 ８５０，检 出数 为 ８４６，其 检　

出率达 ９０．５　 。而个 别 Ｒ波漏检 主要是 因为某个 Ｒ波的波峰受干扰 信号破坏严重 所致 ，对此　

可利 用 内 插程 序 来 克服 。　

衰 １　 ＥＣＧ 序号　
ｌ　 ２　 ３　 ４　 ５　 ６　 ７　 ８　 ９　 ｌＯ　
合 计　

ＱＲＳ幢 出 衰　

总 ＱＲＳ波 数　

幢 出徽　

４８　 ４８　 ４９　 ５４　 ５６　 １４２　 １３７　 １４７　 ８９　 ８０　
８５０　

４８　 ４８　 ４９　 ５４　 ５４　 １４２　 １３６　 １４７　 ８８　 ８０　
８４６　

幢 出率 （　 ）　
１００　 １００　 １００　 １００　 ９６．４　 １００　 ９９　３　 １００　 ９８．９　 １００　
９９．５　

由此 系统 产 生的 Ｒ— Ｒ（Ｉ）序 列 及 经 内插 后 得 到 的 ＨＲＶ 序 列 如 图 ７所 示 。　 如 图 ７所 示 为 正 常 生 理状 态 下 的 ＨＲＶ 信 号 直 观 地 看 其 特 征 不 明 显 ，直 接 应 用 尚嫌 不 足 。　 为此意大利学者 Ｆ．Ｂａｒｔｏｌｉ对此信号进行了进一步的处理和研 究 ，其初步成 果 已在国际权威 刊　 物 ＩＥＥＥ上 发 展 ，并 引 起 广泛 关 注 ，充分 展 示 了这 方 面 的 研 究 前 景 。 国 内此 方 面 研 究 工 作 尚未　 见 报道 。 作 者 对此 信 号 采 用 了 谱 估 计 分 析 法 进 行 处 理 ，已取 得一 定进 展 ，细 情 将 另撰 文 详 述 。　
· ６６ ·　

维普资讯 http://www.cqvip.com

图 ６　 由插程序 框图　

· ６７ ·　

维普资讯 http://www.cqvip.com

图７．ｏ（　）Ｒ—Ｒ（Ｉ）序列窗口长度为 ２００信号序列长度 为］４３　

图 ７．Ｏ（ｂ）Ｒ—Ｒ（Ｉ）序列经内插后得到的 ＨＲＶ序列　

参 考 文 献　

ＯＭ ＡＲ　ＥＳＣＡ ＬＯ ＮＡ ．Ｂ．Ｓ．ｅｔ．ａ１。Ｊｏｕｒｎａｌ　ｏｆ　ｃｌｉｎｉｃａｌ　Ｅｎｇｉｎｅｅｒｉｎｇ，¨ （３） ］９８６，２７— ３１　
宗孔 德 ．胡广 书 ，《数 学信 号处 理 》。北 京 ：清 华大学 出版杜 ，］９８８，２３９－２４５　 宗伟 ，　ＥＣＧ 无 损心 功 能检测　西 安 ．西 安交 通大 学硕士 论 文 ·１９８５·　 山东 医学 院 附院 ，《实用 心 电图学 》，济南 ｔ山东科 学技 术 出版杜 ．］９８０，ｌ¨一 １２２　

ＴＨ Ｅ　０ ＢＴＡ ＩＮＩＮＧ　０ Ｆ　ＴＨＥ　Ｈ ＲＶ　ＳＩＮＧＮＡ Ｌ　

Ｌｉ１　Ｘ ｉａｏｑｉ　
Ａｂｓｔｒａｃｔ　 Ｔｈｉｓ　ｐａｐｅｒ　ｄｅｓｅｒｉｂｓ　ａ　ｍｅｔｈｏｄ　ｏｆ　ｏｂｔａｉｎｉｎｇ　ＨＲＶ　ｓｉｎｇｎａ］ｆｒｏｍ　ＥＣＧ． Ｈｅｒｅ，ＨＲＶ　ｓｉｎｇｎａｌ　ｈａｖｅ　 ｂ　 ｏｂｔａｉｎｅｄ　ｖｉａ　ｄｅｔｅｃｔｉｏｎ　ｏｆ　Ｒ—ｗａｖｅ　ｆｒｏｍ　ＥＣＧ　ａｎｄ　ｉｎｔｅｒｐ０１ａｔａｔｉｏｎｓ　ｏｆ　Ｒ－Ｒ　ｉｎｔｅｒｖａｌ　ｄｕｒａｔｉｏｎ　ｓｅｇｕｅｎｃｅ．　
Ｋｅｙ　ｗ口ｒｄｓ　 ＥＣＧ ；Ｒ—Ｒ　ｉｎｔｅｒｖａｌ；ＨＲＶ （ｔｈｅ　ｈｅａｒｔ　ｒａｔｅ　ｖａｒｉｔｉｏｎ　ｓｉｎｇｎａ１）　

·６８ ·　

