IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 1, JANUARY 2013

203

Atrial Fibrillation Detection Using an iPhone 4S
Jinseok Lee, Member, IEEE, Bersain A. Reyes, David D. McManus, Oscar Mathias, and Ki H. Chon∗, Senior Member, IEEE

Abstract—Atrial ﬁbrillation (AF) affects three to ﬁve million Americans and is associated with signiﬁcant morbidity and mortality. Existing methods to diagnose this paroxysmal arrhythmia are cumbersome and/or expensive. We hypothesized that an iPhone 4S can be used to detect AF based on its ability to record a pulsatile photoplethysmogram signal from a ﬁngertip using the builtin camera lens. To investigate the capability of the iPhone 4S for AF detection, we ﬁrst used two databases, the MIT-BIH AF and normal sinus rhythm (NSR) to derive discriminatory threshold values between two rhythms. Both databases include RR time series originating from 250 Hz sampled ECG recordings. We rescaled the RR time series to 30 Hz so that the RR time series resolution is 1/30 (s) which is equivalent to the resolution from an iPhone 4S. We investigated three statistical methods consisting of the root mean square of successive differences (RMSSD), the Shannon entropy (ShE) and the sample entropy (SampE), which have been proved to be useful tools for AF assessment. Using 64-beat segments from the MIT-BIH databases, we found the beat-to-beat accuracy value of 0.9405, 0.9300, and 0.9614 for RMSSD, ShE, and SampE, respectively. Using an iPhone 4S, we collected 2-min pulsatile time series from 25 prospectively recruited subjects with AF pre- and postelectrical cardioversion. Using derived threshold values of RMSSD, ShE and SampE from the MIT-BIH databases, we found the beat-to-beat accuracy of 0.9844, 0.8494, and 0.9522, respectively. It should be recognized that for clinical applications, the most relevant objective is to detect the presence of AF in the data. Using this criterion, we achieved an accuracy of 100% for both the MIT-BIH AF and iPhone 4S databases.
Index Terms—Atrial ﬁbrillation (AF), cardioversion, iPhone, RR time series, root mean square of successive differences (RMSSD), sample entropy (SampE), Shannon entropy (ShE), smartphone.
I. INTRODUCTION
A TRIAL ﬁbrillation (AF) is the most common sustained arrhythmia. Over three million Americans are currently diagnosed, and the prevalence of AF is increasing with the aging of the U.S. population [1]. Through its association with
Manuscript received March 17, 2012; revised June 25, 2012; accepted July 4, 2012. Date of publication July 31, 2012; date of current version December 14, 2012. This work was supported in part by the Ofﬁce of Naval Research work unit under Contract N00014-12-1-0171. Asterisk indicates corresponding author.
J. Lee was with the Department of Biomedical Engineering, Worcester Polytechnic Institute, MA 01609 USA. He is now with Department of Biomedical Engineering, Wonkwang University School of Medicine, Iksan, Jeonbuk, Republic of Korea (e-mail: gonasago@gmail.com).
B. A. Reyes is with the Department of Biomedical Engineering, Worcester Polytechnic Institute, MA 01609 USA (e-mail: bareyes@wpi.edu).
D. D. McManus and O. Mathias are with the Cardiology Division, Departments of Medicine and Quantitative Health Sciences, University of Massachusetts Medical Center, Worcester, MA 01605 USA (e-mail: mcmanus.dave@gmail.com; oscar.maitas@gmail.com).
∗K. H. Chon are with the Department of Biomedical Engineering, Worcester Polytechnic Institute, MA 01609 USA (e-mail: kichon@wpi.edu).
Color versions of one or more of the ﬁgures in this paper are available online at http://ieeexplore.ieee.org.
Digital Object Identiﬁer 10.1109/TBME.2012.2208112

increased risk for heart failure, stroke, and mortality, AF has a profound impact on the longevity and quality of life of a growing number of people [2], [3]. Although new AF treatment strategies have emerged over the last decade, a major challenge facing clinicians and researchers is the paroxysmal, often short lived, and sometimes asymptomatic nature of AF. Our current inability to diagnose AF in minimally symptomatic patients with paroxysmal AF has important clinical implications, since even brief episodes of asymptomatic AF are associated with increased risk for stroke, heart failure, hospitalization, and death [4]. Moreover, the treatment of patients with disabling symptoms from AF, including shortness of breath, syncope, and exertion intolerance, is often impeded by delays in diagnosis. Although the population burden of known AF is substantial, [5] studies have shown that more frequent monitoring can improve AF detection [6]. There is, therefore, a pressing need to develop methods for accurate AF detection and monitoring in order to improve patient care and reduce healthcare costs associated with treating complications from AF. Such a method would have important clinical and research applications for AF screening as well as in assessing treatment response (e.g., after cardioversion or AF ablation) and need for anticoagulation. For these reasons, the importance of developing new AF detection technologies was emphasized by a recent National Institute of Health Heart Lung and Blood Institute Expert panel [7].
Given that detection of paroxysmal AF currently relies primarily on the arrhythmia being present at the time of an in-ofﬁce electrocardiogram (a mere 10–20 s ECG strip recording), a great deal of serendipity is required in the diagnosis of AF. A more effective paroxysmal AF detection strategy requires a readily available and cost-effective monitoring device that can be operated by a patient on a daily basis, combined with an accurate real time AF detection algorithm. It is an understatement that such a monitoring device needs to be readily accessible, relatively inexpensive, and simple to operate in order to be widely accepted by individuals with, or at risk for AF. As smartphones have become almost ubiquitous, they meet the criteria of ready access and acceptance. In fact, although they cannot detect arrhythmias, rudimentary smartphone-based pulse recorders are already in use. In our study, we developed a smartphone application to measure pulsatile time series and then use this data to detect AF realtime. We have recently successfully demonstrated that using a smartphone’s camera to image a ﬁnger tip pressed to it will yield pulsatile signals that are similar to heart-rate ﬂuctuations [8]. In addition, the use of pulsatile signals from smartphones has recently attracted the attention of many researchers [8]–[11]. Note that the approach does not require the need for additional hardware as the optical video monitoring of the skin with a standard digital camera contains sufﬁcient information related to variability in the heart-rate signal, and it

0018-9294/$31.00 © 2012 IEEE

204

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 1, JANUARY 2013

consequently provides accurate heart rate time series. The only requirement is that the camera’s illumination and optical sensor be within ﬁnger tip range of each other.
In this paper, we introduce the feasibility of AF detection on an iPhone 4S. Speciﬁcally, we developed a comprehensive iPhone application for collection of pulsatile time series followed by real-time detection of AF using the following three statistical methods: RMSSD, shannon entropy (ShE), and sample entropy (SampE). We evaluated the AF detection performance with an iPhone 4S on 25 AF subjects undergoing electrical cardioversion. The iPhone-based AF detection is innovative because no one has yet been able to embed accurate, real-time AF monitoring into a smartphone application. Further, our application has the potential to be widely accepted and will lead to better compliance by patients since it has the potential to signiﬁcantly reduce healthcare costs and enhance patient care by accurately and rapidly establishing the diagnosis of AF in at-risk groups, thereby providing clinicians with an opportunity to better treat and prevent complications from these sometimes life-threatening arrhythmias.
II. METHODS
A. AF Databases and Clinical Data Collection
To discriminate between AF and normal sinus rhythm (NSR) using an iPhone, we used the MIT-BIH AF and MIT-BIH NSR databases to derive threshold values of RMSSD, ShE, and SampE. We down sampled the MIT-BIH AF and NSR RR time series to 30 Hz to replicate the sampling resolution of an iPhone 4S. The MIT-BIH AF database is an ideal dataset to derive discriminatory threshold values since it contains 25 ECG recordings containing a total of 299 AF episodes. Each ECG recording is approximately 10 h in duration. The data sets 4936 and 5091 were excluded from our study due to incorrect AF annotations. The MIT-BIH NSR database contains 18 ECG recordings, and the duration of each ECG data is approximately 24 h. It consists of 5 men, aged 26–45, and 13 women, aged 20–50.
For the iPhone 4S data collection, 25 patients with AF who presented for electrical cardioversion to the University of Massachusetts Medical Center (UMMC) cardiac electrophysiology laboratory were recruited by trained study personnel (McManus, Mathias). Twenty men and ﬁve women with an average age of 57.95 ± 13.64 years were recruited. Data collection was performed before and after electrical cardioversion. Our protocol for data collection was approved by the Institutional Review Boards of UMMC and Worcester Polytechnic Institute. The camera of an iPhone 4S was placed on either the index or middle ﬁnger of study participants for 2 min prior to, and immediately after, cardioversion. Data were recorded in the supine position (to minimize motion artifacts) with spontaneous breathing, with the assistance of a physician. Patients who had essential tremor or suffered involuntary movement disorders were very prone to producing a distorted reading and were a challenge for accurate data collection. In these instances, the iPhone 4S camera was focused on the thenar eminence of the examined hand. Other anatomic areas used to pick up the recordings were the anterior medial leg and forearm. Fig. 1 shows an iPhone 4S prototype

Fig. 1. iPhone 4S prototype for AF detection.
for AF detection. Our AF and NSR detection for the iPhone was based on threshold values of RMSSD, ShE, and SampE derived from the MIT-BIH AF and MIT-BIH NSR databases, respectively.
B. Preprocessing and Postprocessing
The iPhone App was developed using the Objective-C programming language. For the pulsatile signal acquisition, the iPhone 4S videos were recorded, and the signal was obtained by averaging 50 × 50 pixels of the green band for every frame [8], [11]. The sampling rate for iPhone 4s was 30 frames/s. However, in rare cases, the sampling rate was slightly lower (e.g., ∼25 Hz due to internal processing load). Due to the frame rate variability, we interpolated the pulsatile signal to 30 Hz using a cubic spline algorithm followed by peak detection. The peak detection algorithm incorporated a ﬁlter bank with variable cutoff frequencies, spectral estimates of the heart rate, rank-order nonlinear ﬁlters and decision logic [12]. The ﬁnal result shows either “NORMAL” or “AF DETECTED” based on statistical algorithm values detailed in the following section.
C. Statistical Approach for AF Detection
The RMSSD is used to quantify beat-to-beat variability. Since AF exhibits higher variability than NSR, the RMSSD is expected to be higher than those of NSR RR time series. As subjects have different mean heart rates, we normalize by dividing the RMSSD by the mean value of the RR time series.
Fig. 2(a) shows a histogram of the normalized RMSSD values for AF and NSR (postcardioversion) from the iPhone 4S, MIT-BIH AF and NSR segments. As previously noted, we down sampled these MIT-BIH AF and NSR time series to 30 Hz, and calculated the value of RMSSD/mean for each 64-beat segment. Each segment was then shifted by one beat for the entire database. As shown in Fig. 2(a), the RMSSD/mean for AF (combined MIT-BIH AF and iPhone AF) values are higher and nearly distinct from those of NSR databases.
The second component of the AF detection algorithm isShE. The ShE provides a quantitative measure of uncertainty for a random variable. For example, a random white noise signal is expected to have the highest ShE value due to maximum uncertainty in predicting the patterns of the signal. Fig. 2(b) shows a histogram of the ShE for AF (combined MIT-BIH AF and iPhone AF) and NSR segments from the MIT-BIH NSR

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 1, JANUARY 2013

205

TABLE I BEAT-BY-BEAT ANALYSIS OF SENSITIVITY, SPECIFICITY, AND ACCURACY BASED ON EACH STATISTICAL METHOD ON MIT-BIH AF & NSR, 25 AF
SUBJECTS PRE- AND POSTELECTRICAL CARDIOVERSION

testing using an ANOVA on ranks was done to see if there were signiﬁcant differences among each dataset.

Fig. 2. Histogram of each statistical method according to AF and NSR. The AF-included 479594 beats from MIT-BIH AF and 4623 beats from precardioversion samples obtained using an iPhone 4S. The NSR values were comprised of 650 008 beats from MIT-BIH AF database, 1 728 459 beats from MIT-BIH sinus rhythm database, and 4435 beats from postcardioversion databse using iPhone 4S. (a) RMSSD/mean values, (b) ShE values, and (c) SampE values.
and iPhone NSR databases. Similar to RMSSD, ShE values for AF are higher than NSR, and a good separation between them is observed.
The third component of the AF detection algorithm is theSampE. The SampE is the negative natural logarithm of an estimate of the conditional probability that a subseries that matches pointwise within a tolerance r also match at the next point, where self-matches are not included in calculating the probability. A high value of SampE indicates low similarity in the time series while a low value of Sample entropy indicates high similarity. Thus, the SampE is a useful tool to assess randomness of RR time series. Fig. 2(c) shows a histogram of the SampE for AF (combined MIT-BIH AF and iPhone AF) and NSR segments from MIT-BIH AF and iPhone NSR databases. The SampE values are higher for AF than NSR, and similar to RMSSD and ShE calculations, a good separation between AF and NSR is observed.
D. Performance Evaluation
The condition for AF detection is based on each threshold value of THRm , THSE , and THSA : RMSSD/mean ≥ THRm , ShE ≥ THSE , or/and SampE ≥ THSA . For each parameter set, we found the number of true positives (TP), true negatives (TN), false positives (FP), and false negative (FN) from the MIT-BIH AF and NSR databases. Subsequently, we calculated the sensitivity TP/(TP+FN), speciﬁcity TN/(TN+FP), and accuracy (TP+TN)/(TP+TN+FP+FN). For each statistical method, we found the threshold values providing the largest area under the receiver operating characterstics curve in the MIT-BIH AF and NSR databases. After ﬁnding each threshold value, we applied the same value to the iPhone 4S data. In addition, statistical

III. RESULTS
For each statistical method examined using the MIT-BIF AF and NSR databases, we found the threshold values of THRm = 0.130, THSE = 0.76, and THSA = 1.3, which provided the beat-by-beat accuracy values of 0.9405, 0.9300, and 0.9614, for RMSSD, ShE, and SampE, respectively. We applied the parameters above to the iPhone 4s database. For subjects in AF, we found that the beat-by-beat accuracy for each algorithm was 0.9844, 0.8494, and 0.9552, for RMSSD, ShE, and SampE, respectively. Table I summarizes overall sensitivity, speciﬁcity, and accuracy for each algorithm by database. In addition, when all three methods are combined, the iPhone 4S data show 0.9951 accuracy with THRm = 0.115, THSE = 0.55, and THSA = 0.76. For clinical applications, the relevant objective is to detect the presence of AF episodes from a given dataset. With this criterion, the AF and NSR detection accuracy was 100%. Fig. 3 shows statistical value distribution of (a) RMSSD/mean, (b) ShE, and (c) SampE for NSR RR time series segments (scaled to 30 Hz) from MIT-BIH AF, MIT-BIH AF (scaled to 30 Hz), NSR RR time series segments (scaled to 30 Hz) from MIT-BIH NSR database, and AF subjects pre- and postcardioversion using an iPhone 4S. We found that the statistical value distributions of MIT-BIH AF and NSR databases overlapped with the iPhone 4S AF and NSR data. Further, we found statistically signiﬁcant differences (p < 0.01) between iPhone AF versus iPhone NSR, iPhone AF versus NSR in MIT-BIH AF, iPhone AF versus NSR in MIT in NSR, iPhone NSR versus AF in MIT-BIH AF, AF in MIT-BIH AF versus NSR in MIT-BIH AF and AF in MIT-BIH AF versus NSR in MIT-BIH NSR.
We also examined the AF detection performance across different ranges of pulse rates. We classiﬁed the pulse rates during AF into four ranges: less than 60, 60–90, 90–120, and greater than 120 beats per min. Fig. 4(a) and (b) shows the distribution of AF pulse rate for the MIT-BIH AF database and precardioversion iPhone database, respectively. When the iPhone AF pulse rates were between 90 and120, both Shannon and sample entropy resulted in degradation of their AF detection performance; RMSSD was consistently accurate for both databases and all ranges of AF pulse rates.

206

IEEE TRANSACTIONS ON BIOMEDICAL ENGINEERING, VOL. 60, NO. 1, JANUARY 2013

to-use monitor for AF outside of the traditional health care establishment. Because the application does not involve a separate ECG sensor and instead employs built-in hardware, it is both novel and cost effective. We believe this package will lead to better acceptance and more widespread use than existing out-of-hospital arrhythmia monitors. Further data are needed to explore the acceptability and feasibility of smartphone-based AF detection applications in older, at-risk populations. One notable limitation of our approach is that strong ﬁnger pressure on the camera lens degrades the pulse quality. A simple remedy is to instruct a subject to make only light contact with the camera lens. We found that motion and noise artifacts were not a huge problem as long as the subject had consistent and light contact with the camera lens during recording.

Fig. 3. Distribution of statistical values on each different dataset. Comparison of each statistical value of (a) RMSSD/mean, (b) Shannon entropy, (c) sample entropy according to each different database; pre- and postcardioversion with iphone 4 (n = 25 with 4623 and 4435 beats, respectively), AF and NSR in MIT-BIH AF database (n = 23 with 479 594 and 650 008 beats, respectively), NSR in MIT-BIH NSR database (n = 18 with 1 728 459 beats).
Fig. 4. Distribution of AF pulse rates for (a) MIT-BIH AF database and (b) precardioversion iPhone database.
IV. DISCUSSION AND CONCLUSION In this paper, we show that AF can be accurately detected from pulsatile signals in the human ﬁngertip using the camera of an iPhone 4S. The computation time including the processing stage was approximately 25 ms for each 64-beat segment on the iPhone 4S, thus the AF prototype is real-time realizable. Currently, clinical AF monitoring is cumbersome and/or expensive. Given the high prevalence of diagnosed paroxysmal and asymptomatic AF, as well as the increasing number of individuals at risk for this potentially life-threatening arrhythmia, better and more readily available AF detection technology is needed. Given the ever-growing popularity of cell phones and smartphones, a smartphone-based AF detection application provides patients and their caregivers with access to an inexpensive and easy-

REFERENCES
[1] A. S. Go, E. M. Hylek, K. A. Phillips, Y. Chang, L. E. Henault, J. V. Selby, and D. E. Singer, “Prevalence of diagnosed atrial ﬁbrillation in adults: National implications for rhythm management and stroke prevention: The AnTicoagulation and Risk Factors in Atrial Fibrillation (ATRIA) study,” J. Amer. Med. Assoc., vol. 285, no. 18, pp. 2370–2375, May 9, 2001.
[2] I. Hajjar and T. A. Kotchen, “Trends in prevalence, awareness, treatment, and control of hypertension in the United States, 1988–2000,” J. Amer. Med. Assoc., vol. 290, no. 2, pp. 199–206, Jul. 9, 2003.
[3] T. S. Tsang, G. W. Petty, M. E. Barnes, W. M. O’Fallon, K. R. Bailey, D. O. Wiebers, J. D. Sicks, T. J. Christianson, J. B. Seward, and B. J. Gersh, “The prevalence of atrial ﬁbrillation in incident stroke cases and matched population controls in Rochester, Minnesota: Changes over three decades,” J. Amer. Coll. Cardiol., vol. 42, no. 1, pp. 93–100, Jul. 2, 2003.
[4] D. L. Dries, D. V. Exner, B. J. Gersh, M. J. Domanski, M. A. Waclawiw, and L. W. Stevenson, “Atrial ﬁbrillation is associated with an increased risk for mortality and heart failure progression in patients with asymptomatic and symptomatic left ventricular systolic dysfunction: A retrospective analysis of the SOLVD trials. Studies of left ventricular dysfunction,” J. Amer. Coll. Cardiol., vol. 32, no. 3, pp. 695–703, Sep. 1998.
[5] K. H. Humphries, C. R. Kerr, S. J. Connolly, G. Klein, J. A. Boone, M. Green, R. Sheldon, M. Talajic, P. Dorian, and D. Newman, “New-onset atrial ﬁbrillation: Sex differences in presentation, treatment, and outcome,” Circulation, vol. 103, no. 19, pp. 2365–2370, May 15, 2001.
[6] E. J. Benjamin, P. A. Wolf, R. B. D’Agostino, H. Silbershatz, W. B. Kannel, and D. Levy, “Impact of atrial ﬁbrillation on the risk of death: The framingham heart study,” Circulation, vol. 98, no. 10, pp. 946–952, Sep. 8, 1998.
[7] E. J. Benjamin, P. S. Chen, D. E. Bild, A. M. Mascette, C. M. Albert, A. Alonso, H. Calkins, S. J. Connolly, A. B. Curtis, D. Darbar, P. T. Ellinor, A. S. Go, N. F. Goldschlager, S. R. Heckbert, J. Jalife, C. R. Kerr, D. Levy, D. M. Lloyd-Jones, B. M. Massie, S. Nattel, J. E. Olgin, D. L. Packer, S. S. Po, T. S. Tsang, D. R. Van Wagoner, A. L. Waldo, and D. G. Wyse, “Prevention of atrial ﬁbrillation: Report from a national heart, lung, and blood institute workshop,” Circulation, vol. 119, no. 4, pp. 606–618, Feb. 3, 2009.
[8] C. G. Scully, J. Lee, J. Meyer, A. M. Gorbach, D. Granquist-Fraser, Y. Mendelson, and K. H. Chon, “Physiological parameter monitoring from optical recordings with a mobile phone,” IEEE Trans. Biomed. Eng., vol. 59, no. 2, pp. 303–306, Feb. 2012.
[9] E. Jonathan and M. Leahy, “Investigating a smartphone imaging unit for photoplethysmography,” Physiol. Meas., vol. 31, no. 11, pp. N79–N83, Nov. 2010.
[10] M. J. Gregoski, M. Mueller, A. Vertegel, A. Shaporev, B. B. Jackson, R. M. Frenzel, S. M. Sprehn, and F. A. Treiber, “Development and validation of a smartphone heart rate acquisition application for health promotion and wellness telehealth applications,” Int. J. Telemed. Appl., vol. 2012, Art. ID 696324, pp. 1–7, 2012.
[11] D. Grimaldi, Y. Kurylyak, F. Lamonaca, and A. Nastro, “Photoplethysmography detection by smartphone’s videocamera,” in Proc. 6th IEEE Int. Conf. Intell. Data Acquisition Adv. Comput. Syst.: Technol. Appl., Prague, Czech Republic, 2011.
[12] M. Aboy, J. McNames, T. Thong, D. Tsunami, M. S. Ellenby, and B. Goldstein, “An automatic beat detection algorithm for pressure signals,” IEEE Trans. Biomed. Eng., vol. 52, no. 10, pp. 1662–1670, Oct. 2005.

