Feature Extraction of Photoplethysmography Signal using Wavelet Approach

Pan Fan, He Peiyu, Li Shangwen
School of Electronics and Infonnation Engineering Sichuan University Chengdu, China
popfan229@gmail.com, hepeiyu@scu.edu.cn, Ishangwenli@gmail.com

Duan Wenfeng
Institute of Cellular Medicine Newcastle University
Newcastle upon Tyne, UK wenfeng.duan@hotmail.com

Abstract-Photoplethysmography (PPG) signal has been commonly used in detecting the peripheral blood volume pulse. This kind of optical-based technique is simple, rapid, low-cost and non-invasive. It can be used widely for different purposes. Many useful information can be obtained from the PPG signal, including heart rate, respiratory rate, pulse wave velocity (PWV) and so on. In order to obtain these information, feature points must be extracted first. In this paper eight healthy subjects were studied. One PPG probe was used to record the PPG signal from left ear and the ECG signal has also been recorded simultaneously. These signals were converted into digital signals and stored into computer for off-line analysis. An automatic algorithm based on wavelet approach has been developed to extract feature points from the PPG signal, then compare with the manual measurement. The result shows that the automatic algorithm provided an effective way for PPG signal feature extraction.
Keywords-PPG; feature extraction; wavelet;

1.

INTRODUCTION

PPG is an optical-based technique. Light in the appropriate frequency range is absorbed by blood (venous, capillary and arterial) as well as bone, tissue and skin. At each contraction of the heart, a surge of blood is forced through the peripheral vascular system, producing engorgement of the vessels under the light source and reducing the amount of light returning to the photo-detector. Therefore, changes in the light absorption occur as the blood volume changes at the arterial pulse rate and at slower rates due to respiration, vasomotion, and temperature etc. The electrical resistivity of the photo-detector changes as a function of the amount of light falling on it, which results in the changes of the electrical current flowing through the detector circuit. Therefore, the small dynamic activity of the vasculature can be monitored electronically and the detected time-varying signal is called the PPG signal. PPG signal can provide many useful infonnation of cardiovascular system [1][2]. However, the quality of PPG signal can be affected by many factors, such as

the movement of subject which is the main cause of baseline wanders and motion artifacts. Additionally, 50 Hz power-line interference is also a problem for PPG signal measurement. So, pre-processing via signal processing and analysis techniques is an important step for PPG signal analysis.
Wavelet was proposed by MorIet and Grossman in 1980's. Wavelet analysis or wavelet transfonn means using finite-length or fast-attenuation 'mother wavelet' to represent signals. Wavelets can be combined, using a "reverse, shift, multiply and integrate" technique called convolution, with portions of a known signal to extract infonnation from the unknown signal. Recently, wavelet has been widely used on biomedical signal analysis [3][4]. For example, in order to diagnose cardiovascular disease, wavelet approach can be used to remove redundant features, and detect the R-R interval (interval between two R wave on ECG signal) from the reconstruction signal; on EEG signal analysis, wavelet approach used to help recognize the a wave and � wave.
In this paper, we proposed an automatic algorithm based on wavelet transfonn technique to decompose and reconstruct the PPG signal, and then detect key feature points on the proposed signals including systolic peak point, foot point, notch point and diastolic peak point. Based on the measurement of these feature points from PPG signal, indices of clinical importance, such as pulse rate, pulse transit times (PTTs), reflect index (RI), can be obtained [5][6][7] .
II. METHODS
A. Subject
Eight male subjects with no known cardiovascular disease were studied, their ages are from 22 to 50 years. The general subject infonnation including age, height, weight, SBP (Systolic Blood Pressure), DBP (Diastolic Blood Pressure) and BMI (Body Mass Index) are given in Table 1. This study received ethical permission from the Newcastle & North Tyneside Research

978-1-4799-8058-1/15/$31.00 ©2015lEEE.

283

Ethics Committee, and all subjects gave their written informed consent to participate in the study.

B. PPG signal record
PPG signal was recorded in a quiet and temperature controlled clinical measurement room. The subject was laid on a bed. Before the measurement, the subject was asked to have a 5 minute rest on the chair to make sure cardiovascular stabilization.

Three ECG electrodes and one PPG probe were used to record the ECG and PPG signals simultaneously. The PPG probe was put on the left ear. These signals were digitally saved in a data capture computer at sample rate of 1000 Hz for off-line analysis

Table 1. Demographic data of the studied subjects.

Subject information

No. subjects

8

Age (years) Height (cm) Weight (kg) SBP (mmHg) DBP (mmHg) BMI(kg/m2)

Mean

SD

34

12

176

4

72

15

120

13

75

8

24

6

waveform as well as the corresponding original signal IS illustrated on Figure 2.

I

Read ECG signal and Ear PPG signal from the files

I

I

�

�

I I Decompose ECG signal with wavelet transfonn 1

Decompose Ear PPG signal with wavelet transform
1

Reconstruct ECG signal with suitable approximation coefficient and detail coefficients

Reconstruct Ear PPG signal with suitable approximation
coefficient and detail coefficients

1

I I Find theR wave of

ECG signal

I

1
Divide the reconstructed Ear PPG signal into sections based
on the position ofR wave

1 I I Detect the feature points of Ear
PPG signal of each cardiac cycle

Fig 1. Automatic feature extraction algorithm flow chart

C. Feature extraction using wavelet approach
An automatic algorithm base on wavelet was developed using Matlab 2011a. It is used to extract the following feature points from PPG signal beat by beat:
• Pulse foot: the onset of the major components on the pulse following ECG QRS complex;
• Systolic peak: the major peak of the incident wave on the pulse;
• Notch: the notch (valley) point between the systolic peak and diastolic peak;
• Diastolic peak: the major peak of the reflected wave on the pulse.
Algorithm flow is shown in Figure 1. From the chart we can see that the PPG and ECG signal was decomposed and then reconstructed by wavelet method first, then the ECG signal was used to partition the PPG signal beat by beat. Lastly, four feature points of PPG signal would be detected for each cardiac cycle.
These four features were measured on the decomposed and reconstructed waves via wavelet method. The measurement of PPG feature points on a single cardiac cycle from the processed

Fre

�,��;.::=-J,... ········

........

........

: :! :! : ;::

-..
'\ Foot

!: !:

by the algorithm of and reconstmction
.
. unglllal signal or J:.al·
: PPG
Ear PPG signal processec

v
tJftr.olnno�itl()n ;:tnrl n�r:nn

Fig 2. Ear PPG signal and its feature points detected by the algorithm

284

Figure 3 gives an example of the measurement results for the four feature points on the by the algorithm on a 15s pulse waveform and synchronized ECG waveform. The detected feature points on each cardiac cycle were denoted by red markers.

D. Feature extraction by manual meth od
In order to do comparison, feature points were also extracted by manual method. Another software was also been developed by Matlab 2011a for manual measurement. This software can show the PPG sigual on the screen of computer. People can detect the feature points by mouse manually. The results were stored into the computer automatically for future analysis and comparison.

E. Data and statistical analysis
For the measurement results from manual method and automatic wavelet method, mean and standard deviation (SD) of PPG foot, systolic peak, notch and diastolic peak (all measured from ECG R wave) were calculated across all the beats for every individual. Bland-Altman plots and paired t-test were employed to demonstrate agreement between the two methods.

Fig 3. An example of measurement result

III. RESULTS
Table 2 shows the means and SDs of PPG features by manual method and automatic wavelet method. The mean differences between the two methods were within 20ms. The PPG foot measured from the automatic wavelet method was

Table 2. Mean and standard deviation of difference between R wave and feature points

Subject ID 1
2
3
4
5
6
7
8 Mean Difference± SD(ms) Pvalue

R->Foot

manual

Auto

165±2

164±2

16l±4

16l±4

149±5

155±5

179±3

19l±2

16l±3

174±2

185±6

203±10

176±7

189±8

152±4

153±4

-8±7

0.02

Mean±SD(ms)

R->Systolic peak

R->Notch

manual

Auto

manual

Auto

398±4

372±4

429±5

458±5

430±6

420±4

488±3

494±5

410±3

395±3

456±5

475±3

423±3

433±4

517±10

507±4

445±3

442±3

529±5

527±3

425±3

427±6

504±23

502±6

432±4

430±6

50l±17

510±26

397±5

365±6

428±8

45l±8

10±l4

-9±l4

0.10

0.10

R->Diastolic peak

manual

Auto

559±l2

583±13

54l±24

574±11

553±7

572±5

606±7

602±4

622±8

624±4

608±l8

604±l0

59l±38

606±26

508±11

558±20

-17±19

0.04

285

significantly longer than that from manual method (mean difference: 8ms, P = 0.02). There were no significant differences for the PPG systolic peak and the notch by the two different methods, while the diastolic peak measured from manual method was significantly shorter than that from the automatic method (mean difference: 17ms, P = 0.04).
Fignre 4 shows the Bland-Altman plot for the PPG foot measurement by the automatic and manual methods. A reasonable agreement between the two methods was demonstrated on the plot.

25

20
i-c
o
15

'"
� 10
Eo

c

o
'" .,

o

a.

o

o

.{

·5

o oo

+1.9261.S2D1o o 0 Mean
7.73
-1.96 SD

-5.74

·10 L-__-L__�____�___L____L____L__�____�__�

150

155

160

165

170

175

180

185

190

195

Average of auto operation and manual operation

Fig 4. Bland-Altman plot for the PPG foot measurement by the automatic wavelet method and manual method.
IV. DISCUSSION AND CONCLUSION
An automatic algorithm based on wavelet method was proposed in this study. It is used to the detection of PPG signal key features.

The primary results showed that reasonable agreements were obtained by the automatic method with manual measurement for the studied features, which means that the proposed automatic algorithm have the potential to be used as an alternative method for PPG signal analysis. It is helpful to improve efficiency and reduce inter-observer errors.
This study did not include finger PPG signal, although we believe that it would be similar with ear PPG signal. The reason why there were significant differences between the two methods for the measurement of PPG foot and diastolic peak measured still need to be discussed. Further research on more data is needed to verify the accuracy and robustness of this automatic method though.
REFERENCES
[I] Allen J. Photoplethysmography and its application in clinical physiological measurement[J]. Physiological measurement, 2007, 28(3): R1.
[2] Wei C, Sheng L, Lihua G, et a!. Study on conditioning and feature extraction algorithm of photoplethysmography signal for physiological parameters detection[C]//lmage and Signal Processing (CISP), 2011 4th International Congress on. IEEE, 2011, 4: 2194-2197.
[3] Fu T H, Liu S H, Tang K T. Heart rate extraction from photoplethysmogram waveform using wavelet multi-resolution analysis[J]. Joumal of Medical and Biological Engineering, 2008, 28(4): 229-232.
[4] Dingli L, Yi P, Hang C, et a!. T he establishment of a non-invasive continuous blood pressure measure system based on pulse transit time[C]//Bioinformatics and Biomedical Engineering, 2008. ICBBE 2008. T he 2nd International Conference on. IEEE, 2008: 1624-1627.
[5] Lee C M, Zhang Y T. Reduction of motion artifacts from photoplethysmographic recordings using a wavelet denoising approach[C]/lBiomedical Engineering, 2003. IEEE EMBS Asian-Pacific Conference on. IEEE, 2003: 194-195.
[6] Raghuram M, Madhav K Y, Krishna EH, et a!. Evaluation of wavelets for reduction of motion artifacts in photoplethysmographic signals[C]//Information Sciences Signal Processing and their Applications (ISSPA), 2010 10th International Conference on. IEEE, 2010: 460-463.
[7] Sahoo A, Manimegalai P, Thanushkodi K. Wavelet based pulse rate and Blood pressure estimation system from ECG and PPG signals[C]//Computer, Communication and Electrical Technology (ICCCET), 2011 International Conference on. IEEE, 2011: 285-289.

286

