Biomedical Signal Processing and Control 47 (2019) 196–206
Contents lists available at ScienceDirect
Biomedical Signal Processing and Control
journal homepage: www.elsevier.com/locate/bspc

Blood pressure estimation from appropriate and inappropriate PPG signals using A whole-based method
Seyedeh Somayyeh Mousavi a, Mohammad Firouzmand b, Mostafa Charmi a,∗, Mohammad Hemmati a, Maryam Moghadam c, Yadollah Ghorbani d
a Department of Electrical Engineering, University of Zanjan, Zanjan, Iran b Department of Biomedical Engineering, Iranian Research Organization for Science & Technology (IROST), Tehran, Iran c Department of Biomedical Engineering, Amirkabir University of Technology (Tehran-Polytechnic), Tehran, Iran d Medical Equipment Section, Valiasr Hospital, Zanjan University of Medical Sciences, Zanjan, Iran

article info
Article history: Received 17 May 2018 Received in revised form 16 July 2018 Accepted 20 August 2018 Available online 29 August 2018
Keywords: Blood pressure Photoplethysmography Whole-based Parameter-based Cuff-less

abstract
Background and objective: Blood pressure (BP) is one of the four vital signals that provides valuable medical information about the cardiovascular activity. In recent years, extensive studies have been conducted on non-invasive and cuff-less BP estimation using photoplethysmography (PPG) signals. PPG is a noninvasive optical method for measuring blood volume changes per pulse. In other words, the PPG waveform represents the mechanical activity of the heart. Methods: In this paper, a new method for estimating the Mean Arterial Pressure (MAP), Diastolic Blood Pressure (DBP) and Systolic Blood Pressure (SBP) is proposed using only the PPG signal regardless of its shape (appropriate or inappropriate). Our proposed algorithm called whole-based, uses raw values of the PPG signal at a given time interval for estimating the BP. In other algorithms called parameter-based, use features which are extracted from PPG signals in time or frequency domain. These features related to precise spotting in the form of the PPG signal. In fact, compared to parameter-based methods, our algorithm is independent of the form of the PPG signal. Results: Using the proposed algorithm, our results are completely met by the Association for the Advancement of Medical Instrumentation (AAMI) standard for both MAP and DBP estimations. The results are also very close to the standard boundary with an average error close to zero for SBP estimation. Also, according to the British Hypertension Society (BHS) standard, the proposed algorithm for DBP estimation got grade A, whereas it got grade B for estimation of MAP and got approximately grade C for SBP estimation. Conclusion: The results demonstrate the applicability of the proposed algorithm in estimating BP noninvasively, cuff-less, calibration-free, and only by using the appropriate or inappropriate PPG signal.
© 2018 Elsevier Ltd. All rights reserved.

1. Introduction
Cardiovascular disease is one of the most important causes of death in the world. According to the report of the European Heart Journal, 4.1 million people die annually due to this disease [1]. Hypertension is the main cause of cardiovascular disease. In 2014, the prevalence of hypertension was 1.3 billion people worldwide
∗ Corresponding author at: Room 101, Department of Electrical Eng., Faculty of Eng., University of Zanjan, University Blvd, 45371-38791, Zanjan, Iran.
E-mail addresses: s.somaiie.mousavie@znu.ac.ir (S.S. Mousavi), ﬁrouzmand@irost.org (M. Firouzmand), charmi.mostafa@znu.ac.ir (M. Charmi), m hemmati@znu.ac.ir (M. Hemmati), moghadam.m@aut.ac.ir (M. Moghadam), yadollah gh@yahoo.com (Y. Ghorbani).
https://doi.org/10.1016/j.bspc.2018.08.022 1746-8094/© 2018 Elsevier Ltd. All rights reserved.

as such, it is anticipated that by 2030, 1.56 billion people will suffer from hypertension [2,3].
Blood pressure (BP) is one of the signiﬁcant parameters of the human body whose measurement provides valuable information for physicians. Frequent BP measurement can avail early detection, control, and treatment of diseases associated with BP such as hypotension and hypertension [4]. BP shows the resistance of the body vessels to the movement of the blood and its amount depends on the function of the heart and vascular features, such as elasticity and thickness of the walls of the vessel [5]. The upper and lower bounds of this pressure are called Systolic Blood Pressure (SBP) and Diastolic Blood Pressure (DBP), respectively [6]. Another BP called Mean Arterial Blood Pressure (MAP) can be approximated to the following equation:

MAP = (2DBP + SBP)/3

(1)

S.S. Mousavi et al. / Biomedical Signal Processing and Control 47 (2019) 196–206

197

Fig. 1. PPG signal for a) A healthy individual [18] and b) A patient [19].

Based on the report of National Heart, Lung, and Blood Institute (NHLBI), in Hypertension, the SBP and DBP are in the ranges higher than 120 and 80 mmHg, respectively [7]. In health centers, BP is generally measured with cuff. Sphygmomanometer mercury is the most common method of measuring BP [8]. Insufﬁcient accuracy in BP measurement with cuff during movement, discreet BP monitoring, excessive weight of the cuff, discomfort inﬂations and deﬂations of the cuff in speciﬁc situations such as exercise stress test and ambulatory blood pressure monitoring (ABPM) are some of the important challenges of continuous BP measurement [5,9,10]. In the recent two decades, extensive studies have been conducted to measure BP non-invasively and without the use of any cuff.
Pulse Transit Time (PTT) is one of the most commonly used methods for obtaining BP [11]. PTT is generally deﬁned as the time that the heart beat pulse takes to propagate from the heart to the body peripherals. In most cases, researchers use Electrocardiograph (ECG) and Photoplethysmography (PPG) signals to measure this parameter. The measurement of PTT can be done with one ECG sensor and one PPG sensor or two PPG sensors [12]. Proper recording of the ECG signal requires at least three electrodes to be positioned at three different points of the body. Motion artifacts and noncontacting of the electrode with the skin surface and the electrode wires for long-term recording can add noise to the signal, which are the limiting factors of BP estimation with this method [9,13]. In recording two PPG signals to estimate BP, two distinct hardware are needed at two different points of the body. Thus, in this paper, estimating BP using only one PPG signal is intended.
Due to the elasticity of the human blood vessels, when the pressure pulse passes through them, the diameter of the vessels and then the blood volume inside them changes [14]. Plethysmography is a method for recording the change in the blood volume per heartthrob in the body while PPG is a non-invasive optical method for measuring blood volume change per pulse [15]. In this method, the light is emitted to a part of the body’s tissue by a Light Emitting Diode (LED), and changes in light absorption are measured over a period of time using a Photo Detector (PD) [16]. If the changes in blood volume are accurately measured, PPG has a wave-like form and its frequency would be the same as the working frequency of the heart [17]. The PPG signal can be divided into two parts. The upper part of the signal is related to the contraction of the heart or the systole while the underside of the signal is related to cardiac expansion or diastole. In the PPG signal, there is a time-split variable between systolic and diastolic cardiac phases which is called dicrotic notch. In many recorded samples of the PPG signals from patients with hypertension, the dicrotic notch is not detectable. Fig. 1(a) shows an example of a PPG signal and its important points that belong to a healthy person, whereas Fig. 1(b) indicates the PPG

signal which is for a patient with hypertension. In this study, a PPG signal is called appropriate if it is detectable in the three points of systole peak, dicrotic notch, and diastolic peak. Otherwise, the signal is called inappropriate.
The PPG signal is not only used for BP measurement, but also used in many cases such as studying the cardiovascular system [20], identifying individuals [21], extracting heart rate (HR) [22], determining the amount of oxygen-saturated blood [23], determining the arterial stiffness [24], determining blood-glucose levels, and measuring BP [25]. In recent years, researchers have investigated methods for measuring BP using only the PPG signal. In 2003, the ﬁrst research in the ﬁeld of BP estimation using PPG signals was conducted by Teng & Zhang that were able to estimate BP in a group of 15 people based on time interval and the amplitude of the PPG signal in the time domain, with mean error (ME) of 0.21 mmHg and standard deviation (SD) of 7.32 mmHg for SBP, and with ME of 0.02 mmHg and SD of the 4.39 mmHg for DBP [26]. Some other works have extracted speciﬁc features in the time domain of PPG signal and their results reveal the high correlation of the PPG signal with BP. In 2013, Kurylyak et al. with 21 features extracted from the PPG signal, could estimate SBP with a Mean Absolute Error (MAE) of 3.80 mmHg and SD of 3.46 mmHg and could estimate DBP with MAE of 2.21 mmHg and SD of 2.09 mmHg [27]. Some of these time domain features as illustrated in Fig. 2, are Systolic Area, Systolic Upstroke Time, Diastolic Area, Cycle Duration and Diastolic Time.
For better estimation of BP, another set of features can be deﬁned by the ﬁrst and second derivative of the PPG signal (SDPPG) that contains information about stiffness and aortic compliance and BP is highly affected by these factors. In 2016, Gaurav et al. extracted 46 features from the PPG and the second derivative of PPG signals, then used six neural networks of which each had 4 hidden layers. According to the results, DBP and SBP were estimated with MAE of 21.3 and 47.4 mmHg, respectively [29]. There have also been other studies which are based on new linear and nonlinear feature extraction of the PPG and SDPPG signal in the time domain [14]. The SDPPG consists of ﬁve waveforms called Initial Positive Wave (IPW), Early Negative Wave (ENW), Late Up sloping Wave (LUW), Late Down sloping Wave (LDW), and Diastolic Positive Wave (DPW) and these waveforms are designated with ’a’, ’b’, ’c’,’ d’, and ’e’, respectively. Fig. 3 shows some of the extracted features based on PPG and SDPPG.
In 2000, Millasseau et al. reported a new method for feature extraction in the frequency domain based on the generalized transfer function (GTF) and Fast Fourier Transform (FFT) [30]. Also, Wang et al. extracted features in the frequency domain but based on discrete cosine transform (DCT) [31]. In all studies of time and frequency domain, after the formation of the feature vector, the

198

S.S. Mousavi et al. / Biomedical Signal Processing and Control 47 (2019) 196–206

Fig. 2. Some of the time domain features in PPG signal [28].

Fig. 3. Extraction of features from PPG and SDPPG signals [14].

training stages and then BP estimation are performed using different machine learning algorithms such as regression algorithms [32], neural network [33], fuzzy logic [10], and support vector machine [12]. This approach which is the extraction of features based on precise spotting in the form of a signal is called the parameter-based approach.
In 2016, Xing et al. examined the correlation between appropriate and inappropriate PPG and BP values. In other words, the hypothesis that the good PPG signal is highly correlated with BP has been proven [34]. Correlation between BP and appropriate and inappropriate PPG signals is shown in Fig. 4, although the appropriate signal which is given in this ﬁgure is not as well-shaped as the deﬁnition of the appropriate signal presented in Fig. 1. Accordingly, both Fig. 4(a) and (b) are inappropriate signals from the viewpoint of this paper. It should be noted that in many cases, inappropriate PPG signals are also considered as inputs of machine learning algorithms. In these cases, it is anticipated that the results of the BP estimation would have high errors.
The above-mentioned features are focused on the precise spotpointing on the PPG signal. As explained, in many cases, despite the

fact that the PPG signal has its own nature, its shape changes. An example of these signals is shown in Fig. 5. Due to the possibility of occurrence of different shapes, exact spotting in their charts is not possible to extract the features and then to estimate the BP with them. Therefore, the output of the BP predictor algorithms will not be accurate enough. On the other hand, predictor algorithms provide a general equation for estimating BP. Therefore, the ﬁtting of the model to each person requires a calibration step, and even several iterations on that step [35]. In general, health-care standards do not allow any calibration step [32].
In 2016, Kiani et al. presented a new type of feature vector based on the concept of pulse arrival time (PAT) and using ECG and PPG signals together. In this method, part of the raw signal at a time interval is used as a feature vector. The formation method for this feature vector is called whole-based [32].
In this work, the solutions for two main problems are investigated; the need for calibration and extracting the precise features associated with the PPG signal. In the proposed algorithm of this paper, after employing signal processing techniques, the feature vector is extracted, which is based on the whole-based method but

S.S. Mousavi et al. / Biomedical Signal Processing and Control 47 (2019) 196–206

199

Fig. 4. Correlation between BP and appropriate and inappropriate PPG signals: a) An inappropriate PPG, b) Correlation between BP (Green line) and inappropriate PPG (Blue line), c) An appropriate PPG, and d) Correlation between BP (Green line) and appropriate PPG (Blue line) [34]. (For interpretation of the references to colour in this ﬁgure legend, the reader is referred to the web version of this article).

Fig. 5. Inappropriate PPG signals [32].

by using only the PPG signal. Then, by using the nonlinear regression algorithm on these feature vectors, all three values of MAP, SBP, and DBP are estimated continuously, noninvasively, and without any cuff with a very low ME and an appropriate SD. Based on the dependence of PPG signal on the physiological parameters of each person’s body, in this algorithm, the BP estimation model does not require calibration and it is not dependent on whether the PPG waveform is appropriate or not.

2. Methods
The proposed algorithm for BP estimation which uses only the PPG signal in a non-invasive manner and without any cuff and calibration consists of four steps:
1 Using signal pre-processing algorithms for removing the noise from the PPG signal

200

S.S. Mousavi et al. / Biomedical Signal Processing and Control 47 (2019) 196–206

Table 1 Information about database.

DBP MAP SBP HR

Mean(mmHg)
62.2 85.6 132.3 88.8

SD(mmHg)
11.10 12.95 22.91 15.17

Min(mmHg)
50 59 76 51

Max(mmHg)
117 134 200 125

Fig. 6. Diagram of the proposed algorithm for BP estimation.
2 Extracting feature vectors 3 Decreasing the dimension of the feature vectors 4 Applying nonlinear regression algorithms
Fig. 6 illustrates the block diagram of the proposed algorithm. In the following, each step is described in detail separately.
2.1. Database
In this paper, in order to evaluate the efﬁciency of the proposed method, a part of the MIMIC II data (version 3, 2015) [36] is used as the PPG and ABP (aorta blood pressure) data source. This database includes simultaneous PPG and ABP of many patients which have been recorded in various Intensive Care Units (ICU) in several hospitals. Their sampling frequency is 125 Hz, with a precision of 8 bits. It should also be noted that the ABP has been recorded from the aorta invasively and also, the PPG signal is recorded from the

ﬁngertip [37]. In this work, we consider the interval of 15 s to estimate BP from the PPG signal. In each 15 s section of the ABP signal, the minimum and maximum values are considered as DBP and SBP. Then, we calculate the MAP according to (1).
The database includes 1323 records and belongs to at least 441 individuals, because three different intervals of 15 s from one person’s data exist in the database. After checking the data, we visually found that almost 80% of the PPG signals are inappropriate. Table 1 gives the statistical information and Fig. 7 shows the histogram of the DBP, MAP, SBP and HR values.
2.2. Preprocessing
Before extracting the feature from the PPG signal, signal preprocessing algorithms are applied to reduce the effects of noise on the PPG signal. PPG signals are affected by noise such as power line interference, motion artifact, low amplitude of the PPG signal, and premature ventricular contraction [38]. Although different algorithms are proposed for noise reduction such as Empirical Mode Decomposition (EMD) [39], Discrete Wavelet Transform (DWT) [40], Inﬁnite Impulse Response (IIR), and Fast Fourier Transform (FFT) [34]. In this work, a FFT ﬁlter is chosen for noise removal. Fig. 8 illustrates the block diagram for preprocessing of the PPG signal. After transferring the signal to the frequency domain, val-

Fig. 7. Histogram of the database: a) HR, b) DBP, c) MAP, and d) SBP.

S.S. Mousavi et al. / Biomedical Signal Processing and Control 47 (2019) 196–206

201

Fig. 8. Diagram of the signal preprocessing algorithm.

ues in the range of less than 0.4 Hz and more than 8 Hz are ﬁlled with zero values. Then, the signal is again transferred to the time domain by the Inverse Fast Fourier Transform (IFFT) function. In the ﬁnal stage, the normalization of the signal is accomplished by the following equation:

PPGn= (PPG0–min(PPG0))/(max(PPG0)–min(PPG0))

(2)

Where PPG0 indicates the original PPG signal and PPGn represents normalized version of PPG0.

2.3. Extracting whole-based feature
Based on the whole-based method, all values of the PPG signal at a speciﬁc distance between two consecutive R peaks in an ECG signal is considered as the feature vector. Each of these vectors is an input of the applied machine learning algorithms. It should be noted that the training algorithm is done independently for the estimation of SBP, DBP, and MAP. The feature vectors introduced in this paper include the values between two consecutive systolic peak of PPG signals. In the following, the procedure for extracting the feature vector is explained:

1 At ﬁrst, a zero-dimensional matrix of 4 × sampling frequency (fs) is considered as the feature vector. According to Table 1, the minimum and maximum of HR are 51 and 125 bpm, respectively. Consequently, the maximum and minimum time intervals between two consecutive systolic peaks of the PPG signal are 1.17 and 0.48 s, respectively. Because the sampling frequency is 125 Hz, 125 samples are necessary to record one second of the signal. In this way, the basic assumption for the length of the feature vector is sufﬁcient to record all the points between two consecutive systolic peaks in all kinds of the PPG signals.
2 After the signal preprocessing step is applied, the systolic points of the PPG signal are detected by using the Automatic Multi-scalebased Peak Detection (AMPD) algorithm [41].
3 The values between the ﬁrst and second successive systolic peaks of the PPG signal, respectively, ﬁtting from the ﬁrst home of the feature vector matrix, and the value of the end points of the feature vector may also be zero.
4 Resampling is done by performing an interpolation operation by the length 5 × fs. If the values at the end points of the feature vectors are zero, this operation may change them, however these changes are very small.
Fig. 9 shows the extraction and formation of the feature vectors.

Fig. 9. Extraction of the whole-based feature vector.

202
Table 2 Performance of the BP estimator.
Learner algorithms
Decision Tree Regression Support Vector Regression Adaptive Boosting Regression Random Forest Regression

S.S. Mousavi et al. / Biomedical Signal Processing and Control 47 (2019) 196–206

SBP
Mean
−0.247 −0.655 0.187 0.196

SD
6.736 7.506 4.173 4.731

MAP
Mean
0.050 −0.597 0.067 0.196

SD
9.594 9.055 4.911 5.714

DBP
Mean
0.021 −0.903 −0.050 0.155

SD
18.543 16.717 8.901 10.683

2.4. Dimension reduction
In the proposed method, dimensional reduction algorithm is used in the whole-based method for two reasons: The lengths of the feature vectors are large, and the values of the whole-based feature vectors have a very high correlation with each other. Reducing the length of the feature vector in the training and evaluation section would reduce the amount of computing. Furthermore, the reduction of data correlation increases the efﬁciency of the model training process. By using the principal component analysis (PCA) algorithm, the length of the feature vector is reduced by maintaining 98% of the energy of the vectors. This step reduces the length of the feature vectors from 625 to 43.
2.5. Calibration free by non-linear regression
In this paper, the model for training and evaluating the BP estimation values is performed by implementing 4 nonlinear regression algorithms. Owing to the nonlinear relation between the PPG and BP signals, the linear regression algorithm is not explained. Furthermore, the results of the linear regression algorithm on the database of this paper do not produce acceptable results in terms of the criteria of the Advancement of Medical Instrumentation (AAMI) standard [42], and the British Hypertension Society (BHS) standard [43]. It should be noted that the proﬁciency of all the following algorithms which have been implemented using the Scikit library in the Python programming environment [44] is studied in this work:
A Decision tree regression: The decision tree (DT) is a model for deciding and classifying a particular data, and is composed of a number of nodes and branches as a tree. The most important task in assigning the decision tree is to determine the attribute of the data that leads to a greater resolution. Then, these attributes are ranked for decision. When the output of a decision tree is a real number, the method is called decision tree regression (DTR) [45].
B Support vector regression: Support vector machine (SVM) is one of the techniques of machine learning. An important feature of the SVM is its structural risk minimization; unlike algorithms such as linear regression which operate by minimizing the absolute magnitude of the error or the second power of the error. Because of this, SVM does not encounter the local minima associated with the error function. It also avails making nonlinear decisions using nonlinear kernels. The Support vector regression (SVR) algorithm is used by processing kernels such as radial basis function (RBF) in the SVM algorithm for nonlinear regression problems [46].
C Adaptive Boosting regression: Adaptive Boosting Regression (AdaboostR) generates the estimation function using a large number of weak estimators. However, each of the estimators alone produces a poor result in reaching the target value, their weighted composition can produce a favorable result. In this algorithm, DTR is usually selected as a weak estimator. The AdaboostR in contrast to complex models does not have much chance of over ﬁtting. Due to the large number of DTR estimators, it requires a high memory capacity to store the ﬁnal model. It should also be noted that the training algorithm is implemented

sequentially. In other words, estimating coefﬁcients in each step requires the estimated results of the previous step. This operation causes the algorithm’s learning process to be slowed down [47]. In this paper, the AdaboostR algorithm is implemented with 500 DTR estimators. D Random Forest regression: In a standard tree, each node of a decision is broken at the best point to create the highest resolution, but in Random Forest (RF), each node is broken down based on the best point, which is a point of the range of attributes that are randomly selected at the node level. The Random Forest regression (RFR) falls into a class of algorithms that estimate the result in a group method and the ﬁnal result is the average result of simple estimators. In this algorithm, DTR is evaluated as a weak estimator like in AdaboostR. The RFR model also needs a large amount of memory to store the ﬁnal model, but due to the parallel training of trees, in the entire model, the training process is faster than AdaboostR [48].
3. Results
As mentioned previously, extracted feature vectors are used as inputs to nonlinear regression algorithms. In each of the four nonlinear regression models, estimation of each of the BP values (DBP, MAP, SBP) is done by separating training and testing data with the 10 fold cross validation algorithm. Table 2 shows the performance of nonlinear models of the BP estimator with whole-based feature vectors. The results are based on the ME of estimating the BP with the actual value of BP and the SD of these errors.
A model is selected as a best estimator if it contains the minimum ME and SD in the results. The low average error in the results of the learning algorithms is around the least standard deviation of the error. However, ME is the most important parameter to compare the accuracy of the algorithms, its values for different algorithms are very close to each other; thus, the best algorithm is selected with the lowest SD. In this way, the best estimator algorithm is AdaBoostR. Based on the results, the time intervals of two consecutive systolic peaks of PPG signals are enough for BP estimation.
Figs. 10 and 11 show the histogram of the estimation error in the AdaBoostR model for all three values of BP. The errors in the BP estimation in all three histograms are distributed normally around zero. According to the histogram of the error, the dispersion of the estimated error of SBP is approximately twice the DBP and MAP. The results of the AdaboostR algorithm in Table 2 prove the correctness of this observation.
Figs. 12 and 13 present the linear regression and the Bland Altman plot for all three BP values, respectively. All three linear regression forms support the claim that the nonlinear AdaBoostR algorithm estimates the BP accurately with a near-zero error. There are also three Bland Altman charts which most of the error of the predicted values are less than 5 mmHg.
In the AAMI standard, based on the ME and SD, the validity of the proposed algorithm is examined. The results of the AdaboostR algorithm’s evaluation based on the AAMI standard are presented in Table 3. According to this standard, if the algorithm is executed at least on 255 separated samples, the results are reliable. Also,

S.S. Mousavi et al. / Biomedical Signal Processing and Control 47 (2019) 196–206

203

Fig. 10. The error histograms of the BP estimations for a) DBP and b) MAP.

Fig. 11. The error histograms of the SBP estimations.

based on this standard, up to 3 times samples from each person is permissible; therefore, at least 85 individuals must participate in the experiment. Based on this standard, the validity of an algorithm is conﬁrmed if the ME of measurements is less than 5 mmHg and the SD of errors is less than 8 mmHg.
In this research, the non-linear algorithm of AdaboostR is performed on 1323 samples. According to Table 3, the results of the AdaboostR algorithm in the DBP and MAP estimation are fully accepted by the AAMI standard; but the model in the SBP estimation despite its acceptable ME, its SD value is slightly greater than the maximum permissible range of the standard.

Moreover, the accuracy of the proposed algorithm is checked from the viewpoint of the BHS standard, which reports on the accuracy of the algorithm in three categories based on the percentage of the cumulative error. In this standard, at least 85 people must be studied, which is similar to the AAMI standard. The accuracy of an algorithm is graded according to the percentage of cumulative error of the results detailed in Table 4. The results of the AdaBoostR algorithm based on the BHS standard are shown in Table 5. In accordance with this standard, the AdaBoostR algorithm is classiﬁed in category A and B for the estimation of DBP and MAP, respectively. For SBP estimation, in the range less than 15 mmHg, if 1% of error

Table 3 The comparison of the results of this paper with the AAMI standard.

Our Results AAMI [42]

DBP MAP SBP BP

MEAN(mmHg)
0.187 0.067 −0.050 ≤5

SD(mmHg)
4.173 4.911 8.901 ≤8

Subject
441 441 441 ≥85

Table 4 Bhs grading standard.

Cumulative Error Percentage

Grade A Grade B Grade C

≤5 mmHg
60% 50% 40%

≤10 mmHg
85% 75% 65%

≤15 mmHg
95% 90% 85%

204

S.S. Mousavi et al. / Biomedical Signal Processing and Control 47 (2019) 196–206

Fig. 12. Linear regression for BP values: a) DBP, b) MAP, c) SBP.

Table 5 The comparison of the results of this paper with the BHS standard.

Cumulative Error Percentage

DBP MAP SBP

≤5 mmHg
1118 (84%) 1055 (79%) 953 (71%)

≤10 mmHg
1227 (92%) 1166 (83%) 1027 (77%)

≤15 mmHg
1295 (97%) 1236 (93%) 1113 (84%)

Total
1323 1323 1323

due to the high volume and variety of data can be ignored, the algorithm for SBP estimation falls in category C.
4. Discussion
According to statistics, hypertension which is one of the major causes of cardiovascular diseases is on the increase. The continuous measurement of BP is one of the most basic methods of controlling and treating this type of disease. In today’s world, high-speed living does not allow people to constantly go to health centers for BP measurement. The availability of BP measurement devices with cuff is not always possible at any time and at any place. On the other hand,

Fig. 13. Bland-Altman for BP values: a) DBP, b) MAP, c) SBP.
due to the further development of mobile-health technologies, the development of high-reliability algorithms for implementing an application of mobile phones seems to be essential for computing BP. Nowadays, all mobile phones are almost equipped with a PPG signal sensor. The PPG signal is easily recorded from the wrist and ﬁngertip, and PPG signal recording does not require a special ability and skill. Also, the PPG signal recording hardware is of very low cost.
In our previous study, we estimated BP by using only the ECG signal, which is useful in many cases such as an exercise test and ECG Holter devices, but the challenges of the correct ECG signal recording and its related hardware are limiting factors in this algorithm development in any place and at any time [49]. In this paper, our aim is providing an effective algorithm for the BP estimation noninvasively, without cuff and without calibration, by the appropriate and inappropriate PPG signal. In some cases, the shape of the PPG signal changes, which makes it impossible to extract the useful features of the signal. The proposed algorithm for whole-based feature vector extraction is based on raw signal values, but does not depend on its shape.
In the following, the results of this work are compared to other studies based on BP estimation by using only the PPG signal. The

RMSE – – – – 10.9 – – – – – – – 8.9

SD2 – – – – – – 8.202 – 3.46 13.1 – – 7.99

MAE – 4.47 – – 8.45 – 11.6415 – 3.8 0.78 – – 3.97

SD1 7.68 6.85 7.08 13.81 – 4.2 – 2.91 – – 4.3 19.35 8.901

SBP ME 4.77 0.16 0.06 −1.95×10−16 – 3.8 – 2.32 – – 5.1 −2.98 −0.050

RMSE – – – – – – – – – – – – 4.92

SD2 – – – – – – – – – – – – 4.16

MAE – – – – – – – – – – – – 2.61

SD1 5.87 – – 10.44 – – – – – – – 10.35 4.911

S.S. Mousavi et al. / Biomedical Signal Processing and Control 47 (2019) 196–206

205

results of each of these studies have been reported based on spe-

ciﬁc criteria such as root mean square error (RMSE), ME, MAE, and

SD related to each of them. To perform a fair comparison, all algo-

rithms should be executed in the same database in terms of the

number and type of data; however, it is not possible in the consid-

ered studies. Table 6 includes the results of this study along with

the data obtained from other works which have estimated BP based

on only the PPG signal.

Overall, the proposed method in this paper has acceptable

results in terms of accuracy compared to other studies; but due

to

the

fact

that

the

size

of

data

used

in

[34]

is

approximately

1 19

times that of the amount of data in this study, their results are

better. It should be noted that the used database in this work con-

tains patient data from ICU sections of hospitals, but the research

data from [51] and [53] have been collected from healthy peo-

ple. Undoubtedly, the results of the proposed method would be

greatly improved by adding data of healthy individuals to the

database and involving them in the training and testing section

of this research. PPG signals related to a person are highly corre-

lated with each other, and then the frequent use of one person’s

signals in the database can improve the estimated results, but

the level of the algorithm’s generalizability decreases. According

to AAMI, an individual’s data can be used up to three times in

the database. This research, considering this limitation, includes

at least 400 people and unless it has fewer records compared to

studies such as [12] and [35], it has a better accuracy. In many

studies, calibration has been used to improve the results, but the

results of this work are without calibration. Additionally, the fact

that 80% of the studied database includes inappropriate PPG sig-

nals and the proposed method’s success in accurate estimation

of BP validates that the proposed method for BP estimation is

independent of the form of PPG signals. In contrast, the results of

parameter-based methods are not as accurate as the whole-based

method.

5. Conclusion
In this paper, a new approach based on using only the PPG signal is proposed for BP estimation which is noninvasive, cuff less, calibration-free, and continuous. In this study, the problem of conventional feature extraction methods including their lack of accuracy in the conditions that the PPG signal is inappropriate is solved.
The proposed algorithm is based on the non-linear relationship between BP and the PPG signal of a person. The results demonstrate the potential of the proposed algorithm for accurate BP estimation. According to the estimated results, in both parts of the DBP and MAP, the conditions are met to comply with the AAMI standard requirements and in SBP estimation with a ME close to zero and SD close to the standard AAMI limit. This achievement is due to the high number and variety of data used in the implementation of the algorithm. Also, according to BHS standard, learning algorithms in DBP and MAP estimation achieve grade A and B, respectively and for SBP estimation, by ignoring the 1% error, it can be categorized as grade C.
As a future work, in order to improve the accuracy of the BP estimation, data from healthy people are recommended to be used for data training of the proposed method.

Conﬂict of interest All authors declare that they have no conﬂict of interest.

MAP ME 3.85 – – 9.34×10−7 – – – – – – – −3.38 0.067

RMSE – – – – 5.8 – – – – – – – 4.18

– – – – – – 6.7837 – 2.09 10.23 – – 3.37

SD2

SD1 : Standard deviation of errors, SD2 : Standard deviation of absolute errors.

– 3.21 – – 4.34 – 7.617 – 2.21 0.59 – – 2.43

MAE

5.69 4.72 4.66 9.45 – – – 2.47 – – 4.3 8.69 4.173

SD1

3.67 0.03 0.01 7×10−15 – – – 1.92 – – 4.6 −3.65 0.187

ME

DBP

7678 3000 69 113 910 – 7000< 250< 15,000< 7000< 78 53708 1323

Record

Table 6 The comparison of the results of this paper with other works.

32 – 69 113 – 10 19 – – 32 65 572 400<

Subject

[35] [29] [34] [50] [14] [51] [12] [33] [27] [52] [53] [54] This WORK

work

References
[1] M. Nichols, N. Townsend, P. Scarborough, M. Rayner, Cardiovascular disease in Europe: epidemiological update, Eur. Heart J. 34 (2013) 3028–3034.

206

S.S. Mousavi et al. / Biomedical Signal Processing and Control 47 (2019) 196–206

[2] W. H. Organization, et al., World Health Statistic 2015, World Health Organization, 2015.
[3] V. Perkovic, R. Huxley, Y. Wu, D. Prabhakaran, S. MacMahon, The burden of blood pressure-related disease: a neglected priority for global health, Hypertension 50 (2007) 991–997.
[4] X.-R. Ding, N. Zhao, G.-Z. Yang, R.I. Pettigrew, B. Lo, F. Miao, et al., Continuous blood pressure measurement from invasive to unobtrusive: celebration of 200th birth anniversary of Carl Ludwig, IEEE J. Biomed. Health Inform. 20 (2016) 1455–1465.
[5] L. Peter, N. Noury, M. Cerny, A review of methods for non-invasive and continuous blood pressure monitoring: pulse transit time method is promising? IRBM 35 (2014) 271–282.
[6] P.A. Iaizzo, Handbook of Cardiac Anatomy, Physiology, and Devices, Springer Science & Business Media, 2009.
[7] N.H. Lung, B. Institute, Diseases and Conditions Index: Hypotension, 2008. [8] D. Buxi, J.-M. Redouté, M.R. Yuce, A survey on signals and systems in
ambulatory blood pressure monitoring using pulse transit time, Physiol. Meas. 36 (2015), p. R1. [9] Y. Zheng, C.C. Poon, B.P. Yan, J.Y. Lau, Pulse arrival time based cuff-less and 24-H wearable blood pressure monitoring and its diagnostic value in hypertension, J. Med. Syst. 40 (2016) 195. [10] S. Mottaghi, M. Moradi, L. Roohisefat, Cufﬂess blood pressure estimation during exercise stress test, Int. J. Biosci. Biochem. Bioinform. 2 (2012) 394. [11] L. Geddes, M. Voelz, C. Babbs, J. Bourland, W. Tacker, Pulse transit time as an indicator of arterial blood pressure, Psychophysiology 18 (1981) 71–74. [12] Y. Zhang, Z. Feng, A SVM method for continuous blood pressure estimation from a PPG Signal, in: Proceedings of the 9th International Conference on Machine Learning and Computing, 2017, pp. 128–132. [13] C. Sideris, H. Kalantarian, E. Nemati, M. Sarrafzadeh, Building continuous arterial blood pressure prediction models using recurrent networks, in: 2016 IEEE International Conference on Smart Computing (SMARTCOMP), 2016, pp. 1–5. [14] M. Liu, P. Lai-Man, H. Fu, Cufﬂess blood pressure estimation based on photoplethysmography signal and its second derivative, Int. J. Comput. Theory Eng. 9 (2017) 202. [15] J. Allen, Photoplethysmography and its application in clinical physiological measurement, Physiol. Meas. 28 (2007), p. R1. [16] T. Tamura, Y. Maeda, M. Sekine, M. Yoshida, Wearable photoplethysmographic sensors—past and present, Electronics 3 (2014) 282–302. [17] Z. Zhang, Z. Pi, B. Liu, TROIKA: a general framework for heart rate monitoring using wrist-type photoplethysmographic signals during intensive physical exercise, IEEE Trans. Biomed. Eng. 62 (2015) 522–531. [18] J. Spigulis, I. Kukulis, E. Fridenberga, G. Venckus, Potential of advanced photoplethysmography sensing for noninvasive vascular diagnostics and early screening, in: Clinical Diagnostic Systems: Technologies and Instrumentation, 2002, pp. 38–44. [19] A. Suzuki, K. Ryu, Feature selection method for estimating systolic blood pressure using the Taguchi method, IEEE Trans. Ind. Inform. 10 (2014) 1077–1085. [20] S. Botman, D. Borchevkin, V. Petrov, E. Bogdanov, M. Patrushev, N. Shusharina, Photoplethysmography-based device designing for cardiovascular system diagnostics, World Acad. Sci., Eng. Technol. Int. J. Med. Health Biomed. Bioeng. Pharm. Eng. 9 (2015) 689–693. [21] V. Jindal, J. Birjandtalab, M.B. Pouyan, M. Nourani, An adaptive deep learning approach for PPG-based identiﬁcation, in: 2016 IEEE 38th Annual International Conference of the Engineering in Medicine and Biology Society (EMBC), 2016, pp. 6401–6404. [22] I. Reyes, H. Nazeran, M. Franco, E. Haltiwanger, Wireless photoplethysmographic device for heart rate variability signal acquisition and analysis, in: 2012 Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), 2012, pp. 2092–2095. [23] C.N. Devi, Z.C. Alex, Non-invasive estimation of oxygen saturation level in blood, Indian J. Sci. Technol. 10 (2017). [24] M. Huotari, A. Vehkaoja, K. Määttä, J. Kostamovaara, Photoplethysmography and its detailed pulse waveform analysis for arterial stiffness, J. Struct. Mech. 44 (2011) 345–362. [25] E. Monte-Moreno, Non-invasive estimate of blood glucose and blood pressure from a photoplethysmograph by means of machine learning techniques, Artif. Intell. Med. 53 (2011) 127–138. [26] X. Teng, Y. Zhang, Continuous and noninvasive estimation of arterial blood pressure using a photoplethysmographic approach, in: 2003 Proceedings of the 25th Annual International Conference of the IEEE Engineering in Medicine and Biology Society, 2003, pp. 3153–3156. [27] Y. Kurylyak, F. Lamonaca, D. Grimaldi, A neural network-based method for continuous blood pressure estimation from a PPG signal, in: 2013 IEEE International Instrumentation and Measurement Technology Conference (I2MTC), 2013, pp. 280–283. [28] S. Datta, A.D. Choudhury, A. Chowdhury, T. Banerjee, R. Banerjee, S. Bhattacharya, et al., Novel statistical Post processing to improve blood pressure estimation from smartphone photoplethysmogram, in: Proceedings of the First International Workshop on Human-Centered Sensing, Networking, and Systems, 2017, pp. 31–36. [29] A. Gaurav, M. Maheedhar, V.N. Tiwari, R. Narayanan, Cuff-less PPG based continuous blood pressure monitoring—A smartphone based approach, in:

IEEE 38th Annual International Conference of the Engineering in Medicine and Biology Society (EMBC), 2016, 2016, pp. 607–610. [30] S.C. Millasseau, F.G. Guigui, R.P. Kelly, K. Prasad, J.R. Cockcroft, J.M. Ritter, et al., Noninvasive assessment of the digital volume pulse: comparison with the peripheral pressure pulse, Hypertension 36 (2000) 952–956. [31] Z. Wang, Y. Zhang, A novel frequency domain method for estimating blood pressure from photoplethysmogram, in: Proceedings of the 9th International Conference on Signal Processing Systems, 2017, pp. 201–206. [32] M. Kachuee, M.M. Kiani, H. Mohammadzade, M. Shabany, Cufﬂess blood pressure estimation algorithms for continuous health-care monitoring, IEEE Trans. Biomed. Eng. 64 (2017) 859–869. [33] P. Li, M. Liu, X. Zhang, X. Hu, B. Pang, Z. Yao, et al., Novel wavelet neural network algorithm for continuous and noninvasive dynamic estimation of blood pressure from photoplethysmography, Sci. China Inf. Sci. 59 (2016), p. 042405. [34] X. Xing, M. Sun, Optical blood pressure estimation with photoplethysmography and FFT-based neural networks, Biomed. Opt. Express 7 (2016) 3007–3020. [35] K. Duan, Z. Qian, M. Atef, G. Wang, A feature exploration methodology for learning based cufﬂess blood pressure measurement using photoplethysmography, in: IEEE 38th Annual International Conference of the Engineering in Medicine and Biology Society (EMBC), 2016, 2016, pp. 6385–6388. [36] M. Kachuee, M.M. Kiani, H. Mohammadzade, M. Shabany, Cuff-less high-accuracy calibration-free blood pressure estimation using pulse transit time, in: IEEE International Symposium on Circuits and Systems (ISCAS), 2015, 2015, pp. 1006–1009. [37] A.L. Goldberger, L.A. Amaral, L. Glass, J.M. Hausdorff, P.C. Ivanov, R.G. Mark, et al., Physiobank, physiotoolkit, and physionet, Circulation 101 (2000) e215–e220. [38] M. Elgendi, On the analysis of ﬁngertip photoplethysmogram signals, Curr. Cardiol. Rev. 8 (2012) 14–25. [39] G. Rilling, P. Flandrin, P. Goncalves, On empirical mode decomposition and its algorithms, in: IEEE-EURASIP Workshop on Nonlinear Signal and Image Processing, 2003, pp. 8–11. [40] M. Holschneider, R. Kronland-Martinet, J. Morlet, P. Tchamitchian, A real-time algorithm for signal analysis with the help of the wavelet transform, in: Wavelets, Springer, 1990, pp. 286–297. [41] F. Scholkmann, J. Boss, M. Wolf, An efﬁcient algorithm for automatic peak detection in noisy periodic and quasi-periodic signals, Algorithms 5 (2012) 588–603. [42] A. f. t. A. o. M. Instrumentation, American National Standard. Manual, Electronic or Automated Sphygmomanometers, ANSI/AAMI SP10-2002/A1, 2003. [43] E. O’brien, B. Waeber, G. Parati, J. Staessen, M.G. Myers, Blood pressure measuring devices: recommendations of the European Society of Hypertension, BMJ: Br. Med. J. 322 (2001) 531. [44] F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel, et al., Scikit-learn: machine learning in Python, J. Mach. Learn. Res. 12 (2011) 2825–2830. [45] S.C. Lemon, J. Roy, M.A. Clark, P.D. Friedmann, W. Rakowski, Classiﬁcation and regression tree analysis in public health: methodological review and comparison with logistic regression, Ann. Behav. Med. 26 (2003) 172–181. [46] H. Drucker, C.J. Burges, L. Kaufman, A.J. Smola, V. Vapnik, Support vector regression machines, in: Advances in Neural Information Processing Systems, 1997, pp. 155–161. [47] H. Drucker, Improving regressors using boosting techniques, ICML (1997) 107–115. [48] A. Liaw, M. Wiener, Classiﬁcation and regression by randomForest, R news 2 (2002) 18–22. [49] S.S. Mousavi, M. Charmi, M. Firouzmand, M. Moghadam, M. Hemmati, Y. Ghorbani, Cuff-less & Calibration-free Blood Pressure Estimation Using Only the ECG Signal, is submitted to Elsevier Computers in Biology and Medicine, 2018. [50] H. Jiang, F. Miao, M. Gao, X. Hong, Q. He, H. Ma, et al., A novel indicator for cuff-less blood pressure estimation based on photoplethysmography, in: International Conference on Health Information Science, 2016, pp. 119–128. [51] R. Gircys, A. Liutkevicius, A. Vrubliauskas, E. Kazanavicius, Blood pressure estimation accoording to photoplethysmographic signal steepness, Inf. Technol. Control. 44 (2015) 443–450. [52] A.D. Choudhury, R. Banerjee, A. Sinha, S. Kundu, Estimating blood pressure using Windkessel model on photoplethysmogram, in: 2014 36th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), 2014, pp. 4567–4570. [53] S.C. Gao, P. Wittek, L. Zhao, W.J. Jiang, Data-driven estimation of blood pressure using photoplethysmographic signals, in: 2016 IEEE 38th Annual International Conference of the Engineering in Medicine and Biology Society (EMBC), 2016, pp. 766–769. [54] J.C. Ruiz-Rodríguez, A. Ruiz-Sanmartín, V. Ribas, J. Caballero, A. García-Roche, J. Riera, et al., Innovative continuous non-invasive cufﬂess blood pressure monitoring based on photoplethysmography technology, Intensive Care Med. 39 (2013) 1618–1625.

